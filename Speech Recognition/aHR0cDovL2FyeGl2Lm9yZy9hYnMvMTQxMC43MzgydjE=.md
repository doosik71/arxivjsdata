# Modified Mel Filter Bank to Compute MFCC of Subsampled Speech

Kiran Kumar Bhuvanagiri, Sunil Kumar Kopparapu

## 🧩 Problem to Solve

이 논문은 음성 신호의 시간 스케일 변형(Time Scale Modification, TSM), 특히 다운샘플링(시간 압축)된 음성에서 MFCC(Mel-Frequency Cepstral Coefficients)를 효율적으로 추출하는 문제를 다룹니다. 주요 목표는 다운샘플링된 음성에서 추출된 MFCC가 원본 음성의 MFCC와 높은 상관관계를 유지하도록 하는 것입니다. 이를 통해 원본 음성으로 훈련된 음성 인식 모델을 다운샘플링된 음성에 적용할 때 인식 성능 저하를 최소화하는 방법을 찾는 것이 핵심 과제입니다. 기존 방법들은 이러한 목표를 달성하는 데 한계가 있었습니다.

## ✨ Key Contributions

- **수정된 멜 필터 뱅크 제안:** 다운샘플링된 음성에서 MFCC를 추출하기 위한 새로운 멜 필터 뱅크 구성 방법을 제안합니다.
- **높은 MFCC 상관관계 달성:** 제안된 방법이 기존 연구([8])와 비교하여 원본 음성 MFCC와 다운샘플링된 음성 MFCC 간의 상관관계를 현저히 높임을 입증했습니다.
- **우수한 음성 인식 성능:** 다운샘플링된 음성에서 제안된 방법을 사용할 경우, 원본 음성과 유사한 수준의 음성 인식 성능을 달성할 수 있음을 보여주었습니다.
- **새로운 평가 지표 도입:** 멜 필터 뱅크 구성의 효과를 평가하기 위해 피어슨 상관계수 외에 음성 인식 정확도라는 더 강력한 지표를 활용했습니다.

## 📎 Related Works

- 본 논문은 다운샘플링된 음성에서 MFCC를 계산할 때 멜 필터 뱅크의 선택에 대해 다룬 S. Kopparapu와 L. Narayana의 이전 연구([8])와 주로 비교하며 그 한계를 지적합니다. [8]에서는 6가지 유형의 필터 뱅크를 제안하고 피어슨 계수로 유사도를 측정했습니다.
- 그 외에도 시간 스케일 변형(TSM) 기술([1, 2]), MFCC 계산 원리([3, 12, 13, 15]), 음성 및 화자 인식 시스템([4, 5, 6, 7]), 그리고 실험에 사용된 AN4 데이터베이스 및 Sphinx ASR 엔진([9, 10, 14])과 관련된 일반적인 연구들이 참조되었습니다.

## 🛠️ Methodology

1. **MFCC 계산 개요:**

   - 샘플링 주파수 $f_s$의 음성 신호 $x[n]$은 $N$ 샘플 길이의 $P$개 프레임으로 분할되며, $N/2$의 오버랩을 가집니다.
   - 각 프레임에 해밍 윈도우를 적용하고 DFT(Discrete Fourier Transform)를 수행하여 $X_p(k)$를 얻습니다.
   - 주파수 스펙트럼의 크기 $|X_p(k)|$를 추출합니다.
   - 인간 청각의 주파수 해상도 특성을 모방하기 위해 멜 필터 뱅크 $M(m,k)$를 사용하여 크기 스펙트럼을 멜 스케일로 변환합니다. 멜 주파수 $\phi_f$와 선형 주파수 $l_f$는 $\phi_f = 2595 \cdot \log_{10}(1 + l_f/700)$의 관계를 가집니다.
   - 필터 뱅크 출력의 로그 값(멜 스펙트럼) $L_p(m,k) = \ln \left\{ \sum_{k=0}^{N-1} M(m,k) \cdot |X_p(k)| \right\}$를 계산합니다.
   - $L_p(m,k)$에 DCT(Discrete Cosine Transform)를 적용하여 MFCC 파라미터 $\Phi_r^p\{x[n]\} = \sum_{m=1}^F L_p(m,k) \cos\left\{ \frac{r(2m-1)\pi}{2F} \right\}$를 얻습니다.

2. **재샘플링된 음성의 MFCC:**

   - 재샘플링된 음성 $y[s]$는 $x[\alpha n]$으로 표현되며, $\alpha$는 스케일링 인자입니다 (시간 압축 시 $\alpha > 1$).
   - 재샘플링된 프레임의 DFT $Y_p(k')$는 원본 DFT $X_p(k)$와 $Y_p(k') = \frac{1}{\alpha} \sum_{l=0}^{\alpha-1} X_p(k'+lS)$ (여기서 $S = N/\alpha$)의 관계를 가집니다.
   - 여기서 핵심은 재샘플링된 음성에 적합한 멜 필터 뱅크 $M'(m,k')$를 구성하는 것입니다.

3. **제안된 수정 멜 필터 뱅크 $M_{new}(m,k')$:**

   - 제안된 방법은 원본 멜 필터 뱅크를 다운샘플링 계수 $\alpha$에 따라 스케일링하는 것입니다.
   - 수정된 필터 뱅크는 $M_{new}(m,k') = M(m, \alpha k')$ (선형 주파수 $l_f(k') \le (1/\alpha \cdot f_s/2)$ 범위에서)로 정의됩니다.
   - 다운샘플링된 신호의 나이퀴스트 주파수 $f_s/(2\alpha)$ 이상의 주파수 대역에서는 필터 뱅크 출력을 0으로 설정합니다.
   - 원본과 동일한 수의 필터 뱅크 출력($F$)을 유지하기 위해, 나머지 출력(중심 주파수 $f_c$가 $f_s/(2\alpha)$ 미만인 필터 수 $F_\xi$를 초과하는 $F_\xi < m \le F$인 경우)은 마지막 유효 출력에 기반하여 $L_{new,p}(m,k') = (0.95)^{m-F_\xi} L_{new,p}(F_\xi,k')$와 같이 정의됩니다. 이는 지수적 감소를 적용하는 방식입니다.
   - 실험에서는 $\alpha=2$ (16kHz에서 8kHz로 다운샘플링)를 사용했고, 윈도우 길이는 절반($N/2$)으로 설정했습니다.

4. **평가 지표:**
   - **피어슨 상관계수 ($r$):**
     - **Case I:** 모든 프레임의 $F$차원 MFCC 벡터를 연결한 후 원본과 다운샘플링된 음성 MFCC 간의 $r$을 계산합니다.
     - **Case II:** 각 개별 프레임의 MFCC에 대해 $r$을 계산한 후 평균과 분산을 보고합니다.
   - **음성 인식 정확도:** Sphinx 툴박스를 사용하여 원본 (16kHz) 음성으로 음향 모델을 훈련합니다. 인식은 원본 (16kHz) 및 다운샘플링된 (8kHz) 음성 모두에서 수행됩니다. Case A (30 MFCC) 및 Case B (13 MFCC + 13 속도 + 13 가속도 계수, 총 39차원 특징 벡터)의 두 가지 경우를 평가합니다.

## 📊 Results

AN4 오디오 데이터베이스에서 실험을 수행했습니다 (원본 16kHz, $\alpha=2$로 8kHz 다운샘플링). 30개의 멜 밴드(130Hz ~ 6800Hz)가 사용되었습니다.

- **피어슨 상관계수:**

  - **Case I (연결된 MFCC):** 제안된 방법은 평균 $r$ 값이 0.986 (분산 0.00004)을 달성하여, [8]의 최고치(0.913, 분산 0.00087)보다 현저히 높은 상관관계를 보였습니다.
  - **Case II (프레임별 MFCC):** 제안된 방법은 평균 $r$ 값이 0.961 (분산 0.00433)을 달성하여, 이 역시 [8]의 최고치(0.756, 분산 0.07570)보다 훨씬 높았습니다.
  - 두 경우 모두 제안된 필터 뱅크는 원본과 다운샘플링된 MFCC 간에 훨씬 높은 상관관계를 일관되게 보여주었습니다.

- **음성 인식 성능 (773개 단어에 대한 단어 인식률):**

  - **기준선 (원본 16kHz 음성):** Case A: 43.21%, Case B: 81.63%.
  - **제안된 방법 (8kHz 다운샘플링된 음성):** Case A: 37.00%, Case B: 77.62%. 이는 원본 음성의 기준선 성능에 매우 근접한 수치입니다.
  - **[8]의 최고 방법 (8kHz 다운샘플링된 음성):** Case A: 3.88% (Type C), Case B: 11.90% (Type C).
  - 제안된 방법은 다운샘플링된 음성 인식 정확도 면에서 [8]의 6가지 방법 모두를 압도적으로 능가했습니다.

- **시각적 비교 (필터 뱅크 출력):** 그림 2를 통해 제안된 멜 필터 뱅크의 출력이 원본 음성과 매우 유사하게 동작하는 반면, [8]의 최적 방법은 필터 뱅크 출력에서 상당한 편차를 보여 성능 차이의 원인을 설명합니다.

## 🧠 Insights & Discussion

- 이 연구의 핵심 통찰은 다운샘플링된 음성에 대해 멜 필터 뱅크의 중심 주파수와 대역폭이 원본 음성의 그것과 밀접한 관계를 유지해야 한다는 것입니다. 제안된 방법은 원본 필터 뱅크를 효과적으로 스케일링하고, 다운샘플링된 신호의 나이퀴스트 주파수 이상의 고주파 대역을 적절히 처리(0으로 설정 및 나머지 대역 지수적 감소)함으로써 이를 달성합니다.
- 높은 피어슨 상관계수(예: 0.986)는 제안된 방법으로 다운샘플링된 음성에서 추출된 MFCC가 원본 음성의 MFCC와 매우 유사하여 중요한 판별 정보를 보존함을 나타냅니다.
- 음성 인식 결과는 제안된 필터 뱅크의 실용적인 유용성을 강력하게 증명합니다. 기존 방법들이 매우 낮은 인식률을 보였던(예: 11.90%) 반면, 제안된 방법은 다운샘플링된 음성에서 거의 기준선에 가까운 성능(예: 77.62% vs 81.63%)을 달성했습니다.
- **주요 시사점:** 이 연구는 고 샘플링률(원본) 음성으로 음성 인식 모델을 훈련했지만, 더 낮은 샘플링률(다운샘플링/압축된) 음성으로 인식을 수행해야 하는 시나리오에서 특히 중요합니다. 제안된 멜 필터 뱅크는 다운샘플링된 데이터로 음성 엔진 전체를 재훈련할 필요성을 없애주어 상당한 계산 자원과 시간을 절약할 수 있게 합니다.
- **한계(내재적):** 논문은 특정 다운샘플링 계수($\alpha=2$)에 초점을 맞추었으며, 임의의 유리수 $\alpha$ 값으로의 일반화에 대해서는 명시적으로 논의하지 않았습니다. 지수적 감소 부분($L_{new,p}(m,k') = (0.95)^{m-F_\xi} L_{new,p}(F_\xi,k')$)은 경험적인 선택이며, 다른 $\alpha$ 값에 대한 최적성은 추가 연구가 필요할 수 있습니다.

## 📌 TL;DR

본 논문은 다운샘플링된 음성에서 MFCC를 계산하기 위한 수정된 멜 필터 뱅크를 제안합니다. 이 방법은 원본 멜 필터 뱅크를 스케일링하고 고주파 대역을 효과적으로 처리합니다. 실험 결과, 제안된 방법은 원본 음성과 다운샘플링된 음성 MFCC 간의 상관관계(피어슨 $r$ = 0.986, 기존 최고 0.913 대비)를 크게 향상시키며, 기존 방법에 비해 다운샘플링된 음성에서 훨씬 높은 음성 인식 정확도(77.62%, 기존 최고 11.90% 대비)를 달성합니다. 이는 원본 음성으로 훈련된 모델을 재훈련 없이 다운샘플링된 음성에 사용할 수 있도록 하여 실제 응용에서의 효율성을 크게 높입니다.
