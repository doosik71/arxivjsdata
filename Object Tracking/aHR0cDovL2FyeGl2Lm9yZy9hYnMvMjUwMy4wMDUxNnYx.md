# Two-stream Beats One-stream: Asymmetric Siamese Network for Efficient Visual Tracking
Jiawen Zhu, Huayi Tang, Xin Chen, Xinying Wang, Dong Wang, Huchuan Lu

## 🧩 Problem to Solve
최근 시각 추적 기술은 심층 모델의 발전으로 상당한 발전을 이루었지만, 고성능 추적기는 자원 제약적인 플랫폼(예: 에지 장치)에서 요구되는 낮은 연산 지연 시간(low computational latency)을 충족하지 못하는 경우가 많습니다. 현재의 효율적인 추적기는 대부분 정확도 지향 추적기에서 파생된 단일 스트림(one-stream) 프레임워크를 따르지만, 이는 다음과 같은 문제를 야기합니다:
1.  **템플릿 연산의 중복성**: 단일 스트림 네트워크는 매 프레임마다 템플릿 연산을 통합하여 상당한 중복성을 발생시킵니다.
2.  **에지 장치에 대한 부담**: 템플릿과 검색 영역 간의 광범위한 의미론적 상호작용은 연산 집약적이어서 에지 장치에 큰 부담을 줍니다.
이러한 문제들을 해결하면서도 높은 효율성과 정확도를 동시에 달성하는 효율적인 시각 추적기 설계가 필요합니다.

## ✨ Key Contributions
*   **새로운 비대칭 샴 네트워크(Asymmetric Siamese Network) 프레임워크 제안 (AsymTrack)**: 기존의 이중 스트림(two-stream) 추적기의 효율성과 단일 스트림 추적기의 높은 정확도를 결합하여, 현재 주류인 단일 스트림 파이프라인을 능가하는 효율적인 추적 아키텍처에 대한 새로운 통찰력을 제공합니다.
*   **효율적인 템플릿 변조(Efficient Template Modulation, ETM) 메커니즘 개발**: 비대칭 샴 추적 아키텍처 내에서 관계 모델링을 수행하여 불필요한 반복 연산을 제거합니다.
*   **객체 지각 강화(Object Perception Enhancement, OPE) 모듈 설계**: 경량 네트워크의 제한된 객체 표현 능력을 향상시키기 위해 추상적인 의미 정보와 지역적 세부 정보를 효율적으로 통합합니다. 추론 시에는 단일 계층 컨볼루션으로 재매개변수화(re-parameterize)되어 지연 시간을 최소화합니다.
*   **AsymTrack 모델 제품군 제안 및 효과성 입증**: 다양한 플랫폼(GPU, CPU, AGX)에서 광범위한 실험을 통해 AsymTrack 시리즈가 최첨단 효율 추적기 대비 뛰어난 정확도와 속도를 제공함을 입증합니다.

## 📎 Related Works
*   **정확도 지향 추적(Precision-Oriented Tracking)**:
    *   **샴 추적(Siamese Tracking)**: 템플릿과 검색 영역에서 특징을 추출하고 상호작용 모듈을 통해 융합하는 방식 (e.g., SiamRPN++, TransT). 특징 추출과 상호작용이 분리되어 추론 시 템플릿 브랜치를 생략할 수 있어 효율적입니다.
    *   **단일 스트림 추적(One-stream Tracking)**: ViT(Vision Transformer) 기반으로, 템플릿과 검색 영역을 단일 구조로 통합하여 특징 추출 및 상호작용을 동시에 수행 (e.g., OSTrack, MixFormer). 전역적인 특징 추출과 상호작용을 통해 높은 정확도를 달성하지만, 매 프레임 템플릿 연산과 변압기 어텐션의 2차 복잡도로 인해 자원 제약적인 플랫폼에서 속도 문제가 발생합니다.
*   **효율성 지향 추적(Efficiency-Oriented Tracking)**:
    *   고성능 추적기의 연산 부하를 줄이기 위해 경량 모듈을 통합하는 것이 일반적인 접근 방식입니다.
    *   **샴 기반 효율 추적기**: 경량 백본 및 헤드 네트워크를 활용하거나, 경량 특징 추출 및 융합 블록을 도입 (e.g., LightTrack, FEAR, E.T.Track).
    *   **단일 스트림 기반 효율 추적기**: MixFormerV2, HiT와 같이 단일 스트림 프레임워크 내에서 경량화 기술을 적용합니다. 하지만 단일 스트림의 본질적인 한계(템플릿 연산의 중복, ViT 백본의 2차 복잡도)로 인해 에지 장치에서의 배포에 어려움이 있습니다.

## 🛠️ Methodology
AsymTrack은 샴 네트워크의 효율성과 단일 스트림 네트워크의 성능을 결합한 비대칭 샴 추적 아키텍처를 제안합니다.

*   **비대칭 샴 구조(Asymmetric Siamese Architecture)**:
    *   템플릿 브랜치($F_z$)와 검색 영역 브랜치($F_x$)를 분리하여 사용하며, $F_z$는 $F_x$ 네트워크의 부분 집합으로 가중치를 공유합니다.
    *   템플릿 특징 추출($H_z$) 및 프로토타입($P_z$) 생성은 초기화 단계에서 단 한 번만 수행됩니다.
    *   추론 시에는 검색 영역 브랜치($F_x$)만 실행되며, 이전에 생성된 $H_z$와 $P_z$가 검색 영역 특징에 일방향으로 주입되어 변조(modulation)됩니다.
    *   추론 과정은 $B = \phi((F_x(X, H_z, P_z)))$로 표현됩니다.

*   **경량 백본(Lightweight Backbone)**:
    *   EfficientMod라는 경량 계층 모델의 처음 세 단계를 백본으로 사용합니다.
    *   각 단계는 Context Modeling (CM) 블록과 완전 연결(FC) 계층으로 구성되며, CM 블록은 FC-Conv-FC 구조로 시각적 컨텍스트를 통합합니다.
    *   마지막 단계 후에는 템플릿과 검색 영역 간의 상호작용을 강화하기 위해 트랜스포머 어텐션 계층을 추가합니다.

*   **박스 예측 헤드(Box Prediction Head)**:
    *   간단한 코너 헤드(corner head)를 사용하여 객체 경계 상자(bounding box)의 좌상단 및 우하단 좌표를 예측합니다.

*   **효율적인 템플릿 변조(Efficient Template Modulation, ETM)**:
    *   **프로토타입 생성(Prototype Generation)**: 템플릿($H_z$)과 검색 영역($H_x$) 특징으로부터 선형 계층과 점곱 연산을 사용하여 프로토타입($P_z, P_x$)을 생성합니다. $P_{z,x} = r(H_{z,x} * W_k)r(H_{z,x})^{\top}$ (여기서 $r(\cdot)$은 공간 차원을 평탄화). $P_z$는 초기화 시에만 생성됩니다.
    *   **동적 템플릿 변조(Dynamic Template Modulation)**: 1D 동적 컨볼루션을 사용하여 프로토타입 관계 모델링을 경량화합니다. $P_{mix} = SeDyConv_{1d}(P_z, K)$, 여기서 $K=P_x W_c$ 입니다.
    *   **프로토타입 어텐션(Prototype Attention)**: 변조된 검색 특징에 적용되는 후처리 어텐션 형태입니다. 혼합된 프로토타입($P_{mix}$)을 선형 계층을 통해 압축하여 프로토타입 임베딩($P_{emb_{mix}}$)을 생성하고, 이를 전치된 프로토타입($P'_{mix}$)과 곱하여 채널 차원에서 가중치를 부여하는 어텐션 벡터를 생성합니다. $V' = \sigma(P'_{mix} P_{emb_{mix}}) \odot V$ ($ \odot $는 하마다 곱).

*   **객체 지각 강화(Object Perception Enhancement, OPE) 모듈**:
    *   **의미론적 및 지역적 표현의 결합(Joint Semantic and Local Representation)**: 경량 추적기의 표현 병목 현상을 해결하기 위해, 3x3 컨볼루션 커널로 추상적인 의미 정보를, 1x1 컨볼루션 커널로 지역적 세부 정보를 추출하여 백본 특징을 강화합니다. 지역 디스크립터는 공유된 의미론적 디스크립터 주위의 그래디언트 정보의 선형 변환으로 생성됩니다.
    *   **재매개변수화 추론(Re-parameterization Inference)**: 추론 시에는 의미론적 및 지역적 디스크립터를 단일 3x3 컨볼루션으로 접어서(fold) 성능 저하 없이 오버-매개변수화된 병렬 브랜치를 동등한 단일 브랜치로 변환합니다.

*   **최적화 및 추적기 추론(Optimization and Tracker Inference)**:
    *   **최적화**: $L_1$ 손실과 GIoU 손실을 포함하는 통합 손실 함수를 사용합니다 ($L=\lambda_1 L_1(B,B_{gt}) + \lambda_G L_G(B,B_{gt})$).
    *   **추적기 추론**: 초기화 시에만 템플릿 브랜치가 실행되며, 이후에는 검색 영역 브랜치만으로 추적을 수행합니다.

## 📊 Results
AsymTrack은 AsymTrack-T, AsymTrack-S, AsymTrack-B의 세 가지 변형으로 제공됩니다.

*   **전반적인 성능 및 속도**:
    *   **AsymTrack-T**: GPU에서 224 FPS, CPU에서 81 FPS, AGX에서 84 FPS로 가장 빠른 속도를 자랑합니다. LaSOT AUC 60.8%를 달성하여 HiT-Tiny보다 6.0% 높은 AUC를 기록하면서도 더 빠른 속도를 보입니다.
    *   **AsymTrack-B**: LaSOT AUC 64.7%, TrackingNet AUC 80.0%, GOT-10k AO 67.7%를 달성하며 최상위 실시간 성능을 보여줍니다. TransT와 유사한 정확도(64.7% vs 64.9%)를 유지하면서 CPU에서 6.6배, AGX에서 4.7배 더 빠르게 작동합니다.

*   **벤치마크별 성능**:
    *   **GOT-10k, LaSOT, TrackingNet**: AsymTrack-B는 모든 플랫폼에서 이전 최신 기술인 HiT-Base를 속도와 정확도 면에서 능가합니다. AsymTrack-S는 MixFormerV2를 능가하는 경쟁력 있는 성능을 보여줍니다.
    *   **NFS, UAV123, LaSOT$_{ext}$**: AsymTrack-B는 NFS (64.4% AUC), UAV123 (66.5% AUC), LaSOT$_{ext}$ (44.6% AUC)에서 최상위 또는 매우 경쟁력 있는 성능을 달성합니다.
    *   **VOT2021**: Jetson AGX Xavier에서 25.4%의 EAO 점수를 기록하며 다른 모든 실시간 효율 추적기를 능가합니다.

*   **탐색 연구 (Ablation Studies)**:
    *   **템플릿 변조(ETM)의 필요성**: ETM이 없는 모델에 비해 ETM을 포함한 모델이 GOT-10k에서 2.5%p/4.0%p, LaSOT에서 2.4%p/3.7%p의 AUC 향상을 보이며, 속도-정확도 균형이 우수함을 확인했습니다.
    *   **지각 강화(OPE)의 효과**: OPE를 통합하면 GOT-10k AO에서 1.7%p, LaSOT AUC에서 1.9%p 향상됩니다. 재매개변수화 추론 덕분에 OPE 모듈은 플랫폼 전반에 걸쳐 최소한의 지연 시간만을 추가합니다. OPE 적용 시 특징 식별 능력이 향상됨을 시각화로도 확인했습니다.
    *   **ETM 설계의 세부 분석**: 동적 템플릿 변조(DTM)와 프로토타입 어텐션(Prototype Attention) 모두 효과적이며, 초기 단계(Stage1)에 ETM을 추가하는 것은 큰 개선이 없음을 확인했습니다.
    *   **OPE 위치 분석**: OPE를 모델의 모든 단계에 적용하는 것이 가장 좋은 결과를 보이며, 초기 단계에 적용하는 것이 후기 단계에 비해 더 효과적입니다.

*   **정확도 지향 추적기와의 격차 분석**: AsymTrack과 OSTrack과 같은 최신 정확도 지향 추적기 사이에는 여전히 성능 격차가 존재합니다. 이 격차는 주로 낮은 해상도, 시점 변화, 빠른 움직임과 같은 속성에서 크게 나타나며, 모델의 표현 능력이 더 크게 도전받는 상황입니다.

## 🧠 Insights & Discussion
AsymTrack은 이중 스트림 구조의 효율성 장점을 활용하면서도 단일 스트림 트랜스포머의 강력한 상호작용 및 표현 능력을 비대칭적인 방식으로 통합하여, 효율적인 시각 추적 분야에서 중요한 발전을 이루었습니다. 특히, 매 프레임 템플릿 연산의 중복성과 고비용의 전역 상호작용 문제를 해결하여 자원 제약적인 플랫폼에서의 실시간 배포 가능성을 크게 높였습니다.

ETM과 OPE 모듈은 이러한 효율성과 정확도 균형을 달성하는 핵심 요소입니다. ETM은 가벼운 방식으로 템플릿과 검색 영역 간의 관계 모델링을 가능하게 하며, OPE는 경량 백본의 표현 한계를 극복하고 추론 시 지연 시간을 최소화하도록 설계되었습니다.

하지만, AsymTrack은 여전히 최첨단 정확도 지향 추적기와 비교했을 때 특히 저해상도, 시점 변화, 빠른 움직임과 같은 까다로운 시나리오에서 성능 격차를 보입니다. 이는 효율적인 추적기가 향후 연구에서 집중해야 할 영역임을 시사합니다. 그럼에도 불구하고, AsymTrack은 UAV나 로봇과 같은 실제 응용 시나리오에서 신뢰할 수 있는 시각 추적 솔루션이 될 잠재력을 가지고 있으며, 학술 연구와 산업 응용 간의 간극을 좁히는 데 기여할 것으로 기대됩니다.

## 📌 TL;DR
**문제**: 자원 제약 환경(예: 에지 장치)에서 기존 단일 스트림 추적기의 템플릿 연산 중복성과 높은 연산 부담으로 인한 비효율성.
**방법**: 템플릿 연산을 초기화 시 한 번만 수행하고 비대칭적으로 검색 브랜치에 주입하는 **AsymTrack**이라는 새로운 비대칭 샴 네트워크를 제안. 효율적인 관계 모델링을 위한 **ETM(Efficient Template Modulation)**과 경량 네트워크의 표현력 강화를 위한 **OPE(Object Perception Enhancement)** 모듈을 설계하여 정확도와 속도를 동시에 최적화.
**핵심 결과**: AsymTrack은 다양한 벤치마크(LaSOT, GOT-10k, TrackingNet 등)에서 최첨단 효율 추적기 대비 뛰어난 속도-정확도 균형을 보이며, GPU, CPU, AGX 등 여러 플랫폼에서 높은 FPS를 달성하여 실제 배포 가능성을 입증.