# An Experimental Survey on Correlation Filter-based Tracking
Zhe Chen, Zhibin Hong, and Dacheng Tao,Fellow, IEEE

## 🧩 Problem to Solve
시각 객체 추적 분야에서 상관 필터 기반 트래커(CFTs)는 뛰어난 성능을 보여왔지만, 이들의 발전 과정을 포괄적으로 검토하고 다양한 알고리즘의 효과와 효율성을 체계적으로 평가한 연구는 부족했습니다. 이 논문의 목표는 CFTs의 발전을 종합적으로 조사하고, 일반적인 프레임워크를 요약하며, 주요 개선 사항들을 분석하고, 대규모 벤치마크에서 광범위한 실험을 통해 성능을 비교 평가하는 것입니다.

## ✨ Key Contributions
*   11가지 주요 CFTs를 검토하고 이들의 일반적인 프레임워크를 요약했습니다.
*   상관 필터의 다양한 학습(training) 방식과 최근 도입된 효과적인 개선점들을 심층적으로 조사했습니다.
*   설문 조사된 CFTs의 효과 및 효율성을 평가하기 위해 포괄적인 실험을 수행했으며, 다른 경쟁 트래커들과 비교 분석했습니다.
*   MOSSE, Regularized ASEF, CSK, KCF, CN, DSST, SAMF, STC, MUSTer, RPT를 포함한 다양한 CFTs의 성능을 OOTB 벤치마크에서 정량적, 정성적으로 평가했습니다.
*   MUSTer와 SAMF 같은 최신 CFTs가 강건성, 속도, 정확도 면에서 최첨단 성능을 달성함을 입증했습니다.
*   상관 필터 기반 추적의 추가 개선을 위한 미래 연구 방향(스케일 추정, 부분 기반 추적, 장기 추적 방법과의 협력)을 제시했습니다.

## 📎 Related Works
*   **생성 모델 기반 트래커**: 객체 추적을 위해 가장 잘 맞는 윈도우를 탐색하는 방식. (예: [1]-[6])
*   **식별 모델 기반 트래커**: 배경과 타겟을 구별하도록 학습하는 방식. (예: [7]-[12])
*   **초기 상관 필터**: 패턴 감지기로 사용되었으나 온라인 추적에는 부적합했음. (예: Synthetic Discriminant Functions (SDF) [27], Optimal Tradeoff Filters (OTF) [28], Minimum Average Correlation Energy (MACE) [29], Maximum Average Correlation Height (MACH) [30], Unconstrained MACE (UMACE) [31], Average of Synthetic Exact Filters (ASEF) [34]).
*   **MOSSE (Minimum Output Sum of Squared Error) [15]**: 상관 필터를 온라인 추적에 적합하게 만든 선구적인 작업.
*   **CSK (Circulant Structure with Kernels) [16]**: MOSSE 필터에 커널 메서드를 도입하여 성능을 향상시킴.
*   **KCF (Kernelized Correlation Filters) [20]**: CSK의 작업을 공식화하고 다채널 HOG 특징을 도입.
*   **CN (Color Names) [17]**: 효과적인 특징으로 색상 속성을 도입.
*   **DSST (Discriminative Scale Space Tracker) [19]**: 특징 피라미드와 3D 상관 필터를 사용하여 스케일 문제를 해결.
*   **SAMF (Scale Adaptive Multi-Feature Tracker) [18]**: 색상 및 HOG 특징을 통합하고 스케일 풀을 적용하여 스케일 변화를 처리.
*   **STC (Spatio-Temporal Context) [26]**: 시공간 문맥 정보를 활용하여 추적.
*   **RPAC (Real-time Part-based visual tracking via Adaptive Correlation filters) [24] 및 RPT (Reliable Patch Trackers) [25]**: 부분 기반 추적 전략을 도입.
*   **LCT (Long-term Correlation Tracking) [23] 및 MUSTer (MUlti-Store Tracker) [22]**: 장기 추적 방법을 CFTs에 통합.

## 🛠️ Methodology

### 일반적인 상관 필터 기반 추적 프레임워크
1.  **초기화**: 첫 프레임에서 타겟의 이미지 패치로 상관 필터를 학습합니다.
2.  **검출**: 매 프레임마다 이전 예측 위치에서 패치를 잘라냅니다.
3.  **특징 추출 및 코사인 윈도우 적용**: 원본 입력 데이터에서 다양한 특징을 추출하고, 경계 효과를 줄이기 위해 코사인 윈도우를 적용합니다.
4.  **효율적인 상관 연산**: 이산 푸리에 변환(DFT)을 사용하여 컨볼루션을 요소별 곱셈으로 대체함으로써 효율적인 상관 연산을 수행합니다.
    *   컨볼루션 정리: $x \otimes h = \mathcal{F}^{-1}(\hat{x} \odot \hat{h}^{*})$
    *   여기서 $\mathcal{F}^{-1}$는 역 푸리에 변환, $\odot$는 요소별 곱셈, $*$는 복소수 켤레를 의미합니다.
5.  **응답 맵 생성 및 위치 예측**: 역 FFT를 사용하여 공간 신뢰도 맵(응답 맵)을 얻고, 이 맵에서 최대값이 있는 위치를 새로운 타겟 상태로 예측합니다.
6.  **필터 갱신**: 추정된 위치의 외형을 추출하여 상관 필터를 학습하고 갱신합니다. 모든 학습 및 갱신은 주파수 도메인에서 수행됩니다.

### 상관 필터 학습 방식

*   **전통적인 학습 방법 (ASEF)**:
    *   MOSSE 이전의 필터들은 배경에 대한 응답을 억제하며 학습되었으나, 온라인 추적에는 느렸습니다.
    *   Regularized ASEF는 개별 학습된 정확한 필터들을 평균하여 더 일반적인 필터를 생성하며, 불안정성을 방지하기 위해 정규화 파라미터 $\epsilon$를 분모에 도입합니다:
        $$ \hat{h}^{*}_{i} = \frac{\hat{y}_{i} \odot \hat{x}^{*}_{i}}{\hat{x}_{i} \odot \hat{x}^{*}_{i} + \epsilon} $$
*   **적응형 상관 필터 (MOSSE)**:
    *   MOSSE는 실제 상관 출력과 원하는 상관 출력 간의 제곱 오차 합을 최소화하여 필터 $h$를 찾습니다. 주파수 도메인에서 해는 다음과 같습니다:
        $$ \hat{h}^{*} = \frac{\sum_{i} \hat{y}_{i} \odot \hat{x}^{*}_{i}}{\sum_{i} \hat{x}_{i} \odot \hat{x}^{*}_{i}} $$
    *   원하는 출력 $y$는 일반적으로 중심에 피크가 있는 2D 가우시안 분포로 생성됩니다.
*   **커널 상관 필터 (KCF/CSK)**:
    *   릿지 회귀 문제(Ridge Regression problem)와 순환 행렬(circulant matrix)을 도입하여 상관 필터를 효과적으로 커널화합니다.
    *   순환 행렬을 활용하여 타겟 주변의 모든 이동된 샘플을 속도 저하 없이 학습에 사용할 수 있습니다.
    *   커널 함수(다항식 커널, 가우시안 커널)를 사용하여 비선형 특징 공간으로 데이터를 매핑하여 더욱 강력한 성능을 달성합니다.
    *   듀얼 공간 계수 $\alpha$는 주파수 도메인에서 효율적으로 계산됩니다:
        $$ \hat{\alpha} = \frac{\hat{y}}{\hat{k} + \lambda} $$
    *   검출 시, 새로운 샘플 $z$에 대해 신뢰도 맵 $y$는 다음과 같이 얻어집니다:
        $$ y = C(k_{xz})\alpha = \mathcal{F}^{-1}(\hat{k}_{xz} \odot \hat{\alpha}) $$
*   **밀집 시공간 문맥 트래커 (STC)**:
    *   최적화를 통해 학습하는 대신, 객체의 위치에 대한 사전 가능성(likelihood distribution)을 학습합니다.
    *   시공간 문맥 정보와 객체 외형을 모델링하여 추적합니다.

### 갱신 방식
*   대부분의 CFTs는 **이동 평균(running average)** 방식을 사용하여 필터를 갱신합니다.
    *   **ASEF**:
        $$ \hat{h}^{*}_{t} = \eta \frac{\hat{y}_{t} \odot \hat{x}^{*}_{t}}{\hat{x}_{t} \odot \hat{x}^{*}_{t} + \epsilon} + (1-\eta)\hat{h}^{*}_{t-1} $$
    *   **MOSSE**: 분자와 분모를 각각 평균합니다.
    *   **KCF**: 듀얼 공간 계수 $\hat{\alpha}_{t}$를 갱신합니다.
*   장기 추적을 위해 **실패 감지 메커니즘**을 도입하여 오탐지 샘플 학습을 방지합니다 (예: MUSTer, RPAC).

### 추가 개선점
*   **특징 표현**:
    *   초기 CFTs는 원본 픽셀을 사용했으나, HOG 특징 [49] 및 색상 속성(Color Names, CN) [17]과 같은 다채널 특징은 더욱 대표적이고 정보량이 많아 성능을 크게 향상시켰습니다.
    *   HOG(기울기)와 CN(색상) 특징을 융합하여 강건한 추적을 가능하게 합니다 (SAMF [18]).
*   **스케일 변화 처리**:
    *   **스케일 풀(Scaling Pool) 전략**: SAMF [18]와 DSST [19]는 다양한 크기의 윈도우를 샘플링하고 가장 높은 상관 점수를 가진 윈도우를 새로운 스케일로 예측합니다. DSST는 3D 상관 필터를 사용합니다.
    *   **부분 기반 추적**: RPAC [24]와 RPT [25]는 부분 기반 추적을 통해 스케일 변화에 적응합니다.
    *   **STC의 스케일 추정**: 신뢰도 점수를 기반으로 스케일을 추정하지만, 불안정할 수 있습니다.
*   **부분 기반 추적 전략**:
    *   RPAC [24]는 타겟의 5개 부분을 독립적으로 추적하고, 파티클 필터를 사용하여 결합된 맵을 구성하여 새로운 상태를 예측합니다.
    *   RPT [25]는 신뢰할 수 있는 지역 패치(reliable local patches)를 자동으로 선택하여 추적합니다.
    *   부분 폐색(partial occlusions)에 대한 강건성을 높이는 데 유용합니다.
*   **장기 추적**:
    *   **MUSTer [22]**: Atkinson-Shiffrin 기억 모델에서 영감을 받아 단기(CFT) 및 장기(키포인트 기반 재검출) 구성 요소를 협력시킵니다. CFT가 실패할 경우 키포인트를 사용하여 재탐지합니다.
    *   **LCT [23]**: 온라인 랜덤 펀 분류기(random fern classifier)를 재검출 구성 요소로 추가하여 장기 추적 능력을 향상시킵니다. 표류 후 타겟을 재배치하는 능력은 CFTs의 약점을 보완합니다.

## 📊 Results

### 실험 설정
*   **비교 트래커**: Regularized ASEF, MOSSE, CSK, KCF, CN, DSST, SAMF, STC, MUSTer, RPT (총 10개 CFTs 직접 평가 및 구현), 그리고 OOTB의 28개 인기 트래커 및 최신 MEEM [63] (총 39개) 포함.
*   **테스트 시퀀스**: OOTB (51개 시퀀스) 및 OOTB100 (100개 시퀀스) 벤치마크 사용.
*   **평가 방법**:
    *   **One-Pass Evaluation (OPE)**: 각 시퀀스에서 트래커를 한 번 실행.
    *   **Temporal Robustness Evaluation (TRE)**: 원본 시퀀스에서 다른 길이의 20개 하위 시퀀스로 실행.
    *   **Spatial Robustness Evaluation (SRE)**: 약간 이동하거나 스케일링된 실제 경계 상자로 초기화하여 실행.
    *   **정밀도 플롯 (Precision Plots)**: 예측 중심과 실제 중심 간의 거리가 주어진 임계값 내에 있는 프레임의 비율. 20픽셀 임계값에서 정밀도로 순위 매김.
    *   **성공률 플롯 (Success Plots)**: 예측 경계 상자와 실제 경계 상자 간의 중첩 점수(Overlap Score, OS)가 임계값보다 큰 프레임의 비율. 곡선 아래 면적(AUC)으로 순위 매김.

### 정량적 평가
*   **전반적인 성능 (OOTB 51 시퀀스)**:
    *   MUSTer, RPT, SAMF와 같은 CFTs가 매우 우수한 성능을 보였습니다.
    *   특히 MUSTer는 모든 성공률 플롯(OPE 64.1%, SRE 56.4%, TRE 61.7%)에서 다른 트래커들을 능가하며 최첨단 결과를 달성했습니다.
    *   최신 6개 개선된 CFTs는 항상 상위 10위권에 들며 강력한 강건성을 입증했습니다.
*   **속성 기반 평가 (SRE)**:
    *   **스케일 변화**: MUSTer, DSST, SAMF가 약 50%의 중첩 점수로 최고 성능을 보였으며, 스케일링 풀 전략의 효과를 입증했습니다. RPT의 스케일 추정 방식도 유효함을 보여주었습니다.
    *   **회전 및 변형**: MUSTer가 가장 강건했으며, RPT, SAMF, MEEM도 우수했습니다.
    *   **빠른 움직임**: MEEM (52.7%)이 가장 높은 점수를 기록했습니다.
    *   **주변 환경 도전 과제 (조명 변화, 폐색, 배경 혼란)**: CFTs가 다른 트래커들을 상위 2위권에서 제외하며 우수한 결과를 보였습니다. 이는 상관 필터 기반 알고리즘이 배경 문맥을 효율적으로 식별하여 방해 요소를 피하는 데 도움이 됨을 시사합니다.
    *   **카메라 제약 (모션 블러, 시야 이탈, 낮은 해상도)**: MEEM은 모션 블러와 시야 이탈에서 가장 강건했고, MUSTer는 낮은 해상도에서 1위를 유지했습니다. RPT는 낮은 해상도에서 성능이 크게 저하되었습니다.
    *   결론적으로 MUSTer는 11개 도전 과제 중 8개에서 1위를 차지하며 가장 강건한 트래커로 평가되었습니다.
*   **확장 실험 (OOTB100)**:
    *   MOSSE의 학습 방식(모든 샘플 평균)이 ASEF(학습된 필터 평균)보다 우수함이 입증되었습니다.
    *   STC의 공간 문맥 활용, CSK/KCF의 커널 메서드 도입, CN/KCF의 HOG 및 색상 속성 특징 활용, SAMF의 특징 통합이 모두 성능 개선에 기여했음이 확인되었습니다.
    *   스케일 문제 해결, 부분 기반 전략 적용, 장기 추적 도입(MUSTer, SAMF)이 효과적임을 증명했습니다.
    *   MUSTer와 SAMF는 OOTB100에서도 다른 경쟁 트래커들(Struck, ASLA, MEEM, TLD)과 비교하여 여전히 우수한 성능을 보였습니다. MEEM이 OPE와 TRE의 정밀도 플롯에서 가장 높았는데, 이는 재탐지 방식이 표류 후 타겟을 빠르게 재배치하는 데 도움이 되었기 때문일 수 있습니다.
    *   평균 중심 위치 오차(CLE), 평균 중첩 점수(OS), 평균 속도(FPS) 통계에서 MUSTer와 MEEM이 가장 정밀했으며, MUSTer, RPT, SAMF가 높은 중첩 점수를 기록했습니다. 전반적으로 더 나은 점수는 종종 더 느린 트래커에 의해 달성되었으며, 이는 속도 향상이 여전히 중요한 연구 주제임을 시사합니다.

### 정성적 평가 (OOTB100 20개 비디오 시퀀스)
*   **KCF**: 고정된 윈도우 사용으로 스케일 변화가 큰 `CarScale`, `Singer1` 등에서 한계를 보였습니다.
*   **DSST, SAMF**: 스케일 문제를 완화하여 `Car4`, `CarScale` 등에서 더 잘 추적했지만, 장기 구성 요소의 부재로 `Freeman1`처럼 놓친 타겟을 재배치하지 못했습니다.
*   **MUSTer**: 장기적인 고려 사항 덕분에 `MotorRolling`에서 다른 트래커들이 타겟을 놓쳤을 때도 타겟을 찾아 추적을 재개했습니다. `Board`에서만 실패했는데, 배경 객체가 타겟과 매우 유사했기 때문입니다.
*   **MEEM**: 타겟 재배치 능력이 있지만, `Singer1`에서 조명 변화 처리 시 한계를 보였습니다.
*   **RPT**: 비디오 품질이 낮을 때(`Bolt` 초기) 추적 결과가 저하되는 경향이 있으며, 초기화가 RPT에 중요할 수 있음을 시사했습니다.
*   전반적으로 CFTs의 질적 성능은 유망하지만, 강건성 향상을 위한 개선의 여지가 많으며, MUSTer의 구현 방식이 유망한 방향을 제시합니다.

## 🧠 Insights & Discussion
*   **강력한 특징의 중요성**: CN 및 KCF의 성능 향상에서 보듯이, 강력한 특징(HOG, Color Names)을 사용하면 표류 가능성이 크게 줄어듭니다. 다양한 유형의 특징을 시도하는 것이 가치가 있습니다.
*   **스케일 문제 해결의 필요성**: 스케일 풀 및 부분 기반 방법이 스케일 변화 처리에 유용함이 입증되었지만, 처리 시간이 적게 드는 접근 방식이 더 바람직합니다.
*   **부분 기반 추적 전략의 잠재력**: RPT의 성능에서 알 수 있듯이, 부분 기반 추적의 장점이 완전히 활용되지 못했습니다. 여러 부분의 추적 결과를 융합하는 더 효과적인 메커니즘이 필요합니다.
*   **장기 추적의 핵심 역할**: MUSTer의 뛰어난 성능을 통해 장기 추적 방법이 상관 필터 기반 추적의 가장 유용한 보완책임이 입증되었습니다. 장기 추적 구성 요소의 정확도를 높이고, 더 적절한 아키텍처를 개발하며, 전체 시스템의 속도를 높이는 추가 연구가 필요합니다.
*   최신 CFTs는 강건성과 효율성 면에서 상당한 발전을 이루었지만, 다양한 실제 시나리오에서 성능을 더욱 향상시키기 위한 지속적인 연구가 중요합니다.

## 📌 TL;DR
이 논문은 시각 객체 추적 분야에서 상관 필터 기반 트래커(CFTs)의 발전 과정을 포괄적으로 조사하고 평가합니다. 논문은 CFTs의 일반적인 프레임워크를 요약하고, MOSSE, KCF, STC 등 다양한 학습 방식을 분석하며, 특징 표현, 스케일 처리, 부분 기반 추적, 장기 추적과 같은 주요 개선점들을 검토합니다. 광범위한 실험을 통해 MUSTer, RPT, SAMF, DSST와 같은 최신 CFTs가 강건성, 정확성, 속도 면에서 최첨단 성능을 달성함을 입증하고, 특히 MUSTer가 가장 강건한 트래커임을 보여줍니다. 결론적으로, 강력한 특징, 효과적인 스케일 및 부분 기반 전략, 그리고 장기 추적 구성 요소의 통합이 CFTs 성능 향상을 위한 핵심 방향임을 강조합니다.