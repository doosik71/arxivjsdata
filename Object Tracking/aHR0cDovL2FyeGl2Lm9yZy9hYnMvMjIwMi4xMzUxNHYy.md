# StrongSORT: Make DeepSORT Great Again
Yunhao Du, Zhicheng Zhao, Yang Song, Yanyun Zhao, Fei Su, Tao Gong, Hongying Meng

## 🧩 Problem to Solve
*   **MOT 분야의 공정한 비교 기준선 부재**: 기존 MOT(Multi-Object Tracking) 방법론들은 다양한 기본 모델(탐지기, 임베딩 모델)과 학습/추론 트릭을 사용하여 성능을 높여왔기 때문에, 공정한 성능 비교를 위한 견고한 기준선(baseline)을 설정하기 어려웠습니다.
*   **MOT 고유의 "누락" 문제**:
    *   **연결 누락(Missing Association)**: 동일한 객체가 여러 트랙렛(tracklet)으로 분리되는 문제. 온라인 트래커에서 전역 정보 부족으로 인해 자주 발생합니다.
    *   **탐지 누락(Missing Detection)**: 객체가 배경으로 오인되어 탐지되지 않는 문제(오탐, false negatives). 주로 가려짐(occlusion)이나 낮은 해상도로 인해 발생합니다.
*   **기존 방법론의 한계**: 연결 누락 문제를 해결하기 위한 전역 연결 모델은 계산 비용이 높고, 탐지 누락을 보완하는 선형 보간법은 운동 정보를 무시하여 정확도가 제한됩니다.

## ✨ Key Contributions
*   **StrongSORT 제안**: DeepSORT를 최신 탐지 및 임베딩 모델과 여러 추론 트릭으로 강화하여 MOT 커뮤니티에 강력하고 공정한 기준선을 제공했습니다.
*   **AFLink (Appearance-Free Link) 개발**: 외형 정보 없이 시공간 정보만을 사용하여 트랙렛 간의 연결을 예측하는 경량 모델로, 연결 누락 문제를 해결합니다.
*   **GSI (Gaussian-Smoothed Interpolation) 개발**: 가우시안 프로세스 회귀를 기반으로 탐지 누락으로 인한 보간된 바운딩 박스의 정확도를 향상시키는 알고리즘입니다.
*   **경량 및 플러그-앤-플레이(Plug-and-Play) 설계**: AFLink와 GSI는 가볍고 모델에 구애받지 않아 다양한 트래커에 쉽게 통합될 수 있으며, 계산 비용이 미미합니다.
*   **최첨단 성능 달성**: StrongSORT에 AFLink와 GSI를 통합한 StrongSORT++는 MOT17, MOT20, DanceTrack, KITTI 등 여러 공개 벤치마크에서 최첨단(SOTA) 성능을 달성했습니다.

## 📎 Related Works
*   **MOT 방법 분류**: MOT 방법은 크게 **분리형 트래커(Separate Trackers)** (탐지-후-추적 패러다임)와 **결합형 트래커(Joint Trackers)** (탐지 및 기타 구성 요소 동시 학습)로 나눌 수 있습니다. 본 논문은 DeepSORT와 유사한 분리형 패러다임을 따릅니다.
*   **외형 정보 없는 추적**: 고성능 탐지기와 모션 정보에만 의존하는 방법도 있습니다(e.g., ByteTrack, OC-SORT).
*   **MOT에서의 전역 연결(Global Link)**: 연결 누락 문제를 해결하기 위해 전역 정보를 사용하여 트랙렛을 연결하는 연구들이 있었으나(e.g., TNT, TPM, ReMOT, GIAOTracker), 대부분 외형 특징에 의존하여 계산 비용이 높았습니다. AFLink는 모션 정보만을 활용합니다.
*   **MOT에서의 보간(Interpolation)**: 탐지 누락으로 인한 궤적의 빈 공간을 채우기 위해 선형 보간법이 널리 사용되었으나, 운동 정보를 무시하는 한계가 있었습니다(e.g., V-IOUTracker, MAT, MAATrack). GSI는 가우시안 프로세스 회귀를 통해 이 문제를 해결합니다.

## 🛠️ Methodology

본 논문은 고전적인 DeepSORT 트래커를 개선하고, 두 가지 경량 플러그-앤-플레이 알고리즘(AFLink, GSI)을 제안하여 MOT의 "누락" 문제를 해결합니다.

### StrongSORT
DeepSORT [55]는 외형(appearance)과 모션(motion) 두 가지 브랜치를 기반으로 합니다.
*   **DeepSORT의 원리**:
    *   **외형 브랜치**: CNN을 통해 외형 특징을 추출하고, 피쳐 뱅크(feature bank)에 저장된 특징과의 코사인 거리를 매칭 비용으로 사용합니다.
    *   **모션 브랜치**: 칼만 필터(Kalman filter)를 사용하여 트랙렛의 위치를 예측하고, 마할라노비스 거리(Mahalanobis distance)를 매칭 게이트로 활용합니다.
    *   **매칭 캐스케이드(Matching Cascade)**: 더 자주 보이는 객체에 높은 매칭 우선순위를 부여하여 할당 문제를 해결합니다.

StrongSORT는 DeepSORT를 다음과 같이 개선합니다.
*   **향상된 모듈**:
    *   **탐지기**: YOLOX-X [18]로 교체.
    *   **임베딩 모델**: BoT [30]로 교체하여 더 판별력 있는 외형 특징 추출.
*   **추론 트릭**:
    *   **EMA (Exponential Moving Average) 특징 업데이트**: 피쳐 뱅크 대신 EMA 방식으로 외형 상태를 업데이트하여 탐지 노이즈에 강인하며 매칭 품질을 향상시킵니다.
        $$e^t_i = \alpha e^{t-1}_i + (1-\alpha)f^t_i$$
        여기서 $e^t_i$는 i-번째 트랙렛의 t 프레임에서의 외형 상태, $f^t_i$는 현재 매칭된 탐지의 외형 임베딩, $\alpha=0.9$는 모멘텀 항입니다.
    *   **ECC (Enhanced Correlation Coefficient Maximization)**: 카메라 움직임으로 인한 모션 노이즈를 보상합니다 [13].
    *   **NSA (Noise Scale Adaptive) Kalman 필터**: 탐지 신뢰도 점수 $c_k$에 따라 측정 노이즈 공분산 $\tilde{R_k}$를 적응적으로 계산하여 칼만 필터의 정확도를 높입니다 [11].
        $$\tilde{R_k} = (1-c_k)R_k$$
        여기서 $R_k$는 사전 설정된 상수 측정 노이즈 공분산입니다.
    *   **모션 비용(Motion Cost) 활용**: 외형 비용 $A_a$와 모션 비용 $A_m$의 가중치 합을 사용하여 할당 문제를 해결합니다 ($C = \lambda A_a + (1-\lambda) A_m$, $\lambda=0.98$).
    *   **바닐라 매칭(Vanilla Matching)**: 매칭 캐스케이드 알고리즘을 단순한 전역 선형 할당(Hungarian 알고리즘 [27])으로 대체합니다. 이는 강력한 트래커에서는 매칭 캐스케이드의 사전 제약이 오히려 성능을 저해할 수 있기 때문입니다.

### StrongSORT++
StrongSORT에 두 가지 경량 플러그-앤-플레이 알고리즘을 추가합니다.

*   **AFLink (Appearance-Free Link)**:
    *   **목표**: 외형 정보 없이 시공간 정보만을 사용하여 트랙렛 간의 연결을 예측합니다.
    *   **입력**: 프레임 ID($f^*_k$) 및 위치($x^*_k, y^*_k$) 정보로 구성된 두 개의 트랙렛 $T_i$와 $T_j$ (최근 $N=30$ 프레임).
    *   **아키텍처**: 두 브랜치 구조로, Temporal Module(시간 차원 특징 추출)과 Fusion Module(다양한 특징 차원 정보 통합)을 통해 시공간 특징을 추출합니다. 이 특징들을 연결(concatenation)하여 MLP(다층 퍼셉트론)에 입력, 연결 신뢰도 점수를 예측합니다.
    *   **학습**: 이진 분류 작업으로, 이진 교차 엔트로피 손실($L_{BCE}$)로 최적화됩니다.

*   **GSI (Gaussian-Smoothed Interpolation)**:
    *   **목표**: 탐지 누락으로 인한 궤적의 빈 공간을 가우시안 프로세스 회귀(GPR) [54]를 사용하여 비선형 모션을 모델링하고 더 정확하게 채웁니다.
    *   **원리**: 궤적의 위치 좌표 $p_t$는 함수 $f^{(i)}(t)$에 가우시안 노이즈가 더해진 것으로 모델링됩니다. 이 함수 $f^{(i)}$는 가우시안 프로세스를 따릅니다.
        새로운 프레임 $F^*$에 대한 스무딩된 위치 $P^*$는 다음과 같이 예측됩니다.
        $$P^* = K(F^*,F)(K(F,F) + \sigma^2I)^{-1}P$$
        여기서 $K(\cdot,\cdot)$는 공분산 함수입니다.
    *   **적응형 부드러움 계수($\lambda$)**: 궤적의 길이 $l$에 따라 $\lambda = \tau \ast \text{log}(\tau^3/l)$ (여기서 $\tau=10$)로 적응적으로 조절됩니다. GSI는 궤적 전체를 평활화하여 탐지 노이즈를 줄이고 안정적인 위치를 생성합니다.

## 📊 Results
*   **StrongSORT의 성능 향상**: DeepSORT를 StrongSORT로 개선함으로써 IDF1, MOTA, HOTA 등 주요 지표에서 큰 폭의 성능 향상을 입증했습니다. 특히 BoT와 바닐라 매칭의 기여가 두드러졌습니다.
*   **AFLink 및 GSI의 범용성 및 효율성**:
    *   AFLink는 StrongSORT (IDF1 최대 +1.0)를 포함한 다양한 트래커에서 연결 품질을 개선했으며, 특히 성능이 낮은 트래커에서 큰 효과를 보였습니다 (CenterTrack IDF1 +3.7).
    *   GSI는 StrongSORT (HOTA 최대 +1.2) 등에서 탐지 및 연결 성능을 개선했으며, 더 강력한 트래커에서 더 효과적이었습니다.
    *   두 알고리즘 모두 MOT17에서 이미지당 각각 1.7ms, 7.1ms의 무시할 수 있는 추가 계산 비용으로 실행됩니다.
*   **매칭 캐스케이드 알고리즘 분석**: 약한 트래커(DeepSORT)에서는 효과적이었으나, StrongSORT와 같이 강력해진 트래커에서는 오히려 성능을 저해하며, 바닐라 매칭으로 교체 시 IDF1이 최대 1.4 상승했습니다.
*   **GSI의 노이즈 필터링 효과**: GSI는 선형 보간법에 비해 궤적의 속도 변화를 더 안정적이고 부드럽게 만들어, 탐지 노이즈 필터로서 속도 추정 등 후속 작업에 유리함을 보였습니다.
*   **StrongSORT++의 최첨단 성능**:
    *   **MOT17**: HOTA, IDF1, AssA, DetA 지표에서 1위, MOTA와 IDs에서 2위를 기록하며 높은 연결 정확도를 달성했습니다.
    *   **MOT20**: 혼잡한 장면에서도 HOTA, IDF1, AssA 지표에서 1위를 차지하고, IDs(오류가 적음)에서 월등히 적은 수를 기록하며 뛰어난 일반화 능력을 입증했습니다.
    *   **DanceTrack**: 외형 정보의 중요도가 낮은 데이터셋에서도 HOTA, IDF1, MOTA, AssA, DetA 등 대부분의 지표에서 최고 성능을 달성했습니다.
    *   **KITTI**: 자동차 추적에서 비교할 만한 결과를, 보행자 추적에서는 뛰어난 성능을 보였습니다.
*   **정성적 결과**: 다양한 복잡한 시나리오(가려짐, 카메라 움직임, 복잡한 모션 패턴, 낮은 프레임률)에서 StrongSORT++의 효과적인 추적 능력을 시각적으로 입증했습니다.

## 🧠 Insights & Discussion
*   **강력한 기준선의 중요성**: DeepSORT와 같은 고전적인 프레임워크도 최신 기술을 접목하면 최첨단 성능을 달성할 수 있음을 보여주었으며, 이는 MOT 연구의 공정한 비교를 위한 강력한 기준선을 제시합니다.
*   **플러그-앤-플레이 모듈의 가치**: AFLink와 GSI는 가볍고 모델에 구애받지 않으며, 기존 트래커에 쉽게 통합되어 성능을 개선할 수 있는 범용적인 솔루션임을 입증했습니다. 특히 GSI는 탐지 노이즈 필터로서 궤적의 안정성을 높여줍니다.
*   **제한 사항**:
    *   **속도**: 결합형 트래커나 외형 정보 없는 분리형 트래커에 비해 상대적으로 낮은 실행 속도를 가집니다.
    *   **MOTA 성능**: MOT17 및 MOT20에서 MOTA 지표가 약간 낮은 경향이 있는데, 이는 탐지 점수 임계값이 높아 탐지 누락이 많기 때문으로 분석됩니다.
    *   **AFLink의 한계**: 연결 누락 복원에는 효과적이나, 잘못 연결된 ID 궤적을 분리하는 데는 도움이 되지 않아 향후 더 유연한 전역 연결 전략 개발이 필요합니다.

## 📌 TL;DR
이 논문은 고전적인 DeepSORT를 최신 탐지 및 외형 모델, 추론 트릭으로 강화한 **StrongSORT**를 제안하여 MOT의 강력한 기준선을 마련했습니다. 또한, 연결 누락(missing association) 문제를 해결하기 위한 외형 정보 없는 경량 모델 **AFLink**와 탐지 누락(missing detection) 문제를 보완하기 위한 가우시안 프로세스 기반의 보간 알고리즘 **GSI**를 도입했습니다. 이 두 알고리즘은 기존 트래커에 쉽게 통합되어 성능을 향상시킬 수 있습니다. StrongSORT에 AFLink와 GSI를 결합한 **StrongSORT++**는 MOT17, MOT20, DanceTrack, KITTI 등 여러 벤치마크에서 최첨단 성능을 달성하여, DeepSORT와 같은 고전적인 프레임워크가 여전히 매우 효과적임을 입증했습니다.