# SIMPLE ONLINE AND REALTIME TRACKING WITH A DEEP ASSOCIATION METRIC

Nicolai Wojke, Alex Bewley, Dietrich Paulus

## π§© Problem to Solve

κΈ°μ΅΄ SORT(Simple Online and Realtime Tracking)λ” κ°„λ‹¨ν•κ³  ν¨μ¨μ μ΄μ§€λ§, μ£Όλ΅ λ°”μ΄λ”© λ°•μ¤ μ¤‘μ²©λ¥ (IoU) κΈ°λ°μ μ—°κ²° λ°©μ‹μ„ μ‚¬μ©ν•μ—¬ κΈ΄ μ‹κ°„μ νμƒ‰(occlusion) μƒν™©μ—μ„ κ°μ²΄ ID μ „ν™(identity switches)μ΄ λΉλ²ν•κ² λ°μƒν•λ‹¤λ” ν•κ³„κ°€ μμµλ‹λ‹¤. νΉν μ¶”μ • λ¶ν™•μ‹¤μ„±μ΄ λ†’μ€ κ²½μ° μ—°κ²° μ •ν™•λ„κ°€ λ–¨μ–΄μ Έ μ¶”μ  μ„±λ¥μ΄ μ €ν•λ©λ‹λ‹¤.

## β¨ Key Contributions

- νμƒ‰ μƒν™©μ—μ„ κ°μ²΄ ID μ μ§€λ¥Ό κ°μ„ ν•κΈ° μ„ν•΄ SORTμ— **κΉμ΄ ν•™μµ κΈ°λ°μ μ™Έν•(appearance) μ •λ³΄**λ¥Ό ν†µν•©ν–μµλ‹λ‹¤.
- μ¤ν”„λΌμΈμ—μ„ λ€κ·λ¨ λ³΄ν–‰μ μ¬μ‹λ³„(person re-identification) λ°μ΄ν„°μ…‹μΌλ΅ ν•™μµλ **κΉμ€ μ—°κ²° μ²™λ„(deep association metric)**λ¥Ό λ„μ…ν•μ—¬, μ¨λΌμΈ μ¶”μ  μ‹ μ™Έν• κ³µκ°„μ—μ„μ μµκ·Όμ ‘ μ΄μ›ƒ(nearest neighbor) μΏΌλ¦¬λ¥Ό ν†µν•΄ μΈ΅μ •κ°’-νΈλ™ μ—°κ²°μ„ μν–‰ν•©λ‹λ‹¤.
- μ›€μ§μ„ μ •λ³΄(λ§ν• λΌλ…ΈλΉ„μ¤ κ±°λ¦¬)μ™€ μ™Έν• μ •λ³΄(μ½”μ‚¬μΈ κ±°λ¦¬)λ¥Ό κ²°ν•©ν• μƒλ΅μ΄ μ—°κ²° λΉ„μ© ν•¨μλ¥Ό μ μ•ν•κ³ , **λ§¤μΉ­ μΊμ¤μΌ€μ΄λ“(matching cascade)** λ°©μ‹μ„ λ„μ…ν•μ—¬ λ” μμ£Ό λ³΄μ΄λ” κ°μ²΄μ— μ°μ„ μμ„λ¥Ό λ¶€μ—¬ν•¨μΌλ΅μ¨ μ¶”μ  μ•μ •μ„±μ„ λ†’μ€μµλ‹λ‹¤.
- MOT16 λ²¤μΉλ§ν¬μ—μ„ κΈ°μ΅΄ SORT λ€λΉ„ **ID μ „ν™μ„ μ•½ 45% κ°μ†**μ‹ν‚¤λ©΄μ„ κ²½μλ ¥ μλ” μ „μ²΄ μ„±λ¥μ„ μ μ§€ν•κ³  μ‹¤μ‹κ°„ μ¶”μ  μ†λ„λ¥Ό λ‹¬μ„±ν–μµλ‹λ‹¤.
- μ μ•ν•λ” λ¨λΈμ μ½”λ“μ™€ μ‚¬μ „ ν•™μµλ CNN λ¨λΈμ„ κ³µκ°ν•μ—¬ μ—°κµ¬ λ° μ‹¤μ  μ‘μ© κ°λ°μ„ μ©μ΄ν•κ² ν–μµλ‹λ‹¤.

## π“ Related Works

- **μ¶”μ -by-κ²€μ¶(Tracking-by-detection) ν¨λ¬λ‹¤μ„:** κ°μ²΄ κ²€μ¶μ λ°μ „μΌλ΅ μ»΄ν“¨ν„° λΉ„μ „ λ¶„μ•Όμ μ£Όλ¥κ°€ λμ—μµλ‹λ‹¤.
  - **μ „μ—­ μµμ ν™” λ°©μ‹:** ν”λ΅μ° λ„¤νΈμ›ν¬(flow network) [1, 2, 3] λ° ν™•λ¥ μ  κ·Έλν”½ λ¨λΈ(probabilistic graphical models) [4, 5, 6, 7]μ€ μ „μ²΄ λΉ„λ””μ¤λ¥Ό λ°°μΉ(batch) μ²λ¦¬ν•μ—¬ μ¨λΌμΈ μ‹λ‚λ¦¬μ¤μ— λ¶€μ ν•©ν•©λ‹λ‹¤.
  - **μ „ν†µμ μΈ μ¨λΌμΈ λ°©μ‹:** MHT(Multiple Hypothesis Tracking) [8] λ° JPDAF(Joint Probabilistic Data Association Filter) [9]λ” ν”„λ μ„λ³„ λ°μ΄ν„° μ—°κ²°μ„ μν–‰ν•μ§€λ§ κ³„μ‚° λ° κµ¬ν„ λ³µμ΅λ„κ°€ λ†’μµλ‹λ‹¤.
- **κΈ°μ΅΄ SORT (Simple Online and Realtime Tracking)** [12]: μ΄λ―Έμ§€ κ³µκ°„μ—μ„ μΉΌλ§ ν•„ν„°λ§κ³Ό ν—κ°€λ¦¬μ• λ©”μ†λ“λ¥Ό μ‚¬μ©ν•μ—¬ ν”„λ μ„λ³„ λ°μ΄ν„° μ—°κ²°μ„ μν–‰ν•λ” κ°„λ‹¨ν• ν”„λ μ„μ›ν¬μ…λ‹λ‹¤. λ†’μ€ ν”„λ μ„λ¥ μ—μ„ μΆ‹μ€ μ„±λ¥μ„ λ³΄μ΄μ§€λ§, ID μ „ν™μ΄ μƒλ€μ μΌλ΅ λ§λ‹¤λ” ν•κ³„κ°€ μμµλ‹λ‹¤.

## π› οΈ Methodology

λ³Έ λ…Όλ¬Έμ€ μ¬κ·€μ μΈ μΉΌλ§ ν•„ν„°λ§κ³Ό ν”„λ μ„λ³„ λ°μ΄ν„° μ—°κ²°μ„ μ‚¬μ©ν•λ” λ‹¨μΌ κ°€μ„¤ μ¶”μ  λ°©λ²•λ΅ μ„ μ±„νƒν•λ©°, κΈ°μ΅΄ SORT ν”„λ μ„μ›ν¬λ¥Ό ν™•μ¥ν•©λ‹λ‹¤.

- **νΈλ™ κ΄€λ¦¬ λ° μƒνƒ μ¶”μ • (Track Handling and State Estimation):**
  - 8μ°¨μ› μƒνƒ κ³µκ°„ $(u, v, \gamma, h, \dot{x}, \dot{y}, \dot{\gamma}, \dot{h})$μ„ μ‚¬μ©ν•©λ‹λ‹¤. μ—¬κΈ°μ„ $u, v$λ” λ°”μ΄λ”© λ°•μ¤ μ¤‘μ‹¬ μ„μΉ, $\gamma$λ” μΆ…ν΅λΉ„, $h$λ” λ†’μ΄μ΄λ©°, λ’¤μ λ„¤ ν•­μ€ κ°κ°μ μ†λ„μ…λ‹λ‹¤.
  - κ°μ²΄ μƒνƒμ μ§μ ‘μ μΈ κ΄€μΈ΅κ°’μΌλ΅ λ°”μ΄λ”© λ°•μ¤ μΆν‘ $(u, v, \gamma, h)$λ¥Ό μ‚¬μ©ν•λ” ν‘μ¤€ μΉΌλ§ ν•„ν„°λ¥Ό μ μ©ν•©λ‹λ‹¤.
  - κ° νΈλ™μ— λ€ν•΄ λ§μ§€λ§‰ μ„±κ³µμ μΈ μ—°κ²° μ΄ν›„ ν”„λ μ„ μ $a_k$λ¥Ό μΉ΄μ΄νΈν•λ©°, λ―Έλ¦¬ μ •μλ μµλ€ λ‚μ΄ $A_{max}$λ¥Ό μ΄κ³Όν•λ” νΈλ™μ€ μ‚­μ λ©λ‹λ‹¤.
  - μƒλ΅μ΄ νΈλ™ κ°€μ„¤μ€ κΈ°μ΅΄ νΈλ™κ³Ό μ—°κ²°λμ§€ μ•μ€ κ° κ²€μ¶μ— λ€ν•΄ μ΄κΈ°ν™”λλ©°, μ²μ μ„Έ ν”„λ μ„ λ™μ• μ„μ‹(tentative) μƒνƒλ΅ λ¶„λ¥λ©λ‹λ‹¤.
- **μ—°κ²° λ¬Έμ  (Assignment Problem):**
  - μμΈ΅λ μΉΌλ§ μƒνƒμ™€ μƒλ΅ λ„μ°©ν• μΈ΅μ •κ°’ κ°„μ μ—°κ²°μ€ ν—κ°€λ¦¬μ• μ•κ³ λ¦¬μ¦(Hungarian algorithm)μ„ μ‚¬μ©ν•μ—¬ ν•΄κ²°λ©λ‹λ‹¤.
  - **μ›€μ§μ„ μ²™λ„:** λ§ν• λΌλ…ΈλΉ„μ¤ κ±°λ¦¬(Mahalanobis distance) $d^{(1)}(i,j) = (d_j - y_i)^T S_i^{-1} (d_j - y_i)$λ¥Ό μ‚¬μ©ν•μ—¬ μμΈ΅λ μΉΌλ§ μƒνƒμ™€ μΈ΅μ •κ°’ μ‚¬μ΄μ κ±°λ¦¬λ¥Ό κ³„μ‚°ν•©λ‹λ‹¤.
    - μ΄ κ±°λ¦¬λ” μƒνƒ μ¶”μ • λ¶ν™•μ‹¤μ„±μ„ κ³ λ ¤ν•λ©°, 4μ°¨μ› μΈ΅μ • κ³µκ°„μ— λ€ν•΄ 95% μ‹ λΆ° κµ¬κ°„μ— ν•΄λ‹Ήν•λ” $t^{(1)} = 9.4877$λ΅ κ²μ΄ν…(gating)λ©λ‹λ‹¤.
  - **μ™Έν• μ²™λ„:** κ° λ°”μ΄λ”© λ°•μ¤ κ²€μ¶ $d_j$μ— λ€ν•΄ μ •κ·ν™”λ μ™Έν• κΈ°μ μ(appearance descriptor) $r_j$λ¥Ό κ³„μ‚°ν•©λ‹λ‹¤. κ° νΈλ™ $k$μ— λ€ν•΄ λ§μ§€λ§‰ $L_k = 100$κ°μ μ—°κ²°λ μ™Έν• κΈ°μ μ κ°¤λ¬λ¦¬ $R_k$λ¥Ό μ μ§€ν•©λ‹λ‹¤.
    - μ™Έν• κ³µκ°„μ—μ„ νΈλ™ $i$μ™€ κ²€μ¶ $j$ μ‚¬μ΄μ κ°€μ¥ μ‘μ€ μ½”μ‚¬μΈ κ±°λ¦¬(cosine distance) $d^{(2)}(i,j) = \min\{1-r_j^T r^{(i)}_k | r^{(i)}_k \in R_i\}$λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.
    - μ΄ λν• μ„κ³„κ°’ $t^{(2)}$λ΅ κ²μ΄ν…λ©λ‹λ‹¤.
  - **λ‘ μ²™λ„μ κ²°ν•©:** μ—°κ²° λΉ„μ©μ€ κ°€μ¤‘ν•© $c_{i,j} = \lambda d^{(1)}(i,j) + (1-\lambda) d^{(2)}(i,j)$μΌλ΅ κ³„μ‚°λ©λ‹λ‹¤. μ—°κ²°μ€ λ‘ μ²™λ„ λ¨λ‘μ— μν•΄ ν—μ©λ  λ• μ ν¨ν•©λ‹λ‹¤($b_{i,j} = \prod_{m=1}^{2} b^{(m)}_{i,j}$).
- **λ§¤μΉ­ μΊμ¤μΌ€μ΄λ“ (Matching Cascade):**
  - μ „μ—­μ μΈ ν• λ‹Ή λ¬Έμ  λ€μ‹ , μΌλ ¨μ ν•μ„ λ¬Έμ λ¥Ό ν•΄κ²°ν•λ” μΊμ¤μΌ€μ΄λ“λ¥Ό λ„μ…ν•©λ‹λ‹¤.
  - μ΄λ” λ‚μ΄(age)κ°€ μ‘μ€(μ¦‰, μµκ·Όμ— λ” μμ£Ό κ΄€μΈ΅λ) νΈλ™μ— μ°μ„ μμ„λ¥Ό λ¶€μ—¬ν•μ—¬, λ§ν• λΌλ…ΈλΉ„μ¤ κ±°λ¦¬κ°€ λ¶ν™•μ‹¤μ„±μ΄ ν° νΈλ™μ„ μ„ νΈν•λ” κ²½ν–¥μΌλ΅ μΈν• νΈλ™ λ‹¨νΈν™”(fragmentation) λ¬Έμ λ¥Ό μ™„ν™”ν•©λ‹λ‹¤.
  - μ•κ³ λ¦¬μ¦μ€ νΈλ™ λ‚μ΄ $n \in \{1, \dots, A_{max}\}$μ— λ”°λΌ λ°λ³µν•λ©° μ„ ν• ν• λ‹Ή λ¬Έμ λ¥Ό ν•΄κ²°ν•κ³ , λ§¤μΉ­λ νΈλ™κ³Ό λ‚¨μ€ κ²€μ¶μ„ μ—…λ°μ΄νΈν•©λ‹λ‹¤.
  - λ§μ§€λ§‰ λ§¤μΉ­ λ‹¨κ³„μ—μ„λ” μ΄κΈ° SORTμ IoU μ—°κ²° λ°©μ‹μ„ μ‚¬μ©ν•μ—¬ κ°‘μ‘μ¤λ¬μ΄ μ™Έν• λ³€ν™”λ‚ μ΄κΈ°ν™” μ¤λ¥λ¥Ό μ²λ¦¬ν•©λ‹λ‹¤.
- **κΉμ€ μ™Έν• κΈ°μ μ (Deep Appearance Descriptor):**
  - λ€κ·λ¨ λ³΄ν–‰μ μ¬μ‹λ³„ λ°μ΄ν„°μ…‹(MARS)μΌλ΅ μ¤ν”„λΌμΈμ—μ„ μ‚¬μ „ ν•™μµλ CNNμ„ μ‚¬μ©ν•μ—¬ μ™Έν• κΈ°μ μλ¥Ό μƒμ„±ν•©λ‹λ‹¤.
  - CNN μ•„ν‚¤ν…μ²λ” λ‘ κ°μ μ»¨λ³Όλ£¨μ… λ μ΄μ–΄μ™€ 6κ°μ μ”μ°¨ λΈ”λ΅μΌλ΅ κµ¬μ„±λ μ™€μ΄λ“ μ”μ°¨ λ„¤νΈμ›ν¬(wide residual network)μ…λ‹λ‹¤.
  - μµμΆ… 128μ°¨μ› νΉμ§• λ§µμ€ λ°°μΉ μ •κ·ν™”(batch normalization) λ° $L_2$ μ •κ·ν™”λ¥Ό ν†µν•΄ λ‹¨μ„ μ΄κµ¬(unit hypersphere)μ— ν¬μλμ–΄ μ½”μ‚¬μΈ μ™Έν• μ²™λ„μ™€ νΈν™λ©λ‹λ‹¤.

## π“ Results

- **λ°μ΄ν„°μ…‹:** MOT16 λ²¤μΉλ§ν¬μ 7κ° ν…μ¤νΈ μ‹ν€€μ¤μ—μ„ ν‰κ°€λμ—μµλ‹λ‹¤.
- **κ²€μ¶κΈ°:** Yu et al. [16]μ΄ μ κ³µν• Faster R-CNN κ²€μ¶κΈ°λ¥Ό μ‚¬μ©ν•μ€μΌλ©°, κ³µμ •ν• λΉ„κµλ¥Ό μ„ν•΄ SORTλ„ λ™μΌν• κ²€μ¶κΈ°λ΅ μ¬μ‹¤ν–‰λμ—μµλ‹λ‹¤.
- **μ£Όμ” μ„±λ¥ μ§€ν‘ (MOTA, MOTP, MT, ML, ID, FM):**
  - **ID μ „ν™ (ID Sw.):** κΈ°μ΅΄ SORTμ 1423νμ—μ„ Deep SORTλ” 781νλ΅, **μ•½ 45% κ°μ†**ν–μµλ‹λ‹¤. μ΄λ” λ³Έ λ°©λ²•μ ν•µμ‹¬ λ©ν‘μΈ ID μ μ§€ κ°μ„ μ„ μ„±κ³µμ μΌλ΅ λ³΄μ—¬μ¤λ‹λ‹¤.
  - **Mostly Tracked (MT):** 25.4%μ—μ„ 32.8%λ΅ μ¦κ°€ν–κ³ , **Mostly Lost (ML):** 22.7%μ—μ„ 18.2%λ΅ κ°μ†ν–μµλ‹λ‹¤. μ΄λ” λ” λ§μ€ κ°μ²΄κ°€ μλ… μ£ΌκΈ° λ™μ• κΎΈμ¤€ν μ¶”μ λκ³  λ μ†μ‹¤λ¨μ„ μλ―Έν•©λ‹λ‹¤.
  - **νΈλ™ λ‹¨νΈν™” (FM):** 1835νμ—μ„ 2008νλ΅ μ†ν­ μ¦κ°€ν–μµλ‹λ‹¤. μ΄λ” νμƒ‰ λ° λ„λ½λ κ²€μ¶μ„ ν†µν•΄ κ°μ²΄ IDλ¥Ό μ μ§€ν•λ” κ³Όμ •μ—μ„ λ°μƒν•λ” trade-offλ΅ ν•΄μ„λ©λ‹λ‹¤.
  - **MOTA (Multi-Object Tracking Accuracy):** 59.8%μ—μ„ 61.4%λ΅ μƒμΉν•μ—¬ μ „λ°μ μΈ μ¶”μ  μ •ν™•λ„λ„ ν–¥μƒλμ—μµλ‹λ‹¤.
  - **μ‹¤μ‹κ°„ μ„±λ¥:** μ•½ 20 Hzμ ν”„λ μ„λ¥ λ΅ λ™μ‘ν•λ©°, μ΄ μ¤‘ μ λ° μ •λ„μ μ‹κ°„μ΄ νΉμ§• μƒμ„±μ— μ†μ”λ©λ‹λ‹¤. μµμ‹  GPU ν™κ²½μ—μ„ μ‹¤μ‹κ°„ μ¶”μ μ— μ ν•©ν•©λ‹λ‹¤.

## π§  Insights & Discussion

- **ID μ μ§€ κ°μ„ :** μ™Έν• μ •λ³΄ ν†µν•©μ„ ν†µν•΄ νΉν κΈ΄ νμƒ‰ κΈ°κ°„ λ™μ• κ°μ²΄ IDλ¥Ό μ„±κ³µμ μΌλ΅ μ μ§€ν•λ” λ° ν° ν¨κ³Όλ¥Ό λ³΄μ€μµλ‹λ‹¤. μ΄λ” μ •λ‰μ  μ§€ν‘(ID κ°μ†, MT μ¦κ°€)λΏλ§ μ•„λ‹λΌ μ§μ  λ¶„μ„μ—μ„λ„ ν™•μΈλμ—μµλ‹λ‹¤.
- **κ²½μλ ¥:** μ μ•λ λ°©λ²•μ€ λ‹¤λ¥Έ μ¨λΌμΈ μ¶”μ  λ°©λ²•λ“¤κ³Ό λΉ„κµν–μ„ λ•, κ°€μ¥ μ μ€ μμ ID μ „ν™μ„ λ‹¬μ„±ν•λ©΄μ„λ„ μ „λ°μ μΈ MOTA μ μμ™€ λ‹¤λ¥Έ μ§€ν‘λ“¤μ—μ„ κ²½μλ ¥μ„ μ μ§€ν•©λ‹λ‹¤.
- **ν•κ³„ λ° ν–¥ν›„ κ°μ„ μ :**
  - MOTA μ μλ” λΉ„κµμ  λ§μ€ μμ μ¤νƒ(false positives, FP)μΌλ΅ μΈν•΄ λ¶€λ¶„μ μΌλ΅ μ €ν•΄λμ—μµλ‹λ‹¤. μ΄λ” μ£Όλ΅ μ •μ  μ¥λ©΄ κΈ°ν•ν•™μ—μ„ λ°μƒν•λ” μ‚°λ°μ μΈ κ²€μ¶κΈ° λ°μ‘κ³Ό νΈλ™ μµλ€ λ‚μ΄($A_{max}$) μ„¤μ • λ•λ¬ΈμΌλ΅ λ³΄μ…λ‹λ‹¤.
  - κ·Έλ¬λ‚ μ΄λ¬ν• μ¤νƒμ΄ μμ£Ό νΈλ™μ„ κ±΄λ„λ›°κ² ν•λ” λ€μ‹ , νΈλμ»¤λ” λ³΄κ³ λ κ°μ²΄ μ„μΉμ—μ„ λΉ„κµμ  μ•μ •μ μΈ μ •μ§€ νΈλ™μ„ μƒμ„±ν•λ” κ²½ν–¥μ΄ μμ—μµλ‹λ‹¤.
  - κ²€μ¶ μ‹ λΆ°λ„ μ„κ³„κ°’μ„ λ†’μ΄λ©΄ FPλ¥Ό μ¤„μ—¬ MOTA μ„±λ¥μ„ ν¬κ² ν–¥μƒμ‹ν‚¬ μ μ¬λ ¥μ΄ μμµλ‹λ‹¤.

## π“ TL;DR

Deep SORTλ” κΈ°μ΅΄ SORTμ λ†’μ€ ID μ „ν™ λ¬Έμ λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄ **κΉμ€ ν•™μµ κΈ°λ°μ μ™Έν• μ •λ³΄**λ¥Ό ν†µν•©ν• μ‹¤μ‹κ°„ μ¨λΌμΈ λ‹¤μ¤‘ κ°μ²΄ μ¶”μ  μ•κ³ λ¦¬μ¦μ…λ‹λ‹¤. **μΉΌλ§ ν•„ν„°μ μ›€μ§μ„ μμΈ΅**κ³Ό **μ‚¬μ „ ν•™μµλ CNN κΈ°λ° μ™Έν• κΈ°μ μμ μ½”μ‚¬μΈ κ±°λ¦¬**λ¥Ό κ²°ν•©ν• μƒλ΅μ΄ μ—°κ²° μ²™λ„λ¥Ό μ‚¬μ©ν•κ³ , **λ§¤μΉ­ μΊμ¤μΌ€μ΄λ“**λ¥Ό ν†µν•΄ νΈλ™μ λ‚μ΄μ— λ”°λΌ μ—°κ²° μ°μ„ μμ„λ¥Ό λ¶€μ—¬ν•©λ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ MOT16 λ²¤μΉλ§ν¬μ—μ„ **ID μ „ν™μ¨μ„ 45% κ°μ†**μ‹ν‚¤λ” λ™μ‹μ— λ†’μ€ μ¶”μ  μ •ν™•λ„μ™€ μ‹¤μ‹κ°„ μ„±λ¥μ„ λ‹¬μ„±ν•μ—¬, κΈ΄ νμƒ‰ μƒν™©μ—μ„λ„ κ°μ²΄ IDλ¥Ό ν¨κ³Όμ μΌλ΅ μ μ§€ν•  μ μμμ„ μ…μ¦ν–μµλ‹λ‹¤.
