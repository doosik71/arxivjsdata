# Federated Learning in Distributed Medical Databases: Meta-Analysis of Large-Scale Subcortical Brain Data

Santiago Silva, Boris A. Gutman, Eduardo Romero, Paul M. Thompson, Andre Altmann, Marco Lorenzi

## 🧩 Problem to Solve

의료 영상 데이터뱅크는 전례 없는 규모의 뇌 이미지를 보유하고 있지만, 개인 정보 보호 및 법적 문제로 인해 서로 다른 기관에 저장된 데이터를 직접 공유할 수 없어 뇌 질환 연구에서 빅 데이터의 완전한 활용이 제한됩니다. 기존 메타 분석은 주로 단일 변량 모델을 사용하며, 다변량 분석은 높은 통신 비용(그래디언트 기반 최적화) 또는 데이터 정규화 및 교란 변수 보정의 부재와 같은 실용적인 한계가 있었습니다.

## ✨ Key Contributions

* **종단 간(End-to-End) 연합 학습 프레임워크 제안:** 분산된 생의학 데이터의 데이터 표준화, 교란 변수 보정 및 고차원 특징의 다변량 변동성 분석을 위한 포괄적인 프레임워크를 제시합니다.
* **ADMM 기반 교란 변수 보정:** 교란 변수(예: 연령, 성별)의 영향을 일관되게 보정하기 위해 ADMM(Alternating Direction Method of Multipliers)을 활용하여 통신 횟수를 줄입니다.
* **연합 PCA(fPCA) 개발:** 개별 데이터를 공유하지 않고도 전체 데이터의 저차원 표현을 얻기 위한 연합 주성분 분석 방법을 제안합니다.
* **대규모 실제 데이터셋에 적용 및 검증:** ADNI, PPMI, MIRIAD, UK Biobank 등 다중 센터, 다중 데이터베이스의 뇌 MRI 데이터를 활용하여 제안된 프레임워크의 잠재력을 입증했습니다.

## 📎 Related Works

* **메타 분석 (Meta-analysis):** 여러 독립적인 연구 결과(p-값, 효과 크기 등)를 결합하여 통계적 테스트를 수행하는 방식.
* **연합 학습 (Federated Learning):** 개별 정보를 공유하지 않고 모델 파라미터만 교환하여 모델을 학습시키는 방식.
* **ENIGMA 컨소시엄:** 신경영상학 및 유전학 데이터의 대규모 협력 분석을 수행하지만, 주로 대량 단일 변량 모델에 의존하여 다변량 데이터의 공분산을 잘 설명하지 못하는 한계가 있습니다.
* **기존 연합 다변량 분석:** 독립 성분 분석(ICA) [4], 희소 회귀(sparse regression), 모수 통계 테스트 [5, 6] 등이 제안되었으나, 그래디언트 기반 최적화로 인해 수렴까지 많은 통신이 필요할 수 있습니다.
* **Lorenzi et al. [7, 8]의 차원 축소 접근 방식:** 아이겐값 분해(eigen-value decomposition) 기반의 다변량 차원 축소법으로 반복적인 통신이 필요 없지만, 데이터 표준화 및 교란 변수 보정이 연합 방식으로 일관되게 수행되지 못하는 한계가 있었습니다.

## 🛠️ Methodology

본 논문은 생의학 데이터가 여러 센터에 분할되어 저장되어 개별 정보에 대한 접근이 제한되는 시나리오를 가정하며, 다음과 같은 세 가지 주요 단계로 구성된 연합 분석 프레임워크를 제안합니다 (그림 1 참조):

1. **데이터 표준화 (Data Standardization):**
    * 각 센터는 로컬 데이터($X_c$)와 공변량($Y_c$)을 사용하여 특징별 평균($\bar{x_c}$)과 표준 편차($\sigma_c$)를 계산합니다.
    * 이 로컬 통계량($\bar{x_c}$, $\sigma_c$)을 센터 간에 전달하여 전체 연구의 전역 통계량($\bar{x}$, $\sigma$)을 반복적으로 업데이트하고, 이를 사용하여 각 센터의 데이터를 전역적으로 표준화합니다.

2. **교란 변수 보정 (Correction from Confounding Factors):**
    * 데이터와 교란 변수 사이에 선형 관계($X = YW$)가 있다고 가정합니다.
    * ADMM [10]을 사용하여 전역 가중치 행렬 $\hat{W}$를 추정하고, 이를 모든 센터에서 공유하여 교란 변수 효과를 일관되게 보정합니다.
    * 최적화는 다음 단계를 통해 반복적으로 수행됩니다:
        * **로컬 업데이트:** 각 센터 $c$에서 독립적으로 로컬 파라미터 $W_c^{(k+1)}$ 및 듀얼 변수 $\alpha_c^{(k+1)}$를 계산합니다.
        $$W_c^{(k+1)} := (\hat{X}'_c \hat{X}_c + \frac{\rho}{2}I)^{-1} (\hat{X}'_c Y_c - \frac{1}{2}\alpha_c^{(k)} + \frac{\rho}{2} \tilde{W}_c^{(k)})$$
        $$\alpha_c^{(k+1)} := \alpha_c^{(k)} + \rho (W_c^{(k+1)} - \hat{W}^{(k+1)})$$
        * **전역 업데이트:** 모든 센터의 $W_c$와 $\alpha_c$를 공유하여 전역 파라미터 $\hat{W}^{(k+1)}$를 계산합니다.
        $$\hat{W}^{(k+1)} := \frac{1}{C}\sum_{c} (\frac{\alpha_c^{(k)}}{\rho} + W_c^{(k+1)})$$
    * 수렴 후, 추정된 $\hat{W}$를 사용하여 교정된 관측 행렬 $E_c = \hat{X}_c - Y_c \hat{W}$를 얻습니다.

3. **연합 PCA (Federated PCA, fPCA):**
    * 전역 공분산 행렬 $S$가 로컬 공분산 행렬 $S_c$의 합으로 표현될 수 있다는 점($S = \sum_{c=1}^C E_c E_c'$)에 기반합니다.
    * 개별 데이터에 접근하지 않고도 전역 공분산 행렬의 아이겐 모드와 값을 얻기 위해, 각 센터는 로컬 공분산 행렬의 주요 아이겐 구성 요소($U_c, \Sigma_c^2$)만을 공유합니다.
    * 설명된 변동성의 80%를 포함하는 구성 요소만 공유하여 문제의 차원을 더욱 줄입니다.

## 📊 Results

* **합성 데이터:** ADMM 기반의 교란 변수 보정은 다양한 센터 수에서 효과적으로 수렴하며, 연합 PCA는 전역 PCA 결과를 정확하게 근사함을 보여주었습니다 (그림 2).
* **실제 신경영상 데이터 (ADNI, PPMI, MIRIAD, UK Biobank):**
  * 연합 주성분 분석 결과 (그림 3), 첫 번째 주성분들은 건강한 상태에서 알츠하이머병(AD)으로 진행되는 변동성을 여러 센터에 걸쳐 일관되게 식별했습니다.
  * 건강한 ADNI 참가자들이 AD 환자군과 다른 인구 집단 사이에 위치하는 경향을 보였는데, 이는 보정 후에도 연령과 관련된 잔여 효과가 남아있을 수 있음을 시사합니다.
  * 파킨슨병(PD) 환자들은 모델링된 피질하 정보에서 전반적으로 건강한 개인과 유사한 양상을 보였습니다.
  * 첫 번째 주성분과 관련된 가중치 맵(그림 4)은 주로 해마와 편도체의 변화를 보여주었습니다.

## 🧠 Insights & Discussion

이 연구는 분산된 생의학 데이터의 안전하고 일관된 다변량 연합 분석을 위한 강력한 종단 간 프레임워크를 성공적으로 제시했습니다. 이 프레임워크는 개인 정보 보호 문제를 해결하면서도 대규모 데이터셋의 잠재력을 활용하여 뇌 질환의 유전적 및 구조적 기저를 더 깊이 이해하는 데 기여할 수 있습니다. 특히, ADMM을 통해 교란 변수 보정 시 통신 오버헤드를 줄인 점과, 연합 PCA를 통해 데이터 공유 없이 전역적인 변동성 분석을 수행한 점이 중요합니다.

하지만, 교란 변수 보정 후에도 잔여 변동성(예: 연령 효과)이 남아있을 수 있다는 한계도 발견되었으며, 이는 다중 센터 연구에서 지속적인 연구 과제입니다. 향후 ENIGMA 메타 연구와 같은 대규모 영상 유전학 데이터 분석으로 확장될 수 있는 가능성을 열었습니다.

## 📌 TL;DR

개인 정보 보호 문제로 인해 분산된 의료 데이터의 대규모 다변량 분석이 어려운 문제를 해결하기 위해, 본 논문은 데이터 표준화, ADMM 기반 교란 변수 보정, 그리고 연합 PCA를 통합한 종단 간 연합 학습 프레임워크를 제안합니다. 이 방법은 ADNI, PPMI, UK Biobank 등의 대규모 뇌 MRI 데이터를 분석하여, 개별 데이터 공유 없이도 신경퇴행성 질환에서 일관된 뇌 구조 변화 패턴을 효과적으로 식별할 수 있음을 입증했습니다.
