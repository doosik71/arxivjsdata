# FedHealth: A Federated Transfer Learning Framework for Wearable Healthcare

Yiqiang Chen, Jindong Wang, Chaohui Yu, Wen Gao, Xin Qin

## π§© Problem to Solve

μ›¨μ–΄λ¬λΈ” κΈ°κΈ°μ ν™•μ‚°μΌλ΅ κ±΄κ°• λ°μ΄ν„°κ°€ ν’λ¶€ν•΄μ΅μ§€λ§, λ‹¤μ λ‘ κ°€μ§€ μ£Όμ” λ¬Έμ μ— μ§λ©΄ν•΄ μμµλ‹λ‹¤.

- **λ°μ΄ν„° κ³ λ¦½ (Data Isolation):** μ‚¬μ©μ λ°μ΄ν„°λ” κ°μΈ μ •λ³΄ λ³΄νΈ λ° λ³΄μ• λ¬Έμ (μ: GDPR κ·μ )λ΅ μΈν•΄ μ„λ΅ λ‹¤λ¥Έ μ΅°μ§μ΄λ‚ μ¥μΉ κ°„μ— κ³µμ λκ±°λ‚ ν†µν•©λκΈ° μ–΄λ µμµλ‹λ‹¤. μ΄λ΅ μΈν•΄ κ°•λ ¥ν• λ¨λΈμ„ ν›λ ¨ν•κΈ° μ„ν• λ€κ·λ¨ λ°μ΄ν„° μ§‘κ³„κ°€ λ¶κ°€λ¥ν•©λ‹λ‹¤.
- **κ°μΈν™” λ¶€μ΅±:** λ€λ¶€λ¶„μ ν—¬μ¤μΌ€μ–΄ μ• ν”λ¦¬μΌ€μ΄μ…μ€ λ¨λ“  μ‚¬μ©μμ—κ² μ μ©λλ” λ‹¨μΌ κ³µν†µ λ¨λΈμ— μμ΅΄ν•©λ‹λ‹¤. κ·Έλ¬λ‚ μ‚¬μ©μλ§λ‹¤ μ‹ μ²΄μ  νΉμ„± λ° ν™λ™ ν¨ν„΄μ΄ λ‹¤λ¥΄κΈ° λ•λ¬Έμ— μ΄λ¬ν• κ³µν†µ λ¨λΈμ€ κ°μΈν™”λ ν—¬μ¤μΌ€μ–΄ μ„λΉ„μ¤λ¥Ό μ κ³µν•λ” λ° ν•κ³„κ°€ μμµλ‹λ‹¤.

## β¨ Key Contributions

- μ›¨μ–΄λ¬λΈ” ν—¬μ¤μΌ€μ–΄λ¥Ό μ„ν• μµμ΄μ μ—°ν•© μ „μ΄ ν•™μµ(Federated Transfer Learning) ν”„λ μ„μ›ν¬μΈ **FedHealth**λ¥Ό μ μ•ν–μµλ‹λ‹¤.
- ν”„λΌμ΄λ²„μ‹μ™€ λ³΄μ•μ„ μΉ¨ν•΄ν•μ§€ μ•μΌλ©΄μ„ λ¶„λ¦¬λ μ΅°μ§μ λ°μ΄ν„°λ¥Ό ν¨κ³Όμ μΌλ΅ μ§‘κ³„ν•λ” λ°©λ²•μ„ μ μ‹ν•©λ‹λ‹¤.
- μ§€μ‹ μ „μ΄(knowledge transfer)λ¥Ό ν†µν•΄ μ‚¬μ©μλ³„ κ°μΈν™”λ λ¨λΈ ν•™μµμ„ λ‹¬μ„±ν•©λ‹λ‹¤.
- μ¤λ§νΈν° κΈ°λ° ν™λ™ μΈμ‹ μ‹¤ν—μ—μ„ κΈ°μ΅΄ λ°©μ‹ λ€λΉ„ **5.3%** λ” λ†’μ€ μ •ν™•λ„λ¥Ό λ‹¬μ„±ν•μ—¬ ν”„λ μ„μ›ν¬μ μ°μμ„±μ„ μ…μ¦ν–μµλ‹λ‹¤.
- FedHealthλ” μΌλ°μ μ΄κ³  ν™•μ¥ κ°€λ¥ν•μ—¬ λ‹¤μ–‘ν• ν—¬μ¤μΌ€μ–΄ μ• ν”λ¦¬μΌ€μ΄μ…μ— μ μ©λ  μ μ¬λ ¥μ„ κ°€μ§‘λ‹λ‹¤.

## π“ Related Works

- **μ›¨μ–΄λ¬λΈ” ν—¬μ¤μΌ€μ–΄:** μ¤λ§νΈν°, μ†λ© λ°΄λ“ λ“± μ›¨μ–΄λ¬λΈ” κΈ°κΈ°λ¥Ό ν™μ©ν•μ—¬ μΌμƒ ν™λ™ λ° μƒμ²΄ μ‹ νΈλ¥Ό λ¨λ‹ν„°λ§ν•μ—¬ μΈμ§€ μ§ν™(νν‚¨μ¨λ³‘, μ†νκ΄€ μ§ν™ λ“±), μ •μ‹  κ±΄κ°• ν‰κ°€, λ‚™μƒ κ°μ§€, μ¤ν¬μΈ  λ¨λ‹ν„°λ§ λ“±μ— ν™μ©λ©λ‹λ‹¤. κ·Έλ¬λ‚ κΈ°μ΅΄ λ°©μ‹μ€ λ°μ΄ν„° ν†µν•©μ μ–΄λ ¤μ›€κ³Ό κ°μΈν™” λ¶€μ΅±μ΄λΌλ” ν•κ³„λ¥Ό κ°€μ§‘λ‹λ‹¤.
- **μ—°ν•© κΈ°κ³„ ν•™μµ (Federated Machine Learning):** μ‚¬μ©μ λ°μ΄ν„°λ¥Ό μ™Έλ¶€λ΅ λ…Έμ¶ν•μ§€ μ•κ³  λ¶„μ‚°λ ν™κ²½μ—μ„ λ¨λΈμ„ ν›λ ¨ν•λ” ν”„λΌμ΄λ²„μ‹ λ³΄μ΅΄ν• ν•™μµ ν¨λ¬λ‹¤μ„μ…λ‹λ‹¤. μν‰μ , μμ§μ , μ—°ν•© μ „μ΄ ν•™μµμΌλ΅ λ¶„λ¥λλ©°, FedHealthλ” μ—°ν•© μ „μ΄ ν•™μµμ— ν•΄λ‹Ήν•©λ‹λ‹¤.
- **μ „μ΄ ν•™μµ (Transfer Learning):** κΈ°μ΅΄ λ„λ©”μΈμ—μ„ μ–»μ€ μ§€μ‹μ„ μƒλ΅μ΄ κ΄€λ ¨ λ„λ©”μΈμ— μ „μ΄ν•μ—¬ ν•™μµ μ„±λ¥μ„ ν–¥μƒμ‹ν‚¤λ” κΈ°λ²•μ…λ‹λ‹¤. μ£Όλ΅ μΈμ¤ν„΄μ¤ κ°€μ¤‘μΉ μ¬μ΅°μ • λλ” νΉμ§• λ§¤μΉ­μ„ ν†µν•΄ λ„λ©”μΈ κ°„ λ¶„ν¬ λ°μ‚°(distribution divergence)μ„ μ¤„μ΄λ” κ²ƒμ„ λ©ν‘λ΅ ν•©λ‹λ‹¤. FedHealthλ” μ›μ‹ μ‚¬μ©μ λ°μ΄ν„°μ— μ ‘κ·Όν•μ§€ μ•κ³  λ”¥ μ „μ΄ ν•™μµμ„ κ°€λ¥ν•κ² ν•©λ‹λ‹¤.

## π› οΈ Methodology

FedHealth ν”„λ μ„μ›ν¬λ” μ—°ν•© ν•™μµκ³Ό μ „μ΄ ν•™μµμ„ κ²°ν•©ν•μ—¬ λ°μ΄ν„° κ³ λ¦½ λ° κ°μΈν™” λ¬Έμ λ¥Ό ν•΄κ²°ν•©λ‹λ‹¤.

1. **ν΄λΌμ°λ“ λ¨λΈ κµ¬μ¶•:** μ„λ²„λ” κ³µκ° λ°μ΄ν„°μ…‹μ„ μ‚¬μ©ν•μ—¬ μ΄κΈ° ν΄λΌμ°λ“ λ¨λΈ $f_S$λ¥Ό ν›λ ¨ν•©λ‹λ‹¤. ν•™μµ λ©ν‘λ” λ‹¤μκ³Ό κ°™μµλ‹λ‹¤:
    $$ \arg \min_{\Theta} L = \sum_{i=1}^{n} \mathcal{L}(y_i, f_S(x_i)) $$
    μ—¬κΈ°μ„ $\mathcal{L}$μ€ μ†μ‹¤ ν•¨μ, $\{x_i, y_i\}_{i=1}^n$λ” μ„λ²„ λ°μ΄ν„° μƒν”μ…λ‹λ‹¤.
2. **ν΄λΌμ°λ“ λ¨λΈ λ°°ν¬:** ν›λ ¨λ ν΄λΌμ°λ“ λ¨λΈμ€ λ™ν• μ•”νΈν™”(homomorphic encryption)λ¥Ό ν†µν•΄ λ¨λ“  μ‚¬μ©μμ—κ² λ°°ν¬λ©λ‹λ‹¤. μ΄λ” μ •λ³΄ μ μ¶ μ—†μ΄ νλΌλ―Έν„° κ³µμ λ¥Ό κ°€λ¥ν•κ² ν•©λ‹λ‹¤.
3. **μ‚¬μ©μ λ¨λΈ ν›λ ¨ λ° μ§‘κ³„:** κ° μ‚¬μ©μ $u$λ” μμ‹ μ λ°μ΄ν„° $D_u$λ¥Ό μ‚¬μ©ν•μ—¬ λ΅μ»¬ λ¨λΈ $f_u$λ¥Ό ν›λ ¨ν•©λ‹λ‹¤. ν•™μµ λ©ν‘λ” λ‹¤μκ³Ό κ°™μµλ‹λ‹¤:
    $$ \arg \min_{\Theta_u} L_1 = \sum_{i=1}^{n_u} \mathcal{L}(y_i^u, f_u(x_i^u)) $$
    ν›λ ¨λ μ‚¬μ©μ λ¨λΈμ€ λ™ν• μ•”νΈν™”λ μƒνƒλ΅ μ„λ²„μ— μ—…λ΅λ“λλ©°, μ„λ²„λ” μ΄λ¥Ό μ§‘κ³„ν•μ—¬ μƒλ΅μ΄ ν΄λΌμ°λ“ λ¨λΈ $f'_S$λ¥Ό μ—…λ°μ΄νΈν•©λ‹λ‹¤. μ΄ μ—…λ°μ΄νΈλ λ¨λΈμ€ λ¨λ“  μ‚¬μ©μμ μ§€μ‹μ„ λ°μν•μ—¬ λ” λ‚μ€ μΌλ°ν™” λ¥λ ¥μ„ κ°€μ§‘λ‹λ‹¤.
4. **κ°μΈν™”λ λ¨λΈ ν•™μµ (μ „μ΄ ν•™μµ):** μ—…λ°μ΄νΈλ ν΄λΌμ°λ“ λ¨λΈ $f'_S$κ°€ κ° μ‚¬μ©μμ—κ² λ‹¤μ‹ λ°°ν¬λ©λ‹λ‹¤. κ° μ‚¬μ©μλ” μ΄ λ¨λΈκ³Ό μμ‹ μ λ΅μ»¬ λ°μ΄ν„°λ¥Ό μ‚¬μ©ν•μ—¬ κ°μΈν™”λ λ¨λΈμ„ ν›λ ¨ν•©λ‹λ‹¤. μ΄ κ³Όμ •μ—μ„ λ”¥ λ„¤νΈμ›ν¬μ ν•μ„ κ³„μΈµ(μ: μ»¨λ³Όλ£¨μ… λ° ν’€λ§ κ³„μΈµ)μ€ κ³µν†µ νΉμ§•μ„ ν•™μµν•λ―€λ΅ νλΌλ―Έν„°κ°€ κ³ μ •(frozen)λ©λ‹λ‹¤. λ°λ©΄, μƒμ„ κ³„μΈµ(μ: μ™„μ „ μ—°κ²° κ³„μΈµ)μ€ μ‚¬μ©μλ³„ νΉμ • νΉμ§• ν•™μµμ„ μ„ν•΄ νλΌλ―Έν„°κ°€ μ—…λ°μ΄νΈλ©λ‹λ‹¤.
    - **μƒκ΄€ κ΄€κ³„ μ •λ ¬ (CORAL) μ†μ‹¤:** λ¨λΈμ $fc2$ κ³„μΈµμ„ μ •λ ¬(alignment) κ³„μΈµμΌλ΅ λ€μ²΄ν•μ—¬ λ„λ©”μΈ κ°„μ 2μ°¨ ν†µκ³„λ‰μ„ μ •λ ¬ν•©λ‹λ‹¤. μ‚¬μ©μ λ¨λΈμ μµμΆ… μ†μ‹¤ ν•¨μλ” λ‹¤μκ³Ό κ°™μµλ‹λ‹¤:
    $$ \arg \min_{\Theta_u} L_u = \sum_{i=1}^{n_u} \mathcal{L}(y_i^u, f_u(x_i^u)) + \eta \mathcal{L}_{\text{CORAL}} $$
    μ—¬κΈ°μ„ $\mathcal{L}_{\text{CORAL}}$μ€ μƒκ΄€ κ΄€κ³„ μ •λ ¬ μ†μ‹¤μ„ λ‚νƒ€λ‚΄λ©°, $\eta$λ” νΈλ μ΄λ“μ¤ν”„ νλΌλ―Έν„°μ…λ‹λ‹¤.

μ΄ ν”„λ μ„μ›ν¬λ” μ§€μ†μ μΌλ΅ μ—…λ°μ΄νΈλ  μ μμ–΄, μ‚¬μ© κΈ°κ°„μ΄ κΈΈμ–΄μ§μλ΅ λ¨λΈμ΄ λ”μ± κ°μΈν™”λ©λ‹λ‹¤.

## π“ Results

- **λ°μ΄ν„°μ…‹:** UCI μ¤λ§νΈν° ν™λ™ μΈμ‹ λ°μ΄ν„°μ…‹(6κ°€μ§€ ν™λ™, 30λ… μ‚¬μ©μ)μ„ μ‚¬μ©ν–μµλ‹λ‹¤. μ΄ μ¤‘ 5λ…μ μ‚¬μ©μλ¥Ό ν”„λΌμ΄λ²„μ‹ λ¬Έμ λ΅ μΈν•΄ λ°μ΄ν„° κ³µμ κ°€ λ¶κ°€λ¥ν• 'κ³ λ¦½λ μ‚¬μ©μ'λ΅ μ„¤μ •ν•κ³ , λ‚λ¨Έμ§€ 25λ…μ€ ν΄λΌμ°λ“ λ¨λΈ ν›λ ¨μ— μ‚¬μ©ν–μµλ‹λ‹¤.
- **ν‰κ°€ μ§€ν‘:** λ¶„λ¥ μ •ν™•λ„(accuracy), μ •λ°€λ„(precision), μ¬ν„μ¨(recall), F1-scoreλ¥Ό μ‚¬μ©ν–μµλ‹λ‹¤.
- **λΉ„κµ λ€μƒ:** κΈ°μ΅΄μ KNN, SVM, Random Forest λ°©λ²•λΏλ§ μ•„λ‹λΌ ν΄λΌμ°λ“ λ¨λΈλ§ μ‚¬μ©ν•λ” `NoFed` λ°©μ‹κ³Ό λΉ„κµν–μµλ‹λ‹¤.
- **μ£Όμ” κ²°κ³Ό:**
  - FedHealthλ” λ¨λ“  ν…μ¤νΈ μ‚¬μ©μμ—μ„ μµκ³ μ λ¶„λ¥ μ •ν™•λ„λ¥Ό λ‹¬μ„±ν–μΌλ©°, `NoFed` λ€λΉ„ ν‰κ·  **5.3%**μ μ •ν™•λ„ ν–¥μƒμ„ λ³΄μ€μµλ‹λ‹¤.
  - κΈ°μ΅΄μ KNN, SVM, RF λ°©λ²•κ³Ό λΉ„κµν•΄μ„λ„ ν¬κ² ν–¥μƒλ μΈμ‹ κ²°κ³Όλ¥Ό λ³΄μ—¬μ£Όμ—μµλ‹λ‹¤.
  - μ „μ΄ ν•™μµμ ν™•μ¥μ„± ν‰κ°€μ—μ„λ” Fine-tuning λ° MMD(Maximum Mean Discrepancy)μ™€ κ°™μ€ λ‹¤λ¥Έ μ „μ΄ ν•™μµ λ°©λ²•μ„ ν†µν•©ν–μ„ λ•λ„ `NoFed` λ€λΉ„ 4% ν–¥μƒλ μ„±λ¥μ„ λ³΄μ—¬μ£Όλ©° FedHealthμ μ μ—°μ„±κ³Ό ν¨κ³Όλ¥Ό μ…μ¦ν–μµλ‹λ‹¤.
  - νΌλ™ ν–‰λ ¬(confusion matrix) λ¶„μ„μ„ ν†µν•΄ νΉν 'κ±·κΈ°(Walking)'μ™€ κ°™μ€ μΌλ°μ μΈ ν™λ™μ—μ„ μ¤λ¶„λ¥μ¨μ„ ν¨κ³Όμ μΌλ΅ μ¤„μ΄λ” κ²ƒμ„ ν™•μΈν–μµλ‹λ‹¤.

## π§  Insights & Discussion

- **ν”„λΌμ΄λ²„μ‹ λ³΄μ΅΄ λ° κ°μΈν™”:** FedHealthλ” μ›¨μ–΄λ¬λΈ” ν—¬μ¤μΌ€μ–΄ λ¶„μ•Όμ—μ„ λ°μ΄ν„° κ³ λ¦½ λ¬Έμ μ™€ κ°μΈν™” λ¶€μ΅± λ¬Έμ λ¥Ό λ™μ‹μ— ν•΄κ²°ν•λ” ν¨κ³Όμ μΈ μ†”λ£¨μ…μ„ μ κ³µν•©λ‹λ‹¤. λ™ν• μ•”νΈν™”λ¥Ό ν†µν•΄ μ‚¬μ©μ ν”„λΌμ΄λ²„μ‹λ¥Ό μ•μ „ν•κ² λ³΄νΈν•λ©΄μ„λ„, μ—°ν•© ν•™μµκ³Ό μ „μ΄ ν•™μµμ μ‹λ„μ§€λ¥Ό ν†µν•΄ λ†’μ€ μμΈ΅ μ •ν™•λ„μ™€ κ°μΈν™”λ μ„λΉ„μ¤λ¥Ό κ°€λ¥ν•κ² ν•©λ‹λ‹¤.
- **ν™•μ¥μ„± λ° λ²”μ©μ„±:** μ μ•λ ν”„λ μ„μ›ν¬λ” λ‹¤μ–‘ν• μ „μ΄ ν•™μµ μ•κ³ λ¦¬μ¦(Fine-tuning, MMD λ“±)μ„ ν†µν•©ν•  μ μλ” ν™•μ¥μ„±μ„ κ°€μ§€κ³  μμΌλ©°, λ”¥ λ„¤νΈμ›ν¬ μ™Έμ λ‹¤λ¥Έ λ¨Έμ‹ λ¬λ‹ λ°©λ²•(μ: κ·Έλλ””μ–ΈνΈ λ¶€μ¤ν… κ²°μ • νΈλ¦¬)μ΄λ‚ μ¦λ¶„ ν•™μµ(incremental learning)κ³Ό κ°™μ€ κΈ°μ κ³Όλ„ κ²°ν•©λ  μ μμµλ‹λ‹¤. μ΄λ” μ ν•λ μ»΄ν“¨ν… μμ›μ„ κ°€μ§„ μ›¨μ–΄λ¬λΈ” κΈ°κΈ°μ—λ„ μ μ©λ  μ μμ–΄ μ‹¤μ©μ μ…λ‹λ‹¤.
- **λ―Έλ ν—¬μ¤μΌ€μ–΄ ν‘μ¤€μΌλ΅μ μ μ¬λ ¥:** FedHealthλ” λ―Έλμ— λΈ”λ΅μ²΄μΈ κΈ°μ κ³Ό κ²°ν•©λμ–΄ μ‚¬μ©μ λ°μ΄ν„°μ λ³΄μ•μ„ λ”μ± κ°•ν™”ν•κ³ , λ¨λ“  νμ‚¬λ“¤μ΄ μ•μ „ν•κ² λ°μ΄ν„°λ¥Ό κ³µμ ν•κ³  λ¨λΈμ„ ν›λ ¨ν•  μ μλ” ν‘μ¤€ ν”λ«νΌμ΄ λ  μ μ¬λ ¥μ„ κ°€μ§‘λ‹λ‹¤.
- **λ‹¤μ–‘ν• μ• ν”λ¦¬μΌ€μ΄μ…μΌλ΅μ ν™•μ¥:** ν™λ™ μΈμ‹ μ™Έμ—λ„ λ…ΈμΈ λλ΄„, λ‚™μƒ κ°μ§€, μΈμ§€ μ§ν™ κ°μ§€ λ“± κ΄‘λ²”μ„ν• ν—¬μ¤μΌ€μ–΄ μ• ν”λ¦¬μΌ€μ΄μ…μ— μ μ©λ  μ μμΌλ©°, μ΄λ” μ—°ν•© ν•™μµμ΄ λ―Έλ μ»΄ν“¨ν… λ¨λΈμ μƒλ΅μ΄ ν¨λ¬λ‹¤μ„μ΄ λ  μ μμμ„ μ‹μ‚¬ν•©λ‹λ‹¤.

## π“ TL;DR

μ›¨μ–΄λ¬λΈ” ν—¬μ¤μΌ€μ–΄ λ¶„μ•Όμ λ°μ΄ν„° ν”„λΌμ΄λ²„μ‹ λ° κ°μΈν™” λ¶€μ΅± λ¬Έμ λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄, FedHealthλ” **μ—°ν•© ν•™μµ($$f_{S}$$)μ„ ν†µν•΄ μ—¬λ¬ μ΅°μ§μ λ°μ΄ν„°λ¥Ό ν”„λΌμ΄λ²„μ‹ μΉ¨ν•΄ μ—†μ΄ μ•μ „ν•κ² μ§‘κ³„**ν•κ³ , **μ „μ΄ ν•™μµ($$L_u$$)μ„ ν†µν•΄ κ° μ‚¬μ©μμ—κ² κ°μΈν™”λ λ¨λΈμ„ κµ¬μ¶•**ν•λ” ν”„λ μ„μ›ν¬λ¥Ό μ μ•ν•λ‹¤. μ¤λ§νΈν° ν™λ™ μΈμ‹ λ°μ΄ν„°μ…‹μ—μ„ κΈ°μ΅΄ λ°©μ‹ λ€λΉ„ **5.3% λ†’μ€ μ •ν™•λ„**λ¥Ό λ‹¬μ„±ν•μ—¬, ν”„λΌμ΄λ²„μ‹λ¥Ό λ³΄νΈν•λ©΄μ„λ„ μ •ν™•ν•κ³  κ°μΈν™”λ ν—¬μ¤μΌ€μ–΄ μ„λΉ„μ¤λ¥Ό μ κ³µν•λ” ν¨κ³Όμ μΈ μ†”λ£¨μ…μ„μ„ μ…μ¦ν–λ‹¤.
