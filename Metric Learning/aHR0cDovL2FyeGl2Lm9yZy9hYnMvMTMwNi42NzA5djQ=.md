# A Survey on Metric Learning for Feature Vectors and Structured Data

Aur ́elien Bellet, Amaury Habrard, Marc Sebban

## 🧩 Problem to Solve

기계 학습, 패턴 인식 및 데이터 마이닝 분야에서 데이터 간의 거리 또는 유사성을 측정하는 적절한 방법은 필수적입니다. 그러나 특정 문제에 대해 효과적인 메트릭(metric)을 수동으로 설계하는 것은 일반적으로 매우 어렵습니다. 이로 인해 데이터로부터 메트릭을 자동으로 학습하는 메트릭 학습(Metric Learning)이라는 연구 분야가 탄생했으며, 지난 10년간 큰 관심을 받아왔습니다.

## ✨ Key Contributions

- 메트릭 학습 문헌에 대한 체계적인 검토를 제공하며, 각 접근 방식의 장단점을 강조합니다.
- 마할라노비스 거리 메트릭 학습(Mahalanobis Distance Metric Learning)을 중점적으로 다루고, 비선형(nonlinear), 유사성(similarity), 지역(local) 메트릭 학습 등 최근 부상한 강력한 대안들을 제시합니다.
- 반지도 메트릭 학습(semi-supervised metric learning), 히스토그램 데이터용 메트릭 학습(metric learning for histogram data), 일반화 보증(generalization guarantees) 도출과 같은 최신 동향과 확장 분야를 다룹니다.
- 특히 편집 거리 학습(edit distance learning)에 초점을 맞춰 구조화된 데이터(structured data)용 메트릭 학습에 대해 다루며, 향후 메트릭 학습 분야의 남은 과제에 대한 개요를 제공합니다.
- 연구자들이 메트릭 학습 분야에서 새로운 연구를 촉진하고, 실무자들이 자신의 문제에 가장 적합한 방법을 선택하는 데 유용한 정보를 제공하는 것을 목표로 합니다.

## 📎 Related Works

- **커널 학습 (Kernel Learning):** 메트릭 학습이 매개변수적(parametric) 접근 방식(메트릭의 특정 형태의 매개변수를 학습)인 반면, 커널 학습은 일반적으로 비매개변수적(nonparametric)입니다. 암묵적으로 커널 행렬을 학습하며, 전이적 설정(transductive setting)에 제한되어 새로운 데이터에 적용하기 어렵습니다.
- **다중 커널 학습 (Multiple Kernel Learning, MKL):** 미리 정의된 기본 커널의 조합을 학습하는 매개변수적 방법입니다. 커널 학습보다 제한적이지만 효율적인 정식화가 가능하며 귀납적 설정(inductive setting)에 적용할 수 있습니다.
- **차원 축소 (Dimensionality Reduction):** 지도 차원 축소는 레이블이 지정된 데이터의 분리를 최대화하는 저차원 표현을 찾는 반면, 비지도 차원 축소(매니폴드 학습)는 데이터의 원래 속성(분산 또는 지역 거리 측정값)을 보존하는 저차원 표현을 목표로 합니다.
- **이전 메트릭 학습 설문 조사:** Yang and Jin (2006)의 초기 검토는 현재의 중요한 발전을 다루지 못해 크게 시대에 뒤떨어졌으며, Kulis (2012)의 최근 설문 조사와는 일부 중복되지만, 본 설문 조사는 더 상세하고 포괄적인 문헌 검토를 제공하며 구조화된 데이터 및 일반화 보증과 같은 Kulis의 논문에서 다루지 않은 주제에 중점을 둡니다.

## 🛠️ Methodology

본 설문조사는 메트릭 학습 알고리즘을 체계적으로 분류하고 검토하기 위해 다음과 같은 접근 방식을 따릅니다.

- **메트릭 학습의 일반적인 정식화:**
  - 대부분의 메트릭 학습 방법은 학습 예시로부터 얻은 정보(제약)를 사용하여 특정 메트릭 함수, 예를 들어 마할라노비스 거리 $d_M(x,x') = \sqrt{(x-x')^T M (x-x')}$의 매개변수 $M$을 조정하는 것을 목표로 합니다. 여기서 $M$은 대칭 양의 반정부호(Positive Semi-Definite, PSD) $d \times d$ 실수 행렬입니다.
  - 주로 다음과 같은 쌍 또는 삼중항 기반 제약(pair or triplet-based constraints)을 사용합니다:
    - **Must-link / Cannot-link 제약 ($S, D$):** $x_i$와 $x_j$가 유사해야 하는 쌍($S$) 또는 유사하지 않아야 하는 쌍($D$).
    - **상대적 제약 ($R$):** $x_i$가 $x_k$보다 $x_j$에 더 유사해야 한다는 삼중항 제약.
  - 이러한 과정은 일반적으로 다음과 같은 최적화 문제로 정식화됩니다:
    $$\min_{M} \ell(M,S,D,R) + \lambda R(M)$$
    여기서 $\ell(M,S,D,R)$은 훈련 제약 위반에 대한 손실 함수, $R(M)$은 학습된 메트릭의 매개변수 $M$에 대한 정규화(regularizer), $\lambda \ge 0$는 정규화 매개변수입니다.
- **메트릭 학습 알고리즘의 주요 특성 기반 분류:**
  본 설문조사는 알고리즘을 다음과 같은 다섯 가지 핵심 특성을 기준으로 분류하여 각 방법의 고유한 속성과 적합성을 평가합니다.
  - **학습 패러다임:** 완전 지도(Fully supervised), 약한 지도(Weakly supervised), 준지도(Semi-supervised).
  - **메트릭 형태:** 선형(Linear), 비선형(Nonlinear), 지역(Local).
  - **확장성 (Scalability):** 훈련 예시 수 $n$ 및 데이터 차원 $d$에 대한 확장성.
  - **해의 최적성 (Optimality of the Solution):** 전역 최적(Global optimum) 또는 지역 최적(Local optimum) 달성 여부.
  - **차원 축소 (Dimensionality Reduction):** 학습된 메트릭이 저차원 투영 공간을 유도하는지 여부.
- **문헌 검토 구조:**
  이러한 분류 기준에 따라, 본 설문조사는 다음을 포함하여 광범위한 메트릭 학습 접근 방식을 체계적으로 검토합니다.
  - 지도 마할라노비스 거리 학습 (초기 접근 방식, k-최근접 이웃 기반, 정보 이론적 접근, 온라인 학습, 다중 작업 학습 등)
  - 선형 유사성 학습
  - 비선형 메트릭 학습 (커널화 및 직접 비선형 메트릭 학습)
  - 지역 메트릭 학습
  - 히스토그램 데이터용 메트릭 학습
  - 일반화 보증에 대한 이론적 프레임워크
  - 준지도 메트릭 학습 (표준 준지도 설정 및 도메인 적응)
  - 구조화된 데이터용 메트릭 학습 (문자열, 트리, 그래프 편집 거리 학습)

## 📊 Results

- **수치 데이터(Feature Vectors)용 메트릭 학습:** 지난 10년간 큰 발전을 이루어 현재는 높은 성숙도에 도달했습니다. 온라인 학습(online learning)이나 확률적 최적화(stochastic optimization)를 통해 대규모 데이터셋($n$)에 대한 확장성 문제가 상당 부분 해결되었으며, 비선형(nonlinear) 또는 지역(local) 메트릭 학습 방법을 통해 복잡한 작업을 처리할 수 있습니다. 랭킹(ranking), 다중 작업 학습(multi-task learning), 도메인 적응(domain adaptation)과 같은 어려운 설정에서도 효과적인 방법론이 개발되었습니다. 또한, 학습된 메트릭의 일반화 성능에 대한 이론적 이해를 위한 연구도 활발하게 진행되고 있습니다.
- **구조화된 데이터(Structured Data)용 메트릭 학습:** 수치 데이터용 메트릭 학습에 비해 발전이 더디며, 여전히 초기 단계에 머물러 있습니다. 대부분의 접근 방식은 EM(Expectation-Maximization)과 유사한 반복 알고리즘에 기반하고 있어, 대규모 데이터셋이나 큰 인스턴스 크기(예: 긴 문자열, 복잡한 트리/그래프)에는 적용하기 어렵고, 지역 최적 문제(local optima)로 인해 분석이 어렵습니다. 그러나 Bellet et al. (2011)의 GESL과 같은 최근 연구는 수치 데이터용 성공적인 정식화에서 영감을 받아 메트릭을 단순화하는 방식으로 확장성(scalability)과 유연성(flexibility) 측면에서 큰 이점을 가져올 수 있음을 보여주며 이 연구 분야의 유망한 방향을 제시합니다.

## 🧠 Insights & Discussion

- **$n$과 $d$ 모두에 대한 확장성:** 훈련 예시 수 $n$과 데이터 차원 $d$ 모두에 대해 높은 확장성을 달성하는 것은 여전히 중요한 과제로 남아 있습니다. 대부분의 방법은 $O(d^2)$개의 매개변수를 학습하므로, 수천 개의 특징을 포함하는 실제 응용 분야에서는 차원 축소(dimensionality reduction)를 미리 적용하지 않으면 비실용적입니다. 저차원 행렬 매니폴드(low-rank matrices) 최적화 또는 간단한 분류기 조합을 기반으로 하는 접근 방식이 향후 연구에서 좋은 잠재력을 가집니다.
- **더 깊은 이론적 이해:** 학습된 메트릭의 일관성(consistency)과 특정 알고리즘(예: k-NN 분류, 클러스터링, 정보 검색)에서의 성능 간의 연관성에 대한 일반화 보증은 여전히 중요한 미해결 문제입니다. 현재까지는 선형 분류에 대한 결과만 알려져 있습니다.
- **비지도 메트릭 학습 (Unsupervised Metric Learning):** 순수한 비지도 방식으로 메트릭을 학습하는 방법에 대한 더 많은 연구가 필요합니다. 노이즈에 강하거나 특정 변환에 불변하는 메트릭 학습과 같은 새로운 기준이 탐색되어야 합니다.
- **구조 활용 (Leveraging the Structure):** 히스토그램 데이터용 메트릭 학습 사례처럼 데이터의 구조적 특성을 메트릭 학습 과정에 통합하는 것은 성능을 크게 향상시킬 수 있습니다. 소셜 네트워크와 같이 점점 더 구조화되는 데이터가 많아짐에 따라, 이러한 구조를 활용하여 메트릭 선택에 편향(bias)을 주는 연구가 더욱 중요해질 것입니다.
- **변화하는 데이터에 대한 메트릭 적응:** 데이터의 변화에 강건한 방법 개발이 중요합니다. 잡음이 있는 데이터, 전이 학습(transfer learning), 도메인 적응(domain adaptation)을 위한 메트릭 학습에 대한 연구가 있었지만, 개념 표류(concept drift)가 발생하여 학습자가 메트릭을 감지하고 적응시켜야 하는 평생 학습(lifelong learning) 응용 분야에는 아직 충분하지 않습니다.
- **더 풍부한 메트릭 학습:** 유사성 개념이 다중 모드(multimodal), 즉 여러 가지 방식으로 유사할 수 있고 유사성의 정도가 다양할 수 있다는 사실을 기존 알고리즘은 무시하는 경향이 있습니다. 이러한 유사성의 미묘한 차이를 모델링하고, 왜 사물이 유사한지 해석하는 능력을 학습된 메트릭에 부여한다면, 우리의 유사성 개념에 더 가까워질 것입니다.

## 📌 TL;DR

본 설문조사는 기계 학습의 핵심 과제인 데이터로부터 효과적인 거리 및 유사성 메트릭을 자동으로 학습하는 메트릭 학습(Metric Learning) 분야를 포괄적으로 검토합니다. 마할라노비스 거리 학습을 포함한 선형, 비선형, 지역 메트릭 학습 방법은 물론, 준지도 학습, 히스토그램 데이터, 구조화된 데이터(편집 거리 학습)를 위한 최신 동향과 각 접근 방식의 장단점을 체계적으로 분석합니다. 수치 데이터용 메트릭 학습은 상당한 발전을 이루어 성숙 단계에 도달했지만, 구조화된 데이터용 메트릭 학습은 여전히 확장성과 이론적 한계를 안고 있음을 강조합니다. 마지막으로, $n$ 및 $d$ 모두에 대한 확장성, 일반화 보증에 대한 깊이 있는 이론적 이해, 비지도 학습, 데이터 구조의 효과적인 활용, 변화하는 데이터에 대한 메트릭 적응, 그리고 다중 모드 유사성을 포착하는 더 풍부하고 해석 가능한 메트릭 학습을 미래 연구의 주요 과제로 제시합니다.
