# A Comparison of Deep Learning Architectures for Spacecraft Anomaly Detection

Daniel Lakey, Tim Schlippe

## 🧩 Problem to Solve

우주선 운영은 신뢰성과 안전성이 매우 중요하며, 임무 실패를 방지하기 위해 이상 징후를 조기에 감지하고 완화하는 것이 필수적입니다. 우주선 시스템이 점점 더 복잡해지고 원격 측정 데이터의 양이 방대해짐에 따라, 기존의 수동 방식이나 단순한 '제한 초과' 기술로는 이상 징후를 식별하기 어려워지고 있습니다. 이 연구는 다양한 딥러닝 아키텍처가 우주선 원격 측정 데이터에서 이상 징후를 얼마나 효과적으로 감지할 수 있는지 비교하여, 가장 최적의 효율적인 접근 방식을 찾고자 합니다.

## ✨ Key Contributions

- **종합적인 딥러닝 모델 비교:** CNN, RNN, LSTM, Transformer 기반 아키텍처 및 하이브리드 모델 등 다양한 딥러닝 모델들을 우주선 이상 감지에 적용하여 포괄적인 성능 비교를 수행했습니다. 특히, 기존에 우주선 이상 감지에 적용되지 않았던 모델들도 포함하여 탐색의 새로운 길을 열었습니다.
- **새로운 데이터 클러스터링 방법론 제안:** 원격 측정 데이터셋의 통계적 특성(평균, 표준 편차, 왜도, 첨도)을 기반으로 데이터를 5가지 유형(Binary, Flat, Oscillating, Spiky, Complex)으로 분류하는 비지도 학습 클러스터링 메커니즘을 혁신적으로 도입했습니다. 이를 통해 데이터 유형에 대한 더 미묘한 이해를 가능하게 합니다.
- **클러스터별 모델 성능 분석:** 식별된 각 데이터 클러스터 유형에 따라 딥러닝 모델들의 비교 성능에 대한 통찰력을 제공하여, 특정 원격 측정 데이터 유형에 가장 적합한 모델을 선택하는 데 도움이 되는 지침을 제시했습니다.
- **앙상블 접근 방식의 우월성 입증:** 최적화되지 않은 개별 모델을 사용했음에도 불구하고, 클러스터별로 가장 성능이 좋은 모델을 조합하는 앙상블 접근 방식이 기존의 베이스라인 연구(83.6%)보다 우수한 평균 84.7%의 F1 anomaly 점수를 달성했습니다.

## 📎 Related Works

- **이상 감지 접근 방식:** NASA [4], ESA [3], CNES [5] 등 여러 기관에서 위성 원격 측정 데이터 이상 감지를 위한 다양한 고급 알고리즘과 전략을 제안했습니다.
- **딥러닝 트렌드:** 우주선 원격 측정 데이터에 내재된 복잡한 다변량 시계열 데이터를 처리하는 능력 때문에 통계적 방법보다 딥러닝 접근 방식이 선호되는 추세입니다 [6].
- **시계열 예측 기반 이상 감지:** 일반적인 접근 방식은 딥러닝 모델을 사용하여 시계열 데이터에 대한 회귀 기반 예측을 수행하고, 예측과 실제 값 간의 재구성 오류가 임계값을 초과할 때 이상 징후를 식별하는 것입니다 [15].
- **Telemanom [4]:** 비지도 비모수적 이상 임계값 설정 접근 방식을 제안하며, 이상에 해당하는 오류 값을 동적으로 학습합니다. LSTM 기반 모델이며 이 연구의 주요 비교 베이스라인으로 사용됩니다.
- **다양한 딥러닝 아키텍처:**
  - **mWDN (Multilevel Wavelet Decomposition Network) [19]:** 웨이블릿 변환과 딥러닝 모델을 결합하여 시계열 데이터를 분석합니다. 우주선 원격 측정 이상 감지에는 이전에 적용되지 않았습니다.
  - **MLP (Multi-Layer Perceptron) / gMLP [22]:** Transformer 모델에 필적하는 성능을 목표로 하는 단순한 아키텍처입니다. 우주선 이상 감지에도 사용되었습니다 [25].
  - **Transformer / TST (TimeSeriesTransformer) [30]:** 자체 주의(self-attention) 메커니즘을 사용하여 시퀀스 내의 지역적 및 전역적 관계를 학습합니다. 시계열 분석 및 이상 감지에 활발히 연구되고 있습니다 [27, 28, 29, 31].
  - **CNN (Convolutional Neural Network) [32]:** 시계열 데이터의 공간적 및 시간적 특징을 학습하여 이상 패턴을 식별하는 데 사용됩니다 [33, 34, 35]. ResNet [36, 37], FCN [37], XceptionTime [38], InceptionTime [39] 등의 변형이 있습니다.
  - **RNN (Recurrent Neural Network):** 순차 데이터 처리에 특화되어 시퀀스 내의 시간적 특징을 모델링합니다.
    - **LSTM (Long Short-Term Memory) [40]:** RNN의 한 변형으로, 장기적인 의존성을 학습하며 기본 연구의 베이스라인 모델에 사용되었습니다.
    - **GRU (Gated Recurrent Units) [41]:** LSTM과 유사하지만 구조가 더 단순하며 계산 요구 사항이 적습니다 [42].
  - **하이브리드 모델 [44, 18]:** 여러 딥러닝 아키텍처의 장점을 활용합니다. LSTM/Transformer 모델이 인기가 많으며 [45, 46], 이 연구에서는 TransformerLSTM [47, 48] 및 LSTMAttention [30, 26, 48], LSTM_FCN [48]을 포함했습니다. 우주선 이상 감지에 대한 하이브리드 딥러닝 모델 사용 사례는 이전에 알려진 바가 없습니다.
- **데이터셋:** 연구는 SMAP/MSL 데이터셋 [4]을 사용하며, 이는 NASA의 SMAP 및 MSL "Curiosity" 임무에서 수집된 82개 원격 측정 채널로 구성된 공개 데이터셋입니다.

## 🛠️ Methodology

1. **프레임워크:** Telemanom [4] 이상 감지 프레임워크를 기반으로 실험을 수행했습니다.
2. **모델 교체:** Telemanom의 기본 LSTM 모델을 `tsai` 라이브러리 [48]에서 제공하는 13가지 최신 딥러닝 아키텍처 (CNN, RNN, LSTM, Transformer, MLP, mWDN, Hybrid)로 교체하여 순수한 아키텍처 성능 차이를 비교했습니다.
3. **이상 감지 알고리즘:** Telemanom의 동적 임계값 설정 및 이상 감지 알고리즘은 그대로 유지하고, 시계열 예측 모델만 변경하여 아키텍처의 영향을 고립시켰습니다.
4. **훈련 설정:**
   - 각 원격 측정 채널당 하나의 모델을 훈련했습니다 (총 82개 채널 $\times$ 13개 아키텍처 = 1,066개 모델).
   - 훈련에는 "fit one cycle" [53] 기법을 사용했습니다.
   - 하이퍼파라미터는 `tsai` 및 `fastai` 라이브러리의 기본값을 주로 사용했으며, RNN 기반 모델의 깊이만 Telemanom의 기본 LSTM과 동일하게 맞췄습니다. 대규모 모델 수로 인해 하이퍼파라미터 튜닝은 수행하지 않았습니다.
   - 학습률 감소를 위해 `fastai`의 `ReduceLROnPlateau` 콜백을 적용했습니다.
   - 실험 환경은 8코어 CPU와 16GB RAM을 갖춘 가상 머신에서 수행되었으며, GPU 가속은 사용되지 않았습니다.
5. **데이터:** NASA SMAP 및 MSL 임무에서 수집된 82개 원격 측정 채널로 구성된 SMAP/MSL 데이터셋 [4]을 사용했습니다. 데이터는 훈련 및 테스트 세트로 미리 분할되어 있었으며, 테스트 세트에는 레이블링된 이상 징후가 포함되어 있었습니다.
6. **데이터 클러스터링:**
   - 원격 측정 채널의 특성과 모델 성능 간의 관계를 분석하기 위해 비지도 클러스터링 접근 방식을 도입했습니다.
   - 각 채널의 목표 파라미터에 대해 평균, 표준 편차, 왜도, 첨도와 같은 중심 모멘트 통계값을 계산하여 4차원 벡터로 표현했습니다. 결측값(NaN)은 0으로 처리했습니다.
   - 이 벡터들에 K-Means 클러스터링 [58]을 적용했으며, "엘보우 메서드" [59]를 사용하여 최적의 클러스터 수를 5개로 결정했습니다.
   - 클러스터는 "Binary" (43개 채널), "Flat" (21개 채널), "Oscillating" (11개 채널), "Spiky" (2개 채널), "Complex" (2개 채널)의 5가지 데이터 유형으로 분류되었습니다.
7. **평가 지표:**
   - "F1 anomaly" (올바르게 감지된 이상 징후 수에 대한 F1 점수) 및 "F1 time point" (이상 징후 내에서 올바르게 레이블링된 시점에 대한 F1 점수)를 사용했습니다.
   - 정확도와 계산 효율성을 종합적으로 고려하는 "F1 per second" (F1/s) 지표를 도입하여 모델의 효율성을 평가했습니다.

## 📊 Results

- **전반적인 모델 성능:**
  - CNN 기반의 `XceptionTimePlus`가 가장 우수한 F1 anomaly 점수(69.9%)를 기록했습니다. 이는 베이스라인인 Telemanom의 튜닝된 결과(83.6%)보다는 낮지만, 하이퍼파라미터 최적화 없이 아키텍처 자체의 성능을 비교하기 위한 의도적인 선택이었습니다.
  - CNN 기반의 `FCNPlus`는 가장 낮은 성능(63.2%)을 보여, CNN 모델이 일반적으로 항상 우수하다고는 할 수 없음을 시사했습니다.
  - 하이브리드 `TransformerLSTMPlus`(69.6%)와 RNN 기반 `GRUPlus`(69.1%)는 유사한 성능을 보였습니다.
- **훈련 효율성 (F1/s):**
  - CNN 기반 `ResNetPlus`와 `XceptionTimePlus`가 가장 효율적이었으며, 훈련 시간이 짧고 성능이 좋았습니다.
  - 매우 큰 모델인 `InceptionTimeXLPlus`(CNN 기반)와 RNN/Transformer 하이브리드인 `LSTMAttentionPlus`는 성능 대비 훈련 시간이 가장 길어 효율성이 낮았습니다.
  - 일반적으로 Transformer 기반 아키텍처는 성능은 높지만 훈련 시간이 오래 걸리는 경향이 있었습니다.
- **클러스터별 최적 아키텍처:**
  - 클러스터별로 최적의 아키텍처를 선택하는 앙상블 접근 방식은 평균 84.7%의 F1 anomaly 점수를 달성하여 베이스라인 Telemanom(83.6%)을 능가했습니다.
  - **"Binary", "Flat", "Oscillating" 클러스터:** `MultiInceptionTimePlus` 및 `XceptionTimePlus`와 같은 CNN 기반 모델이 가장 좋은 성능을 보였습니다 (각각 65.2%, 86.3%, 72.0%). 이는 CNN의 공간 인식 능력이 이러한 데이터 유형의 이상 징후 식별에 유용함을 시사합니다.
  - **"Spiky" 및 "Complex" 클러스터:** MLP 기반의 `gMLP`가 놀랍게도 100%의 F1 anomaly 점수로 가장 우수한 성능을 보였습니다. 다만, 이 두 클러스터에는 데이터 채널 수가 각각 2개로 매우 적었기 때문에 일반화된 결론을 내리기 위해서는 더 많은 예시가 필요합니다.

## 🧠 Insights & Discussion

- **데이터 종속적인 모델 선택:** 우주선 이상 감지를 위한 딥러닝 아키텍처 선택은 데이터의 특성, 이상 징후의 유형, 운영 제약 조건에 크게 좌우됩니다.
- **CNN의 패턴 인식 강점:** CNN은 특정 유형의 우주선 데이터(예: "Binary", "Flat", "Oscillating")에서 공간 패턴을 식별하는 데 탁월하며, 효율적인 범용 이상 감지기로 추천될 수 있습니다.
- **시계열 이상에 강한 RNN/LSTM:** RNN 및 LSTM 모델은 시계열 데이터에서 나타나는 시간적 이상 징후를 포착하는 데 능숙함을 보여주었습니다.
- **Transformer의 미묘한 이상 감지 능력:** Transformer 기반 아키텍처는 미묘하고 장기간에 걸쳐 나타나는 이상 징후를 감지하는 데 유망하지만, 상당한 계산 자원이 필요합니다.
- **클러스터링의 중요성:** 이 연구에서 제시된 새로운 데이터 클러스터링 방법론은 원격 측정 데이터에 대한 미묘한 이해를 제공하며, 이를 통해 특정 데이터 유형에 최적화된 전문 모델을 선택하는 앙상블 접근 방식이 가능하게 합니다.
- **앙상블 모델의 잠재력:** 데이터 유형별로 최적의 모델을 선택하는 앙상블 접근 방식이 단일 모델보다, 심지어 베이스라인보다도 우수한 성능을 보여주어, 모델을 데이터 특성에 맞춰 조정하는 것의 중요성을 강조합니다.
- **한계 및 향후 연구:** 본 연구는 하이퍼파라미터 최적화를 의도적으로 배제하여 아키텍처 자체의 비교에 집중했습니다. 향후 연구에서는 클러스터링 방법론을 활용하여 각 데이터 유형에 대한 하이퍼파라미터 최적화된 앙상블 모델을 탐색하고, 임계값에 의존하지 않는 딥러닝 분류 기술의 적용 가능성도 모색할 수 있습니다.

## 📌 TL;DR

우주선 이상 감지에서 딥러닝 아키텍처의 효능을 비교한 연구입니다. CNN, RNN, LSTM, Transformer 등 13가지 아키텍처를 SMAP/MSL 데이터셋에 적용하고, 원격 측정 데이터의 통계적 특성을 기반으로 5가지 유형으로 클러스터링하는 새로운 방법을 제안했습니다. `XceptionTimePlus`(CNN 기반)가 전반적으로 우수한 성능을 보였고 효율성도 높았습니다. 하지만, 데이터 유형별로 최적의 아키텍처가 달랐으며, 각 클러스터에 가장 적합한 모델을 조합하는 앙상블 접근 방식이 베이스라인(83.6%)을 능가하는 평균 84.7%의 F1 anomaly 점수를 달성했습니다. 결론적으로, 우주선 이상 감지에는 데이터 특성을 고려하여 모델을 선택하고, 이를 위한 데이터 클러스터링이 핵심적인 역할을 한다는 점을 시사합니다.
