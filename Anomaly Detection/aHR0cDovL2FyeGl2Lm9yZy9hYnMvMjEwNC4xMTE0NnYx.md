# AN EFFICIENT ONE-CLASS SVM FOR ANOMALY DETECTION IN THE INTERNET OF THINGS

Kun Yang, Samory Kpotufe, Nick Feamster

## 🧩 Problem to Solve

점점 더 많은 IoT 장치들이 인터넷에 연결되면서, 이러한 장치들에서 발생하는 이상 행동을 빠르고 효율적이며 정확하게 탐지하는 것이 중요해지고 있습니다. One-Class Support Vector Machine (OCSVM)은 복잡한 비선형 결정 경계를 학습하는 능력 덕분에 이상 탐지(novelty detection) 분야의 최첨단 기술 중 하나로 꼽힙니다. 하지만 기존 OCSVM은 학습 데이터셋의 크기 $n$이 커질수록 예측 시 $\Omega(n)$에 비례하는 상당한 메모리 요구 사항과 계산 비용이 발생합니다. 이러한 메모리 및 계산 제약은 대규모 학습 데이터가 필요한 실제 IoT 배포 환경에서는 심각한 장애물이 됩니다. 특히 리소스가 제한된 IoT 장치(예: 홈 라우터 또는 임베디드 센서)에서는 이러한 문제가 더욱 두드러집니다.

## ✨ Key Contributions

이 연구는 OCSVM의 이러한 한계를 극복하기 위해 Nyström 및 (Gaussian) Sketching 접근 방식을 OCSVM에 확장하고, 이를 클러스터링 및 가우시안 혼합 모델(GMM)과 결합하여 IoT 환경에서 탐지 정확도를 희생하지 않으면서 예측 시간과 공간을 크게 개선하는 효율적인 방법론을 제안합니다.

핵심 기여는 다음과 같습니다:

- **효율적인 임베딩 기법 도입**: Nyström 및 Kernel Johnson-Lindenstrauss (KJL) Sketching을 사용하여 OCSVM의 데이터를 저차원 공간 $\phi'(x) \in \mathbb{R}^d$으로 임베딩하는 새로운 접근 방식을 개발했습니다. 이는 기존 OCSVM의 무한 차원 매핑을 효율적인 유한 차원 표현으로 변환합니다.
- **GMM 기반 클러스터 모델링**: 임베딩된 데이터 $\left\{\phi'(X_i)\right\}_{i=1}^{n}$가 원본 커널 매핑 $\phi$에서 발견된 클러스터 구조를 보존한다는 통찰을 바탕으로, 정상 데이터를 모델링하기 위해 가우시안 혼합 모델(GMM)을 활용합니다.
- **자동 GMM 구성 요소 개수 선택**: GMM의 구성 요소 개수 $k$를 QuickShift++와 같은 밀도 모드 추정기를 통해 자동으로 식별하여, 수동 하이퍼파라미터 튜닝의 필요성을 줄였습니다.
- **성능 향상 입증**: 실제 IoT 데이터셋 및 공용 네트워크 데이터셋에 대한 광범위한 평가를 통해, 제안된 OC-Nyström 및 OC-KJL 방법이 기존 OCSVM 대비 탐지 시간은 14~20배(일부 데이터셋에서는 40배 이상) 단축하고, 공간 복잡도는 20배 이상 감소시키면서, 동등하거나 일부 경우 개선된 탐지 정확도(AUC)를 달성함을 입증했습니다.

## 📎 Related Works

- **네트워크 이상 탐지**: 수십 년간 활발히 연구된 분야로, 지도 학습(SVM, Bayesian networks, Neural networks) 및 비지도 학습(PCA, Generalized likelihood ratio) 기법이 적용되었습니다. 지도 학습은 특정 공격 유형에 효과적이지만, 다양한 이상 징후를 모두 레이블링하기 어려운 IoT 환경에서는 비실용적입니다. 비지도 학습은 광범위한 이상 징후를 탐지하지만, PCA와 같은 방법은 트래픽 데이터 변환 시 취약점이 있을 수 있습니다.
- **IoT 환경에서의 OCSVM 기반 이상 탐지**: OCSVM은 복잡하고 이질적인 IoT 환경에서 복잡한 비선형 결정 경계를 학습하는 능력 때문에 이상 탐지에 특히 효과적인 것으로 입증되었습니다. 하지만 기존 연구에서는 OCSVM의 높은 시간 및 메모리 요구 사항으로 인해 리소스가 제한된 IoT 장치에 실용적으로 배포하기 어렵다는 문제가 있었습니다.

## 🛠️ Methodology

본 연구에서 제안하는 효율적인 OCSVM 기반 이상 탐지 방법론은 다음과 같은 단계로 구성됩니다:

1. **초기 OCSVM 개념**:

   - OCSVM은 입력 데이터 $x \in \mathbb{R}^D$를 무한 차원 공간 $H$($\phi(x)$)으로 매핑하여 데이터를 선형적으로 분리 가능하게 만듭니다. Gaussian 커널 $K(x, x') = C \cdot \exp\left(-\|x - x'\|^2 / 2h^2\right)$을 주로 사용하며, 이 경우 모든 데이터 포인트는 반지름 $\sqrt{C}$의 구 표면에 매핑됩니다.
   - 훈련 시에는 정상 데이터 $\left\{X_i\right\}_{i=1}^{n}$만 사용하여 구의 중심으로부터 정상 데이터를 최대한 분리하는 초평면을 찾습니다.
   - 탐지 시, 새로운 데이터 $x$에 대해 스코어링 함수 $f(x) = \sum_{i=1}^{n} \alpha_i K(X_i, x)$를 평가하여 임계값 $\alpha_0$보다 작으면 이상으로 분류합니다. 이때 $n$개의 서포트 벡터 $X_i$와 계수 $\alpha_i$를 메모리에 유지해야 하므로, $\Omega(n)$의 시간 및 공간 복잡도가 발생합니다.

2. **데이터 임베딩 (Nyström 및 KJL Sketching)**:

   - OCSVM의 높은 계산 비용을 줄이기 위해, Gram 행렬 $K \in \mathbb{R}^{n \times n}$을 저차원 행렬 $K'$로 근사하는 Nyström 및 KJL (Kernel Johnson-Lindenstrauss) Sketching 기법을 활용하여 새로운 저차원 매핑 $\phi'(x) \in \mathbb{R}^d$ ($d \ll n$)을 생성합니다.
   - **Nyström 방식**: 학습 데이터의 무작위 서브샘플 $S_m$ ($m \ll n$)을 기반으로 Gram 행렬 $K_{I,I}$의 상위 $d$개 고유값 $\Lambda$와 고유 벡터 $V$를 사용하여 투영 행렬 $P = \Lambda^{-1/2} \cdot V^T$를 구성합니다. 이후 새로운 데이터 $x$를 $\phi'(x) = P \cdot K(x)$로 임베딩합니다.
   - **KJL Sketching 방식**: 무작위 Gaussian 엔트리를 가진 행렬 $Z \in \mathbb{R}^{d \times m}$과 $S_m$에 대한 Gram 행렬 $K_{I,I}$를 사용하여 투영 행렬 $P = Z \cdot K_{I,I}$를 구성합니다. 마찬가지로 $x$를 $\phi'(x) = P \cdot K(x)$로 임베딩합니다.
   - 이러한 $\phi'(x)$는 원본 $\phi(x)$의 선형 분리성은 잃을 수 있지만, 데이터의 클러스터 구조는 보존합니다. 또한, 학습 시 투영 행렬 $P$와 $S_m$의 데이터 포인트만 저장하면 되므로, 공간 복잡도가 $m \cdot (d+D)$로 크게 줄어들며, 탐지 시간은 $n$에 독립적으로 $m, d, D$에만 의존합니다.

3. **정상 데이터 클러스터링 및 밀도 추정 (GMM)**:

   - 저차원 임베딩된 정상 데이터 $\left\{\phi'(X_i)\right\}_{i=1}^{n}$에 대해 클러스터 구조가 보존되므로, 이 클러스터들을 모델링하기 위해 가우시안 혼합 모델(GMM)을 사용합니다. GMM은 정상 데이터의 확률 밀도 $f(z) = \sum_{l=1}^{k} \pi_l \cdot N(z; \mu_l, \Sigma_l)$를 추정합니다.
   - **구성 요소 개수 $k$ 선택**: GMM의 구성 요소 개수 $k$는 데이터의 고밀도 영역(클러스터) 수를 자동으로 식별하는 QuickShift++ [13]와 같은 밀도 모드 추정기를 통해 결정하거나, 유효성 검사 데이터가 있는 경우 이를 통해 튜닝합니다.

4. **탐지 절차 요약 (OC-Nyström 및 OC-KJL)**:
   - **훈련 단계**:
     - 정상 데이터 $\left\{X_i\right\}_{i=1}^{n} \in \mathbb{R}^D$를 Nyström 또는 KJL을 통해 $\left\{\phi'(X_i)\right\}_{i=1}^{n} \in \mathbb{R}^d$로 임베딩합니다.
     - $k$는 QuickShift++를 통해 자동으로 선택하거나, 하이퍼파라미터로 제공됩니다.
     - 임베딩된 데이터에 대해 $k$개의 구성 요소를 가진 GMM 밀도 $f$를 추정합니다.
     - 학습된 GMM $f$와 투영 매개변수 $\phi'$ (행렬 $P$ 및 서브샘플 $S_m$)를 저장합니다.
   - **탐지 단계**:
     - 새로운 입력 데이터 $x \in \mathbb{R}^D$를 학습된 $\phi'$를 사용하여 $\mathbb{R}^d$ 공간으로 임베딩합니다.
     - 임베딩된 $\phi'(x)$에 대해 GMM $f$의 밀도값 $f(\phi'(x))$를 계산합니다.
     - $f(\phi'(x))$가 미리 설정된 임계값 $t$보다 작거나 같으면 $x$를 이상(novelty)으로 플래그합니다.
   - **효율성**: $\phi'$ 저장에는 $m \cdot (d+D)$ 공간이, GMM 매개변수 저장에는 $k \cdot (d+d^2)$ 공간이 필요합니다. IoT 장치의 운영 모드는 일반적으로 적으므로 $k$를 작게 유지할 수 있어 메모리 사용량이 최소화됩니다.

## 📊 Results

- **탐지 시간 및 공간 절감**: 제안된 방법(OC-Nyström 및 OC-KJL)은 OCSVM 대비 14~20배(일부 데이터셋에서는 40배 이상) 빠른 탐지 시간을 달성했습니다. 공간 복잡도는 20배 이상 감소했습니다. 이는 라즈베리 파이나 엔비디아 나노와 같은 리소스 제약 장치에서도 실제 배포를 가능하게 합니다.
- **탐지 성능 (AUC)**:
  - **최소 튜닝 시**: OC-Nyström 및 OC-KJL (QuickShift++ 사용 여부와 무관)은 OCSVM과 동등한 AUC를 달성했으며, UNB, CTU와 같은 일부 데이터셋에서는 더 높은 AUC를 보였습니다. 이는 차원 축소에 따른 정규화 효과 덕분으로 추정됩니다.
  - **튜닝 없음 시**: OCSVM의 기본 설정과 동일한 룰 오브 썸(rule-of-thumb) 밴드위스 $h$를 사용하고 QuickShift++로 $k$를 자동 선택했을 때, 대부분의 데이터셋에서 OCSVM의 AUC를 유지하거나 개선했습니다. 다만, MAWI와 같은 일부 데이터셋에서는 성능 저하가 관찰되기도 했습니다.
- **훈련 시간**: 추가적인 임베딩 및 GMM 학습 단계에도 불구하고, 제안된 방법들은 OCSVM의 훈련 시간과 경쟁력을 유지했으며, QuickShift++를 사용하지 않는 버전은 OCSVM보다 2~3배 빠른 훈련 시간을 보이기도 했습니다.

## 🧠 Insights & Discussion

- **IoT 장치 특성 활용**: IoT 장치가 소수의 운영 모드를 가진다는 본질적인 특성을 활용하여, 정상 동작을 소수의 클러스터로 간결하게 모델링할 수 있음을 보여주었습니다. 이는 제안된 방법론의 핵심 효율성 동인입니다.
- **실용적 배포 가능성**: OCSVM의 고질적인 문제인 높은 계산 및 메모리 요구 사항을 해결함으로써, 라즈베리 파이 또는 엔비디아 나노와 같은 저사양 임베디드 장치에서도 OCSVM 기반의 정교한 이상 탐지 알고리즘을 실질적으로 배포할 수 있는 길을 열었습니다.
- **모델 드리프트 문제**: 이 연구는 모델 드리프트(device's normal behavior changing over time due to various factors like software upgrades or usage patterns)에 대한 한계를 언급하며, 기존 모델을 효율적으로 업데이트하는 증분 학습(incremental updates)의 필요성을 향후 연구 과제로 제시합니다.
- **데이터 표현의 영향**: 패킷 추적에서 파생된 간단한 특징 집합을 사용했지만, 더 단순하거나 다른 패킷 기반 표현 방식이 모델 효율성에 미치는 영향을 탐구하는 것도 향후 연구 방향으로 논의됩니다.

## 📌 TL;DR

**문제**: IoT 이상 탐지에서 강력한 OCSVM은 높은 계산 및 메모리 비용으로 인해 리소스가 제한된 장치에 배포하기 어렵습니다.
**방법**: 이 연구는 Nyström 및 KJL Sketching을 통해 OCSVM 데이터를 저차원 공간으로 효율적으로 임베딩하고, 이 임베딩된 데이터의 클러스터 구조를 가우시안 혼합 모델(GMM)로 모델링합니다. GMM 구성 요소 수는 QuickShift++로 자동 결정됩니다.
**결과**: 제안된 방법(OC-Nyström 및 OC-KJL)은 OCSVM 대비 탐지 시간은 최대 40배 이상, 공간은 20배 이상 절감하면서도, 이상 탐지 정확도(AUC)는 동등하거나 더 높게 유지합니다. 이는 IoT 장치와 같은 제한된 환경에서도 OCSVM 기반 이상 탐지를 실제 배포할 수 있음을 보여줍니다.
