# Adversarially Robust One-class Novelty Detection

Shao-Yuan Lo,Poojan Oza, and Vishal M. Patel

## 🧩 Problem to Solve

본 논문은 단일 클래스(one-class) 신기 객체 탐지(Novelty Detection) 모델의 **적대적 강건성(adversarial robustness) 부족** 문제를 다룹니다. 대부분의 최신 딥 신경망 기반 신기 객체 탐지기는 적대적 공격(adversarial attacks)에 취약하며, 분류(classification) 작업에 사용되는 기존 방어(defense) 기법들은 신기 객체 탐지에는 효과가 제한적임을 보여줍니다. 따라서 신기 객체 탐지에 특화된 효과적인 방어 전략의 필요성을 강조합니다.

## ✨ Key Contributions

- 신기 객체 탐지기를 보호하기 위한 작업별 지식(task-specific knowledge) 기반의 새로운 적대적 방어 방법인 **PrincipaLS(Principal Latent Space)**를 제안합니다. 이는 적대적으로 강건한 신기 객체 탐지 방법 중 최초의 시도 중 하나입니다.
- 적대적으로 강건한 신기 객체 탐지 문제에 대한 **탄탄한 평가 벤치마크**를 구축합니다.
- 제안된 PrincipaLS는 다양한 공격, 데이터셋 및 신기 객체 탐지 모델 전반에 걸쳐 신기 객체 탐지기의 적대적 강건성을 **일관되고 큰 폭으로 향상**시킵니다.
- 제안된 방법과 새로운 문제에 대한 광범위한 분석 및 논의를 제공합니다.
- 8가지 적대적 공격, 5가지 데이터셋, 7가지 신기 객체 탐지기를 포괄하는 포괄적인 **벤치마크 결과**를 제공합니다.

## 📎 Related Works

- **단일 클래스 신기 객체 탐지:** SVM 기반 초기 알고리즘([30], [31])에서 발전하여 DAE, VAE, AAE, GAN 등 딥 오토인코더(AE) 기반 접근 방식([1], [5], [7], [8], [9], [24], [32], [33], [34], [35])이 주류를 이룹니다. ALOCC([8]), GPND([5]), OCGAN([7]), ARAE([1]), Puzzle-AE([9]) 등이 있습니다.
- **적대적 공격:** Szegedy et al.([12])이 딥 네트워크의 취약성을 보인 이후, FGSM([11]), PGD([27]), MI-FGSM([36]), MultAdv([37])와 같은 디지털 공격과 Adversarial Framing(AF)([38])과 같은 물리적 공격이 제안되었습니다.
- **적대적 방어:** 초기에는 적대적 예제 탐지([39], [40], [41])에 초점을 맞췄으나, 방어가 더 효과적임이 알려졌습니다. 이미지 변환 기반 방어([13], [16], [42])는 화이트박스 공격([43], [44])에 취약하며, PGD-AT([27])와 같은 적대적 훈련(Adversarial Training, AT)이 가장 효과적인 방어 중 하나로 여겨집니다. FD([15]), SAT([23]), RotNet-AT([21]), SOAP([22]) 등이 분류 모델을 위해 제안되었습니다. anomaly detection을 위한 유일한 기존 방어법인 APAE([46])는 제한적인 평가를 받았습니다.

## 🛠️ Methodology

본 논문은 신기 객체 탐지 모델의 적대적 강건성을 향상시키기 위해 **Principal Latent Space(PrincipaLS)**라는 방어 전략을 제안합니다. PrincipaLS는 인코더(encoder)와 디코더(decoder)를 포함하는 AE 기반 모델의 잠재 공간(latent space)을 조작하여 적대적 교란(adversarial perturbations)을 제거합니다.

1. **적대적 공격 모델 구성:**

   - AE 기반 모델 $Enc$ (인코더)와 $Dec$ (디코더)를 사용합니다.
   - 입력 이미지 $X$와 실제 라벨 $y \in \{-1, 1\}$ (알려진 클래스: 1, 새로운 클래스: -1)에 대해 적대적 예제 $X_{adv}$를 생성합니다.
   - 주요 공격 수식은 PGD([27])를 기반으로 하며, 다음과 같은 MSE 손실 $L$을 사용합니다:
     $$L(\hat{X}_t, X_t, y) = y\| \hat{X}_t - X_t \|_2$$
     여기서 $\hat{X}_t = Dec(Enc(X_t))$입니다. 알려진 클래스에 속하면 재구성 오류를 최대화하고, 새로운 클래스에 속하면 재구성 오류를 최소화하여 적대적 예제를 생성합니다.

2. **PrincipaLS(Principal Latent Space) 구성:**

   - PrincipaLS는 두 가지 주요 구성 요소, **Vector-PCA**와 **Spatial-PCA**를 포함합니다.
   - 인코더의 마지막 활성화 함수는 잠재 공간 $Z_{adv} = Enc(X_{adv}) \in \mathbb{R}^{s \times v}$의 값을 0과 1 사이로 제한하기 위해 시그모이드(sigmoid) 함수로 대체됩니다. 여기서 $s = h \times w$는 공간 차원이고 $v$는 벡터 차원(채널 수)입니다.

   - **Vector-PCA:**

     - $Z_{adv}$의 평균 잠재 벡터와 주 잠재 벡터를 계산합니다: $\{\mu_V, \tilde{U}_V\} = h_V(Z_{adv}, k_V=1)$. (여기서 $k_V$는 항상 1로 설정됩니다.)
     - $Z_{adv}$를 Vector-PCA 공간 $Z_V \in \mathbb{R}^{s \times 1}$으로 변환합니다: $Z_V = f_V(Z_{adv}; \mu_V, \tilde{U}_V)$.
     - 이를 통해 잠재 벡터가 학습된 주 잠재 벡터 $\tilde{U}_V^*$의 스케일링 인자(scaling factor)로 대체되어 대부분의 적대적 교란이 제거됩니다. 남은 교란은 단일 채널 맵의 스케일링 인자에만 존재하게 됩니다.

   - **Spatial-PCA:**
     - $Z_V$의 평균 Vector-PCA 맵과 주 Vector-PCA 맵을 계산합니다: $\{\mu_S, \tilde{U}_S\} = h_S(Z_V^\top, k_S)$. (여기서 $k_S$는 하이퍼파라미터입니다.)
     - $Z_V$를 Spatial-PCA 공간 $Z_S \in \mathbb{R}^{k_S \times 1}$으로 변환합니다: $Z_S^\top = f_S(Z_V^\top; \mu_S, \tilde{U}_S)$.
     - 이후 역 Spatial-PCA와 역 Vector-PCA를 통해 $Z_S$를 원래 차원으로 변환하여 최종 **Principal Latent Space $Z_{PrincipaLS}$**를 얻습니다. 이 과정은 PCA 기반 노이즈 제거와 유사하게 작동하며 남은 적대적 교란을 추가로 제거합니다.
     - 디코더는 $Z_{PrincipaLS}$를 사용하여 입력 적대적 예제 $X_{adv}$를 재구성하고 신기 객체 점수(novelty score)를 계산합니다.

3. **점진적 훈련(Incremental Training):**

   - PrincipaLS의 주 잠재 구성 요소들 $\{\mu_V, \tilde{U}_V, \mu_S, \tilde{U}_S\}$는 학습 중 **지수 이동 평균(EMA)**을 통해 네트워크 가중치와 함께 점진적으로 훈련됩니다.
   - 이를 통해 주 잠재 구성 요소와 네트워크 가중치 간의 상호 학습을 장려하고, 전체 모델이 엔드 투 엔드로 잘 훈련되도록 합니다.
   - 추론 시에는 훈련된 구성 요소를 사용하며, 전체 과정은 미분 가능하여 `obfuscated gradients` 문제를 유발하지 않습니다.

4. **적대적 훈련(Adversarial Training, AT)과의 통합:**
   - PrincipaLS는 적대적 훈련(AT)과 결합되어 적대적 강건성을 더욱 향상시킵니다.

## 📊 Results

- **적대적 강건성:** PrincipaLS는 8가지 공격(디지털-물리, 화이트박스-블랙박스), 5가지 데이터셋, 7가지 신기 객체 탐지기에서 기존 방어 기법들(PGD-AT, FD, SAT, RotNet-AT, SOAP, APAE)보다 **일관되게 뛰어난 mAUROC(mean AUROC) 성능**을 보였습니다. 특히 MNIST, F-MNIST, CIFAR-10, MVTec-AD, SHTech 등 다양한 데이터셋에서 높은 강건성을 달성했습니다.
- **PrincipaLS-인지 공격:** 공격자가 PrincipaLS 방어 메커니즘을 완전히 인지하고 최적화하려는 Knowledgeable A/B 공격에서도 PrincipaLS의 mAUROC는 감소하지 않고 오히려 증가하는 경향을 보여, 방어 메커니즘을 깨기 어렵다는 것을 입증했습니다.
- **클린 데이터 성능:** PrincipaLS는 적대적 공격뿐만 아니라 **클린 데이터(clean data)에서도 원래 네트워크보다 성능을 향상**시켰습니다. 이는 주 잠재 구성 요소가 알려진 클래스 분포를 배타적으로 모델링하여 새로운 클래스 이미지에 대해 더 높은 재구성 오류를 유도하기 때문입니다.
- **추론 속도:** PrincipaLS 모듈은 가볍고 계산 효율적이며, 추론 속도 저하가 **13.3%에 불과**하여 다른 방어 기법(FD: -62.2%, SOAP: -82.2%, APAE: -77.8%)에 비해 훨씬 적은 오버헤드를 가집니다.
- **잠재 공간의 안정성:** PrincipaLS는 적대적 예제의 잠재 공간과 클린 데이터의 잠재 공간 간의 $L_2$-norm이 다른 방어 기법보다 3 자릿수 작아, 잠재 공간이 적대적 교란에 거의 영향을 받지 않음을 보여주었습니다.
- **재구성 오류 및 이미지:** PrincipaLS는 적대적 공격 하에서도 모든 데이터를 알려진 클래스로 재구성하여, 새로운 클래스 이미지에서 매우 높은 재구성 오류를, 정상 이미지에서 낮은 오류를 유지합니다. 이는 강건한 신기 객체 탐지로 이어집니다.

## 🧠 Insights & Discussion

- **신기 객체 탐지 특화 방어:** PrincipaLS는 신기 객체 탐지 모델이 **정상 데이터에 대한 정보만 유지하면 된다는 작업별 지식**을 활용합니다. 이 특성 덕분에 잠재 공간을 크게 조작하여 적대적 요소를 제거하면서도 클린 데이터 성능을 유지할 수 있습니다.
- **분류 모델과의 차이:** PrincipaLS는 이미지 분류 작업에서는 오히려 성능을 저하시켰습니다. 이는 분류 모델이 여러 카테고리의 정교한 의미론적 정보를 포함해야 하므로 잠재 공간의 대규모 조작이 모델 역량을 제한하기 때문입니다. 이는 신기 객체 탐지와 이미지 분류 작업이 다른 특성을 가지며, 각각에 특화된 적대적 방어가 필요함을 시사합니다.
- **기존 방어 기법과의 비교:** ARAE([1]) 및 APAE([46])와 같은 기존 "적대적 강건성" 관련 연구들은 제한적인 공격 시나리오(예: 정상 데이터만 또는 비정상 데이터만 교란)를 사용했습니다. 본 논문은 모든 입력 데이터에 대한 교란을 허용하는 **더 강력하고 일반적인 공격 프레임워크**를 제시하며, 이를 통해 PrincipaLS의 우월성을 입증했습니다.
- **다중 클래스 신기 객체 탐지(Multiple Class Novelty Detection) 적용 가능성:** PrincipaLS는 다중 클래스 신기 객체 탐지 문제(MNIST의 여러 숫자를 알려진 클래스로 설정)에서도 기존 방어 기법보다 훨씬 뛰어난 강건성을 보여, 잠재적인 확장 가능성을 확인했습니다.

## 📌 TL;DR

신기 객체 탐지 모델이 적대적 공격에 취약하다는 문제를 해결하기 위해, 본 논문은 **Principal Latent Space(PrincipaLS)**라는 새로운 방어 기법을 제안한다. PrincipaLS는 **점진적으로 훈련되는 캐스케이드(cascade) PCA**를 사용하여 모델의 잠재 공간에서 적대적 교란을 효과적으로 정화한다. 광범위한 실험을 통해 PrincipaLS가 다양한 공격, 데이터셋, 신기 객체 탐지 모델에 대해 **일관되게 뛰어난 적대적 강건성**을 제공하며, 클린 데이터 성능도 향상시키고 계산 효율적임을 입증했다. 이 연구는 신기 객체 탐지 고유의 특성을 활용하여 기존 분류 모델 방어 기법의 한계를 극복하는 새로운 방향을 제시한다.
