# NOVELTY DETECTION UNDER MULTI-INSTANCE MULTI-LABEL FRAMEWORK

Qi Lou, Raviv Raich, Forrest Briggs and Xiaoli Z. Fern

## 🧩 Problem to Solve

이 논문은 기계 학습 및 신호 처리 분야에서 중요한 신규성 탐지(novelty detection) 문제를 새로운 설정에서 다룹니다. 기존 MIML(Multi-Instance Multi-Label) 학습은 데이터 객체가 인스턴스의 '가방(bag)'으로 표현되고 여러 클래스 레이블과 연관된다는 점은 같지만, 가방 내의 모든 인스턴스가 알려진 클래스 중 하나에 속한다고 가정합니다. 그러나 현실에서는 이 가정이 깨지는 경우가 많습니다 (예: 이미지 태그가 이미지 속 모든 객체를 포괄하지 못하는 경우).

본 연구의 핵심 문제는 MIML 환경에서, **가방이 '새로운(novel)' 클래스 인스턴스를 포함할 수 있는 시나리오**에 중점을 둡니다. 목표는 새로운 가방의 임의의 인스턴스가 **알려진 클래스에 속하는지 아니면 새로운 클래스에 속하는지**를 판별하는 것입니다. 이러한 설정은 레이블이 지정된 훈련 가방에 알려지지 않은 클래스 인스턴스가 존재할 수 있으며, 이는 알려진 클래스에 대한 "암묵적인" 음성(negative) 예제로 활용될 수 있습니다.

## ✨ Key Contributions

- **새로운 문제 정의:** MIML 환경에서의 신규성 탐지라는 새로운 문제를 제안합니다.
- **스코어 함수 기반 프레임워크:** 이 문제를 해결하기 위한 스코어 함수(score function) 기반의 판별적 프레임워크를 제시합니다.
- **실험적 유효성 입증:** 실제 바이오어쿠스틱스(bioacoustics) MIML 데이터셋에서 제안된 방법의 효과를 입증합니다.
- **레이블 없는 신규 인스턴스의 유용성:** 훈련 가방 내에 레이블이 없는(unlabeled) 신규 인스턴스(novel instances)가 존재하는 것이 테스트 단계에서 이러한 인스턴스 탐지에 도움이 된다는 것을 밝혀냅니다.

## 📎 Related Works

- **전통적인 신규성 탐지:**
  - **통계적 접근 방식:** 밀도 추정 방법 [1, 2].
  - **신경망 기반 접근 방식:** 다층 퍼셉트론(Multi-Layer Perceptrons) [1, 2].
  - **최근 접근 방식:** 기하학적 엔트로피 최소화(geometric entropy minimization) [3], 이분 그래프(bipartite k-NN graphs)를 사용한 효율적인 이상 탐지 [4], 스코어 함수 기반 이상 탐지 [5].
  - **SVM 기반 접근 방식:** One-class SVM(서포트 벡터 머신) [6].
- **MIML 학습:** 주로 지도 학습(supervised learning)을 위해 연구되었으며, 문서 분류나 이미지 분류와 같이 데이터가 인스턴스 가방으로 표현되고 여러 레이블과 연관되는 응용 분야에서 널리 사용됨 [7].
  - **MIML 인스턴스 주석(annotation) 학습:** Rank loss [8] 및 인스턴스 수준 스코어 함수 학습을 시도하는 여러 알고리즘 [8, 10].

## 🛠️ Methodology

본 논문은 주어진 인스턴스 $x$가 알려진 클래스 $Y$에 속하는지 여부를 결정하는 것을 목표로 합니다.

- **스코어 함수(Score Functions) 정의:**
  - 각 레이블 $c \in Y$에 대해 스코어 함수 $f_c(x)$를 할당합니다.
  - $f_c(x) = \sum_{x_l \in \bigcup_i X_i} \alpha_{cl} k(x, x_l) = \alpha_c^T k(x)$
  - 여기서 $k(\cdot, \cdot)$는 커널 함수(예: 가우시안 커널 $k(x_i, x_j) = e^{-\gamma\|x_i - x_j\|^2}$)이며, $\alpha_c$는 가중치 벡터입니다.
- **결정 원칙(Decision Principle):**
  - 만약 모든 알려진 클래스에 대한 스코어의 최댓값이 특정 임계값 $\epsilon$보다 작으면, 인스턴스 $x$를 '알려지지 않음(unknown)'으로 분류합니다.
  - $\max_{c \in \{1, \dots, |Y|\}} f_c(x) < \epsilon$ 이면 'unknown' 반환, 그렇지 않으면 'known' 반환.
- **목적 함수(Objective Function):**
  - 모델 복잡성을 제어하는 정규화 항과 가방 수준 힌지 손실(bag-level hinge loss) 항으로 구성된 목적 함수 $\text{OBJ}$를 최소화합니다.
  - $\text{OBJ} = \frac{\lambda}{2} \sum_{c=1}^{|Y|} \alpha_c^T K \alpha_c + \frac{1}{N|Y|} \sum_{i=1}^N \sum_{c=1}^{|Y|} F_c(X_i)$
  - 여기서 $F_c(X_i) = \max\{0, 1 - y_{ic} \max_{x_{ij} \in X_i} f_c(x_{ij})\}$ 입니다.
  - $y_{ic} = +1$은 가방 $X_i$가 레이블 $c$를 포함하는 경우, 그렇지 않으면 $y_{ic} = -1$ 입니다.
- **최적화(Optimization):**
  - 목적 함수는 비볼록(non-convex)합니다.
  - 각 가방 $X_i$에서 클래스 $c$에 대해 스코어 함수 $f_c(x_{ij})$를 최대로 만드는 '서포트 인스턴스' $x_{ic}^* = \operatorname{argmax}_{x_{ij} \in X_i} \alpha_c^T k(x_{ij})$를 찾습니다.
  - $x_{ic}^*$를 고정하면 목적 함수가 $\alpha_c$에 대해 볼록(convex)해지므로, L-BFGS [9] 알고리즘을 사용하여 이를 해결합니다.
  - 서브그래디언트(subgradient) $\nabla_c = \lambda K \alpha_c - \frac{1}{N|Y|} \sum_{i=1}^N y_{ic} k(x_{ic}^*) \mathbf{1}_{\{1 - y_{ic} f_c(x_{ic}^*) > 0\}}$를 계산하여 사용합니다.
  - 글로벌 최적값은 보장되지 않으므로, 여러 번 무작위 초기화를 통해 알고리즘을 실행하고 목적 함수 값이 가장 작은 결과를 채택합니다 (Algorithm 1).
- **파라미터 튜닝:**
  - 가우시안 커널의 대역폭 $\gamma$와 정규화 파라미터 $\lambda$를 튜닝합니다.
  - 훈련 시에는 제로-원 손실(zero-one loss) $\sum_{i=1}^N \sum_{c=1}^{|Y|} \mathbf{1}_{\{y_{ic} \max_{x_{ij} \in X_i} f_c(x_{ij}) < 0\}}$을 최소화하는 파라미터 쌍을 선택합니다.
  - ROC 곡선 생성을 위한 임계값 $\epsilon$은 훈련 예제로부터 파생됩니다.

## 📊 Results

제안된 알고리즘의 효과는 합성 데이터와 실제 데이터 모두에서 입증되었습니다.

- **MNIST 필기체 숫자 데이터셋:**
  - PCA를 통해 20차원으로 축소된 인스턴스를 사용하여 가방을 생성했습니다.
  - **가방 생성 방식:**
    1. **설정 1 (알고리즘 2):** 훈련 및 테스트 가방 모두 순수하게 신규 예제(빈 레이블 세트)를 포함할 수 있도록 생성.
    2. **설정 2 (알고리즘 3로 훈련, 알고리즘 2로 테스트):** 훈련 가방은 최소한 하나의 알려진 레이블을 포함해야 하지만, 테스트 가방은 빈 레이블 세트를 가질 수 있음.
  - **결과 (표 5, 6):** 알려진 레이블 세트 크기 4에 대해 평균 AUC는 모두 0.85 이상, 크기 8에 대해 0.8 이상을 달성하며, 다양한 레이블 조합에서 안정적인 성능을 보였습니다. 특히, 설정 1(빈 레이블 세트 가방 포함)이 설정 2(훈련 가방 필터링)보다 항상 더 나은 AUC를 보여, 훈련 가방에 순수한 신규 예제가 포함되는 것이 탐지에 유익함을 시사합니다.
- **HJA 새소리 데이터셋 (실제 데이터):**
  - 13종 4998개의 38차원 인스턴스를 포함하는 548개의 가방으로 구성된 실제 바이오어쿠스틱스 데이터셋을 사용했습니다.
  - **결과 (표 8):** 대부분의 AUC 값이 0.85 이상이었고 일부는 0.9에 도달했습니다. 종의 불균형에도 불구하고 다양한 레이블 설정에서 결과가 상당히 안정적이어서, 신규 종 발견을 위한 잠재력을 보여주었습니다.
- **One-Class SVM과의 비교:**
  - One-Class SVM에 "불공정한 이점"(post-hoc 파라미터 튜닝)을 제공했음에도 불구하고, 제안된 알고리즘은 두 데이터셋 모두에서 AUC 및 안정성 측면에서 One-Class SVM보다 훨씬 뛰어난 성능을 보였습니다 (표 9, 10). 이는 훈련 시 레이블이 없는 신규 인스턴스의 존재를 활용하는 것이 얼마나 유익한지를 다시 한번 입증합니다.

## 🧠 Insights & Discussion

- **문제 해결의 중요성:** 이 논문은 기존 MIML 학습의 한계를 넘어, 실제 데이터에서 흔히 발생하는 '불완전한 레이블링' 상황을 반영하는 신규성 탐지 문제를 성공적으로 정의하고 해결책을 제시했습니다.
- **알고리즘의 효과성:** 제안된 판별적 프레임워크는 스코어 함수와 가방 수준 힌지 손실을 통해 알려진 클래스와 신규 클래스를 효과적으로 구분합니다.
- **레이블 없는 신규 인스턴스의 가치:** 훈련 가방에 명시적으로 '신규'로 레이블링되지 않았지만 실제로는 신규 클래스에 속하는 인스턴스들이 존재한다는 것이 탐지 성능을 크게 향상시키는 중요한 요인임을 밝혀냈습니다. 이는 전통적인 신규성 탐지 방법이 활용하지 못하는 MIML 설정의 고유한 이점입니다.
- **제한점 및 향후 연구:** 목적 함수가 비볼록이라는 한계가 있지만, 여러 번의 초기화를 통해 어느 정도 완화됩니다. 향후 연구로는 가방 수준 레이블 정보를 탐지에 더 직접적으로 활용하여 성능을 개선할 가능성이 언급됩니다.

## 📌 TL;DR

- **문제:** 기존 MIML 학습이 모든 인스턴스가 알려진 클래스에 속한다고 가정하는 것과 달리, 가방(bag)에 알려지지 않은(novel) 클래스의 인스턴스가 포함될 수 있는 상황에서 각 인스턴스가 알려진 클래스에 속하는지 또는 새로운 클래스에 속하는지 판별하는 **MIML 환경에서의 신규성 탐지(novelty detection)** 문제를 제안합니다.
- **방법:** 각 클래스에 대한 커널 기반 스코어 함수를 정의하고, 가방 수준 힌지 손실을 포함하는 비볼록 목적 함수를 L-BFGS 알고리즘으로 최적화하는 판별적 프레임워크를 제시합니다. 이 방법은 훈련 데이터에 레이블이 지정되지 않은 신규 인스턴스가 존재할 경우 이를 암묵적인 정보로 활용할 수 있습니다.
- **결과:** 제안된 방법은 MNIST 숫자 데이터셋 및 HJA 새소리 데이터셋에서 0.85 이상의 높은 AUC를 달성하며 효과적임을 입증합니다. 특히, 훈련 데이터에 레이블이 없는 신규 클래스 인스턴스가 포함된 가방이 있는 경우 탐지 성능이 크게 향상되며, 이는 One-Class SVM과 같은 전통적인 신규성 탐지 기법보다 우수함을 보여줍니다.
