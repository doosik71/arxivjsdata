# AUTOENCODERS FOR ANOMALY DETECTION ARE UNRELIABLE
Roel Bouman & Tom Heskes

## Problem to Solve

이 논문은 이상 탐지(anomaly detection)에 널리 사용되는 **오토인코더(Autoencoder, AE)**의 신뢰성 문제를 다룹니다. 오토인코더 기반 이상 탐지는 일반적으로 **재구성 손실(reconstruction loss)**을 사용하며, 정상 데이터는 정확하게 재구성할 수 있지만 이상 데이터는 재구성하기 어렵다는 가정(즉, 이상 데이터의 재구성 손실이 더 높다는 가정)에 의존합니다. 그러나 최근 연구들은 이러한 가정이 항상 유효하지 않을 수 있음을 지적했으나, 이론적 타당성에 대한 연구는 부족했습니다. 이 논문은 이 가정이 **실제로 성립하지 않음**을 수학적으로 그리고 실험적으로 증명하고, 정상 데이터에서 멀리 떨어진 이상 데이터도 완벽하게 재구성될 수 있음을 보여줌으로써 오토인코더의 **예상치 못한 실패 모드**를 분석하는 것을 목표로 합니다.

## Key Contributions

*   **재구성 손실 가설의 반박**: 오토인코더가 정상 데이터를 이상 데이터보다 더 정확하게 재구성한다는 기존 가설이 틀렸음을 이론적으로 그리고 실험적으로 증명했습니다.
*   **외삽(Extrapolation)으로 인한 이상 재구성 증명**: 선형 오토인코더(PCA 포함)가 훈련 데이터에서 멀리 떨어진 **영역 밖(out-of-bounds)**의 데이터 포인트를 **완벽하게 재구성**하여 0의 재구성 손실을 가질 수 있음을 수학적으로 증명했습니다. 이는 의도치 않은 외삽으로 인해 이상 탐지기가 오작동할 수 있음을 의미합니다.
*   **비선형 오토인코더에서의 문제점 확인**: ReLU 및 시그모이드(Sigmoid) 활성화 함수를 사용하는 비선형 오토인코더도 합성 테이블 데이터와 실제 MNIST 이미지 데이터 모두에서 유사한 이상 재구성 동작을 보임을 실험적으로 입증했습니다.
*   **이상 재구성의 원인 분석**: 재구성 문제가 주로 저차원 잠재 공간의 한 지점이 원본 공간의 **초평면(hyperplane)**에 해당하기 때문에 발생하며, 이는 데이터 사이의 **보간(interpolation)** 및 **영역 밖 외삽(out-of-bounds extrapolation)**을 유발한다고 설명합니다. 또한, 정상 클래스들이 접하는 잠재 공간 영역에서도 이상이 탐지되지 않을 수 있음을 밝혔습니다.
*   **안전 필수 애플리케이션에 대한 경고**: 오토인코더의 이러한 신뢰성 부족이 안전 필수(safety-critical) 애플리케이션에서 치명적인 실패로 이어질 수 있음을 경고합니다.
*   **'동일한 지름길(identical shortcut)' 반박**: 충분히 낮은 차원의 잠재 공간을 사용해도 이러한 문제가 발생할 수 있음을 보여줌으로써, 이상 재구성이 단순히 '동일한 지름길' 때문이라는 주장을 반박했습니다.

## Methodology

1.  **이론적 분석 (PCA 및 선형 오토인코더)**:
    *   PCA (Principal Component Analysis)를 통한 차원 축소와 재구성을 **재구성 손실** 기반 이상 탐지의 기본 모델로 설정합니다.
    *   특이값 분해(SVD)를 사용하여 데이터 행렬 $X = U\Sigma V^T$로 분해하고, $V_d$ (첫 $d$개의 직교 특이 벡터)의 열 공간(column space)에 있는 모든 벡터 $a$에 대해 재구성 손실 $L_R(a, h(g(a)))=0$임을 증명합니다.
    *   이러한 $a$가 훈련 데이터 $x_i$로부터 임의의 거리 $\delta$보다 멀리 떨어질 수 있음을 유클리드 거리 기준으로 증명하여, 훈련 시 노출되지 않은 **적대적 이상치(adversarial anomalies)**도 완벽하게 재구성될 수 있음을 보입니다.
    *   선형 오토인코더가 잘 수렴하면 PCA와 유사하게 동작하며, 동일한 원리로 영역 밖 재구성이 발생함을 증명합니다.
    *   편향 항(bias term)이 있는 선형 네트워크에도 이 증명이 확장될 수 있음을 부록에서 다룹니다.

2.  **실험적 검증 (비선형 오토인코더)**:
    *   **합성 테이블 데이터**:
        *   단일 또는 두 개의 가우시안 분포, 그리고 $x_2=x_1^2$ 형태의 2차원 데이터셋을 합성합니다.
        *   ReLU 또는 시그모이드 활성화 함수를 사용하는 얕거나 깊은 비선형 오토인코더를 훈련시킵니다.
        *   재구성 손실(MSE)의 등고선 플롯을 시각화하여 훈련 데이터 영역 밖에서 낮은 손실(거의 완벽한 재구성)이 발생하는지 확인합니다.
    *   **실제 이미지 데이터 (MNIST)**:
        *   특정 숫자(예: 4, 5, 7 또는 0, 1)를 정상 데이터로 사용하여 컨볼루션 오토인코더를 훈련시킵니다.
        *   2차원 잠재 공간에서 재구성 손실의 등고선을 생성하고, 정상 데이터의 잠재 표현을 함께 표시합니다.
        *   잠재 공간 내에서 재구성 손실이 낮은 영역(특히 정상 데이터에서 멀리 떨어진 곳이나 클래스 경계)을 식별하고, 해당 지점을 디코딩하여 **적대적 이상치 이미지**를 생성합니다.
        *   생성된 이상치 이미지의 재구성 손실을 계산하고, 이를 훈련 데이터의 최소 재구성 손실과 비교하여 탐지 실패 사례를 보여줍니다.

## Results (if available)

*   **선형 오토인코더 (PCA 포함)**: 이론적으로 $V_d$ (또는 선형 오토인코더의 가중치 행렬 $W_{enc}W_{dec}^T$)의 열 공간에 있는 모든 점은 재구성 손실이 0이 될 수 있으며, 이러한 점들은 훈련 데이터에서 임의로 멀리 떨어져 있을 수 있음이 증명되었습니다. 이는 선형 모델이 의도치 않게 이상치를 완벽하게 재구성할 수 있음을 의미합니다.
*   **ReLU 활성화 비선형 오토인코더 (테이블 데이터)**: 합성 2D 데이터셋에서 훈련된 ReLU 기반 오토인코더는 훈련 데이터 경계를 훨씬 벗어난 영역에서도 매우 낮은 재구성 손실을 보였습니다 (Figure 1a, 1c, 1d). 심지어 일부 정상 데이터 포인트보다 재구성 손실이 더 낮은 이상 영역도 존재했습니다. 이는 ReLU의 조건부 선형성(conditionally linear nature)으로 인해 데이터 공간의 가장자리에서 선형 동작을 보이기 때문입니다.
*   **시그모이드 활성화 비선형 오토인코더 (테이블 데이터)**: 시그모이드 활성화 오토인코더는 ReLU처럼 급격한 '초평면' 문제를 겪지는 않지만, 다중 모달 데이터(예: 두 가우시안 분포)의 경우 두 클러스터 사이의 중간 영역에서 예상보다 낮은 재구성 손실을 보이는 '원치 않는 보간(unwanted interpolation)' 현상을 보였습니다 (Figure 1f). 이로 인해 많은 정상 데이터 포인트보다 낮은 재구성 손실을 갖는 이상 영역이 발생했습니다.
*   **컨볼루션 오토인코더 (MNIST 이미지 데이터)**:
    *   MNIST 숫자(4, 5, 7)로 훈련된 AE는 잠재 공간의 특정 영역에서 훈련 데이터와는 전혀 다른 '이상한 숫자' 형태를 띠지만 매우 낮은 재구성 손실을 가지는 **적대적 이상치**를 생성했습니다 (Figure 2c). 이 이상치의 재구성 손실은 정상 훈련 데이터의 최소 재구성 손실보다 훨씬 낮아 명백한 오탐(false negative) 사례를 보여주었습니다.
    *   MNIST 숫자(0, 1)로 훈련된 AE는 두 클래스가 만나는 잠재 공간 교차점에서 0과 1의 특징이 혼합된 '이상한' 이미지를 낮은 재구성 손실로 생성했습니다 (Figure 2d).
    *   일부 경우에는 영역 밖 재구성이 '일반적인' 이상치 탐지기의 기대치와 일치하는 경우도 있었지만 (Figure 2e), 전반적으로 오토인코더의 **일반화(generalization)** 능력은 예상치 못한 보간 및 외삽으로 이어져 이상치를 탐지하지 못하는 결과를 초래했습니다.
    *   문제의 발생 여부는 초기화에 사용된 무작위 시드나 정상 데이터로 선택된 숫자에 따라 달라질 수 있으며, 재구성 영역이 에포크마다 비단조적으로 나타나기도 하여 실제 적용 시 신뢰성을 정확히 판단하기 어렵다는 결론을 내렸습니다.