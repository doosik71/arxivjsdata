# DATA AUGMENTATION FOR ROBUST KEYWORD SPOTTING UNDER PLAYBACK INTERFERENCE

Anirudh Raju, Sankaran Panchapagesan, Xing Liu, Arindam Mandal, Nikko Strom

## 🧩 Problem to Solve

온디바이스 키워드 스포팅(KWS) 시스템은 낮은 오탐(False Accept Rate, FAR) 및 미탐(False Reject Rate, FRR)을 유지하며 고객 경험을 향상시키는 것이 중요합니다. 특히 다음 두 가지 도전적인 조건에서 낮은 FRR을 유지하는 것이 어렵습니다:

1. **주변 소음**: TV, 가전제품 또는 장치를 향하지 않는 다른 대화와 같은 외부 소스에서 발생하는 주변 소음.
2. **재생 간섭**: 장치에서 오디오가 재생될 때 음향 에코 제거(Acoustic Echo Cancellation, AEC) 시스템이 완벽하게 작동하지 않아 잔여 에코가 발생하는 경우.

이 논문은 이러한 도전적인 조건, 특히 재생 간섭으로 인한 잔여 에코 상황에서 KWS 시스템의 강건성을 향상시키는 것을 목표로 합니다.

## ✨ Key Contributions

- **데이터 증강 전략 제안**: 재생 간섭으로 인한 잔여 잡음 문제를 해결하기 위한 데이터 증강 전략을 제안합니다. 이는 AEC 신호 강화 문제가 아닌 잡음 강건성 문제로 접근합니다.
- **훈련 데이터 인위적 오염**: 훈련 오디오에 다양한 신호 대 간섭비(Signal-to-Interference Ratio, SIR)로 음악 및 TV/영화 오디오를 혼합하여 데이터를 인위적으로 오염시킵니다.
- **FRR 상당한 감소**: 오디오 재생 환경에서 KWS 시스템의 FRR을 최대 30-45%까지 상대적으로 감소시키는 효과를 입증했습니다. 특히 음악 데이터를 활용한 증강 시 AUC(Area Under the Curve)를 47.6% 감소시켰습니다.
- **런타임 복잡성 없음**: 온디바이스 시스템의 제약을 고려하여, 런타임 시 메모리 사용량이나 CPU 사이클 측면에서 추가적인 복잡성을 발생시키지 않습니다.

## 📎 Related Works

- **KWS 시스템**: Amazon Alexa와 같은 가상 비서의 온디바이스 KWS 시스템([1-5]). HMM(Hidden Markov Model) 기반 KWS([17-20]) 및 DNN(Deep Neural Network) 기반 음향 모델과 HMM 디코더의 조합([21])이 사용됩니다.
- **잡음 강건성 기법**: 음성 인식 및 KWS 시스템에서 잡음 강건성을 위한 기술로 신호/특징 강화([9, 10]), 모델 적응([11]), 특징 적응(fMMLR, [12]) 등이 있습니다.
- **데이터 증강**: 모델의 훈련 데이터 양을 늘리고 과적합을 방지하며 모델의 강건성을 높이는 데 사용되는 방법입니다([13-16]).
- **다중 작업 학습**: KWS 정확도 향상을 위해 DNN이 대규모 어휘 연속 음성 인식(LVCSR) 작업과 키워드 작업을 동시에 예측하도록 훈련하는 방식([22]).
- **원시 오디오 DNN 모델링**: Wake word 감지를 위한 원시 오디오 입력 기반 신경망 아키텍처([3]).

## 🛠️ Methodology

이 논문은 HMM 디코더와 결합된 DNN 기반의 소형 KWS 시스템을 사용하며, LVCSR 및 키워드 감지 두 가지 작업에 대해 가중 크로스 엔트로피 목적 함수로 훈련됩니다. 핵심 방법론은 다음과 같은 데이터 증강 전략입니다:

1. **훈련 데이터 준비**: 상대적으로 깨끗한 원본 원거리 마이크 훈련 데이터($x_{\text{utterance}}(t)$)를 준비합니다.
2. **간섭 신호 생성**:
   - Amazon 내부 데이터셋에서 얻은 TV/영화 오디오 또는 인기 있는 음악 목록에서 얻은 음악 오디오를 간섭 신호($x_{\text{music}}(t)$)로 사용합니다.
   - 이 오디오를 방 임펄스 응답(Room Impulse Response, RIR) $g_{\text{RIR}}(t)$과 컨볼루션하여 잔향 효과를 모의합니다.
     $$ x*{\text{interference}}(t) = x*{\text{music}}(t) \ast g\_{\text{RIR}}(t) $$
     다양한 음향 환경을 시뮬레이션하기 위해 여러 RIR을 사용합니다.
3. **데이터 오염**:
   - 원래 발화 오디오에 인위적으로 생성된 간섭 신호를 혼합하여 오염된 데이터를 만듭니다.
     $$ y*{\text{corrupted}}(t) = x*{\text{utterance}}(t) + \alpha \cdot x\_{\text{interference}}(t) $$
        여기서 $\alpha$는 간섭 신호에 적용되는 스케일링 팩터입니다.
   - 스케일링 팩터 $\alpha$는 발화와 간섭 신호 간의 임의의 신호 대 간섭비(SIR)를 기반으로 계산됩니다.
     $$ \text{SIR(dB)} = 20 \log \frac{\sqrt{\sum*{i=0}^{N} s[i]^2}}{\alpha \sqrt{\sum*{i=0}^{N} n[i]^2}} $$
        실험에서는 주로 $[0, 40]$ dB 및 $[-20, 40]$ dB 범위의 SIR이 균일 분포에서 샘플링되어 사용됩니다.
4. **DNN 훈련**: 오염된 데이터를 사용하여 DNN을 훈련합니다. DNN의 훈련 목표(타겟)는 원본 깨끗한 발화 데이터에 대한 HMM 상태의 강제 정렬(forced alignments)을 통해 얻습니다.

## 📊 Results

- **재생 조건에서의 성능 향상**: 재생이 있는 테스트 세트에서 데이터 오염(특히 $[-20, 40]$ dB SIR 범위)은 KWS 성능을 크게 향상시킵니다.
- **SIR 범위의 영향**: $[-20, 40]$ dB의 더 공격적인 오염은 재생 테스트 세트에서 훨씬 더 큰 개선을 보이지만, 재생이 없는 테스트 세트에서는 성능 저하를 가져옵니다. 따라서 본 논문에서는 균형을 위해 $[0, 40]$ dB SIR 범위를 선택했습니다.
- **간섭 유형 비교 (Movie vs. Music)**:
  - 혼합된 실제 사용 조건에서는 영화(Movie) 및 음악(Music) 데이터로 오염된 모델 모두 유사한 정확도 개선을 보였습니다.
  - 재생 테스트 세트에서는 음악으로 오염된 모델이 약간 더 큰 정확도 개선을 보여주었습니다.
  - AUC(Area Under the Curve) 수치로 정량화했을 때, 음악으로 오염된 모델은 기준선 대비 47.6%의 AUC 감소를, 영화로 오염된 모델은 40%의 AUC 감소를 달성했습니다 (DET 곡선의 AUC는 낮을수록 성능이 좋음).
- **AEC 미적용 조건에서의 효과**: AEC 전처리 알고리즘이 적용되지 않은 테스트 세트에서도 데이터 증강은 KWS 성능 향상에 도움이 됩니다.

## 🧠 Insights & Discussion

- **강건성 향상의 원리**: DNN은 다양한 잡음 조건에서 훈련된 데이터를 통해 잡음에 더 불변하는 특징을 학습하게 됩니다. 이는 네트워크의 하위 계층이 훈련 데이터 내의 다양한 음향 조건에 불변하는 특징 표현을 차별적으로 학습하는 비선형 특징 추출기로 작용하기 때문입니다.
- **실용적인 이점**: 재생 간섭 문제를 AEC 신호 강화 문제보다는 잡음 강건성 문제로 접근하고 데이터 증강을 사용함으로써, 런타임 시 KWS 시스템에 추가적인 복잡성(메모리나 CPU 사용량) 없이 성능을 향상시킬 수 있습니다. 이는 온디바이스 시스템에 매우 중요한 요소입니다.
- **고객 경험 개선**: 낮은 미탐율(FRR)은 사용자가 장치에 말을 걸 때마다 장치가 깨어나므로 원거리 대화형 에이전트의 고객 경험을 크게 향상시킵니다.
- **확장 가능성**: 이 데이터 증강 기법은 배경 대화, 가전제품 소음, 차량 소음 등 다른 유형의 간섭에도 확장 적용될 수 있습니다. 또한, 원시 오디오 입력 기반의 새로운 신경 모델링 아키텍처에도 적용되어 상당한 정확도 개선을 보여주었습니다.

## 📌 TL;DR

KWS 시스템의 재생 간섭(잔여 에코)에 대한 강건성 문제를 해결하기 위해, 이 논문은 깨끗한 훈련 데이터에 음악 및 TV/영화 오디오를 다양한 신호 대 간섭비(SIR)로 혼합하는 데이터 증강 전략을 제안한다. 이 방법은 런타임 복잡성 추가 없이 DNN-HMM 기반 KWS 시스템의 미탐율(FRR)을 최대 47%까지 상대적으로 감소시켜, 재생 조건 및 AEC 비활성 조건에서도 시스템 성능을 크게 향상시키고 사용자 경험을 개선한다.
