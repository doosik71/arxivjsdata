# Continual Learning in Practice

Tom Diethe, Tom Borchert, Eno Thereska, Borja Balle, Neil Lawrence

## 🧩 Problem to Solve

머신러닝(ML) 모델은 훈련 데이터셋을 기반으로 개발 및 배포되지만, 실제 운영 환경에서는 데이터 분포가 끊임없이 진화(evolving)합니다. 기존 ML 모델 배포 전략은 배포 시점의 검증에만 초점을 맞추어 시간이 지남에 따라 모델 성능이 저하되는 문제(데이터 드리프트, 이상치 등)를 해결하지 못합니다. 또한, ML 시스템은 복잡하게 얽혀 있고(entangled), 컴포넌트 경계가 모호하며, 숨겨진 피드백 루프를 가질 수 있어 수동 유지보수가 비효율적이고 위험합니다. 따라서 데이터 변화에 자동으로 적응하고, 필요할 때 재훈련하며, 새로운 태스크를 처리할 수 있는 "제로 터치(zero touch)" ML 시스템에 대한 필요성이 제기됩니다.

## ✨ Key Contributions

- 데이터가 지속적으로 도착함에 따라 모델이 스스로 유지보수되고 계속 학습할 수 있는 **자체 적응형(Auto-Adaptive) ML 시스템을 위한 참조 아키텍처(reference architecture)를 제시**합니다.
- 데이터 분포 변화(data distribution shift)에 효과적으로 적응하고, 이상치(outliers)를 처리하며, 필요할 때 재훈련하고, 새로운 태스크에 적응하는 ML 모델 관리 방안을 제안합니다.
- 기존 AutoML이 다루지 못했던 배포된 ML 시스템의 유지보수 문제를 해결하는, ML 하이퍼바이저(hypervisor)로서의 "Auto-Adaptive ML" 개념을 도입합니다.
- 데이터 스트리밍 처리, 자체 진단(모니터링), 자체 교정(정책 엔진), 자원 자체 관리(공유 인프라)를 포함하는 모듈식 아키텍처 컴포넌트를 정의하여 실용적인 시스템 엔지니어링 관점을 제공합니다.

## 📎 Related Works

- **Facebook의 "FBLearner Flow" [2]** 및 **Uber의 "Michelangelo" [3]**: ML 모델을 프로덕션으로 가져오는 과정을 용이하게 하는 플랫폼이지만, 배포 후 모델의 지속적인 유지보수에는 초점을 맞추지 않습니다.
- **MacroBase [4]**: 대규모 데이터셋 및 데이터 스트림에서 특이하거나 흥미로운 경향을 찾아 인간의 주의를 우선순위화하는 분석 모니터링 엔진입니다. 유사한 개념을 포함하지만, 본 논문의 모델 유지보수 초점과는 다릅니다.
- **고전적 AutoML [1]**: ML 솔루션 생성을 가속화하지만, 배포된 ML 시스템의 동적인 과제에는 직접적으로 대응하지 못합니다.

## 🛠️ Methodology

제안된 Auto-Adaptive ML 시스템은 스트리밍 기반의 참조 아키텍처로, 다음과 같은 주요 컴포넌트들로 구성됩니다.

1. **Streams (스트림)**: 모든 데이터 처리를 스트리밍 기반으로 하여 실시간 데이터 처리 및 기존 배치 ML 배포와의 호환성을 확보합니다.
2. **Sketcher/Compressor (스케처/압축기)**: 높은 데이터 처리량 문제를 해결하기 위해 데이터 다운샘플링 또는 압축을 수행합니다 (예: Bloom filters, Count-Min Sketch, HyperLogLog, t-digest 등 [부록 A]).
3. **Joiner (조이너)**: 훈련에 필요한 레이블이나 피드백이 지연되거나 다른 소스에서 올 경우, 트레이너와 예측기가 데이터를 적절한 형식으로 받을 수 있도록 통합합니다.
4. **Shared Infrastructure (공유 인프라)**:
   - **Model DB**: 훈련된 모델의 출처(provenance)와 롤백 기능을 위해 모델을 저장합니다.
   - **Training Data Reservoir**: 훈련 에피소드 이력을 저장합니다.
   - **Validation Data Reservoir**: 모델 검증 및 재현을 위한 데이터(예: Adaptable Damped Reservoir)를 저장합니다.
   - **System State DB**: 정책 엔진이 의사결정에 사용합니다.
   - **Diagnostic Logs**: 시스템 디버깅을 위한 전체 이력을 제공합니다.
5. **Data Monitoring (데이터 모니터링)**: 들어오는 데이터 스트림을 분석하여 이상치, 분포 변화(drift), 변화 지점(change-points) 등 비정상적인 데이터 패턴을 식별합니다 (예: PSI, Kolmogorov-Smirnov, KL divergence, One-class SVM, Random Cut Forest 등 [부록 B]).
6. **Prediction Monitoring (예측 모니터링)**: 예측 결과 및 시스템 헬스 모니터링 스트림을 분석하여 모델의 실제 성능과 '세상'의 변화를 추정합니다.
7. **Model Policy Engine (모델 정책 엔진)**: 데이터 모니터링 및 예측 모니터링 결과, 비즈니스 로직을 기반으로 모델 재훈련, 롤백, 전이 학습 등 최적의 액션을 결정하고 트리거합니다. 이상적으로는 강화 학습(Reinforcement Learning)을 통해 정책 자체를 학습할 수 있습니다.
8. **Trainer (트레이너)**: 사용자 정의 ML 모델 훈련 알고리즘을 감싸며, 재훈련 단계를 관리하고 관련 메타데이터를 공유 인프라에 저장합니다.
9. **Hyper-Parameter Optimization (HPO)**: 훈련 프로세스를 자동으로 '웜스타트(warm-start)'하여 효율성을 높입니다 (예: Bayesian Optimization).
10. **Predictor (예측기)**: 새로 훈련된 모델의 배포를 담당하며, 트레이너로부터 지속적인 모델 스트림을 구독하여 예측을 수행합니다.

## 📊 Results

본 논문은 실제 시스템 구현의 정량적 결과를 제시하기보다는, **데이터가 끊임없이 진화하는 환경에서 ML 모델의 수명 주기를 자동으로 관리하고 지속적으로 학습하는 "자체 적응형 ML" 시스템을 위한 포괄적인 참조 아키텍처를 성공적으로 설계하고 제안**했습니다.

주요 결과는 다음과 같습니다:

- **실제 문제 해결을 위한 아키텍처 청사진**: 데이터 드리프트, 이상치, 재훈련 필요성 등 프로덕션 ML 시스템이 직면하는 핵심 과제들을 해결하기 위한 명확하고 실용적인 시스템 구조를 제시했습니다.
- **모듈화된 컴포넌트 및 상호작용 정의**: 스케처, 모니터링, 정책 엔진 등 각 기능적 컴포넌트를 명확히 분리하고 그들의 역할을 상세히 설명함으로써, 시스템의 확장성, 유지보수성, 그리고 점진적 도입 가능성을 높였습니다.
- **"제로 터치" ML의 실현 가능성 제시**: 수동 개입을 최소화하면서 모델이 스스로 적응하고 유지보수되는 시스템의 비전을 아키텍처 수준에서 구체화하여, 장기적인 기술 부채 감소와 운영 효율성 증대의 가능성을 보여주었습니다.
- **지속적 학습 연구의 촉진**: 제안된 아키텍처는 데이터의 비정상성(non-stationarity)과 변화에 대응하는 지속적 학습 시스템의 중요한 단계로서, 향후 연구와 개발 방향을 제시하는 토대가 됩니다.

## 🧠 Insights & Discussion

- **ML 시스템의 현실적 과제에 대한 인식**: 논문은 ML 모델이 데이터 변화에 취약하며, 기존 소프트웨어 배포 방식으로는 프로덕션 환경에서 한계가 있음을 강조하며, 실용적인 시스템 엔지니어링 관점의 접근이 필요함을 역설합니다.
- **"제로 터치" ML의 비전**: 수동 유지보수 없이 모델이 스스로 적응하고 진화하는 "제로 터치" ML 시스템은 기술 부채를 줄이고 운영 효율성을 극대화하는 중요한 목표임을 시사합니다.
- **점진적 도입의 유연성**: 제안된 아키텍처는 모듈식으로 설계되어, 기존 프로덕션 파이프라인을 가진 팀도 컴포넌트들을 단계적으로 도입할 수 있어 실제 적용의 장벽을 낮춥니다.
- **지속적 학습의 기반**: 이 아키텍처는 완전한 의미의 지속적 학습(continual learning) 시스템으로 나아가기 위한 중요한 발판을 제공하며, 지능형 시스템의 궁극적인 목표에 도달하기 위한 필수적인 단계로 여겨집니다.
- **남아있는 도전 과제**: 각 컴포넌트의 구현은 상당한 공학적 및 과학적 노력을 요구하며, 특히 최적의 재훈련 주기 결정, 강화 학습 기반 정책 학습 등은 여전히 활발한 연구 영역입니다.

## 📌 TL;DR

이 논문은 프로덕션 환경에서 ML 모델이 진화하는 데이터에 자동으로 적응하고 스스로 유지보수되도록 하는 **자체 적응형 ML(Auto-Adaptive ML) 시스템을 위한 참조 아키텍처**를 제시합니다. 데이터 모니터링, 예측 모니터링, 정책 엔진, 스트리밍 처리, 데이터 압축 및 자원 관리를 포함하는 모듈식 컴포넌트들을 통해 데이터 드리프트와 같은 변화에 대응하고, 필요에 따라 모델을 재훈련하며, 궁극적으로 수동 개입을 최소화하는 "제로 터치" ML을 목표로 합니다. 이는 ML 시스템의 장기적인 안정성과 효율성을 위한 실질적인 토대를 제공합니다.
