# Continuous PPG-Based Blood Pressure Monitoring Using Multi-Linear Regression

Serj Haddad, Assim Boukhayma, and Antonino Caizzone

## 🧩 Problem to Solve

고혈압은 전 세계적으로 심혈관 질환의 주요 위험 요인이자 조기 사망의 주요 원인입니다. "침묵의 살인자"라고 불리는 고혈압은 종종 무증상이므로, 정확하고 장기적이며 지속적인 혈압 모니터링이 필수적입니다. 현재의 혈압 측정 방법들은 다음과 같은 한계를 가집니다:

- **침습적 동맥선(Arterial line)**: 지속적이고 정확하지만, 일상적인 사용에는 부적합한 침습적 방법입니다.
- **커프 기반(Cuff-based) 측정**: 비침습적 황금 표준이지만, 간헐적인 측정 방식이며 혈류를 폐색시켜 불편함과 통증을 유발하여 지속적인 모니터링(특히 수면 중)을 방해합니다.
- **기존 PPG(Photoplethysmography) 기반 방법의 한계**:
  - **맥파 속도(PWV) 기반**: 보조 센서(예: ECG)가 필요하며, 말초 동맥의 탄성 부족으로 인해 성능이 저하될 수 있습니다.
  - **맥파 분석(PWA) 기반**: 특징 식별, 정확한 특징 추출, 다양한 데이터셋에 걸쳐 일반화 가능한 혈압 매핑 모델 구축에 어려움이 있습니다. 특히, 회귀 모델 훈련을 위한 데이터셋 선택이 일반화 성능에 중요합니다.

따라서, 저렴하고, 비침습적이며, 편안하고, 임상적으로 수용 가능한 수준의 정확도를 갖는 지속적인 혈압 모니터링 솔루션 개발이 필요합니다.

## ✨ Key Contributions

- 단일 광혈류량 측정(PPG) 신호만을 사용하여 수축기 혈압(SBP) 및 이완기 혈압(DBP)을 지속적으로 추정하는 혈압 모니터링 알고리즘(PPG-BPM)을 제안합니다.
- PPG 신호의 형태학적 특징을 추출하고 이를 다중 선형 회귀(MLR) 모델을 통해 SBP 및 DBP 값에 매핑하는 맥파 분석(PWA) 기반 접근 방식을 활용합니다.
- 공개 데이터베이스인 MIMIC I 데이터셋에 대한 광범위한 평가를 통해 SBP에 대해 평균 절대 오차(MAE) $6.10$ mmHg, 오차 표준 편차(SDE) $8.08$ mmHg, DBP에 대해 MAE $4.65$ mmHg, SDE $6.22$ mmHg를 달성합니다.
- 혈압 분류(고혈압/정상혈압)에서 $88.14 \%$의 정확도, $79.11 \%$의 민감도, $92.37 \%$의 특이도를 보입니다.
- MLR 모델 훈련에 MIMIC I 데이터의 극히 일부(28개 레코드 중 2개, 총 데이터의 $5.68 \%$)만을 사용하여 구축했음에도 불구하고, 다양한 피험자 및 혈압 그룹에 걸쳐 우수한 일반화 성능을 입증합니다.
- 심박수(HR) 변화에 독립적으로 혈압을 정확하게 추정할 수 있음을 보여주며, 이는 HR이 혈압의 신뢰할 수 있는 대안이 될 수 없음을 강조합니다.
- University of Queensland Vital Signs 데이터셋을 사용하여 커프 기반 측정값과 비교했을 때, ISO/ANSI/AAMI 프로토콜 요구사항($5 \pm 8$ mmHg)에 근접한 성능을 달성하여 임상적 유용성을 시사합니다.

## 📎 Related Works

- **직접적인 혈압 측정 방법**:
  - **동맥선(Arterial line)**: 지속적이고 매우 정확하지만 침습적이며, 중환자실과 같은 특정 임상 환경에만 적합합니다.
  - **커프 기반(Cuff-based)**: 청진법 또는 오실로메트릭(oscillometric) 방법으로, 비침습적 황금 표준이지만 간헐적인 측정만 가능하고 혈류 폐색으로 인한 불편함이 있습니다 [2], [3].
- **PPG 기반 혈압 추정 방법**:
  - **맥파 속도(Pulse Wave Velocity, PWV) 기술**: 동맥 경직도와 혈압 간의 관계를 활용하여 맥파 전파 속도를 추정합니다.
    - **맥파 전파 시간(Pulse Transit Time, PTT)**: 두 PPG 센서 사이의 시간 지연으로 PWV를 추정합니다 [14]–[16].
    - **맥파 도달 시간(Pulse Arrival Time, PAT)**: ECG의 R-피크에서 말초 맥파 도달까지의 시간으로, PTT와 심장 수축 전 기간(PEP)을 포함합니다 [17], [18].
    - **한계**: 말초 동맥에서의 성능 저하, ECG와 같은 보조 센서가 필요하여 실용성이 제한됩니다.
  - **맥파 분석(Pulse Wave Analysis, PWA) 방법**: 단일 PPG 신호만을 사용하여 맥파 형태학적 특징을 분석하여 혈압을 추정합니다 [20], [21].
    - **특징 추출**: 다양한 시간 관련 및 진폭 관련 특징이 제안되었습니다 [22], [23].
    - **특징 매핑**: 추출된 특징을 혈압 값에 매핑하기 위해 다중 선형 회귀(MLR) [24], [25], 인공 신경망(ANN) [26], [27], 서포트 벡터 머신(SVM) [28], 랜덤 포레스트(RF) [24] 등이 사용됩니다.
    - **최근 동향**: 딥러닝(DNN) [29]을 활용하여 명시적인 특징 추출 없이 원시 PPG 신호에서 직접 혈압을 추정하는 연구도 진행되고 있습니다.

## 🛠️ Methodology

제안하는 PPG-BPM 알고리즘은 크게 세 가지 블록으로 구성됩니다.

1. **신호 전처리 및 데이터 분할 (Signal Pre-processing & Data Segmentation)**
   - **데이터셋**: MIMIC I 데이터베이스에서 28개 레코드(총 72개 중, 잡음 없고, 비정상적이지 않으며, 알고리즘이 최소 15분 이상의 BP를 추정할 수 있는 레코드)를 사용합니다. 또한 University of Queensland Vital Signs (QUD) 데이터셋도 커프 기반 측정값과의 비교를 위해 활용됩니다.
   - **PPG 신호 필터링**: 원시 PPG 신호(MIMIC I에서는 이미 필터링되어 있음)를 $0.3$ Hz와 $4.5$ Hz 사이의 대역 통과 필터로 처리합니다.
   - **맥파 식별**: [7]에 제시된 beat-to-beat 감지 알고리즘을 사용하여 PPG 맥파를 식별하고, 각 맥파에 신호 품질 지수(SQI)를 할당합니다.
   - **참조 BP 생성**: ABP 신호의 피크(SBP)와 피크 사이의 최소값(DBP)을 검출하여 참조 혈압 데이터를 생성합니다.
   - **에포크(Epoch) 분할**: PPG 신호를 30초 간격의 에포크로 나눕니다. 고품질 PPG 맥파 수가 특정 임계값 이상이고 맥파 폭 변동이 다른 임계값 이하인 에포크만 "깨끗한(clean)" 에포크로 분류하여 다음 단계로 넘깁니다.
2. **에포크 맥파 생성기 (Epoch Pulse Generator)**
   - "깨끗한" 에포크 내의 고품질 PPG 맥파들을 진폭이 1이 되도록 정규화하고 200개 포인트로 재샘플링합니다.
   - 이 재샘플링된 정규화 PPG 맥파들을 중첩하여 해당 에포크를 대표하는 하나의 에포크 PPG 파형을 생성합니다.
3. **특징 추출 (Feature Extraction)**
   - 생성된 에포크 PPG 파형에서 시간 관련 및 진폭 관련 특징을 포함하여 총 27개의 특징을 추출합니다.
   - 이 중 16개 특징은 PPG 파형 자체의 **6개 특징점**(**최대 기울기, 수축기 피크, 반 진폭 지점, 이첨흔, 변곡점, 이완기 피크**)을 기반으로 추출됩니다.
   - 나머지 11개 특징은 **PPG 파형의 2차 미분**(APPG 또는 PPG'')의 **5개 특징점**(a, b, c, d, e 파형)을 기반으로 추출됩니다 [23].
4. **특징 매핑 (Feature Mapping)**
   - 추출된 특징들을 SBP 및 DBP 값에 매핑하기 위해 **다중 선형 회귀(MLR)** 모델을 구축합니다.
   - **MLR 모델 훈련**:
     - MIMIC I 데이터셋 중 깨끗한 ABP 및 PPG 데이터, 충분한 혈압 변동성, 그리고 다른 데이터셋에 대한 좋은 일반화 성능을 고려하여 레코드 041과 427 (전체 MIMIC I 데이터의 $5.68 \%$) 두 개만을 사용하여 MLR 계수를 생성합니다.
     - **반복적 접근 방식**:
       - 1단계: 레코드 041 데이터를 사용하여 평균 제곱 오차를 최소화하는 MLR 파라미터 $\vec{\gamma_1}$을 계산합니다.
       - 2단계: $\vec{\gamma_1}$ 모델을 레코드 427에 적용하여 추정된 SBP 값과 실제 SBP 값 간의 일정한 오프셋을 계산합니다.
       - 3단계: 이 오프셋을 보상하여 레코드 041과 427 데이터를 모두 사용하여 새로운 MLR 파라미터 $\vec{\gamma_2}$를 계산합니다. 이 $\vec{\gamma_2}$가 모든 데이터셋에 적용되는 최종 MLR 모델 파라미터가 됩니다. DBP 모델도 동일한 방식으로 구축됩니다.
   - **교정 (Calibration)**:
     - **제로-평균 교정 (MIMIC I)**: 추정된 BP 값의 평균 오차(ME)가 0이 되도록 SBP 및 DBP 오프셋을 적용합니다.
     - **시작점 교정 (QUD)**: 첫 번째 커프 기반 SBP 및 DBP 측정값을 기준으로 오프셋을 적용합니다.

## 📊 Results

- **전반적인 성능 평가 (MIMIC I, 47,153개 30초 에포크)**:
  - **SBP**:
    - 평균 오차 (ME): $0.0 \pm 8.08$ mmHg
    - 평균 절대 오차 (MAE): $6.10$ mmHg
    - 오차 표준 편차 (SDE): $8.08$ mmHg
    - 절대 오차 $\le 10$ mmHg 비율: $82.61 \%$
    - Pearson 상관 계수 $r=0.90$, $p < .001$
  - **DBP**:
    - 평균 오차 (ME): $0.0 \pm 6.22$ mmHg
    - 평균 절대 오차 (MAE): $4.65$ mmHg
    - 오차 표준 편차 (SDE): $6.22$ mmHg
    - 절대 오차 $\le 10$ mmHg 비율: $90.71 \%$
    - Pearson 상관 계수 $r=0.85$, $p < .001$
  - **MBP**: MAE $4.32$ mmHg, SDE $5.75$ mmHg.
- **개별 피험자별 성능 평가 (MIMIC I)**: 대부분의 레코드에서 SBP MAE $\approx 6$ mmHg, SDE $\approx 8$ mmHg; DBP MAE $\approx 4.5$ mmHg, SDE $\approx 6$ mmHg로 전반적인 성능과 유사하게 일관된 성능을 보입니다.
- **분류 결과 (MIMIC I, 고혈압: SBP $\ge 130$ mmHg 및/또는 DBP $\ge 80$ mmHg)**:
  - 정확도 (Accuracy): $88.14 \%$
  - 특이도 (Specificity): $92.37 \%$
  - 민감도 (Sensitivity): $79.11 \%$
  - 정밀도 (Precision): $82.93 \%$
- **혈압 그룹별 성능 (MIMIC I)**:
  - 고혈압 그룹과 비고혈압 그룹 모두에서 좋은 성능을 보였으며, 비고혈압 그룹에서 약간 더 나은 성능을 달성합니다 (고혈압은 PPG 형태를 악화시켜 특징 추출이 더 어려울 수 있음).
- **커프 기반 측정값과의 성능 비교 (QUD, 1,709개 에포크)**:
  - **SBP**: ME $1.50 \pm 8.80$ mmHg, MAE $6.70$ mmHg, 절대 오차 $\le 10$ mmHg 비율 $76.75 \%$
  - **DBP**: ME $0.40 \pm 8.00$ mmHg, MAE $6.64$ mmHg, 절대 오차 $\le 10$ mmHg 비율 $80.45 \%$
  - ISO/ANSI/AAMI 프로토콜 요구사항($5 \pm 8$ mmHg)에 매우 근접하는 정확도를 달성했습니다.

## 🧠 Insights & Discussion

- **알고리즘의 강점**:
  - **단일 PPG 기반**: ECG와 같은 보조 센서 없이 단일 PPG 신호만으로 지속적인 혈압 모니터링이 가능하여 웨어러블 기기 및 스마트폰과 같은 장치에 통합하기 용이합니다.
  - **강력한 일반화 성능**: MLR 모델 훈련에 MIMIC I 데이터의 극히 일부(총 데이터의 $5.68 \%$인 단 2개 레코드)만을 사용했음에도 불구하고, 다양한 피험자와 혈압 그룹에 걸쳐 우수한 성능을 보입니다. 이는 모델의 견고성을 시사합니다.
  - **임상적 유용성**: MIMIC I 및 QUD 데이터셋 모두에서 MAE 및 SDE가 ISO/ANSI/AAMI 프로토콜 요구사항($5 \pm 8$ mmHg)에 근접하는 우수한 정확도를 달성하여 임상적 적용 가능성이 높습니다.
  - **심박수 독립성**: 혈압 추정 알고리즘이 심박수(HR) 변화에 편향되지 않고 혈압을 독립적으로 정확하게 추정할 수 있음을 입증합니다. 이는 HR이 혈압의 신뢰할 수 있는 대안이 될 수 없다는 점을 고려할 때 중요합니다.
  - **고혈압 조기 감지 잠재력**: 고혈압 분류에서 $88.14 \%$의 높은 정확도를 보여, 혈압 상승을 조기에 감지하고 잠재적인 합병증을 예방하는 데 기여할 수 있습니다.
- **한계 및 시사점**:
  - **교정 필요성**: 알고리즘은 "제로-평균 교정" 또는 "시작점 교정"과 같은 초기 교정 과정을 통해 오프셋을 보상해야 합니다. 이는 진정한 무교정(calibration-free) 시스템을 목표로 한다면 해결해야 할 과제입니다.
  - **고혈압 그룹 성능**: 고혈압 그룹에서 비고혈압 그룹보다 약간 낮은 성능을 보인다는 점은 고혈압이 PPG 파형 형태를 변형시켜 특징 추출을 더 어렵게 만들 수 있음을 시사하며, 이는 향후 연구에서 개선될 수 있는 부분입니다.
  - **개인 정보 활용**: 현재 알고리즘은 피험자의 나이, 몸무게, BMI, 성별 등 개인 정보를 입력으로 사용하지 않습니다. 이러한 정보를 활용하면 모델의 개인화 및 정확도 향상에 기여할 수 있습니다.

## 📌 TL;DR

이 논문은 단일 광혈류량 측정(PPG) 신호를 사용하여 수축기 및 이완기 혈압(SBP, DBP)을 비침습적으로 지속 모니터링하는 알고리즘(PPG-BPM)을 제안합니다. 제안된 방법론은 PPG 파형에서 형태학적 특징을 추출하고 이를 다중 선형 회귀(MLR) 모델을 통해 SBP와 DBP 값에 매핑하는 맥파 분석(PWA)에 기반합니다. MIMIC I 데이터셋으로 평가한 결과, SBP에 대해 $0.0 \pm 8.08$ mmHg의 평균 오차와 $6.10$ mmHg의 평균 절대 오차를, DBP에 대해 $0.0 \pm 6.22$ mmHg의 평균 오차와 $4.65$ mmHg의 평균 절대 오차를 달성했습니다. 또한, 고혈압 분류에서 $88.14 \%$의 정확도를 보였으며, University of Queensland Vital Signs 데이터셋을 통한 커프 기반 측정값과의 비교에서도 ISO/ANSI/AAMI 프로토콜 기준에 근접하는 우수한 성능을 입증했습니다. 이 연구는 정확하고 비침습적인 지속 혈압 모니터링 시스템의 필요성을 충족시키며 고혈압 관리에 중요한 기여를 할 수 있음을 보여줍니다.
