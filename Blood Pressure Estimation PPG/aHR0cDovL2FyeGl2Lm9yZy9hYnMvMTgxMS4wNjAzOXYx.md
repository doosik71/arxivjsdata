# Photoplethysmography를 이용한 동맥 혈압 특징 추정

Armin Soltan Zadi, Raichel Alex, Rong Zhang, Donald E. Watenpaugh, Khosrow Behbehani

## 🧩 Problem to Solve

혈압의 연속적이고 비침습적인 모니터링은 임상 및 피트니스 분야에서 중요하지만, 기존 방법들은 침습적이거나 고가의 장비가 필요하며, 간헐적이거나 잦은 보정이 필요하고 움직임 아티팩트에 취약합니다. 특히 광혈류측정(PPG) 신호만을 사용하여 심전도(ECG)와 같은 추가 장비 없이도 혈압 변화를 정확하게 추정하는 방법은 여전히 제한적입니다. PPG 단독 방법 중 회귀 모델은 이완기 혈압(DBP) 추정 성능이 낮고 기억력이 없으며, 푸리에 분석은 비정상적인 생리 시스템에 적용하기 어렵다는 한계가 있습니다. 따라서 본 연구는 PPG 신호만을 이용하여 동적 환경에서도 수축기 혈압(SBP) 및 DBP와 평균 동맥압(MAP)을 정확하고 연속적으로 추정할 수 있는 새로운 방법을 모색합니다.

## ✨ Key Contributions

* **ARMA 모델 기반 혈압 추정:** PPG 신호의 피크와 트로프를 입력으로 하는 5차 자기회귀이동평균(ARMA) 모델을 사용하여 SBP 및 DBP를 연속적으로 추정하는 방법을 제안하고, 이를 통해 MAP를 계산했습니다.
* **높은 추정 정확도:** 정상 호흡(NB)과 숨 참기(BH) 조건 모두에서 모델 추정 오차가 낮음(rMSE $< 5$ mmHg). 특히, 숨 참기 중 혈압의 동적 변화를 모델이 효과적으로 추적함을 입증했습니다.
* **모델 일관성:** 15명의 피험자 데이터를 분석한 결과, 모델 간의 유의미한 차이가 1% 미만으로 나타나 제안된 모델의 높은 일관성과 일반화 가능성을 시사합니다.
* **기존 방법 대비 우위:** 맥파 전달 시간(PTT)을 사용하는 기존 방법이나 다른 PPG 단독 방법에 비해 경쟁력 있는 또는 더 우수한 정확도를 달성했습니다.
* **임상적 적용 가능성:** 수면 무호흡증과 같은 생리적 교란 시 야간 혈압 모니터링 등 특정 임상 응용 분야에서의 잠재적 가치를 제시합니다.

## 📎 Related Works

* **커프 기반 혈압 측정:** 정확하고 신뢰성 높지만 불연속적.
* **혈관 언로딩 방법 (예: Finapres):** 연속적이지만 잦은 보정, 핑거 커프의 불편함 등의 단점.
* **압평 측정법 (Tonometry):** 커프의 단점이 없으나 고정의 어려움 및 움직임 아티팩트에 민감.
* **맥파 전달 시간(PTT) 기반 방법:** PPG와 ECG 신호가 모두 필요하며, 추가 장비, 동기화 문제, 동적 환경에서의 신뢰성 부족 등의 한계가 있음.
* **PPG 단독 회귀 모델:** SBP 추정에는 유망하나 DBP 추정 성능이 낮고 기억력이 없어 PPG와 BP 간 지연 모델링 불가.
* **푸리에 도메인 분석:** 정지 시스템 모델링에 적합하나 BP 및 PPG의 비정상성으로 적용 제한적이며 계산 복잡성 높음.
* **Windkessel 모델 기반:** PPG 특징으로부터 모델 파라미터 추정.
* **ARMA 모델:** 입력과 출력 간의 동적 관계 및 순수 시간 지연을 모델링할 수 있어 생리 시스템 분석에 유망.

## 🛠️ Methodology

1. **데이터 수집:**
    * 15명의 젊고 건강한 피험자로부터 Finapres NOVA 모니터로 BP를, Nellcor OxiMax N-600x 모니터로 PPG 신호를 100 Hz로 동시 수집.
    * 실험 프로토콜은 앙와위에서 60초 정상 호흡(NB), 5회의 최대 숨 참기(BH) (각 BH 사이에 90초 회복), 마지막 60초 NB로 구성.
2. **BP 특징 추출:**
    * 측정된 SBP는 MATLAB의 `findpeaks` 알고리즘을 사용하여 추출.
    * DBP는 연속된 SBP 사이의 최소값으로 정의.
    * MAP는 SBP와 DBP로부터 다음 식을 사용하여 계산:
        $$ \text{MAP} = \frac{2 \times \text{DBP} + \text{SBP}}{3} $$
3. **ARMA 모델링:**
    * PPG 파형의 피크는 SBP 모델링의 입력으로, 트로프는 DBP 모델링의 입력으로 사용.
    * 단일 입력-단일 출력(SISO) 시변 ARMA 모델을 적용:
        $$ y(m) + a_1 y(m-1) + \dots + a_{n_a} y(m-n_a) = b_1 u(m-n_k) + \dots + b_{n_b} u(m-n_b-n_k+1) + e(m) $$
        여기서 $y$는 출력(BP), $u$는 입력(PPG), $m$은 샘플 번호, $a_i$와 $b_j$는 모델 파라미터. $n_a, n_b$는 모델 차수, $n_k$는 순수 시간 지연 샘플 수.
    * 모델 차수($n_a, n_b$)는 1에서 5까지, 시간 지연($n_k$)은 0에서 5까지 설정되었으며, 최소 제곱 오차 및 Akaike 정보 기준(AIC)을 바탕으로 최적 모델이 선택되었습니다.
    * 각 피험자의 11개(6 NB, 5 BH) 구간에 대해 SBP 및 DBP 모델을 개별적으로 식별했습니다.
    * ARMA 모델 적용을 위해 SBP, DBP, MAP 값을 100 Hz로 보간하기 위해 큐빅 스플라인 보간법 사용.
4. **모델 및 예측 오차 평가:**
    * **모델 오차:** 모델이 훈련된 동일한 데이터 세트에 대한 예측 정확도를 평가.
    * **예측 오차:** 한 구간(예: BH1)에서 도출된 모델이 다른 유사한 구간(예: BH2)의 BP를 예측하는 능력을 평가.
    * 오차는 제곱근 평균 제곱 오차(rMSE)를 사용하여 정량화되었습니다.
    * 모델 간의 일관성은 분산 분석(ANOVA)과 다중 비교($p < 0.05$)를 통해 평가되었습니다.

## 📊 Results

* **모델 오차 (rMSE):**
  * 정상 호흡(NB) 구간에서 SBP $3.953 \sim 4.692$ mmHg, DBP $2.969 \sim 3.495$ mmHg, MAP $3.025 \sim 3.354$ mmHg를 기록하여 모든 BP 특징에 대해 $5$ mmHg 미만의 우수한 정확도를 보였습니다 (표 I).
  * 숨 참기(BH) 구간에서도 SBP $4.190 \sim 4.935$ mmHg, DBP $2.884 \sim 3.294$ mmHg, MAP $2.842 \sim 3.271$ mmHg로 모든 BP 특징에 대해 $5$ mmHg 미만의 오차를 보였습니다 (표 II).
* **예측 오차 (rMSE):**
  * NB 모델이 다른 NB 구간을 예측하는 경우 SBP $6.582 \sim 8.137$ mmHg, DBP $4.013 \sim 6.439$ mmHg, MAP $4.224 \sim 5.847$ mmHg (표 III).
  * BH 모델이 다른 BH 구간을 예측하는 경우 SBP $6.481 \sim 7.944$ mmHg, DBP $4.239 \sim 4.652$ mmHg, MAP $4.225 \sim 4.655$ mmHg (표 IV).
  * 예측 오차의 rMSE 값은 최대 약 $8$ mmHg로, 모델 오차보다는 높았지만 여전히 실용적인 수준이었습니다.
* **모델 오차 및 예측 오차의 평균:** NB 구간의 추정 오차 평균은 대부분 $\pm 2$ mmHg 이내, BH 구간은 $\pm 2$ mmHg 이내로 나타났습니다.
* **모델 간 일관성:** 1260개의 오차 평균 비교 중 단 9개($0.71$%)만이 통계적으로 유의미한 차이($p < 0.05$)를 보여, 제안된 모델의 피험자 간 높은 일관성을 입증했습니다 (표 V). 유의미한 차이는 주로 숨 참기 구간에서 SBP 및 MAP 관련 오차에서 발생했습니다.

## 🧠 Insights & Discussion

본 연구 결과는 PPG 신호를 이용한 ARMA 모델이 SBP, DBP, MAP와 같은 주요 혈압 특징을 연속적으로 추정하는 데 매우 효과적임을 보여줍니다. 모델은 정상 호흡과 숨 참기 중 혈압의 장기적 추세와 고주파 변동을 모두 성공적으로 추적했습니다. rMSE가 모델 오차의 경우 $5$ mmHg 미만, 예측 오차의 경우 $8$ mmHg 미만으로 나타나, 이는 PTT 기반 방법이나 다른 PPG 단독 방법에 비해 경쟁력 있는 정확도입니다. 특히, 모델 오차의 평균이 $3.2$ mmHg 미만으로 낮게 나타난 것은 중요한 성과입니다.

모델의 일관성은 모든 피험자 데이터에 걸쳐 오차 평균의 1% 미만만이 유의미한 차이를 보였음을 통해 입증되었습니다. 이는 제안된 모델 구조가 다양한 피험자에게 적용될 수 있음을 시사합니다. 숨 참기 중 혈압 변화의 강도 차이로 인해 일부 예측 오차에서 차이가 발생했지만, 이는 전반적인 모델의 견고성을 해치지 않습니다.

향후 연구는 웨어러블 장치에 구현하기 위한 모션 아티팩트 제거, 광범위한 인구 집단에 대한 검증, 그리고 생리학적 시스템의 개인적 차이를 반영한 개인 맞춤형 모델 개발, 비선형 모델링으로의 확장 등을 포함할 수 있습니다. 본 방법은 수면 무호흡증과 같은 임상 환경에서 야간 혈압 모니터링과 같은 장기적인 심혈관 건강 모니터링에 크게 기여할 잠재력을 가지고 있습니다.

## 📌 TL;DR

이 연구는 PPG 신호의 피크와 트로프를 입력으로 하는 5차 ARMA 모델을 사용하여 동맥 혈압(SBP, DBP, MAP)을 비침습적이고 연속적으로 추정하는 방법을 제안합니다. 정상 호흡과 숨 참기 조건 모두에서 모델 추정 오차가 $5$ mmHg 미만, 예측 오차는 $8$ mmHg 미만의 rMSE를 달성하며 높은 정확도를 보였습니다. 또한, 모델의 오차 평균이 피험자 간에 거의 차이가 없어(1% 미만 유의미한 차이) 높은 일관성을 입증했으며, 이는 심혈관 모니터링을 위한 강력한 임상 적용 가능성을 시사합니다.
