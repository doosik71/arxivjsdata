# Deep Transformation Model

Tong Wang, Shunqin Zhang, Sanguo Zhang, Jian Huang, Shuangge Ma

## 해결할 문제

기존의 심층 신경망(DNN) 기술들은 대부분 제한적인 모델 형식과 가정을 가지고 있어 모델 오지정(model mis-specification)에 취약하며, 이상치(outlier)나 두꺼운 꼬리(heavy-tailed) 오차에 대한 강건성(robustness)이 부족합니다. 또한, 예측 변수(predictor)의 수가 많거나 잡음 변수가 존재하는 고차원 시나리오에서 DNN의 해석 가능성과 안정성을 높이기 위한 효과적인 변수 선택(variable selection) 방법론이 부족하며, 중도 절단된 생존 데이터(censored survival data)를 일관되게 다룰 수 있는 DNN 모델이 제한적입니다. 마지막으로, 제안되는 DNN 모델 및 추정 방법론에 대한 엄격한 이론적 토대 마련이 필요합니다.

## 주요 기여

- **비모수 심층 변환 모델 제안**: 다양한 인기 모델을 특수 사례로 포괄하여 모델 오지정에 덜 민감하고 두꺼운 꼬리 오차를 수용할 수 있는 강건한 심층 변환 모델을 제안합니다.
- **새로운 순위 기반 손실 함수 개발**: 기존 DNN 추정 방식과 근본적으로 다른 순위 기반 손실 함수를 개발하여 강건성과 예측 성능을 향상시킵니다.
- **이중 정류 선형 단위 (DReLU) 기반 추정기 도입**: 계산 효율성을 위해 지시 함수(indicator function)를 근사하는 새로운 DReLU 함수를 제안하고, 이를 활용한 추정 방법을 개발합니다.
- **그룹 페널티 기반 변수 선택 기법 적용**: 입력 변수의 수가 증가하는 시나리오에서 중요한 변수를 식별하기 위해 그룹 페널티를 적용하는 변수 선택 방법을 제시합니다.
- **중도 절단된 생존 데이터 처리 확장**: 동일한 프레임워크 내에서 중도 절단된 생존 데이터를 일관성 있게 처리할 수 있도록 모델을 확장합니다.
- **엄격한 이론적 속성 확립**: 제안된 방법의 식별 가능성(identifiability)과 추정 및 변수 선택 일관성(consistency)을 수학적으로 엄격하게 증명하여 견고한 이론적 기반을 제공합니다.
- **실용적 유용성 입증**: 광범위한 수치 연구(시뮬레이션 및 데이터 분석)를 통해 제안된 방법의 만족스러운 실용적 유용성을 확인합니다.

## 방법론

1. **비모수 변환 모델($Y = D \circ F(f^*(X), \epsilon)$) 정의**:

   - $X \in \mathbb{R}^{p}$는 예측 변수, $Y \in \mathbb{R}$는 반응 변수입니다.
   - $D: \mathbb{R} \to \mathcal{Y}$는 비퇴화 증가 함수, $F: \mathbb{R}^{2} \to \mathbb{R}$은 각 좌표에 대해 엄격하게 증가하는 함수입니다.
   - $f^*: \mathcal{X} \to \mathbb{R}$는 목표 함수이며, $\epsilon$은 $X$와 독립적인 무작위 변수입니다.
   - 이 모델은 선형, 일반화 선형, 단일 지수, 다중 지수, 비모수 회귀, 가산 회귀, Cox 모델 등 다양한 기존 모델을 포괄하여 모델 오지정에 덜 민감합니다.

2. **심층 순위 추정 (Deep Rank Estimation)**:

   - $(X_i, Y_i)$의 독립 동일 분포(i.i.d.) 표본 $\{(X_i, Y_i)\}_{i=1}^{n}$을 사용합니다.
   - **순위 기반 목적 함수**: $Y$와 $f(X)$ 사이의 순위 상관(rank correlation)을 측정하는 다음 목적 함수를 최대화합니다.
     $$U_n(f) = \frac{1}{n(n-1)}\sum_{i \neq j} I(Y_i > Y_j)I(f(X_i) > f(X_j))$$
     여기서 $I(\cdot)$는 지시 함수입니다.
   - **추정기**: 순방향 신경망(FNN) $f_{\theta}$를 사용하여 목적 함수를 최대화하는 $\hat{f}_{\theta}$를 찾습니다.

3. **심층 이중 정류 선형 단위 (DReLU) 근사**:

   - 계산 효율성을 위해 지시 함수 $I(u > 0)$를 다음과 같은 DReLU 함수로 근사합니다.
     $$S_{\omega_n}(u) = \sigma(u/\omega_n + 1/2) - \sigma(u/\omega_n - 1/2), \quad u \in \mathbb{R}$$
     여기서 $\sigma(\cdot) = \max(\cdot, 0)$는 ReLU 활성화 함수이며, $\omega_n$은 작은 양수 튜닝 매개변수입니다.
   - 이 근사는 vanishing gradient 문제를 회피하고 계산 비용이 낮습니다.
   - **근사 목적 함수**: 근사된 목적 함수 $U_{n, \omega_n}(f)$를 사용하여 추정기 $\hat{f}_{\theta}^{\omega_n}$를 구합니다.

4. **구현 (Implementation)**:

   - $f_{\theta}: \mathbb{R}^{p} \to \mathbb{R}$는 ReLU 활성화 함수를 사용하는 다층 순방향 신경망(FNN)으로 구현됩니다.
   - 네트워크 매개변수 $\theta = \{(W_i, b_i) : i = 0, 1, \dots, L\}$는 가중치 행렬과 편향 벡터를 포함합니다.
   - **학습 과정**: Algorithm 1에 제시된 확률적 경사 상승(stochastic gradient ascent) 알고리즘 (Adam)을 사용하여 매개변수를 업데이트합니다.
   - 오버피팅 방지 및 효율성 향상을 위해 가중치 감쇠(weight decay), 조기 종료(early stopping), 학습률 감쇠(learning rate decay), 무작위 드롭아웃(random dropout)과 같은 전략을 사용합니다.

5. **페널티 기반 변수 선택**:

   - 첫 번째 계층 가중치 행렬 $W_0(\theta)$의 열 벡터 $W_{0,q}(\theta)$ ($q$-번째 예측 변수에 해당)에 그룹 Lasso 페널티를 적용하여 변수 선택을 수행합니다.
   - **페널티 목적 함수**: $\lambda_n \sum_{q=1}^{p} \|W_{0,q}(\theta)\|_2$를 기존 목적 함수에서 뺀 것을 최대화합니다.
     $$U_{n, \lambda_n}(f_{\theta}) = \frac{1}{n(n-1)}\sum_{i \neq j} I(Y_i > Y_j)I(f_{\theta}(X_i) > f_{\theta}(X_j)) - \lambda_n\sum_{q=1}^{p} \|W_{0,q}(\theta)\|_2$$
     (DReLU 근사 버전에 대해서도 유사하게 정의됩니다.)

6. **중도 절단된 생존 데이터 처리**:
   - 관측값 $(X_i, Y_i, \Delta_i)$에서 $Y_i = \min(T_i, C_i)$는 관측 시간, $\Delta_i = I(T_i \le C_i)$는 사건 지시자입니다.
   - 모델 $T = D \circ F(f^*(X), \epsilon)$을 고려하며, 목적 함수는 중도 절단 지시자 $\Delta_j$를 포함하도록 수정됩니다.
     $$U_n^c(f) = \frac{1}{n(n-1)}\sum_{i \neq j} \Delta_j I(Y_i > Y_j)I(f(X_i) > f(X_j))$$

## 결과

- **통계적 속성**:

  - **식별 가능성**: 이론적 분석을 통해 제안된 목표 함수가 실제 목표 함수 $f^*$를 고유하게 식별함을 입증했습니다. 근사된 DReLU 추정기 또한 $\omega_n \to 0$일 때 $f^*$에 수렴함을 보였습니다.
  - **수렴 속도**:
    - 고정된 $p$에서 과잉 위험(excess risk)의 수렴 속도를 설정했습니다. DReLU 추정기는 비록 약간의 수렴 속도 손실이 있지만, 더 완화된 조건 하에서도 수렴을 달성할 수 있습니다.
    - $p$가 발산하는 고차원 설정에서 희소성(sparsity) 가정을 통해 수렴 속도를 증명했습니다. $p \ll n^{1/2}$ 조건에서 수렴이 가능함을 보였습니다.
  - **변수 선택 일관성**: 제안된 페널티 기반 방법이 중요한 변수와 중요하지 않은 변수를 올바르게 구별하는 일관성을 가짐을 증명했습니다. 중요한 변수에 연결된 가중치는 0에서 벗어나고, 중요하지 않은 변수에 연결된 가중치는 0으로 수렴함을 보였습니다.

- **시뮬레이션 연구**:

  - NN-LSE, NN-LAD, NN-Cauchy, NN-Huber, 고전적인 MRC(Maximum Rank Correlation) 등 다양한 기존 방법과 비교했습니다.
  - 제안된 방법은 단순한 데이터 생성 모델에서는 다른 방법들과 비슷한 성능을 보였지만, 모델 2-6과 같이 데이터 생성 메커니즘이 복잡할수록 **더 작은 예측 오차(MSE, LAD, Cauchy, Huber), 더 높은 Spearman 상관 계수 또는 C-idx, 더 높은 변수 식별 정확도**를 보이며 더 큰 이점을 나타냈습니다.
  - 특히, $D \circ F$가 항등 함수가 아닌 경우 (변환 모델의 이점), 다른 강건한 추정 방법보다 우수한 성능을 보였습니다.
  - 복잡한 비선형 관계를 포착하는 데 있어 '고전적인' MRC보다 훨씬 뛰어난 성능을 보였습니다.

- **실제 데이터 분석**:
  - Energy Prediction (연속 반응), Communities and Crime (연속 반응), METABRIC (중도 절단된 생존 반응), South German Credit (이진 반응), Wiki4HE (이진 반응)의 다섯 가지 다양한 유형의 데이터셋에 적용했습니다.
  - 결과는 제안된 방법이 **경쟁력 있는 예측 성능**을 제공함을 보여주었으며, 각 데이터셋에서 중요한 변수들을 성공적으로 식별했습니다.
