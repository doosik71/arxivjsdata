# Graph Transformers: A Survey

Ahsan Shehzad, Feng Xia, Shagufta Abid, Ciyuan Peng, Shuo Yu, Dongyu Zhang, and Karin Verspoor

## 🧩 Problem to Solve

그래프 트랜스포머(Graph Transformer)는 그래프 구조 데이터 처리에 강력한 성능을 보여주지만, 기존 연구는 최신 발전 사항, 포괄적인 응용 분야, 체계적인 분류법을 충분히 다루지 못했습니다. 이 설문 조사는 이러한 공백을 메우고 그래프 트랜스포머 연구의 현재 상태와 미래 방향에 대한 심층적인 개요를 제공하는 것을 목표로 합니다.

## ✨ Key Contributions

- 그래프 유도 바이어스(inductive bias) 및 그래프 어텐션 메커니즘을 포함한 그래프 트랜스포머의 설계 관점에 대한 포괄적인 검토를 제공합니다.
- 깊이(depth), 확장성(scalability), 사전 학습(pre-training) 전략을 기반으로 한 그래프 트랜스포머의 새로운 분류법(taxonomy)을 제안합니다.
- 다양한 그래프 학습 작업 및 NLP, CV와 같은 다른 영역에서의 그래프 트랜스포머 응용 관점을 정리합니다.
- 확장성 및 효율성, 일반화 및 견고성, 해석 가능성 및 설명 가능성, 동적 및 복잡한 그래프, 데이터 품질 및 다양성과 같은 그래프 트랜스포머 연구의 핵심적인 미해결 문제와 미래 방향을 제시합니다.

## 📎 Related Works

- **Chen et al. [18]:** 주로 CV 분야의 GNN 및 그래프 트랜스포머 활용에 초점을 맞췄지만, 그래프 트랜스포머 분류법이나 다른 도메인(예: NLP)은 다루지 않았습니다.
- **Müller et al. [12]:** 그래프 트랜스포머 및 이론적 특성에 대한 개요를 제공했지만, 기존 방법에 대한 포괄적인 검토나 다양한 작업에서의 성능 평가는 부족했습니다.
- **Min et al. [19]:** 그래프 트랜스포머의 아키텍처 설계 측면에 중점을 두었으나, 중요한 응용 분야나 미해결 과제는 다루지 않았습니다.

## 🛠️ Methodology

이 설문 조사는 그래프 트랜스포머를 설계 및 응용 관점에서 포괄적으로 분석합니다.

1. **기초 개념:** 그래프($G=(V, E)$), 인접 행렬 ($\mathbf{A} \in \mathbb{R}^{N \times N}$), 노드 특징 행렬 ($\mathbf{X} \in \mathbb{R}^{N \times d_n}$) 등 그래프 관련 표기법과 GNN의 메시지 전달(message-passing) 프레임워크를 설명합니다:
   $$h_{v}^{(l+1)} = \varphi \left( h_{v}^{(l)}, \bigoplus_{u \in \mathcal{N}(v)} f(h_{u}^{(l)}, h_{v}^{(l)}, e_{uv}) \right)$$
   또한 트랜스포머의 핵심 요소인 셀프 어텐션(Self-attention) 메커니즘을 정의합니다:
   $$\text{Attention}(\mathbf{Q}, \mathbf{K}, \mathbf{V}) = \text{softmax} \left( \frac{\mathbf{Q} \mathbf{K}^\top}{\sqrt{d_k}} \right) \mathbf{V}$$

2. **설계 관점:**

   - **그래프 유도 바이어스:** 비유클리드 그래프 데이터에 트랜스포머를 적용하기 위한 구조 정보 인코딩 방식을 설명합니다.
     - **노드 위치 바이어스:** 노드의 상대적/절대적 위치 정보를 제공 (예: 최단 경로 거리 기반 원-핫 벡터 $p_i = [I(d(i,j) = 1), ..., I(d(i,j) = \text{max})]$, Laplacian 고유 벡터 $p_i = [u_{i1}, ..., u_{ik}]$).
     - **에지 구조 바이어스:** 노드 거리, 에지 유형, 방향 등 복잡한 에지 정보를 인코딩 (예: 그래프 커널 $k(u,v) = \text{exp}(-\alpha d(u,v))$, 잔여 에지 채널 $\mathbf{R_e}$).
     - **메시지 전달 바이어스:** 그래프의 로컬 구조 학습을 촉진하기 위한 정보 교환. 전처리(preprocessing), 인터리빙(interleaving), 후처리(post-processing) 세 가지 통합 방식을 제시합니다.
     - **어텐션 바이어스:** 메시지 전달이나 위치 인코딩 없이 그래프 구조 정보를 어텐션 메커니즘에 직접 통합. 로컬 어텐션 바이어스($\alpha_{ij} \propto \text{exp}(g(x_i, x_j) \cdot b_{ij})$)와 글로벌 어텐션 바이어스($\alpha_{ij} \propto \text{exp}(g(x_i, x_j) + c(\mathbf{A}, \mathbf{D}, \mathbf{L}, \mathbf{P})_{ij})$)로 나뉩니다.
   - **그래프 어텐션 메커니즘:** 그래프의 노드와 에지에 동적으로 가변 가중치를 할당.
     - **글로벌 어텐션:** 그래프의 모든 노드에 걸쳐 어텐션 가중치를 계산. 이차(quadratic) 어텐션 (계산 복잡도 $O(N^2)$)과 선형(linear) 어텐션 (계산 복잡도 $O(N)$)으로 구분됩니다.
     - **로컬 어텐션:** 각 노드의 이웃 노드 부분집합에 대해 어텐션 가중치를 계산. 메시지 전달(message-passing) 어텐션 (계산 복잡도 $O(E)$)과 스펙트럼(spectral) 어텐션 (계산 복잡도 $O(N)$)으로 구분됩니다.

3. **그래프 트랜스포머 분류법:**

   - **얕은(Shallow) 그래프 트랜스포머:** 적은 수의 레이어로 노드 임베딩을 학습, 계산 효율성에 중점. GAT의 확장으로 볼 수 있습니다.
   - **깊은(Deep) 그래프 트랜스포머:** 여러 셀프 어텐션 레이어를 쌓아 복잡하고 표현력 있는 특징 학습. 과평활화(over-smoothing) 문제와 학습 난이도 해결이 중요합니다.
   - **확장 가능한(Scalable) 그래프 트랜스포머:** 대규모 그래프에서 효율적인 처리를 위해 희소 어텐션(sparse attention), 로컬 어텐션, 저랭크 근사(low-rank approximation) 등 기법을 활용합니다.
   - **사전 학습된(Pre-trained) 그래프 트랜스포머:** 대규모 비레이블 그래프에서 일반적인 특징을 학습하여 특정 다운스트림 작업에 미세 조정(fine-tuning)합니다.

4. **효과적인 그래프 트랜스포머 설계를 위한 가이드:** 그래프 데이터 및 작업의 특성에 따라 적절한 그래프 트랜스포머 유형 선택, 구조적 및 위치 인코딩 설계, 셀프 어텐션 메커니즘 최적화, 사전 학습 기법 활용을 제안합니다.

## 📊 Results

그래프 트랜스포머는 다양한 연결된 데이터 도메인에서 성공적으로 응용됩니다.

- **노드 레벨 작업:**

  - **단백질 구조 예측 (Protein Structure Prediction, PSP):** HEAL, Geometric Algebra(GA) 모델링, Gated-Graph Transformer 등이 활용되어 단백질 구조의 복잡한 구조적 의미를 포착합니다.
  - **개체 해결 (Entity Resolution, ER):** 계층적 그래프 어텐션 네트워크(HierGAT)와 하이브리드 매칭 지식(Hybrid Matching Knowledge, GTA) 방법이 이질적인 개체 표현을 식별하고 연결하는 데 사용됩니다.
  - **이상 탐지 (Anomaly Detection):** TADDY, Anomaly Transformer, GTA 프레임워크 등이 동적 그래프 및 시계열 데이터에서 이상 징후를 효과적으로 탐지합니다.

- **에지 레벨 작업:**

  - **약물-약물 상호작용 예측 (Drug-Drug Interaction Prediction, DDI):** DTI-GTN, DTIOG 등은 약물과 표적 간의 복잡한 관계를 모델링하여 DDI를 예측하는 데 기여합니다.
  - **지식 그래프 완성 (Knowledge Graph Completion, KGC):** iHT, 지식 기반 디코딩을 통한 생성 트랜스포머, 다중 레벨 융합 하이브리드 트랜스포머 등이 지식 그래프의 누락된 링크를 예측하는 데 활용됩니다.
  - **추천 시스템 (Recommender Systems):** 생성적 자기 지도 학습(generative self-supervised learning)과 그래프 트랜스포머 아키텍처를 결합한 GFormer와 같은 모델이 사용자-아이템 간의 복잡한 관계를 포착하여 추천 성능을 향상시킵니다.

- **그래프 레벨 작업:**

  - **분자 특성 예측 (Molecular Property Prediction):** Algebraic Graph-Assisted Bidirectional Transformer (AGBT), KPGT(Knowledge-Guided Pre-training of Graph Transformer) 등은 분자의 그래프 구조를 활용하여 3D 입체 화학 정보와 같은 중요한 정보를 통합합니다.
  - **그래프 클러스터링 (Graph Clustering):** 그래프 트랜스포머 네트워크, PatchGT 등이 새로운 그래프 구조를 생성하거나 그래프를 패치로 분할하여 클러스터링 성능을 향상시킵니다.
  - **그래프 합성 (Graph Synthesis):** 적응형 그래프 트랜스포머(AGT), 앵커 그래프 트랜스포머(AGFormer), 계층적 확장 가능 그래프 트랜스포머(HSGT) 등이 그래프 데이터 마이닝 및 표현 학습을 개선합니다.

- **기타 응용 시나리오 (텍스트, 이미지, 비디오):**
  - **텍스트 요약 (Text Summarization):** 원본 텍스트에서 주요 문장/구절을 추출하거나 핵심 개념을 해석하여 요약문을 생성하는 데 사용됩니다.
  - **이미지 캡셔닝 (Image Captioning):** Transforming Scene Graphs (TSG)와 같은 기술이 이미지의 구조화된 표현을 생성하고 이를 설명적인 캡션으로 변환합니다.
  - **이미지 생성 (Image Generation):** Scene graph에 의해 조건화된 트랜스포머 기반 방법, StyleSwin 등이 고해상도 이미지 생성에 활용됩니다.
  - **비디오 생성 (Video Generation):** Video Graph Transformer (VGT), Object-Centric Video Transformer (OCVT), VideoGPT, MoCoGAN 등이 비디오의 시공간적 동적 정보를 포착하고 비디오 질의응답 및 요약과 같은 작업에 응용됩니다.

## 🧠 Insights & Discussion

그래프 트랜스포머는 큰 잠재력을 가지고 있지만, 여전히 여러 가지 과제와 한계에 직면해 있으며, 이는 향후 연구 방향을 제시합니다.

- **확장성 및 효율성:** 대규모 그래프에서 글로벌 어텐션 메커니즘으로 인한 메모리 및 계산 요구 사항이 높습니다. 이를 해결하기 위해 선형/희소 어텐션 개발, 그래프 희소화/코어닝, 그래프 분할/샘플링, 그래프 증류/압축, 정규화/정규화 기법 활용 등이 필요합니다.
- **일반화 및 견고성:** 보지 못한 그래프나 노이즈가 있는 입력에 대한 일반화 능력과 적대적 공격에 대한 취약성이 있습니다. 동적/유연한 어텐션 메커니즘 개발, 도메인 적응/전이 학습, 메타 학습/소수 학습(few-shot learning), 견고한 어텐션 메커니즘 설계, 불확실성 및 신뢰성 평가 등이 연구될 수 있습니다.
- **해석 가능성 및 설명 가능성:** "블랙 박스" 모델로 간주되어 의사 결정에 대한 정당성 부족 문제가 있습니다. 어텐션 시각화, XAI(설명 가능한 AI) 기법 적용, 자연어 설명 생성, 인간-인-루프(human-in-the-loop) 방법 조사 등을 통해 모델의 투명성을 높여야 합니다.
- **동적 그래프 학습:** 시간이 지남에 따라 변하는 동적이고 복잡한 그래프를 효과적으로 처리하는 것이 중요합니다. 시공간적/인과적 어텐션 메커니즘 개발, 동적 그래프에서의 지속적 학습(continual learning), 멀티모달 어텐션, 다중 레벨/다중 레이어 어텐션 메커니즘 활용이 필요합니다.
- **데이터 품질 및 다양성:** 효과적인 학습을 위해 대량의 다양하고 고품질 데이터가 필요하지만, 현실 세계의 데이터는 제한적이고 노이즈가 많으며 불완전하고 불균형적이며 편향되어 있습니다. 노이즈 허용 어텐션 메커니즘 개발, 데이터 증강/생성, 데이터 불균형 및 편향 완화 기법, 데이터 품질/다양성 평가 등을 통해 데이터 문제를 해결해야 합니다.

## 📌 TL;DR

이 설문 조사는 그래프 트랜스포머 연구의 포괄적인 개요를 제공합니다. 기존 설문 조사의 공백을 메우기 위해, 이 논문은 그래프 유도 바이어스와 어텐션 메커니즘을 포함한 **설계 관점**을 심층적으로 분석하고, 깊이, 확장성, 사전 학습 전략에 따른 **새로운 분류법**을 제안합니다. 또한, 노드/에지/그래프 레벨 작업 및 다른 도메인에서의 **다양한 응용 분야**를 검토합니다. 마지막으로, 확장성, 일반화, 해석 가능성, 동적 그래프 처리, 데이터 품질 및 다양성과 같은 **미해결 과제와 미래 연구 방향**을 제시하여 이 분야의 연구자와 실무자에게 귀중한 참고 자료를 제공합니다.
