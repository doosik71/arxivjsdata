# A Survey on Active Learning and Human-in-the-Loop Deep Learning for Medical Image Analysis

Samuel Budd, Emma C Robinson, Bernhard Kainz

## 🧩 Problem to Solve

의료 영상 분석에서 딥러닝(Deep Learning, DL)은 탁월한 성능을 보이지만, 임상 환경에 적용되기 위해서는 다음과 같은 고유한 문제들을 해결해야 합니다.

1. **훈련 데이터 부족**: 지도 학습 기반 DL 모델은 대규모의 정확히 주석(annotation)된 데이터가 필요하지만, 의료 영상 데이터는 전문가의 주석 작업에 많은 시간, 비용, 노력이 소요됩니다.
2. **최종 정확도 및 안전성**: 안전에 민감한 의료 분야에서는 아무리 작은 오류라도 치명적인 결과를 초래할 수 있습니다. DL 모델이 최고 수준의 성능을 달성하더라도, 실제 임상에서 활용되기 위해서는 사용자(의료 전문가)가 예측 결과를 해석하고, 필요시 수정하며, 시스템이 제시한 예측을 승인/거부할 수 있는 능동적인 개입이 필수적입니다.
3. **투명성 및 해석 가능성**: 대부분의 DL 모델은 '블랙박스'처럼 작동하여, 어떻게 특정 예측에 도달했는지 사용자가 이해하거나 설명하기 어렵습니다. 이는 의료 분야에서 DL 시스템에 대한 신뢰를 구축하고, 의사 결정 과정에서 자동화된 예측을 적절히 평가하는 데 큰 장애물입니다.

이 논문은 이러한 문제들을 해결하기 위해 딥러닝 시스템의 개발 및 배포 과정에서 인간의 역할, 특히 능동 학습(Active Learning, AL) 및 Human-in-the-Loop(HITL) 컴퓨팅의 중요성을 탐구합니다.

## ✨ Key Contributions

- 의료 영상 분석을 위한 능동 학습(AL) 및 Human-in-the-Loop(HITL) 딥러닝에 대한 포괄적인 최신 연구 동향을 정리했습니다.
- 딥러닝이 의료 영상 분야에서 직면하는 세 가지 핵심 과제(데이터 부족, 최종 정확도, 투명성 및 해석 가능성)를 식별하고, 이를 해결하는 데 HITL 컴퓨팅의 필요성을 강조했습니다.
- **네 가지 주요 영역**을 중심으로 HITL 딥러닝 기법들을 평가하고 분류했습니다:
  1. **능동 학습**: 최적의 모델 성능을 위해 주석할 데이터를 선택하는 방법.
  2. **모델 출력과의 상호작용**: 예측 결과를 개선하고 사용자가 해석하도록 돕는 방법.
  3. **실제 고려사항**: 대규모 애플리케이션 개발 및 배포 시 중요한 사항.
  4. **미래 전망 및 미해결 질문**: 지식 격차 및 관련 연구 분야.
- 능동 학습의 주요 구성 요소인 **쿼리 유형** 및 **정보성 측정 방법**(불확실성, 대표성, GAN 기반, 학습된 AL)을 심층적으로 분석했습니다.
- 모델 예측의 **상호작용적 개선** 및 **상호작용적 해석** 기법들을 상세히 논의하여, 모델과 사용자 간의 양방향 피드백 루프의 중요성을 강조했습니다.
- 의료 분야에 DL 시스템을 도입할 때의 **실용적인 문제들**(노이즈 주석자, 약한 지도 학습, 다중 작업 학습, 주석 인터페이스, 가변 학습 비용)을 다루고 관련 해결책을 제시했습니다.
- 능동 학습, 준지도 학습(SSL), 전이 학습(TL), 도메인 적응(DA), 지속 학습(Continual Learning) 등 관련 연구 분야 간의 시너지 효과와 미래 연구 방향을 제안했습니다.

## 📎 Related Works

본 논문은 다양한 분야의 선행 연구들을 참조하여 능동 학습과 Human-in-the-Loop 딥러닝의 맥락을 설명하고 있습니다.

- **능동 학습(AL)의 기본:** Settles (2009)는 초기 AL 방법론을 정리했으며, 이 논문에서는 이를 기반으로 딥러닝 시대의 발전(Wang et al., 2017; Wen et al., 2018; Beluch et al., 2018 등)을 다룹니다.
- **불확실성(Uncertainty) 기반 AL:** 최소 확신도, 마진 샘플링, 엔트로피와 같은 고전적인 방법(Settles, 2009)이 딥러닝에 적용된 사례(Wang et al., 2017; Gal et al., 2017; Kirsch et al., 2019)를 포함합니다.
- **대표성(Representativeness) 기반 AL:** Yang et al. (2017)의 'Suggestive Annotation', Smailagic et al. (2018)의 'MedAL' 등 불확실성과 더불어 데이터 분포의 다양성을 고려하는 방법을 언급합니다.
- **생성적 적대 신경망(GANs) 기반 AL:** Last et al. (2018)은 판별자 출력을 불확실성 측정에 활용했으며, Mahapatra et al. (2018), Zhao et al. (2019) 등은 GAN을 이용한 데이터 합성으로 주석 부담을 줄였습니다.
- **학습 기반 능동 학습(Learning Active Learning):** Konyushkova et al. (2017)과 Bachman et al. (2017)은 과거 AL 경험을 통해 최적의 샘플 선택 전략을 학습하는 접근법을 제시했습니다.
- **모델 출력의 상호작용적 개선:** UI-Net (Amrehn et al., 2017), DeepIGeoS (Wang et al., 2019), BIFSeg (Wang et al., 2018) 등 사용자 스크리블, 바운딩 박스 등 피드백을 통해 분할(segmentation) 결과를 개선하는 연구들이 언급됩니다.
- **모델 출력의 상호작용적 해석:** Attention Gating (Oktay et al., 2018; Schlemper et al., 2019)은 시각적으로 모델의 '주의' 영역을 보여주며, Budd et al. (2019)는 MC Dropout을 이용한 불확실성 시각화를 통해 사용자의 의사결정을 돕는 방법을 제시했습니다.
- **약한 지도 학습(Weakly Supervised Learning):** Rajchl et al. (2016a, 2016b)은 바운딩 박스, 수퍼픽셀 등 '약한' 주석으로도 효과적인 분할이 가능함을 보여주었습니다.
- **전이 학습(Transfer Learning) 및 지속 학습(Continual Learning):** Tajbakhsh et al. (2016)은 의료 영상 분야에서 전이 학습의 효과를 입증했으며, Zhou et al. (2017, 2018a, 2018b)과 Baweja et al. (2018)은 지속 학습의 '치명적인 망각' 문제를 다루었습니다.
- **도메인 적응(Domain Adaptation):** Guan and Liu (2021), Choudhary et al. (2020)은 의료 영상 분석에서 도메인 이동 문제를 해결하기 위한 DA 방법론을 제시했습니다.

## 🛠️ Methodology

본 논문은 새로운 방법론을 제안하기보다는, 의료 영상 분석 분야에서 능동 학습(Active Learning, AL) 및 Human-in-the-Loop(HITL) 딥러닝 연구 동향을 체계적으로 분석하고 분류하는 **서베이(survey)** 방법론을 따릅니다. 주요 내용은 다음과 같이 구성됩니다:

1. **능동 학습(Active Learning) 프레임워크 분석:**

   - **AL 쿼리 유형 분류**:
     - **스트림 기반 선택 샘플링(Stream-based Selective Sampling)**: 데이터가 연속적으로 들어올 때마다 주석 요청 여부를 결정합니다.
     - **멤버십 쿼리 합성(Membership Query Synthesis)**: 모델이 가장 유익하다고 생각하는 새로운 데이터 포인트를 생성하고 주석을 요청합니다. GANs의 발전과 연관 지어 논의합니다.
     - **풀 기반 샘플링(Pool-based Sampling)**: 대규모의 레이블 없는 데이터 풀에서 현재 모델에 가장 정보성이 높은 $N$개 샘플을 선택하여 주석을 요청합니다. 딥러닝 기반 AL 방법의 대부분을 차지합니다.
   - **정보성(Informativeness) 평가 지표**:
     - **불확실성(Uncertainty) 기반**: 예측의 불확실성이 높은 샘플을 선택합니다.
       - 최소 확신도(Least Confident): $x^{*}_{LC} = \text{argmax}_{x} (1 - P_{\theta}(\hat{y}|x))$
       - 마진 샘플링(Margin Sampling): $x^{*}_{M} = \text{argmin}_{x} (P_{\theta}(\hat{y}_1|x) - P_{\theta}(\hat{y}_2|x))$
       - 엔트로피(Entropy): $x^{*}_{E} = \text{argmax}_{x} (-\sum_i P(y_i|x)\log P(y_i|x))$
       - 앙상블(Ensemble) 또는 베이지안 CNN (예: BALD)을 활용하여 불확실성을 추정합니다.
     - **대표성(Representativeness) 기반**: 데이터 분포에서 다양한 영역을 대표하는 샘플을 선택하여 중복을 줄이고 모델의 편향을 방지합니다.
     - **GANs 기반**: GAN의 판별자(discriminator) 출력을 불확실성 측정에 사용하거나, 합성 데이터를 통해 훈련 샘플을 확장합니다.
     - **능동 학습 학습(Learning Active Learning)**: 회귀 모델 또는 강화 학습(RL)을 사용하여 최적의 샘플 선택 정책을 직접 학습합니다.
   - **모델 업데이트 전략**: 새로 얻은 주석을 활용하여 모델을 **재학습(retraining)**할지, 또는 **미세 조정(fine-tuning)**할지에 대한 장단점을 논의합니다.

2. **모델 출력과의 상호작용(Interaction with Model Outputs) 분석:**

   - **상호작용적 개선(Interactive Refinement)**: 사용자의 직접적인 피드백(예: 스크리블, 바운딩 박스)을 통해 모델의 초기 예측(주로 분할 결과)을 반복적으로 수정하여 정확도를 높이는 방법들을 검토합니다.
   - **상호작용적 해석(Interactive Interpretation)**: 모델이 사용자에게 예측의 근거 또는 신뢰도(예: 불확실성 맵, Attention Gating을 통한 시각화)를 제공하여, 사용자가 모델 예측을 신뢰하고 적절히 반응할 수 있도록 돕는 방법들을 분석합니다.

3. **실제 적용 시 고려사항(Practical Considerations) 분석:**

   - **노이즈 주석자(Noisy Oracles)**: 비전문가 주석자의 주석 품질 저하 문제를 다루고, 주석자 품질을 모델링하여 영향을 완화하는 방법을 탐구합니다.
   - **약한 지도 학습(Weakly Supervised Learning)**: 픽셀 단위 주석 대신 바운딩 박스, 스크리블 등 '약한' 주석을 활용하여 주석 비용을 줄이고 효율성을 높이는 방법론을 검토합니다.
   - **다중 작업 학습(Multi-task Learning)**: 여러 관련 작업을 동시에 학습하여 효율성과 성능을 높이는 접근 방식을 살펴봅니다.
   - **주석 인터페이스(Annotation Interface)**: 주석의 정확도와 효율성에 영향을 미치는 사용자 인터페이스 설계의 중요성을 강조하고, 시선 추적, 게임화 등 새로운 인터페이스 기술을 소개합니다.
   - **가변 학습 비용(Variable Learning Costs)**: 주석자 유형, 주석 방식 등에 따라 달라지는 비용을 고려하여 최적의 투자 대비 효율을 달성하는 비용 민감(cost-sensitive) AL 방법을 논의합니다.

4. **미래 전망 및 미해결 질문(Future Prospective and Unanswered Questions) 제시:**
   - 능동 학습과 준지도 학습(SSL), 전이 학습(TL), 도메인 적응(DA), 지속 학습(Continual Learning) 등 관련 분야 간의 통합 및 시너지 효과를 모색합니다.
   - 모델의 장기적인 훈련과 '치명적인 망각(catastrophic forgetting)' 문제 해결에 대한 방향을 제시합니다.
   - 능동 학습에 의해 발생하는 편향(bias)의 역할을 이해하고 활용하는 방법을 제안합니다.

## 📊 Results

이 논문은 서베이 논문이므로 특정 실험 결과를 제시하지 않습니다. 대신, 검토된 다양한 연구들이 의료 영상 분석 분야에서 달성한 주요 성과와 통찰을 종합적으로 요약합니다.

- **능동 학습(Active Learning)의 효율성 입증**:
  - 대부분의 AL 연구는 전체 레이블링된 데이터 중 **적은 비율의 데이터만을 사용하여** 전체 데이터로 훈련한 모델과 **동등하거나 우수한 성능**을 달성할 수 있음을 보여주었습니다. 이는 의료 데이터 주석 비용을 크게 절감할 수 있는 잠재력을 시사합니다.
  - 앙상블 기반 불확실성 추정(Beluch et al., 2018) 및 베이지안 딥러닝(Gal et al., 2017)은 불확실성 측정의 정확도를 높여 AL의 효율성을 향상시켰습니다.
  - 대표성(representativeness) 측정을 통합한 방법(Yang et al., 2017; Smailagic et al., 2018)은 중복 주석을 줄여 AL의 성능을 더욱 개선했습니다.
  - **GAN 기반 데이터 합성**(Last et al., 2018; Mahapatra et al., 2018)은 소량의 주석된 데이터만으로도 고품질의 훈련 샘플을 생성하여 주석 노력의 상당한 절감 효과를 입증했습니다.
- **모델 출력의 상호작용적 개선 효과**:
  - 사용자의 간단한 피드백(예: 스크리블)을 통합하는 상호작용적 분할(segmentation) 시스템(Wang et al., 2019; Bredell et al., 2018)은 완전 자동 방식보다 **정확도가 높으면서도 수동 주석보다 훨씬 빠른** 분할 시간을 가능하게 했습니다.
  - 특히, 3D 의료 영상 분할에서 상호작용적 방법은 높은 정확도를 유지하면서도 주석 시간을 크게 단축시키는 것으로 나타났습니다(Kurzendorfer et al., 2017).
- **모델 해석 가능성(Interpretability)의 발전**:
  - Attention Gating(Oktay et al., 2018)과 같은 기법은 모델이 이미지의 어느 부분에 '주의'를 기울이는지 시각적으로 보여줌으로써, 사용자가 모델의 예측 과정을 **더 잘 이해하고 신뢰**할 수 있도록 도왔습니다.
  - 불확실성 추정(Budd et al., 2019; Jungo and Reyes, 2019)은 모델 예측의 신뢰도를 정량화하여 임상 의사 결정 시 중요한 정보를 제공했습니다.
- **실제 적용을 위한 유용한 통찰**:
  - **약한 주석(weak annotations)**(Rajchl et al., 2016a, 2016b)은 픽셀 단위 주석에 비해 주석 시간과 필요한 전문성을 크게 줄이면서도 경쟁력 있는 분할 정확도를 달성하여, 대규모 데이터셋 구축의 실현 가능성을 높였습니다.
  - 주석자 품질 모델링(Zhang and Chaudhuri, 2015) 및 비용 민감 AL(Kuo et al., 2018)은 실제 주석 환경에서 발생할 수 있는 문제(저품질 주석, 가변 비용)를 효과적으로 관리할 수 있음을 보여주었습니다.
  - 시선 추적 기반 인터페이스(Khosravan et al., 2017)와 같은 혁신적인 주석 도구는 주석 프로세스의 효율성을 획기적으로 향상시킬 수 있는 잠재력을 입증했습니다.

이러한 결과들은 Human-in-the-Loop 딥러닝이 의료 영상 분석의 고유한 과제를 해결하고, DL 모델의 임상 도입을 가속화하는 데 중요한 역할을 할 수 있음을 시사합니다.

## 🧠 Insights & Discussion

- **인간 개입의 필연성**: 의료 영상 분석의 안전에 중요한 특성, 데이터 주석의 어려움, 딥러닝 모델의 블랙박스적 특성 등을 고려할 때, 완전 자동화된 시스템은 현재로서는 한계가 있습니다. Human-in-the-Loop(HITL) 딥러닝은 모델 성능 향상, 신뢰 구축, 규제 준수 측면에서 필수적인 접근 방식입니다.
- **능동 학습(AL)과 HITL의 통합**: 능동 학습은 주석 비용을 줄이면서 모델 학습 효율을 높이고, HITL은 모델 예측을 개선하고 해석 가능성을 제공합니다. 이 두 분야는 상호 보완적이며, 미래에는 주석 선택부터 모델 개선 및 해석에 이르는 모든 과정에서 인간이 참여하는 더욱 통합된 엔드투엔드 시스템으로 발전할 것으로 예상됩니다.
- **불확실성 정량화의 이중 역할**: 모델의 불확실성 추정은 능동 학습에서 가장 정보성 높은 샘플을 선택하는 데 핵심적인 역할을 할 뿐만 아니라, 모델 예측의 해석 가능성을 높여 사용자가 임상적 의사 결정 시 모델의 신뢰도를 적절히 평가하도록 돕는 중요한 도구입니다. 최적의 불확실성 측정 지표를 찾는 연구는 계속될 것입니다.
- **'치명적인 망각'과 지속 학습의 도전**: 의료 환경에서는 모델이 새로운 데이터를 지속적으로 학습하고 업데이트해야 합니다. 이때 이전에 학습한 지식을 잊어버리는 '치명적인 망각(catastrophic forgetting)' 문제는 중요한 난관입니다. 안정성과 가소성(plasticity) 사이의 균형을 맞추는 지속 학습(continual learning) 연구는 장기적으로 모델의 임상 적용 가능성을 결정할 것입니다.
- **능동 학습 편향의 재평가**: 능동 학습으로 인해 훈련 데이터 분포에 편향이 도입될 수 있지만, 특정 조건(예: 소량의 데이터로 과매개변수화된 모델 훈련)에서는 이러한 편향이 오히려 모델 성능에 긍정적인 영향을 미칠 수 있다는 흥미로운 통찰(Farquhar et al., 2021)이 제시되었습니다. 이는 능동 학습에서 편향을 단순히 제거해야 할 요소가 아니라, 이해하고 활용해야 할 잠재적 자원으로 볼 수 있음을 시사합니다.
- **실용적 고려사항의 중요성**: 노이즈 주석자, 약한 주석, 직관적인 주석 인터페이스, 주석 비용 최적화 등 실용적인 측면들은 딥러닝 모델이 실제 임상 환경에 성공적으로 배포되는 데 결정적인 영향을 미칩니다. 이러한 요소들을 통합적으로 고려하는 연구가 필요합니다.
- **다학제적 접근의 필요성**: 능동 학습, 준지도 학습, 전이 학습, 도메인 적응 등 다양한 딥러닝/머신러닝 하위 분야의 발전이 HITL 시스템의 발전에 기여할 수 있습니다. 또한, 인간-컴퓨터 상호작용(HCI) 연구를 통해 사용자 경험을 최적화하고 모델과의 효과적인 상호작용 방법을 모색하는 것도 중요합니다.
- **평가 기준의 재정립**: 다양한 기술을 통합한 복합 시스템의 경우, 개별 구성 요소의 기여도를 명확히 평가하기 위한 새로운 벤치마크 및 평가 체계가 필요합니다. 또한, QALY(Quality-adjusted Life Year)와 같이 임상적 및 경제적 가치를 통합하는 평가 지표 도입도 고려해볼 수 있습니다.

## 📌 TL;DR

의료 영상 분석에서 딥러닝은 데이터 부족, 엄격한 안전성 요구사항, 모델 해석의 어려움이라는 고유한 문제에 직면합니다. 이 서베이 논문은 이러한 도전을 극복하기 위해 **능동 학습(Active Learning, AL)**과 **Human-in-the-Loop(HITL)** 딥러닝의 중요성을 강조합니다. AL은 모델의 불확실성이나 데이터의 대표성을 기반으로 가장 유익한 데이터를 선택하여 주석 비용을 절감하며, HITL은 사용자 피드백을 통해 모델 예측(예: 분할)을 반복적으로 개선하고, 모델의 예측 과정을 사용자에게 직관적으로 해석(예: 불확실성 시각화, 주의 영역 강조)하여 신뢰를 높입니다. 또한, GAN 기반 데이터 합성, 약한 지도 학습, 강화 학습, 전이 학습 등 관련 분야의 기여와 노이즈 주석, 인터페이스, 주석 비용 등 실제 적용 시 고려사항을 논의합니다. 궁극적으로 인간의 지속적인 참여를 통해 의료 딥러닝 모델의 효율성, 정확성, 신뢰성을 높여 임상 활용을 가속화하는 통합된 시스템 개발의 필요성을 역설합니다.
