# iSAID: 항공 이미지 인스턴스 분할을 위한 대규모 데이터셋

Syed Waqas Zamir, Aditya Arora, Akshita Gupta, Salman Khan, Guolei Sun, Fahad Shahbaz Khan, Fan Zhu, Ling Shao, Gui-Song Xia, Xiang Bai

## 🧩 Problem to Solve

- 기존 Earth Vision 데이터셋은 시맨틱 분할(semantic segmentation) 또는 객체 탐지(object detection)에 적합했지만, 픽셀 단위의 정확한 인스턴스 마스크(instance mask)를 필요로 하는 인스턴스 분할(instance segmentation) 작업에는 부족했습니다.
- 항공 이미지는 자연 장면과 비교하여 다음과 같은 고유한 도전 과제를 제시합니다:
  - 이미지당 방대한 수의 인스턴스 (객체 밀도가 높음).
  - 객체 규모의 큰 변화와 풍부한 작은 객체.
  - 임의의 형태와 방향, 큰 종횡비.
- 이러한 항공 이미지의 특성 때문에 자연 장면에서 개발된 기존 인스턴스 분할 알고리즘은 성능이 저하되는 도메인 시프트(domain shift) 문제를 겪으며, 맞춤형 솔루션이 필요합니다.

## ✨ Key Contributions

- **최초의 대규모 항공 이미지 인스턴스 분할 벤치마크 데이터셋 제안 (iSAID)**: 객체 탐지와 픽셀 수준 분할 작업을 결합하여 항공 이미지 분석을 위한 기반을 마련했습니다.
- **방대한 규모와 다양성**: 2,806장의 고해상도 이미지에 걸쳐 15개 범주의 655,451개 객체 인스턴스에 대한 정밀한 픽셀 단위 주석을 제공합니다. 이는 기존 소규모 항공 이미지 인스턴스 분할 데이터셋 대비 객체 범주는 15배, 인스턴스는 5배 더 많습니다.
- **도전 과제 해결 필요성 제시**: Mask R-CNN 및 PANet과 같은 인기 있는 인스턴스 분할 방법을 사용하여 데이터셋을 벤치마크한 결과, 기존 방법들을 직접 적용했을 때 최적 이하의 성능을 보였으며, 항공 이미지의 고유한 도전에 맞는 전문화된 솔루션이 필요함을 입증했습니다.
- **데이터셋 공개**: 연구 커뮤니티의 발전을 장려하기 위해 데이터셋을 공개적으로 제공합니다.

## 📎 Related Works

- **자연 장면 데이터셋**: ImageNet, PASCAL-VOC, MSCOCO, Cityscapes, ADE20K 등은 이미지 분류, 객체 탐지, 시맨틱 및 인스턴스 분할 연구 발전에 크게 기여했습니다.
- **기존 항공 이미지 데이터셋**:
  - **객체 탐지 및 시맨틱 레이블링**: DOTA, xView, NWPU VHR-10, SZTAKI-INRIA 등은 항공 이미지에서 객체 탐지 및 시맨틱 분할 연구를 발전시켰지만, 픽셀 단위의 인스턴스 마스크 주석을 제공하지 않습니다.
  - **소규모 인스턴스 분할**: Airbus Ship, SpaceNet MVOI 등은 단일 객체 범주(예: 선박 또는 건물)에만 초점을 맞춘 소규모 데이터셋입니다.
- **인스턴스 분할 방법론**: Mask R-CNN [10], PANet [18]과 같은 딥러닝 기반 방법론들이 자연 장면 인스턴스 분할에서 최첨단 성능을 달성했습니다.

## 🛠️ Methodology

1. **데이터셋 구축**:
    - DOTA [32] 데이터셋을 기반으로 하지만, DOTA의 부정확하거나 누락된 주석, 바운딩 박스 문제를 해결하기 위해 처음부터 독립적으로 주석을 생성했습니다. 이로 인해 DOTA의 188,282개 인스턴스 대비 약 250% 증가한 655,451개 인스턴스를 확보했습니다.
    - `plane`, `ship`, `storage tank`, `baseball diamond`, `tennis court`, `basketball court`, `ground track field`, `harbor`, `bridge`, `large vehicle`, `small vehicle`, `helicopter`, `roundabout`, `swimming pool`, `soccer ball field`의 15개 클래스를 선정했습니다.
    - 데이터셋 분할: 원본 이미지의 절반은 훈련 세트, $1/6$은 검증 세트, $1/3$은 테스트 세트로 사용합니다.
2. **주석 절차**:
    - **종합적인 주석 파이프라인**: 주석 지침 개발, 주석가 훈련, 이미지 주석, 품질 검사, 만족할 때까지 주석 개선 단계를 포함합니다.
    - **고품질 주석 소프트웨어**: 자체 개발한 "Haibei" 소프트웨어를 사용하여 인스턴스 분할 마스크를 그렸습니다.
    - **명확한 주석 지침 수립 및 주석가 훈련**: 15개 범주의 모든 명확하게 보이는 객체를 픽셀 단위 마스크로 주석 처리하고, 필요시 확대/축소를 사용하며, 불분명한 객체는 보고하여 논의 후 처리하는 등의 지침을 따랐습니다.
    - **5단계 품질 관리 절차**: 주석가 본인의 자가 검토, 동료 주석가 간의 교차 검토, 감독 팀의 무작위 샘플링($70\%$ 이미지), 전문가 팀의 샘플링($20\%$ 이미지) 및 반복적인 개선 요청, 인스턴스 통계 계산을 통한 이상치 확인을 거쳤습니다.
3. **벤치마크 실험**:
    - **모델**: Mask R-CNN [10]과 PANet [18] (둘 다 ResNet101-FPN 백본 사용)을 기본 모델로 사용했습니다.
    - **항공 이미지 특성 반영을 위한 수정 사항**:
        - 평가 시 탐지 상자 수 1000개로 증가 (기본 100개에서).
        - 6가지 스케일(1200, 1000, 800, 600, 400)을 사용한 스케일 증강.
        - NMS (non-maximal suppression) 임계값 0.6 사용.
        - **PANet++**: 더 강력한 백본 (ResNet-152-FPN)을 사용하여 최고 성능 모델을 구성했습니다.
    - **훈련**: 원본 이미지에서 800x800 크기의 패치(stride 200)를 추출하여 훈련 및 테스트를 진행했습니다.

## 📊 Results

- **인스턴스 분할 성능 (Mask AP)**:
  - PANet은 기본 설정에서도 Mask R-CNN보다 우수한 성능을 보였습니다.
  - 항공 이미지에 맞게 약간 수정된 버전(Mask R-CNN+, PANet+)은 기본 모델보다 성능이 향상되었습니다. Mask R-CNN+는 기본 Mask R-CNN 대비 $7.8 \text{ AP}$ 절대 증가를 보였습니다.
  - 가장 강력한 백본(ResNet-152-FPN)을 사용한 PANet++이 $40.0 \text{ AP}$로 최상의 인스턴스 분할 성능을 달성했습니다.
  - PANet++의 경우, 특정 카테고리(예: `baseball diamond`, `basketball court`, `harbor`)에서 $5 \text{ AP}_{50}$ 이상 상당한 성능 향상을 보였습니다.
- **객체 탐지 성능 (Bounding Box AP)**:
  - 인스턴스 분할과 유사하게, PANet 및 그 변형들이 Mask R-CNN보다 더 나은 객체 탐지 성능을 보였습니다.
  - PANet++이 $47.0 \text{ AP}_{\text{bb}}$로 가장 좋은 객체 탐지 성능을 기록했습니다.
  - iSAID의 객체 탐지 결과는 DOTA [32]에서 보고된 결과보다 낮게 나타났는데, 이는 iSAID에 DOTA보다 훨씬 더 많은 수의 인스턴스가 추가되었기 때문입니다.
- **정성적 결과**: PANet++은 가장 설득력 있는 정성적 결과를 제공하며, 매우 작거나 큰 객체 등 극단적인 크기의 객체에서도 정확한 인스턴스 마스크를 생성했습니다.

## 🧠 Insights & Discussion

- **항공 이미지의 고유한 도전 과제**: 항공 이미지는 이미지당 많은 객체 수, 제한된 외형 상세 정보, 작은 객체들, 다양한 객체 유형 간의 상당한 스케일 변화($20,000$배 이상), 큰 종횡비 변화(최대 $90$) 및 높은 클래스 불균형 등 기존 인스턴스 분할 알고리즘에 새로운 도전 과제를 제기합니다.
- **기존 방법의 한계 및 전문 솔루션의 필요성**: 자연 장면을 위해 개발된 최첨단 인스턴스 분할 방법들을 항공 이미지에 직접 적용하는 것은 도메인 시프트와 고유한 이미지 특성 때문에 만족스럽지 못한 결과를 가져옵니다. 벤치마크 결과는 항공 이미지 인스턴스 분할을 위한 특화된 알고리즘 개발의 필요성을 강조합니다.
- **데이터셋의 의의**: iSAID 데이터셋은 대규모, 고밀도 주석을 통해 이 분야의 연구 격차를 해소하고, 항공 이미지 인스턴스 분할 작업의 새로운 발전을 촉진하는 데 기여할 것으로 기대됩니다.

## 📌 TL;DR

항공 이미지의 인스턴스 분할을 위한 대규모, 고밀도 주석 데이터셋의 부족과 기존 자연 장면 알고리즘의 한계를 해결하기 위해, 본 논문은 15개 범주, 655,451개 인스턴스를 포함하는 최초의 대규모 항공 이미지 인스턴스 분할 데이터셋인 **iSAID**를 제안합니다. iSAID는 높은 객체 밀도, 큰 스케일 및 종횡비 변화, 작은 객체 등의 고유한 도전 과제를 포함하며, Mask R-CNN 및 PANet 벤치마크 결과는 기존 방법들이 항공 이미지에 직접 적용될 때 최적 이하의 성능을 보였고, 약간의 수정과 더 강력한 백본(PANet++)을 통해 성능이 향상됨을 보여주어, 항공 이미지 인스턴스 분할을 위한 전문화된 알고리즘 개발이 시급함을 강조합니다.
