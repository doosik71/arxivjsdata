# Associatively Segmenting Instances and Semantics in Point Clouds

Xinlong Wang, Shu Liu, Xiaoyong Shen, Chunhua Shen, Jiaya Jia

## 🧩 Problem to Solve

3D 포인트 클라우드에서 객체의 인스턴스와 의미론적 정보를 동시에 효율적으로 분할하는 것은 중요한 과제입니다. 기존 방식들은 이 두 가지 태스크를 개별적으로 또는 단계적으로 처리하며, 이는 비효율적이고 최적화되지 못한 결과를 초래할 수 있습니다. 특히, 인스턴스 분할은 동일 클래스의 다른 개체를 구분하고, 의미론적 분할은 동일 클래스 개체에 같은 레이블을 부여하려는 경향이 있어 서로 상충하는 면이 있습니다. 이 연구는 이러한 두 태스크가 서로 이점을 취하며 '윈-윈' 상황을 만들 수 있는 공동 학습 프레임워크를 탐색하는 것을 목표로 합니다.

## ✨ Key Contributions

* 3D 포인트 클라우드에서 인스턴스 및 의미론적 분할을 동시에 수행하는 빠르고 효율적인 간단한 베이스라인을 제안했습니다.
* 인스턴스 분할과 의미론적 분할을 긴밀하게 연결하는 새로운 프레임워크인 ASIS(Associatively Segmenting Instances and Semantics)를 제안했습니다.
* 특히, 인스턴스 분할을 위한 '의미론적 인식(semantics awareness)'과 의미론적 분할을 위한 '인스턴스 융합(instance fusion)'이라는 두 가지 파트너십을 통해 두 태스크가 서로 협력하도록 만들었습니다.
* 제안된 ASIS 모델은 의미론적 인식 인스턴스 분할 및 인스턴스 융합 의미론적 분할을 포함하며 엔드-투-엔드로 학습되어, S3DIS 데이터셋에서 최첨단 3D 인스턴스 분할 방법을 능가하고 3D 의미론적 분할 성능을 크게 향상시켰습니다.
* ShapeNet 데이터셋 실험을 통해 ASIS가 파트 분할 태스크에도 유용함을 입증했습니다.

## 📎 Related Works

* **인스턴스 분할(Instance Segmentation)**: Mask R-CNN [10]과 같은 2D 이미지 기반의 상향식(top-down) 및 하향식(bottom-up) 접근 방식(예: [6], [24])이 연구되었지만, 3D 인스턴스 분할은 SGPN [35] 등 비교적 적게 다루어졌습니다.
* **의미론적 분할(Semantic Segmentation)**: FCN [21] 기반의 2D 이미지 분할 방법과 PointNet [26], PointNet++ [28], SPG [16] 등 MLP 및 계층적 구조를 활용한 3D 포인트 클라우드 분할 연구가 진행되었습니다. 이전 연구들은 인스턴스 임베딩을 활용하여 의미론을 분할하는 경우가 드뭅니다.
* **포인트 클라우드 딥러닝(Deep Learning on Point Clouds)**: 다중 뷰 렌더링 [33], 복셀화된 볼륨 [37], 그리고 PointNet [26]처럼 원시 포인트 클라우드를 직접 처리하는 방법들이 발전했습니다.

## 🛠️ Methodology

본 논문은 공유 인코더와 두 개의 병렬 디코더로 구성된 간단한 베이스라인을 기반으로 ASIS 모듈을 추가합니다.

* **3.1. 간단한 베이스라인 (A Simple Baseline)**
  * **공유 인코더**: 포인트 클라우드($N_P$ 포인트)를 피처 매트릭스로 인코딩합니다 (예: PointNet 또는 PointNet++ 사용).
  * **의미론적 분할 브랜치**: 공유 피처 매트릭스를 $N_P \times N_C$ 크기의 의미론적 예측 $P_{\text{SEM}}$으로 디코딩하며, 교차 엔트로피 손실(cross entropy loss)로 학습됩니다.
  * **인스턴스 분할 브랜치**: $N_P \times N_E$ 크기의 포인트 레벨 인스턴스 임베딩 $E_{\text{INS}}$를 예측합니다. 동일 인스턴스 포인트는 임베딩 공간에서 가깝고, 다른 인스턴스 포인트는 멀리 떨어지도록 학습됩니다. 2D 이미지의 차별적 손실 함수를 포인트 클라우드에 맞게 수정하여 사용합니다 (클래스 불가지론적 학습 전략).
        $$L=L_{\text{var}}+L_{\text{dist}}+\alpha \cdot L_{\text{reg}}$$
        여기서 $L_{\text{var}}$은 임베딩을 인스턴스 중심($\mu_i$)으로 끌어당기고, $L_{\text{dist}}$는 인스턴스 중심들이 서로 밀어내도록 하며, $L_{\text{reg}}$는 정규화 항입니다.
  * **추론**: 학습된 인스턴스 임베딩에 평균-이동 클러스터링(mean-shift clustering) [3]을 적용하여 인스턴스 레이블을 얻고, 각 인스턴스에 속한 포인트들의 의미론적 레이블의 최빈값(mode)을 해당 인스턴스의 최종 카테고리로 할당합니다.

* **3.2. 상호 지원 (Mutual Aid - ASIS 모듈)**
  * **의미론적 인식 인스턴스 분할 (Semantic-aware Instance Segmentation)**:
    * 의미론적 피처 매트릭스 $F_{\text{SEM}}$를 FC 레이어를 통해 인스턴스 피처 공간에 맞게 $F'_{\text{SEM}}$으로 변환합니다.
    * 변환된 $F'_{\text{SEM}}$를 인스턴스 피처 매트릭스 $F_{\text{INS}}$에 요소별(element-wise)로 더하여 의미론적 인식 인스턴스 피처 $F_{\text{SINS}}$를 생성합니다:
        $$F_{\text{SINS}}=F_{\text{INS}}+\text{FC}(F_{\text{SEM}})$$
    * 이를 통해 다른 클래스 인스턴스에 속하는 포인트들은 인스턴스 피처 공간에서 더 잘 분리됩니다.
  * **인스턴스 융합 의미론적 분할 (Instance-fused Semantic Segmentation)**:
    * 인스턴스 임베딩 공간에서 각 포인트의 $K$개 최근접 이웃(kNN)을 찾습니다 (동일 인스턴스에 속하는 이웃만 포함하도록 필터링).
    * 이웃 포인트들의 의미론적 피처를 그룹화한 후, 채널별 최대값 집계(channel-wise max aggregation) 연산을 통해 융합하여 중심 포인트의 정제된 의미론적 피처를 얻습니다:
        $$x'_{i} = \text{Max}(x_{i1}, x_{i2}, ..., x_{ik})$$
    * 융합된 $F_{\text{ISEM}}$은 최종 의미론적 분류기에 입력되어 더 정확한 의미론적 예측을 생성합니다.
  * 이 모든 과정은 엔드-투-엔드로 학습됩니다.

## 📊 Results

* **S3DIS 데이터셋**:
  * **인스턴스 분할**: ASIS 베이스라인은 SGPN [35]을 5.5 mWCov 포인트만큼 능가했습니다 (PointNet 백본 기준, 6-겹 교차 검증). ASIS 모듈 적용 시 베이스라인 대비 1.9 mWCov 개선을 보였습니다 (46.3 $\to$ 48.2 mWCov).
  * **의미론적 분할**: ASIS 베이스라인은 순수 PointNet 백본 대비 약간의 mIoU 개선을 보였습니다 (48.9 $\to$ 49.5 mIoU). ASIS 모듈 적용 시 1.6 mIoU 개선을 달성했습니다 (49.5 $\to$ 51.1 mIoU).
  * **백본 네트워크**: PointNet++와 같은 강력한 백본에서도 ASIS의 일관된 성능 향상을 확인했습니다 (예: Area 5에서 2.1 mWCov 및 2.6 mIoU 개선).
  * **어블레이션 연구**: 인스턴스 융합(IF)만 적용 시 0.5 mIoU 개선, 의미론적 인식(SA)만 적용 시 1.1 mWCov 개선을 보였습니다. 두 가지를 함께 적용했을 때 가장 큰 성능 향상(1.6 mIoU, 1.9 mWCov)을 보여, 상호 보완적인 효과를 입증했습니다.
  * **카테고리별 분석**: SA는 보드(board), 벽(wall)과 같이 다른 클래스의 인스턴스와 자주 겹치는 카테고리의 인스턴스 분할에 특히 도움이 되며, IF는 테이블(table), 책장(bookcase)과 같이 복잡한 형태를 가진 카테고리의 의미론적 분할에 크게 기여합니다.
  * **추론 시간**: ASIS는 SGPN보다 3.5배 빨랐습니다 (4096$\times$9 포인트 클라우드 처리 시 205ms vs. 726ms).
* **ShapeNet 데이터셋**: ASIS는 파트 분할 태스크에서도 0.7 mIoU 개선을 보이며 (PointNet++ 백본 기준, 84.3 $\to$ 85.0 mIoU), 이점 있음을 입증했습니다.

## 🧠 Insights & Discussion

* 이 연구는 인스턴스 분할과 의미론적 분할이 단순한 조합을 넘어 상호 보완적인 관계를 통해 "윈-윈" 결과를 도출할 수 있음을 성공적으로 보여주었습니다.
* ASIS 프레임워크는 명시적인 상호작용 메커니즘인 '의미론적 인식'과 '인스턴스 융합'을 통해 각 태스크의 부족한 부분을 채워줍니다.
* 의미론적 인식은 특히 다른 클래스와 접해 있는 인스턴스 경계를 명확히 하여 인스턴스 분할을 개선합니다. 이는 인스턴스 임베딩 공간에서 다른 의미론적 클래스의 포인트들을 더 잘 분리하는 데 기여합니다.
* 인스턴스 융합은 동일 인스턴스 내의 포인트들로부터 의미론적 피처를 집계하여 더욱 견고하고 정확한 포인트별 의미론적 예측을 가능하게 합니다. 이는 복잡한 형태의 객체에 특히 유용합니다.
* ASIS는 PointNet 및 PointNet++와 같은 다양한 백본 네트워크에 일반화될 수 있는 유연한 프레임워크임을 입증했습니다.
* 기존 최첨단 방법 대비 훨씬 빠른 추론 속도를 달성하여 실용적인 활용 가능성을 높였습니다.
* 제한점으로는, 매우 가깝게 붙어 있는 동일 클래스 인스턴스(예: 두 개의 인접한 의자)를 구별하는 데 여전히 어려움이 있다는 점이 언급되었으며, 이는 향후 연구 과제로 남겨졌습니다. 전경(thing)과 배경(stuff)을 통합하는 파놉틱 분할(panoptic segmentation)과 같은 다른 분할 태스크에도 적용 가능성이 있을 것으로 예상됩니다.

## 📌 TL;DR

3D 포인트 클라우드에서 인스턴스 및 의미론적 분할을 동시에 수행하는 문제는 상충하는 태스크 특성으로 인해 어렵습니다. 본 논문은 이러한 두 태스크를 상호 이점을 얻도록 하는 엔드-투-엔드 프레임워크인 **ASIS (Associatively Segmenting Instances and Semantics)**를 제안합니다. ASIS는 공유 인코더와 병렬 디코더를 갖춘 베이스라인에 **의미론적 인식(Semantic-aware)** 모듈(인스턴스 임베딩에 의미론적 피처 융합)과 **인스턴스 융합(Instance-fused)** 모듈(인스턴스 내 의미론적 피처 집계)을 추가하여 구현됩니다. 결과적으로 ASIS는 S3DIS에서 최첨단 3D 인스턴스 분할 방법을 크게 능가하고 3D 의미론적 분할 성능을 향상시키며, 기존 방법보다 3.5배 빠른 추론 속도를 보였습니다.
