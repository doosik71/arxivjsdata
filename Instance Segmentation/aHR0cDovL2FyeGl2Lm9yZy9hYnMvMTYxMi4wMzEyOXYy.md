# Boundary-aware Instance Segmentation

Zeeshan Hayder, Xuming He, Mathieu Salzmann

## 🧩 Problem to Solve

기존의 인스턴스 분할(Instance Segmentation) 방법들은 주로 바운딩 박스(bounding box) 형태의 객체 후보를 제안하고, 이 후보 영역 내에서 이진 마스크를 직접 예측합니다. 이러한 방식은 바운딩 박스 생성 과정에서의 오류(예: 너무 작거나 위치가 벗어난 박스)에 매우 취약하며, 한 번 발생한 후보 영역의 오류를 회복할 수 없어 정확한 객체 마스크를 얻기 어렵다는 한계가 있습니다.

## ✨ Key Contributions

* **경계 인식 객체 표현**: 객체 마스크의 거리 변환(distance transform)에 기반한 새로운 객체 세그먼트 표현 방식을 도입하여, 바운딩 박스 제안의 부정확성에 강건하게 대처할 수 있도록 했습니다.
* **객체 마스크 네트워크 (OMN)**: 제안된 표현을 추론하고 최종 이진 객체 마스크로 디코딩하는 새로운 잔여-역합성곱(residual-deconvolution) 아키텍처를 가진 OMN을 설계했습니다. 이 OMN은 바운딩 박스 범위를 넘어선 마스크 예측이 가능합니다.
* **종단 간 학습 프레임워크**: OMN을 Multitask Network Cascade(MNC) 프레임워크에 통합하여, 경계 인식 인스턴스 분할(Boundary-Aware Instance Segmentation, BAIS) 네트워크를 종단 간(end-to-end) 방식으로 학습시켰습니다.
* **최첨단 성능 달성**: PASCAL VOC 2012 및 Cityscapes 데이터셋에서 객체 제안 생성 및 인스턴스 분할 모두에서 기존 최첨단(state-of-the-art) 방법들을 능가하는 성능을 보였습니다.

## 📎 Related Works

* **제너릭 객체 제안 기반 방법**: Fast-RCNN [11], Hypercolumn [15], InstanceFCN [6], MNC [8] 등 대부분의 기존 방법들은 바운딩 박스 내에서 이진 마스크를 예측하여, 박스 제안의 부정확성에 취약합니다.
* **객체 제안 우회 방법**: Proposal-free Network (PFN) [22]는 인스턴스 수를 예측하나 정확성에 의존하고, 깊이 순서(depth ordering) 기반 [35, 36]는 동일 깊이의 여러 인스턴스 처리가 불분명하며, FCN 기반 방향 인코딩 [33]은 독립 모듈들의 최적화 한계가 있습니다. 순환 신경망(RNN) [29]은 모든 인스턴스가 동일 클래스에 속한다고 가정합니다.
* **클래스 불가지론적 영역 제안**: DeepMask [25], SharpMask [26]와 같은 방법들은 FCN을 사용하여 인스턴스 민감도 점수 맵을 계산하여 객체 세그먼트 제안을 생성합니다. 본 논문의 OMN은 이러한 방법들과 비교하여 유사하거나 더 높은 품질의 세그먼트를 생성합니다.

## 🛠️ Methodology

1. **경계 인식 마스크 표현 ($D(p)$)**:
    * 객체의 전체 모양을 나타내기 위해 각 픽셀 $p$에서 객체 경계까지의 최소 거리(truncated distance)를 인코딩하는 조밀한 다중 값 맵 $D(p)$를 사용합니다.
    * $D(p) = \min(\lceil \min_{\forall q \in Q} d(p, q) \rceil, R)$, 여기서 $Q$는 객체 경계 및 외부 픽셀 집합, $d(p, q)$는 유클리드 거리, $R$은 절단 임계값입니다.
    * 이 다중 값 맵을 $K$개의 균일한 빈(bin)으로 양자화하여 각 픽셀의 거리를 $K$차원 이진 벡터 $b(p)$로 원-핫 인코딩합니다: $D(p) = \sum_{n=1}^{K} r_n \cdot b_n(p)$, $\sum_{n=1}^{K} b_n(p) = 1$.
    * 이는 다중 값 맵 예측 문제를 $K$개의 픽셀별 이진 분류 문제로 변환합니다.
2. **객체 마스크 복원 (Inverse Distance Transform)**:
    * 주어진 $K$개의 이진 맵으로부터 전체 객체 마스크 $M$을 근사적으로 복원합니다.
    * 각 픽셀 $p$를 반경 $D(p)$를 가진 이진 디스크 $T(p, D(p))$와 연관시키고, 이 모든 디스크의 합집합으로 $M$을 구성합니다.
    * 이 연산은 일련의 합성곱(convolution) 연산으로 표현될 수 있습니다: $M = \bigcup_{n=1}^{K} T(\cdot, r_n) * B_n$, 여기서 $B_n$은 $n$-번째 빈에 대한 이진 픽셀 맵입니다.
3. **객체 마스크 네트워크 (OMN)**:
    * Region Proposal Network (RPN) [28]으로 생성된 바운딩 박스 제안에 대해 RoI 워핑된 특징을 입력으로 받습니다.
    * 첫 번째 모듈은 완전 연결(fully connected) 레이어와 시그모이드 활성화 함수를 사용하여 $K$개의 픽셀별 확률 맵($B_n$ 근사)을 예측합니다.
    * 두 번째 모듈은 새로운 잔여 역합성곱 네트워크(residual-deconvolution network)로, $K$개의 확률 맵을 이진 객체 마스크로 디코딩합니다. Eq. 3의 형태학적(morphology) 연산은 고정 가중치를 가진 역합성곱으로 구현됩니다.
    * OMN은 완전히 미분 가능(fully differentiable)하며, 높은 해상도로 교차 엔트로피 손실(cross-entropy loss)을 사용하여 종단 간 학습됩니다.
4. **BAIS 네트워크 학습**:
    * OMN을 Multitask Network Cascade (MNC) [8] 프레임워크에 통합하여 BAIS 네트워크를 구성합니다.
    * 네트워크는 바운딩 박스 제안, 객체 마스크 예측, 객체 분류의 세 가지 하위 네트워크로 구성됩니다. (VGG16 [31] + RPN + OMN + 분류/바운딩 박스 회귀)
    * MNC와 유사하게 5단계 캐스케이드(cascade) 구조를 사용하여 초기 바운딩 박스 제안과 예측된 세그먼트를 정제합니다. 두 OMN과 두 분류 모듈의 가중치는 공유됩니다.
    * 바운딩 박스, 객체 마스크, 분류 오류를 고려하는 다중 작업 손실 함수(multi-task loss function)를 사용하여 종단 간 학습됩니다 (RPN/분류: 소프트맥스 손실, OMN: 이진 교차 엔트로피 손실, 바운딩 박스 회귀: smooth $L_1$ 손실).

## 📊 Results

* **PASCAL VOC 2012**:
  * BAIS가 모든 최첨단 방법(SDS, Hypercolumn, InstanceFCN, MNC)을 능가하며, 특히 높은 IoU 임계값에서 상당한 차이를 보입니다 (mAP(0.7)에서 48.30%).
  * "BAIS - inside BBox"와의 비교를 통해 마스크가 바운딩 박스 범위를 넘어설 수 있도록 하는 것의 중요성을 입증했습니다.
  * 3단계 또는 5단계 학습 모두에서 MNC 기준선보다 뛰어난 성능을 보였습니다.
* **Cityscapes**:
  * 온라인 평가 서버에서 테스트 데이터셋에 대해 모든 측정 항목(AP, AP(50%), AP(100m), AP(50m))에서 기존 최첨단 방법(DWT 등)을 크게 능가했습니다 (AP에서 17.4%).
  * 대부분의 클래스에서 DWT보다 우수한 성능을 보였습니다.
* **세그먼트 제안 생성**:
  * PASCAL VOC 2012 검증 세트에서 OMN이 상위 10개 또는 100개 제안에서 최첨단 방법(MCG, DeepMask, SharpMask, InstanceFCN)보다 우수한 결과를 달성했습니다 (AR@10에서 47.8%, AR@100에서 51.8%).
  * 1000개 제안의 경우 SharpMask에 약간 못 미치지만, 높은 IoU 임계값에서는 대부분의 기준선을 능가합니다.

## 🧠 Insights & Discussion

* 이 연구의 핵심 통찰은 바운딩 박스 제안에 의존하는 기존 방식의 한계를 극복하기 위해 객체 마스크의 거리 변환을 사용하여 경계 인지 표현을 도입했다는 점입니다. 이를 통해 바운딩 박스 오류에 강건한 인스턴스 분할이 가능해졌습니다.
* 잔여-역합성곱 아키텍처를 활용한 OMN은 거리 변환 맵을 효과적으로 추론하고 디코딩하여, 예측된 마스크가 초기 바운딩 박스의 공간적 범위를 넘어 확장될 수 있음을 보여주었습니다. 이는 부정확한 박스에서도 전체 객체 마스크를 복원하는 데 중요합니다.
* 종단 간 학습 가능한 BAIS 프레임워크는 객체 제안 생성과 인스턴스 분할이라는 두 가지 주요 작업에서 동시에 최첨단 성능을 달성하여, 제안된 방법의 강력함을 입증했습니다.
* 일부 제한 사항으로는 한 인스턴스가 여러 개로 분할되는 실패 사례가 있었으며, 이는 향후 개선될 여지가 있습니다.
* 향후 연구 방향으로는 현재 VGG16 네트워크를 Residual Networks와 같은 더 깊은 아키텍처로 대체하여 프레임워크의 정확도를 더욱 향상시킬 수 있을 것입니다.

## 📌 TL;DR

이 논문은 바운딩 박스 오류에 취약한 기존 인스턴스 분할의 문제를 해결하기 위해 **거리 변환(distance transform) 기반의 경계 인식 객체 표현**을 제안합니다. 이 표현을 활용하는 **객체 마스크 네트워크(OMN)**는 새로운 잔여-역합성곱(residual-deconvolution) 아키텍처로 바운딩 박스 범위를 넘어선 마스크를 예측합니다. OMN은 Multitask Network Cascade에 통합된 **BAIS(Boundary-Aware Instance Segmentation)** 네트워크로 종단 간 학습되며, PASCAL VOC 2012 및 Cityscapes 데이터셋에서 기존 최첨단 방법들을 뛰어넘는 정확도를 달성하여, 부정확한 바운딩 박스에도 강건한 인스턴스 분할의 가능성을 보여주었습니다.
