# LVIS: A Dataset for Large Vocabulary Instance Segmentation

Agrim Gupta, Piotr Dollár, Ross Girshick

## 🧩 Problem to Solve

기존 객체 감지 연구는 주로 소수의 카테고리(예: 80개)를 다루거나 카테고리당 충분한 학습 데이터가 있는 환경에서 진행되었습니다. 그러나 실제 환경에서는 자연스럽게 '긴 꼬리'(Zipfian distribution) 분포를 가지는 수많은 객체 카테고리가 존재하며, 이들 중 다수는 학습 데이터가 매우 부족한 '적은 샘플(low-sample)' 또는 '적은 샷(low-shot)' 상황에 놓여 있습니다. 최신 딥러닝 객체 감지 방법은 이러한 적은 샘플 환경에서 성능이 저조하여, 대규모 어휘 인스턴스 분할(Large Vocabulary Instance Segmentation)을 위한 효과적인 벤치마크 데이터셋이 부족한 것이 핵심 문제입니다.

## ✨ Key Contributions

* **LVIS (Large Vocabulary Instance Segmentation) 데이터셋 도입:** 1000개 이상의 다양한 객체 카테고리에 대한 인스턴스 분할을 위한 새로운 대규모 데이터셋을 제시합니다. 총 164K 이미지에서 약 2백만 개의 고품질 인스턴스 분할 마스크를 목표로 합니다.
* **긴 꼬리 분포(Long-Tail Distribution) 도전:** 자연 이미지의 Zipfian 분포를 반영하여, 학습 샘플이 부족한 희귀 카테고리(long tail)를 포함함으로써 적은 샷 학습(low-shot learning)이라는 중요한 과학적 과제를 제기합니다.
* **평가 우선(Evaluation-First) 설계 및 연합 데이터셋(Federated Dataset) 개념:** 대규모 어휘 및 희소한 주석 문제 해결을 위해, 각 카테고리가 개별적으로 충실히 주석된 작은 데이터셋들의 연합으로 전체 데이터셋을 구성하는 '연합 데이터셋' 개념을 제안하고 이를 통해 효율적이고 공정한 평가를 가능하게 합니다.
* **고품질 주석 파이프라인:** COCO 및 ADE20K와 비교하여 객체 경계에 더 가깝고 높은 품질의 인스턴스 분할 마스크를 생성하는 크라우드소싱 주석 파이프라인을 개발했습니다.
* **적은 샷 감지 벤치마크 제공:** Mask R-CNN을 사용한 기준선(baselines)을 제시하여 적은 샷 감지의 어려움과 데이터 재샘플링 전략의 중요성을 보여줍니다.

## 📎 Related Works

* **COCO [23]:** 일반 객체 인스턴스 분할을 위한 가장 인기 있는 벤치마크(80개 카테고리). LVIS는 COCO의 작업 및 측정 방식을 계승하지만, 카테고리 수가 10배 이상 많고 더 높은 품질의 분할 마스크를 제공합니다.
* **ADE20K [37]:** 25K 이미지의 거의 모든 픽셀을 3000개의 객체, 'stuff', 부분으로 주석 처리한 야심찬 데이터셋. 단일 전문가에 의해 주석되어 일관성이 높지만 데이터셋 크기가 제한적입니다. LVIS는 대규모 어휘 인스턴스 분할 벤치마킹을 목표로 합니다.
* **iNaturalist [34]:** 5000종의 식물 및 동물에 대한 바운딩 박스 주석이 있는 약 90만 개의 이미지. 적은 샘플 학습의 중요성을 강조하지만, 분할 마스크를 포함하지 않으며 LVIS와 달리 '진입 수준(entry-level)' 카테고리보다는 미세 분류(fine-grained)에 중점을 둡니다.
* **Open Images v4 [18]:** 190만 개의 이미지에 600개 객체 카테고리에 대한 1500만 개의 바운딩 박스를 포함하는 대규모 데이터셋. 주로 빈번한 카테고리(대부분 1000개 이상의 학습 샘플)를 평가하므로 적은 샷 학습이 핵심적이지 않습니다. 또한 LVIS와 달리 타겟 카테고리 분류기를 사용하여 주석할 이미지를 선택합니다. LVIS처럼 연합 데이터셋 설계를 채택했습니다.

## 🛠️ Methodology

핵심 방법론은 **평가 우선 설계 원칙**과 **연합 데이터셋** 접근 방식에 기반합니다.

**연합 데이터셋 설계:**
이는 각 카테고리 $c$에 대해 전체 데이터셋 $D$에서 다음 두 가지 상호 배타적인 하위 집합이 존재함을 의미합니다.

* **긍정 집합($P_c$):** 이미지 $i \in P_c$ 내의 모든 $c$ 인스턴스가 분할 주석된(exhaustively annotated) 이미지들의 집합입니다.
* **부정 집합($N_c$):** 이미지 $i \in N_c$ 내에 $c$ 인스턴스가 전혀 나타나지 않는 이미지들의 집합입니다.
이러한 설계를 통해 164K 이미지 전체에 걸쳐 1000개 이상의 모든 카테고리를 일일이 주석할 필요 없이, 각 카테고리 $c$에 대해 $P_c \cup N_c$를 사용하여 공정한 AP 평가를 수행할 수 있습니다. 이는 주석 작업량을 획기적으로 줄이고 주석의 모호성을 피합니다.

**주석 파이프라인 (6단계):**

1. **객체 발견(Object Spotting, 1단계):** 주석가가 자동 완성 텍스트 입력을 사용하여 이미지당 다양한 카테고리의 단일 인스턴스를 표시합니다. 이 반복적인 과정을 통해 긴 꼬리 카테고리가 발견되며, 일관성을 위해 두 명의 주석가가 독립적으로 이름을 식별해야 합니다.
2. **전체 인스턴스 마킹(Exhaustive Instance Marking, 2단계):** 1단계에서 식별된 각 (이미지, 카테고리) 쌍에 대해 5명의 주석가가 카테고리 일치 여부를 확인하고 해당 카테고리의 *모든* 다른 인스턴스를 점으로 표시합니다. 빈번한 카테고리는 데이터셋을 지배하지 않도록 하위 샘플링됩니다.
3. **인스턴스 분할(Instance Segmentation, 3단계):** 각 표시된 객체에 대해 한 명의 주석가가 상세한 분할 마스크를 그립니다. 품질은 지속적으로 모니터링됩니다.
4. **분할 검증(Segment Verification, 4단계):** 최대 5명의 주석가가 분할 마스크의 품질을 평가합니다. 2명 이상이 거부한 마스크는 3단계로 다시 보내져 재주석됩니다. 이 과정은 총 4번 반복됩니다.
5. **전체 재현율 검증(Full Recall Verification, 5단계):** $P_c$의 각 $(i, c)$ 쌍에 대해 주석가가 $c$ 카테고리의 주석되지 않은 인스턴스가 남아 있는지 확인합니다. 주석이 완전하지 않으면 플래그 $e^c_i$가 false로 설정됩니다.
6. **부정 집합(Negative Sets, 6단계):** 어휘 내 각 카테고리 $c$에 대해 $D \setminus P_c$에서 이미지를 무작위로 샘플링합니다. 최대 5명의 주석가가 이미지 $i$에 $c$ 카테고리가 나타나지 않는지 확인합니다. 나타나지 않으면 $i$는 $N_c$에 추가됩니다. 이 과정은 $N_c$가 목표 크기(데이터셋 이미지의 1%)에 도달할 때까지 계속됩니다.

**어휘 구성:** WordNet에서 8.8K의 synset으로 시작하여 객체 발견 프로세스를 통해 걸러내어 1723개의 synset(카테고리)을 포함하는 최종 어휘를 구성합니다.

## 📊 Results

* **데이터셋 통계 (5K 이미지 기준):** 초기 5000개 이미지에는 977개의 카테고리가 포함되었으며, 최종 데이터셋에서는 1000개를 초과할 것으로 예상됩니다. 이미지당 평균 3.4개 카테고리에서 11.2개의 인스턴스가 주석되어 있으며, 카테고리당 인스턴스의 중간값은 9개로 긴 꼬리 분포의 특징을 명확히 보여줍니다. 객체는 COCO 데이터셋보다 작고 공간적으로 더 다양하게 분포합니다.
* **주석 일관성:**
  * **파이프라인 재현성:** 두 번 주석된 5000개 이미지에서 데이터셋 평균 마스크 IoU $0.85$ 및 $F_1$ 스코어 $0.87$을 달성하여 높은 분할 및 인식 품질을 보입니다.
  * **전문가 비교:** LVIS 마스크는 전문가 주석과 비교했을 때 COCO (IoU $0.83-0.87$, 경계 품질 $0.77-0.82$) 및 ADE20K (IoU $0.84-0.88$, 경계 품질 $0.83-0.87$)보다 더 높은 품질(평균 마스크 IoU $0.90-0.92$, 경계 품질 $0.87-0.91$)을 보였습니다. LVIS 객체는 또한 더 복잡한 경계를 가집니다.
* **평가 프로토콜 유효성 검증:** COCO로 학습된 Mask R-CNN 모델을 LVIS의 COCO 카테고리 주석으로 평가했을 때, 원본 COCO 주석과 유사한 AP 값을 얻어 LVIS 주석 및 연합 데이터셋 설계의 유효성을 입증했습니다. AP는 부정 이미지($|N_c|$) 수가 증가함에 따라 약간 감소하지만, 작은 긍정 집합($|P_c|$)에서도 견고함을 유지합니다.
* **적은 샷 감지 도전:** Mask R-CNN을 COCO 학습 데이터의 1K 이미지 서브셋으로 학습했을 때, 마스크 AP가 36.4%에서 9.8%로 크게 하락하여 적은 샷 감지가 해결되지 않은 중요한 문제임을 확인했습니다. 데이터셋이 성장함에 따라 희귀 카테고리의 비율이 여전히 높습니다(예: LVIS v0.5 학습 세트 카테고리의 약 75%가 100개 이하의 학습 이미지에 나타남).
* **기준선 (LVIS v0.5):**
  * Mask R-CNN (ResNet-50-FPN)의 기본 성능은 마스크 AP 14.8%, 희귀 카테고리 AP ($AP_r$) 0.8%였습니다. 추론 시 하이퍼파라미터(스코어 임계값, 이미지당 감지 수)를 조정하여 전체 AP를 20.9-21.0%로, $AP_r$를 3.2-3.4%로 개선했습니다.
  * **반복 계수 샘플링(repeat factor sampling)**(희귀 카테고리를 위한 데이터 재샘플링)을 통해 $AP_r$를 13.4%로, 전체 AP를 23.2%로 크게 향상시켰습니다($t=0.001$일 때).
  * 스케일 지터(scale jitter) 및 더 큰 백본(ResNet-101, ResNeXt-101)과 같은 표준 개선 사항을 적용하여 최종적으로 27.1%의 전체 AP (ResNeXt-101-32x8d)를 달성했지만, 가장 큰 백본에서는 $AP_r$의 개선 폭이 상대적으로 작았습니다(15.6%).

## 🧠 Insights & Discussion

* **긴 꼬리 문제의 중요성:** LVIS는 대부분의 카테고리가 적은 학습 예제를 가지는 긴 꼬리 분포를 명시적으로 다룹니다. 이는 자연 이미지 이해에서 피할 수 없는 중요한 도전 과제입니다. 연합 데이터셋 및 반복적인 발견(iterative spotting)과 같은 데이터셋 설계는 데이터셋 규모가 커져도 이 특성이 유지되도록 합니다.
* **적은 샷 학습의 검증:** 학습 이미지 수가 적을수록 Mask R-CNN의 성능이 크게 하락하고 희귀 카테고리의 높은 비율을 보이는 결과는 적은 샷 감지(low-shot detection)가 해결되지 않은 주요 문제임을 경험적으로 검증하며, LVIS가 이 분야의 주요 벤치마크 역할을 할 수 있음을 시사합니다.
* **주석 품질의 우수성:** 정교하고 크라우드소싱 기반의 주석 파이프라인은 COCO 및 ADE20K와 같은 기존 대규모 데이터셋보다 훨씬 높은 품질의 마스크와 객체 경계를 제공하며, 이는 정밀한 분할 연구에 필수적입니다.
* **평가 편향(Evaluation Bias):** 놀라운 통찰은 작은 평가 세트가 특히 희귀 카테고리에서 체계적으로 더 높은 AP를 생성할 수 있는 AP 편향이 관찰되었다는 점입니다. 이는 작은 검증 세트에서의 성능이 더 큰 테스트 세트에 비해 과대평가될 수 있음을 의미하며, 연구자들이 고려해야 할 중요한 요소입니다. 검증 세트와 테스트 세트 간의 카테고리 빈도 분포 변화도 이 편향에 기여하며, 더 큰 테스트 세트는 희귀 카테고리의 비율이 더 높습니다.
* **실용적 함의:** 연합 데이터셋 설계는 주석 작업량을 극적으로 줄이면서도 평가의 공정성을 유지하여, 대규모 어휘 데이터셋의 생성 및 유지를 실현 가능하게 합니다. 반복 계수 샘플링(repeat factor sampling)과 같은 데이터 재샘플링 기술은 희귀 카테고리에서 성능을 크게 향상시키는 데 효과적임이 입증되어 향후 연구를 위한 유망한 방향을 제시합니다.

## 📌 TL;DR

LVIS는 1000개 이상의 카테고리와 도전적인 긴 꼬리 분포를 특징으로 하는 대규모 어휘 인스턴스 분할을 위한 새로운 데이터셋입니다. 이 데이터셋은 164K 이미지에 걸쳐 약 2백만 개의 고품질 분할 마스크를 제공하여 적은 샷 학습 문제를 해결하고자 합니다. 핵심 혁신은 희소한 주석에도 불구하고 공정한 평가를 보장하고 COCO/ADE20K보다 우수한 마스크 품질을 제공하는 '연합 데이터셋' 설계와 정교한 크라우드소싱 주석 파이프라인입니다. 기준선 결과는 적은 샷 감지의 어려움을 확인시켜 주며, 희귀 카테고리에는 데이터 재샘플링이 중요함을 보여줍니다. 또한 작은 평가 세트가 성능을 과대평가할 수 있는 AP 평가 편향도 지적합니다.
