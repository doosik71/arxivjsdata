# 영상 추적에서 상관 필터와 컨볼루션 필터의 등가성
Shuiwang Li, Qijun Zhao, Ziliang Feng, and Li Lu

## 🧩 Problem to Solve
영상 추적은 컴퓨터 비전 분야의 근본적이고 도전적인 과제입니다. 최근 판별 상관 필터(DCF) 기반 추적기는 효율성과 성능 면에서 큰 진전을 이루었습니다. DCF 기반 추적기는 객체의 특징 템플릿과 탐지 샘플의 후보 영역 간의 유사성을 상관 필터를 통해 계산합니다. 이와 대조적으로, 컨볼루션 필터는 일반적으로 이미지 처리에서 블러링, 선명화, 엣지 검출 등 다른 목적으로 사용됩니다. 겉으로는 다른 용도로 사용되는 상관 필터와 컨볼루션 필터가 영상 추적 맥락에서 수학적으로 어떤 관계를 가지는지, 특히 그들의 최소 평균 제곱 오차(MMSE)가 동등한지에 대한 의문이 존재합니다. 본 논문은 이 질문에 대한 해답을 제시합니다.

## ✨ Key Contributions
*   **필터 등가성 증명:** 영상 추적에서 상관 필터와 컨볼루션 필터가 최소 평균 제곱 오차(MMSE) 측면에서 동등함을 수학적으로 처음으로 증명했습니다.
*   **증명 조건 명시:** 이 증명은 최적의 솔루션이 존재하고, 이상적인 필터 응답이 2차원 중심 대칭 가우시안 함수라는 조건 하에 유효합니다.
*   **연구 자유도 증진:** 이 결과는 연구자들이 트래커를 설계할 때 상관 연산자 또는 컨볼루션 연산자 중 하나를 자유롭게 선택할 수 있는 이론적 기반을 제공합니다.
*   **개념적 통찰:** 이상적인 응답을 "유사성"으로 설명하는 것이 본질적이지 않음을 시사합니다.
*   **시아미즈 트래커에 대한 질문 제기:** 현재 최첨단 딥러닝 기반 시아미즈(Siamese) 트래커들이 주로 상관 연산자를 사용하는 상황에서, 본 연구의 결과는 상관 연산자를 컨볼루션 연산자로 대체할 수 있는지, 그리고 유사성 학습 기반 설명이 본질적인지에 대한 중요한 질문을 던집니다.

## 📎 Related Works
*   **판별 상관 필터(DCF)의 발전:**
    *   **MOSSE [3]:** 상관 필터를 시각 추적에 처음 적용하여 최소 출력 제곱합 오차(MOSSE) 필터를 제안했습니다.
    *   **CSK [19] 및 KCF [18]:** 순환 샘플링을 통해 훈련 샘플을 얻고 커널 트릭 및 다채널 특징을 도입하여 DCF 기반 추적기의 성능과 속도를 크게 향상시켰습니다.
    *   **경계 효과 개선:** 주기성 가정으로 인한 경계 효과를 줄이기 위해 SRDCF [9], C-COT [11], ECO [7] 등이 제안되었으며, 특히 C-COT은 연속 컨볼루션 연산자를 학습합니다.
    *   **견고성 및 적응성 개선:** Context-aware DCF [38], STRCF [27], AutoTrack [31] 등은 상황 인지, 시공간적 정규화 등을 통해 추적 모델의 견고성을 높였습니다.
    *   **특징 표현 및 배경 인식:** HOG [6], Color Names [10] 같은 전통적 특징부터 딥 CNN 특징 [37, 11, 42, 22]까지 다양한 특징이 사용되었고, BACF [14], ARCF [21], RACF [30] 등은 배경 인식을 통해 성능을 개선했습니다.
*   **딥러닝(DL) 기반 추적 방법:**
    *   최근 이미지 분류, 객체 감지 등 다양한 분야에서 딥러닝이 성공을 거두면서 영상 추적 분야에서도 DL 기반 방법이 빠르게 발전하고 있습니다.
    *   **Siamese 계열 트래커 [5, 46, 24, 25]:** 딥러닝 기반 추적의 주류를 이루며, 주로 상관 연산자를 활용하여 타겟 신뢰도 맵을 예측합니다. DL 기반 방법은 높은 정확도를 보이지만, 제한된 컴퓨팅 자원 환경(예: UAV)에서는 효율성 문제가 있습니다.

## 🛠️ Methodology
본 논문은 시각 추적에서 상관 필터와 컨볼루션 필터의 등가성을 수학적으로 증명합니다. 증명 과정은 다음과 같습니다:

1.  **상관 필터 기반 추적기의 목적 함수 정의:**
    *   훈련 샘플 $\{x_k\}_{k=1}^t$로부터 다채널 상관 필터 $f = \{f_l\}_{l=1}^d$를 학습하는 것을 목표로 합니다.
    *   필터 응답 $R(x_k;f) = \sum_{l=1}^d x_k^l \circledcirc f_l$ (여기서 $\circledcirc$는 순환 상관 연산자)는 이상적인 응답 $y$ (2차원 중심 대칭 가우시안 함수)에 가깝도록 학습됩니다.
    *   목적 함수는 다음과 같습니다:
        $$ \arg \min_f \sum_{k=1}^t \alpha_k \|R(x_k;f) - y\|^2 + \lambda \sum_{l=1}^d \|f_l\|^2 $$
        여기서 $\alpha_k$는 각 샘플의 가중치, $\lambda$는 정규화 계수입니다.

2.  **컨볼루션 필터 기반 추적기의 목적 함수 정의:**
    *   상관 필터의 목적 함수에서 순환 상관 연산자($\circledcirc$)를 순환 컨볼루션 연산자($\circledast$)로 대체합니다.
    *   목적 함수는 다음과 같습니다:
        $$ \arg \min_f \sum_{k=1}^t \alpha_k \|\sum_{l=1}^d x_k^l \circledast f_l - y\|^2 + \lambda \sum_{l=1}^d \|f_l\|^2 $$

3.  **주파수 도메인 변환 및 최적 솔루션 도출:**
    *   두 목적 함수는 Parseval 정리와 상관/컨볼루션 정리에 따라 주파수 도메인으로 변환될 수 있습니다. 이를 통해 효율적으로 해결 가능한 선형 최소 제곱 문제로 변환됩니다.
    *   주파수 도메인에서 최적의 필터 솔루션 $\hat{f}^*$ (상관)와 $\hat{f}'^*$ (컨볼루션)는 다음과 같은 선형 방정식 시스템을 풀어 얻어집니다:
        *   **상관 필터의 최적 솔루션 $\hat{f}^*$:**
            $$ \hat{f}^* = \left[\left(\sum_{k=1}^t \alpha_k \hat{X}_k^H \hat{X}_k\right) + \lambda I_{dN}\right]^{-1} \left(\sum_{k=1}^t \alpha_k \hat{X}_k^H \hat{y}\right) $$
            여기서 $\hat{X}_k$는 주파수 도메인에서 특징 맵 $\hat{x}_k^l$의 켤레 복소수 형태를 포함하는 행렬입니다.
        *   **컨볼루션 필터의 최적 솔루션 $\hat{f}'^*$:**
            $$ \hat{f}'^* = \left[\left(\sum_{k=1}^t \alpha_k \hat{X}_k^{'H} \hat{X}_k'\right) + \lambda I_{dN}\right]^{-1} \left(\sum_{k=1}^t \alpha_k \hat{X}_k^{'H} \hat{y}\right) $$
            여기서 $\hat{X}_k'$는 주파수 도메인에서 특징 맵 $\hat{x}_k^l$을 포함하는 행렬입니다.

4.  **등가성 증명:**
    *   핵심 증명은 $\hat{X}_k = \text{conj}(\hat{X}_k')$ 관계와, 이상적인 응답 $y$가 2D 중심 대칭 가우시안 함수이므로 $\hat{y}$가 실수 값을 가져 $\text{conj}(\hat{y}) = \hat{y}$임을 활용합니다.
    *   이를 통해 두 필터의 최적 솔루션이 주파수 도메인에서 $\hat{f}^* = \text{conj}(\hat{f}'^*)$ 관계를 가짐을 증명합니다.
    *   마지막으로, 이 관계를 이용하여 주어진 탐지 샘플 $x_k'$에 대한 두 필터의 응답 $R(x_k';f^*)$와 $R'(x_k';f'^*)$가 다음 관계를 만족함을 보입니다:
        *   **동일한 최소 평균 제곱 오차:** $\|R(x_k';f^*) - y\|^2 = \|R'(x_k';f'^*) - y\|^2$
        *   **원점 대칭 응답:** $R(x_k';f^*)[i,j] = R'(x_k';f'^*)[-i,-j]$
    *   이는 두 필터가 영상 추적에서 성능 면에서 동등함을 의미합니다.

## 📊 Results
본 논문의 수학적 증명을 통해 얻은 주요 결과는 다음과 같습니다 (명제 1):

*   **최적 솔루션의 상호 존재성:** 상관 필터의 최적 솔루션이 존재하면 컨볼루션 필터의 최적 솔루션도 존재하며, 그 반대도 성립합니다.
*   **최적 솔루션의 켤레 복소수 관계:** 이상적인 필터 응답 $y$가 2차원 중심 대칭 가우시안 함수인 경우, 주파수 도메인에서 상관 필터의 최적 솔루션 $\hat{f}^*$와 컨볼루션 필터의 최적 솔루션 $\hat{f}'^*$는 서로 켤레 복소수 관계를 가집니다: $\hat{f}^* = \text{conj}(\hat{f}'^*)$.
*   **동일한 최소 평균 제곱 오차:** 주어진 탐지 샘플 $x_k'$에 대해, 상관 필터의 최적 솔루션 $f^*$와 컨볼루션 필터의 최적 솔루션 $f'^*$가 생성하는 필터 응답의 최소 평균 제곱 오차가 동일합니다: $\|R(x_k';f^*) - y\|^2 = \|R'(x_k';f'^*) - y\|^2$.
*   **응답 맵의 원점 대칭:** 두 최적 필터의 응답 맵은 원점에 대해 대칭적인 관계를 가집니다: $R(x_k';f^*)[i,j] = R'(x_k';f'^*)[-i,-j]$.
    *   이는 직관적으로 한 필터의 응답에서 최대값의 좌표가 올바르게 추정되면 다른 필터도 올바르게 추정되며, 한 필터가 벗어나면 다른 필터는 반대 방향으로 벗어나지만 중심으로부터의 거리는 같음을 의미합니다.

## 🧠 Insights & Discussion
본 연구의 결과는 영상 추적 분야에 여러 중요한 통찰을 제공합니다:

*   **알고리즘 설계의 유연성:** 상관 필터와 컨볼루션 필터가 영상 추적에서 성능적으로 동등함이 증명됨에 따라, 개발자들은 특정 시나리오나 계산 환경에 더 적합한 연산자를 자유롭게 선택하여 추적기를 설계할 수 있습니다. 이는 기존 DCF 기반 방법론의 확장성을 높입니다.
*   **이론적 해석의 재조명:** 이상적인 필터 응답을 "유사성"의 개념으로 해석하는 것이 필수적이지 않다는 점을 시사합니다. 핵심은 필터 응답의 최대값이 객체의 위치를 정확히 나타내는 것이며, 이 최대값이 어떻게 계산되는지는 (상관이든 컨볼루션이든) 중요하지 않을 수 있습니다.
*   **딥러닝 기반 트래커에 대한 시사점:** 최신 시아미즈 트래커와 같은 딥러닝 기반 방법론의 상당수가 내부적으로 상관 연산자를 활용합니다. 본 논문의 증명은 이러한 상관 연산자를 컨볼루션 연산자로 대체하는 가능성을 제시하며, 이는 딥러닝 기반 추적기의 아키텍처 및 이론적 기반에 대한 새로운 연구 방향을 열 수 있습니다.
*   **한계:** 본 증명은 최적 솔루션의 존재와 이상적인 응답이 2D 중심 대칭 가우시안 함수라는 특정 조건 하에 유효합니다. 실제 환경에서는 이 조건들이 항상 완벽하게 충족되지 않을 수 있으며, 이는 향후 연구에서 고려될 수 있는 부분입니다.

## 📌 TL;DR
본 논문은 영상 추적에서 판별 상관 필터(DCF)와 컨볼루션 필터가 최소 평균 제곱 오차(MMSE) 측면에서 동등함을 수학적으로 증명했습니다. 최적 솔루션이 존재하고 이상적인 필터 응답이 2차원 중심 대칭 가우시안 함수라는 조건 하에, 두 필터는 동일한 추적 성능을 보이며 그 응답 맵은 원점에 대해 대칭적입니다. 이 결과는 추적기 설계 시 상관 또는 컨볼루션 연산자를 자유롭게 선택할 수 있는 이론적 근거를 제공하며, 이상적인 응답의 유사성 해석이 본질적이지 않음을 시사합니다.