# FACE AGING WITH CONDITIONAL GENERATIVE ADVERSARIAL NETWORKS

Grigory Antipov, Moez Baccouche, Jean-Luc Dugelay

## 🧩 Problem to Solve

얼굴 노화(age synthesis 또는 age progression) 및 젊어짐(rejuvenation) 효과를 자연스럽고 사실적으로 구현하는 것이 주요 목표입니다. 기존의 GAN 기반 얼굴 변형 연구들은 변형된 이미지에서 원본 인물의 '신원(identity)'이 손실되는 공통적인 문제를 가지고 있습니다. 따라서 본 연구의 핵심 문제는 **인물의 신원을 보존하면서 얼굴 노화를 수행**하는 효과적인 GAN 기반 방법을 개발하는 것입니다.

## ✨ Key Contributions

* **Age-cGAN 개발**: 주어진 연령 범주 내에서 고품질의 합성 얼굴 이미지를 생성할 수 있는 최초의 조건부 생성 적대 신경망(Age Conditional Generative Adversarial Network)을 설계했습니다.
* **신원 보존 잠재 벡터 최적화**: 입력 얼굴 이미지를 재구성할 때 원본 인물의 신원을 보존하는 새로운 잠재 벡터 최적화 접근 방식을 제안했습니다.

## 📎 Related Works

* **전통적인 얼굴 노화 방법**:
  * **프로토타이핑(Prototyping) 방식 [5, 6]**: 미리 정의된 연령 그룹의 평균 얼굴을 기반으로 노화 패턴을 적용합니다. 간단하고 빠르지만, 개인화된 정보가 손실되어 비현실적인 이미지를 생성할 수 있습니다.
  * **모델링(Modeling) 방식 [7, 8]**: 개인의 근육, 피부, 두개골 등의 노화 메커니즘을 시뮬레이션하기 위해 파라메트릭 모델을 사용합니다. 그러나 동일 인물의 넓은 연령대의 노화 시퀀스 데이터가 필요하여 수집 비용이 매우 높습니다.
  * 이러한 전통적인 방식은 얼굴의 전체적인 이해(개성, 표정, 액세서리 등)가 부족합니다.
* **GAN(Generative Adversarial Network) [9]**: 딥러닝 발전에 힘입어 매우 높은 시각적 충실도를 가진 이미지 샘플을 생성하는 데 사용되었습니다.
* **GAN 기반 얼굴 변형 연구 [11, 12]**: 머리색 변경, 선글라스 추가, 이진 노화 등 얼굴 속성을 수정하는 데 활용되었으나, **원본 인물의 신원이 손실되는 문제**가 공통적으로 발생했습니다.

## 🛠️ Methodology

본 논문에서 제안하는 얼굴 노화 방법은 Age-cGAN을 훈련한 후 다음 두 단계로 진행됩니다:

1. **잠재 벡터 근사 및 최적화**:
    * **Age-cGAN 설계 (2.1절)**:
        * DCGAN [15] 아키텍처를 기반으로 하며, 조건 정보($y$)는 생성자 $G$의 입력과 판별자 $D$의 첫 번째 컨볼루션 레이어에 주입됩니다 [12].
        * IMDB-Wiki
cleaned 데이터셋(110K 이미지)으로 훈련되었으며, 연령은 6가지 범주(0-18, 19-29, ..., 60+)로 정의됩니다.
    * **초기 잠재 벡터 근사 (2.2.1절)**: 인코더 $E$ (신경망)를 훈련하여 입력 이미지 $x$를 잠재 벡터 $z$로 역매핑($E(x) \approx z$)합니다. 이는 초기 잠재 벡터 $z_0$를 생성합니다.
    * **잠재 벡터 최적화 (2.2.2절)**:
        * **"신원 보존(Identity-Preserving)" 최적화**: 얼굴 인식 네트워크 $FR$ ("FaceNet" CNN [18])이 추출한 원본 이미지 $x$와 재구성된 이미지 $G(z, y_0)$의 임베딩 간의 유클리드 거리($L_2$ 손실)를 최소화하여 신원 보존을 강화합니다.
            $$z^*_{\text{IP}} = \text{argmin}_z ||FR(x) - FR(G(z, y_0))||_{L_2}$$
            이 최적화는 L-BFGS-B 알고리즘 [19]을 사용하여 수행됩니다.

2. **얼굴 노화 수행**:
    * 신원 보존 최적화를 통해 얻은 최적의 잠재 벡터 $z^*_{\text{IP}}$를 사용하고, 생성자 $G$의 입력 조건 $y_0$를 목표 연령 $y_{\text{target}}$으로 간단히 변경하여 노화된 얼굴 이미지 $x_{\text{target}} = G(z^*_{\text{IP}}, y_{\text{target}})$를 생성합니다.

## 📊 Results

* **연령 조건부 얼굴 생성**:
  * Age-cGAN은 잠재 벡터 $z$에 인코딩된 신원 정보와 조건 $y$에 인코딩된 연령 정보를 완벽하게 분리합니다. $z$는 인물의 신원, 얼굴 자세, 헤어스타일 등을 인코딩하고, $y$는 오직 연령만을 인코딩합니다 (그림 2).
  * 최첨단 연령 추정 CNN [20]을 사용한 합성 이미지 평가 결과, 실제 이미지 대비 연령 추정 정확도가 17%만 낮아 요구된 연령을 가진 사실적인 얼굴 이미지를 생성할 수 있음을 입증했습니다.
* **신원 보존 얼굴 재구성 및 노화**:
  * **시각적 비교 (그림 3)**: "신원 보존" 최적화는 머리 형태나 눈 형태와 같은 신원 특성을 "픽셀 단위" 최적화보다 훨씬 더 잘 나타냅니다.
  * **객관적 비교 (표 1)**: "OpenFace" [22]를 사용한 신원 인식 성능 평가에서 "신원 보존" 최적화 ($z^*_{\text{IP}}$)는 **82.9%**의 신원 인식 점수를 달성하여 초기 재구성(53.2%) 및 "픽셀 단위" 최적화(59.8%)보다 월등히 우수한 성능을 보였습니다.
  * **얼굴 노화 (그림 3-(d))**: 제안된 방법은 신원을 보존하면서 얼굴을 현실적으로 노화시키거나 젊게 만들 수 있음을 성공적으로 보여줍니다.

## 🧠 Insights & Discussion

* **주요 통찰**: 본 연구의 핵심인 "신원 보존" 잠재 벡터 최적화 접근 방식은 얼굴 변형 과정에서 인물의 신원을 온전히 유지할 수 있도록 보장합니다.
* **범용성**: 이 접근 방식은 얼굴 노화뿐만 아니라 수염 추가, 선글라스 착용 등 다른 얼굴 변형 작업에도 신원 보존을 위해 활용될 수 있는 범용성을 가집니다.
* **한계 및 향후 연구**:
  * 제안된 얼굴 노화 방법은 얼굴 데이터셋의 합성 증강이나 교차 연령 얼굴 인식 솔루션의 강건성 향상에 기여할 수 있습니다.
  * "픽셀 단위"와 "신원 보존" 최적화 접근 방식을 하나의 최적화 목표로 결합하여 얼굴 재구성 부분을 더욱 개선할 가능성이 있으며, 이는 향후 연구 방향입니다.

## 📌 TL;DR

* **문제**: GAN 기반 얼굴 노화 시 원본 인물의 신원 손실 문제를 해결해야 합니다.
* **방법**: 연령 조건부 GAN인 Age-cGAN을 제안하고, 얼굴 인식 네트워크의 임베딩을 활용하여 신원 보존을 강화하는 새로운 "신원 보존(Identity-Preserving)" 잠재 벡터 최적화 기법을 도입합니다. 이 최적화를 통해 신원을 보존하며 얼굴 재구성을 수행한 후, 목표 연령 조건으로 전환하여 노화를 구현합니다.
* **결과**: Age-cGAN은 특정 연령대에 맞는 사실적인 얼굴을 생성하며, "신원 보존" 최적화는 기존의 픽셀 단위 최적화보다 훨씬 우수한 신원 인식 정확도(OpenFace 기준 82.9% vs. 59.8%)를 보여, 현실적이고 신원 보존적인 얼굴 노화를 성공적으로 가능하게 합니다.
