# Steganographic Generative Adversarial Networks

Denis Volkhonskiy, Ivan Nazarov, Evgeny Burnaev

## 🧩 Problem to Solve

기존 스테가노그래피(Steganography) 기법은 숨겨진 정보를 담는 '컨테이너(container)' 이미지가 스테그분석기(Steganalyzer)의 공격에 적응하지 못하고 쉽게 탐지된다는 한계가 있습니다. 스테그분석기는 이미지에 숨겨진 메시지의 존재 여부를 탐지하려 하며, 기존 방식으로는 이러한 분석기를 기만하기 어렵습니다. 이 연구는 스테그분석에 더욱 강력하게 저항하는 적응형 컨테이너 이미지 생성 모델 및 새로운 스테가노그래피 방법을 개발하는 것을 목표로 합니다.

## ✨ Key Contributions

* **스테가노그래픽 생성적 적대 신경망(SGAN) 제안**: 스테그분석기의 탐지를 효과적으로 회피하는 컨테이너 이미지를 생성하기 위한 새로운 GAN 기반 모델을 제시했습니다.
* **차등 가능한 LSB 임베딩 근사**: LSB (최하위 비트) 임베딩 과정의 비-차등 가능성 문제를 해결하기 위해, 훈련 시 그래디언트 피드백을 제공하는 차등 가능한 근사 함수를 도입했습니다.
* **스테가노그래픽 암호화 생성적 적대 신경망(SEGAN) 제안**: 숨겨진 정보를 포함하는 사실적인 이미지를 생성하고 이를 복호화할 수 있는 GAN 기반의 암호화/복호화 모델을 개발했습니다.
* **DCGAN 및 SGAN의 스테그분석 회피 능력 입증**: SGAN 및 일반 DCGAN으로 생성된 컨테이너 이미지가 스테그분석기의 탐지 정확도를 무작위 분류기 수준으로 떨어뜨릴 수 있음을 실험적으로 증명했습니다.
* **적응형 스테가노그래피 컨테이너 생성 프레임워크 제시**: 스테그분석 알고리즘에 적응하여 컨테이너의 보안성을 높이는 새로운 패러다임을 제안했습니다.

## 📎 Related Works

* **생성적 모델**: VAEs (Variational Autoencoders)와 GANs (Generative Adversarial Networks) 같은 딥 생성 모델의 발전과 응용을 기반으로 합니다.
* **DCGANs (Deep Convolutional GANs)**: 이미지 생성에서 인상적인 결과를 보여주었으며, 이 연구의 생성자 네트워크 아키텍처의 기반이 됩니다.
* **멀티 타겟 GAN 프레임워크**: 여러 판별자(discriminator)를 사용하여 생성자의 출력을 정규화하거나 특정 속성을 부여하는 아이디어에서 영감을 받았습니다.
* **스테가노그래피 알고리즘**: LSB (Least Significant Bit) 매칭, $\pm$1-임베딩, 적응형 스테가노그래피 기법 (HUGO, WOW, S-UNIWARD) 등을 언급하며, 본 연구에서는 $\pm$1-임베딩을 주로 사용합니다.
* **스테그분석 기법**: SPAM (Subtractive Pixel Adjacency Matrix), SRM (Rich Model)과 같은 특징 추출 기반 전통적 머신러닝 모델과 딥 CNN 기반 스테그분석 연구를 참조합니다.

## 🛠️ Methodology

### Steganographic Generative Adversarial Networks (SGAN)

SGAN은 세 가지 구성 요소 간의 제로섬 게임으로 모델링됩니다:

* **생성자 ($G$)**: 입력 노이즈 $z$로부터 실제 데이터 분포 $p_{\text{data}}$를 모방하고, 스테그분석기에 취약하지 않은 이미지를 생성합니다.
* **판별자 ($D$)**: 생성된 이미지 $G(z)$와 실제 이미지 $x$를 구별합니다.
* **스테그분석기 ($A$)**: 페이로드 $m$이 숨겨진 이미지 $S_m(x)$와 빈 이미지 $x$를 구별합니다.

SGAN의 목적 함수는 다음과 같습니다:
$$
\min_{\theta} \max_{\phi, \psi} L(\theta, \phi, \psi) = \alpha L_{\text{Dis}}(\phi; \theta) + (1-\alpha)L_{\text{San}}(\psi; \theta)
$$
여기서,

* $L_{\text{Dis}}(\phi; \theta) = E_{x \sim p_{\text{data}}}[\log D(x; \phi)] + E_{z \sim p_{z}}[\log(1-D(G(z; \theta); \phi))]$ (판별자 손실)
* $L_{\text{San}}(\psi; \theta) = E_{z \sim p_{z}}[E_{m}[\log A(S_{m}(G(z; \theta)); \psi)]] + E_{z \sim p_{z}}[\log(1-A(G(z; \theta); \psi))]$ (스테그분석기 손실)
* $\alpha \in (0,1)$는 생성된 이미지의 사실성($D$에 대한 저항)과 스테그분석에 대한 보안성($A$에 대한 저항) 사이의 균형을 조절하는 하이퍼파라미터입니다.

#### LSB 임베딩의 차등 가능한 근사

LSB 임베딩은 데이터의 비선형적이고 비-차등 가능한 변형을 유발합니다. 이를 해결하기 위해 훈련 중 역전파 단계에서 LSB 임베딩 $S_m(x)$를 다음의 차등 가능한 근사 함수로 대체합니다:
$$
p_m(z) \approx s_{\beta}(z;m) = \sigma(\beta \sin(m-z)\pi)
$$
여기서 $\sigma(\cdot)$는 시그모이드(Sigmoid) 함수이며, $\beta$는 근사의 충실도를 결정합니다. 이는 생성자에게 유용한 그래디언트 피드백을 제공합니다.

#### 훈련 과정

* $D$와 $A$는 각각 $L_{\text{Dis}}$와 $L_{\text{San}}$을 최대화하도록 업데이트됩니다.
* $G$는 $\alpha L_{\text{Dis}} + (1-\alpha)L_{\text{San}}$을 최소화하도록 업데이트됩니다.
* Adam 최적화 알고리즘을 사용하며, $D$와 $A$는 $G$보다 더 빠르게 학습하여, $G$가 $D$와 $A$의 피드백에 천천히 적응하도록 합니다.

### Steganographic Encryption Generative Adversarial Networks (SEGAN)

SEGAN은 정보를 암호화/복호화하기 위한 모델로, 다음 구성 요소로 이루어집니다:

* **앨리스(Alice - 생성자)**: 비밀 키(binary), 비밀 메시지(binary), 생성 클래스, 노이즈를 입력으로 받아 숨겨진 메시지를 포함하는 사실적인 이미지를 출력합니다.
* **밥(Bob - 복호화 네트워크)**: 이미지를 입력으로 받아 비밀 키와 이미지 클래스를 사용하여 숨겨진 메시지를 추출합니다.
* **판별자(Discriminator)**: 이미지가 실제인지 생성된 것인지 판별합니다.

#### 손실 함수

* **앨리스 손실 ($L_A$)**: 표준 GAN 생성자 손실과 유사하게, 생성된 이미지가 판별자를 속이도록 합니다.
* **앨리스-밥 암호화 손실 ($L_{AB}$)**: 원본 메시지와 밥이 복호화한 메시지 간의 $L_2$ 손실을 최소화하여 암호화/복호화의 정확도를 높입니다.
* **판별자 손실 ($L_C$)**: 실제 이미지와 생성된 이미지(앨리스가 생성한)를 올바르게 분류하도록 합니다.

## 📊 Results

### SGAN 실험 (1D 벡터 및 이미지)

* **1D 벡터 실험**:
  * 스테그분석기 ($A^*$)는 Random Forest와 1D CNN을 사용했습니다.
  * 메시지 다양성이 증가할수록($\text{Pool (1024)}$ 이상 또는 $\text{Arbitrary}$), $A^*$의 $\text{ROC-AUC}$, $\text{F1-score}$, $\text{Accuracy}$가 크게 감소하여 50% 수준(무작위 분류기와 동일)에 근접했습니다. 이는 SGAN 생성자가 LSB 임베딩 왜곡에 불변하는 분포를 유도했음을 시사합니다.
* **이미지 생성 실험 (Celebrities 데이터셋)**:
  * 실제 이미지로 훈련된 스테그분석기 $S^*$는 실제 이미지에 대해 96.2%의 정확도를 보였으나, SGAN 생성 이미지에 대해서는 50.1%, DCGAN 생성 이미지에 대해서는 52.2%의 정확도를 보였습니다. 이는 SGAN이 DCGAN보다 약간 더 우수하게 스테그분석기를 속이는 것을 나타냅니다.
  * SGAN 생성 컨테이너는 HUGO 스테가노그래피 분석기의 정확도를 62.4%에서 49.9%로 감소시켜, SGAN이 특정 스테그분석 알고리즘을 기만하는 보편적인 도구가 될 수 있음을 입증했습니다.
  * DCGAN 모델로 훈련된 $S^*$를 사용하여 생성된 이미지에 대해 테스트했을 때, 추가적인 튜닝을 통해 스테그분석 정확도가 98.2%에서 49.9%로 크게 떨어졌습니다.

### SEGAN 실험 (MNIST 및 CIFAR-10)

* **이미지 사실성**: MNIST 및 CIFAR-10 데이터셋에서 SEGAN이 생성한 이미지는 시각적으로 사실적이었습니다.
* **암호화/복호화 품질**: 메시지 복호화 품질은 거의 완벽에 가까웠습니다.
  * **MNIST**: 16비트 (99.98%), 32비트 (99.54%), 64비트 (98.65%)
  * **CIFAR-10**: 16비트 (99.96%), 32비트 (99.82%), 64비트 (99.81%)
  * 메시지 길이가 길어질수록 복호화 정확도가 약간 감소하지만, 여전히 매우 높은 수준을 유지했습니다.

## 🧠 Insights & Discussion

이 연구는 생성적 적대 신경망(GAN)이 스테가노그래피 분야에 새로운 가능성을 열었음을 보여줍니다. 특히, SGAN 모델은 스테그분석기의 탐지를 효과적으로 회피하는 '적응형' 컨테이너 이미지를 생성할 수 있습니다. 이는 기존 스테가노그래피 방식의 주요 단점인 스테그분석에 대한 비적응성을 극복합니다.

실험 결과는 SGAN으로 생성된 이미지들이 스테그분석기의 분류 정확도를 무작위 추측 수준(50%)까지 낮출 수 있음을 명확히 보여주었습니다. 이는 SGAN이 생성하는 이미지의 분포가 LSB 임베딩으로 인한 미묘한 왜곡에 대해 불변하기 때문입니다. 또한, HUGO와 같은 고급 스테가노그래피 알고리즘 분석기까지 기만할 수 있다는 점은 SGAN이 다양한 스테그분석 기법에 대한 보편적인 방어 도구로 사용될 잠재력을 가지고 있음을 시사합니다.

SEGAN은 비밀 메시지를 사실적인 이미지 내에 숨기고 다시 추출하는 강력한 암호화/복호화 시스템으로서의 역할을 성공적으로 수행했습니다. 이는 시각적 마커(예: QR 코드)의 개념을 넘어, 시각적으로 무해해 보이는 이미지에 정보를 숨기는 새로운 형태의 보안 통신 방법을 제시합니다.

한계점으로는 스테그분석기가 실제 이미지 데이터 분포에 과적합되어 GAN이 생성한 이미지 분포에 대해 일반화하지 못했을 가능성도 제기되었습니다. 그럼에도 불구하고, GAN을 활용한 적응형 컨테이너 생성과 스테그분석 회피 능력은 스테가노그래피 보안 분야에서 중요한 진전을 의미합니다.

## 📌 TL;DR

이 논문은 스테그분석에 강한 적응형 컨테이너 이미지를 생성하기 위한 새로운 GAN 기반 모델인 SGAN을 제안합니다. SGAN은 생성자가 판별자와 스테그분석기를 동시에 속이도록 훈련되며, LSB 임베딩의 비-차등 가능성을 차등 가능한 근사 함수로 해결합니다. 실험 결과, SGAN 생성 이미지는 스테그분석기의 탐지 정확도를 무작위 수준으로 떨어뜨려 스테그분석을 효과적으로 회피했습니다. 또한, 숨겨진 정보로 사실적인 이미지를 생성하고 높은 정확도로 메시지를 복호화하는 SEGAN 모델을 제시하여 GAN이 안전한 정보 은닉 및 암호화에 활용될 수 있음을 보였습니다.
