# Human Pose Estimation
Rohit Josyula, Prof. Sarah Ostadabbas

## 🧩 Problem to Solve

인간 포즈 추정(Human Pose Estimation, HPE)은 이미지나 비디오 내에서 사람의 관절 또는 미리 정의된 랜드마크의 위치를 정확하게 찾아내는 컴퓨터 비전 분야의 핵심 문제입니다. 이 문제는 신체, 얼굴, 손 등 다양한 부위에 적용되며, 사람의 움직임과 자세를 이해하는 데 필수적인 기반 기술입니다. 초기 고전적인 방법의 한계를 넘어 딥러닝을 통해 정확도와 일반화 성능을 향상시키는 것이 주된 목표였습니다.

## ✨ Key Contributions

*   **HPE의 역사적 발전 개요:** 고전적 접근 방식(Pictorial Structures, FMP)부터 딥러닝 기반의 Convolutional Pose Machine (CPM)까지 HPE 분야의 발전 과정을 체계적으로 설명했습니다.
*   **다양한 평가 지표 정의:** HPE 모델의 성능을 평가하는 데 사용되는 주요 정확도 지표들(IoU, PCP, PDJ, PCK, AP, AR, OKS, MPJPE)을 상세히 소개하고 설명했습니다.
*   **HPE 표준 및 분류 체계 제시:** HPE 유형(신체, 얼굴, 손)별 랜드마크 수에 대한 표준을 제시하고, 해상도 및 랜드마크 밀도에 따른 HPE 분류 체계를 제안했습니다.
*   **주요 데이터셋 정리:** 신체, 얼굴, 손, 전신 포즈 추정에 사용되는 다양한 최신 데이터셋들의 특징과 용도를 상세히 정리했습니다.
*   **2D 및 3D HPE 분석:** 2D 및 3D 포즈 추정의 개념적 차이를 설명하고, 각 차원에서의 주요 연구 및 GitHub 리포지토리 예시를 제공했습니다.
*   **이미지 및 비디오 기반 HPE 구분:** 단일 이미지 입력과 비디오 입력 기반의 HPE 알고리즘의 차이를 설명하고 관련 예시를 제시했습니다.

## 📎 Related Works

*   **고전적 접근 방식:**
    *   **Pictorial Structures Model:** 강체(rigid) 신체 부위 간의 공간적 상관관계를 스프링으로 연결된 트리 구조의 그래픽 모델로 표현하여 관절 위치를 예측합니다. 이미지 데이터에 독립적이며, 보이지 않거나 변형 가능한 부위의 상관관계를 포착하는 데 한계가 있습니다.
    *   **Flexible Mixture-of-Parts (FMP):** 변형 가능한 부분 모델(deformable part models)을 사용하여, 작고 비정형화된 여러 부분의 혼합을 통해 복잡한 관절 관계를 표현합니다. 동적 프로그래밍을 통해 효율성을 높였으나, 전역적 맥락(global context)을 충분히 고려하지 못하는 단점이 있었습니다.
    *   **다른 고전적 특징:** 초기 HPE 연구에는 에지, 컬러 히스토그램, 윤곽선, 방향성 기울기 히스토그램(Histogram of Oriented Gradients) 등이 주요 구성 요소로 사용되었습니다.
*   **딥러닝 기반 접근 방식:**
    *   **Convolutional Pose Machine (CPM):** 고전적 접근 방식의 한계를 극복하기 위해 등장한 최초의 딥러닝 기반 포즈 추정 모델입니다. 다단계 컨볼루션 네트워크를 통해 이미지 특징과 공간적 맥락을 동시에 학습하며, 예측을 점진적으로 개선합니다.

## 🛠️ Methodology

이 연구는 새로운 방법론을 제안하기보다는, 기존의 다양한 인간 포즈 추정 방법론을 분류하고 설명하는 방식을 채택했습니다.

*   **고전적 접근 방식:**
    *   **Pictorial Structures Model:** 신체 부위를 이미지 기반의 '외형 템플릿(appearance templates)'으로 모델링하고, 이들을 스프링으로 연결된 트리 구조의 그래픽 모델로 표현하여 관절의 위치를 예측합니다. 이 모델은 부위별 픽셀 위치 및 방향을 매개변수화하여 관절 운동을 모델링합니다.
    *   **Flexible Mixture-of-Parts (FMP):** 변형 가능한 부분 모델을 활용하여 다양한 자세 변화와 시점 변화에 강인하도록 여러 개의 작고 비정형화된 부분(parts)을 혼합하여 사용합니다. 동적 프로그래밍을 통해 유사한 변형(warps)에 대한 계산을 공유하여 속도와 효율성을 높였습니다.
*   **딥러닝 기반 접근 방식 (Convolutional Pose Machine, CPM):**
    *   **다단계 순차 예측 프레임워크:** CPM은 여러 단계의 순차적인 컨볼루션 네트워크로 구성됩니다. 각 단계는 이전 단계에서 생성된 '신념 지도(belief maps)'로부터 공간적 맥락 정보를 받아들여 관절 위치에 대한 예측을 점진적으로 정제합니다.
    *   **종단 간 학습:** CPM은 완전히 미분 가능(fully differentiable)하여 역전파(backpropagation)를 통해 전체 다단계 아키텍처를 종단 간(end-to-end)으로 학습할 수 있습니다.
    *   **큰 수용 영역(Receptive Fields) 활용:** 후반 단계에서는 더 큰 수용 영역을 활용하여 부품 간의 장거리 공간 관계를 학습하고 정확도를 향상시킵니다.
    *   **중간 감독(Intermediate Supervision):** 각 단계 후에 중간 감독 손실(intermediate supervision loss)을 적용하여 역전파 시 발생할 수 있는 기울기 소실(vanishing gradients) 문제를 해결합니다.
    *   **그래픽 모델 추론 불필요:** 이 접근 방식은 명시적인 그래픽 모델 스타일의 추론 없이도 이미지 특징과 이미지 종속적인 공간 모델을 학습할 수 있게 합니다.

## 📊 Results

이 연구는 특정 실험 결과를 제시하기보다는, HPE 분야의 다양한 측면들을 포괄적으로 정리하고 분석한 내용을 제시합니다.

*   **정확도 및 지표:**
    *   **측정 지표의 다양성:** HPE 모델 평가에는 IoU, PCP, PDJ, PCK, AP, AR, OKS, MPJPE 등 다양한 지표가 사용됩니다. 특히 3D HPE에서는 예측된 3D 관절과 실제 위치 간의 유클리드 거리 평균인 MPJPE (Mean Per Joint Position Error)가 널리 사용됩니다:
        $$ MPJPE = \frac{1}{N} \sum_{i=1}^{N} \left\| J_{i} - J^{*}_{i} \right\|_{2} $$
        여기서 $N$은 관절의 수, $J_{i}$는 $i$번째 관절의 실제 위치, $J^{*}_{i}$는 $i$번째 관절의 예측 위치입니다.
*   **랜드마크 표준 및 분류:**
    *   **유형별 랜드마크 수:** 신체 포즈 추정은 주로 18~33개의 랜드마크를 사용하며, 얼굴 포즈 추정은 68개 또는 MediaPipe Face Mesh와 같은 최신 방법에서는 468개까지 사용됩니다. 손 포즈 추정은 각 손당 21개의 랜드마크를 사용하는 것이 일반적입니다.
    *   **해상도 기반 분류:**
        *   **저해상도 (최대 30개 랜드마크):** 신체 포즈 추정에 적합하며, 넓은 수용 영역을 통해 폐색 및 복잡한 자세를 처리할 수 있습니다.
        *   **고해상도 (밀집된 포즈):** 얼굴(68개 이상) 및 손(21개/손) 포즈 추정에 필수적이며, 많은 수의 작고 밀집된 랜드마크를 정확하게 찾아내기 위해 요구됩니다.
*   **주요 데이터셋:**
    *   **신체:** COCO (멀티), MPII (단일), AI Challenger (대규모), PoseTrack (비디오), Human3.6M (3D).
    *   **얼굴:** 300W (다중), AFLW (다양한 외형), COFW (폐색), WFLW (밀집 98개).
    *   **손:** BigHand2.2M (대규모 3D), GANerated Hand Dataset (합성, 객체 포함), NYU Hand Dataset (RGB-D), HandNet Dataset (다양한 손 크기).
    *   **전신:** COCO-WholeBody (133개 키포인트 포함 전신 주석).
*   **2D vs 3D HPE 및 이미지 vs 비디오 입력:**
    *   다양한 2D/3D 신체, 얼굴, 손 포즈 추정 알고리즘과 이들의 GitHub 리포지토리 목록을 제시하며, 단일 이미지 입력 또는 비디오 입력을 사용하는 알고리즘들을 분류하여 소개했습니다.

## 🧠 Insights & Discussion

이 독립 연구는 인간 포즈 추정(HPE) 분야의 광범위한 발전을 심층적으로 분석하며 여러 중요한 통찰력을 제공합니다.

*   **딥러닝의 혁신:** 고전적 접근 방식이 가지고 있던 일반화 능력 부족, 폐색 및 복잡한 자세에 대한 취약성 문제를 딥러닝이 성공적으로 해결했음을 보여줍니다. 특히 Convolutional Pose Machine(CPM)은 다단계 컨볼루션 네트워크를 통해 이미지 특징과 공간적 관계를 동시에 학습하는 종단 간 학습 방식을 도입하여 HPE 분야에 획기적인 발전을 가져왔습니다.
*   **정확도 지표의 중요성:** HPE 모델의 성능을 정확히 평가하기 위한 다양한 지표(IoU, PCK, AP, MPJPE 등)의 필요성과 복잡성을 강조합니다. 이는 단일 지표로는 모델의 다양한 측면(정확성, 재현율, 3D 깊이 등)을 모두 반영하기 어렵기 때문입니다.
*   **데이터셋의 진화:** 고품질의 대규모 주석 데이터셋(예: COCO, Human3.6M, COCO-WholeBody)의 등장이 딥러닝 기반 HPE 모델의 발전에 결정적인 역할을 했음을 보여줍니다. 특히 전신(whole-body) 데이터셋과 같은 더 포괄적인 데이터셋의 등장은 실제 환경에서의 복잡한 포즈 추정을 가능하게 했습니다.
*   **HPE의 다양한 차원:** 2D에서 3D로의 확장, 단일 이미지에서 비디오로의 입력 방식 변화는 HPE의 응용 가능성을 크게 넓혔습니다. 3D HPE는 가상 현실, 로봇 제어, 의료 등 다양한 분야에서 더 풍부한 정보를 제공하며, 비디오 기반 HPE는 시간적 일관성을 활용하여 더 안정적인 추정을 가능하게 합니다.
*   **표준화 및 분류의 필요성:** 랜드마크 수에 따른 표준화와 해상도/밀도에 따른 분류는 HPE 연구자들이 각자의 연구 목표에 맞는 모델과 데이터셋을 선택하는 데 유용한 가이드라인을 제공합니다.

## 📌 TL;DR

*   **문제:** 이미지/비디오에서 인간 관절을 정확하게 찾아내는 인간 포즈 추정(HPE) 문제 해결.
*   **제안 방법/개념:** 고전적 방식(Pictorial Structures, FMP)의 한계를 넘어 딥러닝 기반의 **Convolutional Pose Machine (CPM)**이 등장하여 HPE 분야를 혁신. CPM은 다단계 컨볼루션 네트워크를 통해 이미지 특징과 공간적 맥락을 종단 간(end-to-end)으로 학습하며, 점진적인 예측 개선과 기울기 소실 문제 해결을 달성.
*   **주요 발견/통찰:** HPE 모델의 정확도를 평가하는 다양한 지표들(IoU, PCK, AP, MPJPE 등)을 정리하고, 신체, 얼굴, 손 등 유형별 랜드마크 표준 및 해상도 기반의 분류 체계를 제시. COCO, Human3.6M, COCO-WholeBody와 같은 대규모 2D/3D 데이터셋이 모델 발전에 필수적임을 강조하며, 2D/3D 및 이미지/비디오 기반 HPE의 특징과 응용 분야를 조명.