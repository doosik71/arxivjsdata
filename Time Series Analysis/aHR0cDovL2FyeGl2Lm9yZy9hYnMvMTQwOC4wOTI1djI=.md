# Network structure of multivariate time series

Vincenzo Nicosia, Lucas Lacasa, and Vito Latora

## 🧩 Problem to Solve

다변량 시계열 분석은 물리학, 생물학, 경제학 등 다양한 분야에서 현상을 이해하는 데 중요하지만, 기존 방법론은 주로 단변량 시계열에 국한되거나 (예: Visibility Graph), 다차원 시계열 간의 상호 의존성을 분석하는 데 있어 ad-hoc 위상 공간 분할 및 시계열 기호화(symbolization)와 같은 전처리 과정의 한계와 모호성을 가졌다. 대규모 데이터 구조의 가용성이 증가함에 따라 고차원 동적 시스템에서 정보를 추출할 수 있는 새롭고 비모수적인 접근 방식이 필요하다.

## ✨ Key Contributions

- 다변량 시계열을 다중 레이어 네트워크(multiplex visibility graph)로 매핑하는 새로운 비모수적 방법을 제안하여 고차원 동적 시스템을 분석한다.
- 관련된 다중 레이어 네트워크의 간단한 구조적 서술자(structural descriptors)가 결합된 카오스 맵의 동적 위상 전환 및 다양한 유형의 동기화 개시를 포함한 비자명한 속성을 추출하고 정량화할 수 있음을 입증했다.
- 금융 시계열 분석을 통해 이 방법이 금융 위기와 안정 기간을 효율적으로 구별할 수 있음을 보여주었으며, 이는 시계열 기호화에 기반한 표준 방법이 실패하는 경우가 많다는 점에서 큰 강점이다.
- 제안된 방법은 구현이 간단하고, 일반적이며, 확장 가능하고, ad-hoc 위상 공간 분할을 요구하지 않아 대규모, 이질적, 비정상 시계열 분석에 적합하다.

## 📎 Related Works

- **비선형 시계열 분석 및 데이터 마이닝:** [1, 2]
- **복잡계 네트워크 과학:** 시계열을 네트워크로 변환하여 분석하는 접근 방식 [3–5].
- **기능적 네트워크(Functional networks):** 시계열 간의 상호의존성(예: 교차상관 행렬)을 그래프의 가중치 있는 엣지로 해석하며, 신경과학 [39] 및 금융 [40] 분야에서 활용됨.
- **단변량 시계열을 추상 그래프로 매핑하는 방법:** Visibility Graph 알고리즘 [11, 12]은 단변량 시계열 분석에 효과적임 [13–19], 지구 및 행성 과학 [20–22], 금융 [23], 생체의학 [24] 등 다양한 분야에 적용되었으나 [25], 다변량 시계열에는 한계가 있었다.
- **다층 네트워크 이론(Multilayer networks theory):** 최근 발전된 다층 네트워크 연구 [26, 28–31, 34, 35]를 활용하여 새로운 정보를 추출한다.
- **결합 맵 격자(Coupled Map Lattices, CMLs):** 복잡한 시공간 동역학 모델링에 널리 사용되는 고차원 동적 시스템 [36–38].

## 🛠️ Methodology

1. **다변량 시계열 준비:** $M$개의 실측값으로 구성된 $N$개의 시점(time step)을 가진 $M$-차원 시계열 $\{x(t)\}_{t=1}^{N}$를 사용한다. 여기서 $x(t) = (x^{\text{[1]}}(t), x^{\text{[2]}}(t), \ldots, x^{\text{[M]}}(t))$이다.
2. **다중 레이어 네트워크 구축 (Multiplex Visibility Graph):**
   - 각각의 단변량 시계열 $\{x^{\text{[$\alpha$]}}(t)\}_{t=1}^{N}$에 대해 **수평 Visibility Graph (HVG)**를 생성한다. HVG는 두 데이터 포인트 $x(i)$와 $x(j)$ 사이에 중간 데이터 $x(k)$가 $\text{inf}\{x(i), x(j)\}$보다 작을 때 엣지를 연결하는 규칙을 따른다.
   - 생성된 각 HVG는 다중 레이어 네트워크 $M$의 개별 레이어 $\alpha$가 된다.
   - 결과적으로 $M$개의 인접 행렬 $A = \{A^{\text{[1]}}, A^{\text{[2]}}, \ldots, A^{\text{[M]}}\}$로 표현되는 다층 네트워크가 구성된다.
3. **레이어 간 상호 정보량 계산 (Inter-layer Mutual Information):**
   - $M$의 두 레이어 $\alpha$와 $\beta$에 대해 다음 식을 사용하여 레이어 간 상호 정보량 $I_{\alpha, \beta}$를 정의한다:
     $$I_{\alpha, \beta} = \sum_{k^{\text{[$\alpha$]}}} \sum_{k^{\text{[$\beta$]}}} P(k^{\text{[$\alpha$]}},k^{\text{[$\beta$]}}) \log \frac{P(k^{\text{[$\alpha$]}},k^{\text{[$\beta$]}})}{P(k^{\text{[$\alpha$]}})P(k^{\text{[$\beta$]}})}$$
     여기서 $P(k^{\text{[$\alpha$]}})$와 $P(k^{\text{[$\beta$]}})$는 각 레이어의 차수 분포를 나타내며, $P(k^{\text{[$\alpha$]}}, k^{\text{[$\beta$]}})$는 노드가 레이어 $\alpha$에서 차수 $k^{\text{[$\alpha$]}}$를 가지고 레이어 $\beta$에서 차수 $k^{\text{[$\beta$]}}$를 가질 공동 확률이다.
   - $I_{\alpha, \beta}$ 값은 두 레이어의 차수 분포(즉, 관련 시계열의 구조)가 얼마나 상관되어 있는지를 나타낸다.
4. **평균 상호 정보량:** 모든 가능한 레이어 쌍에 대한 $I_{\alpha, \beta}$ 값을 평균하여 스칼라 변수 $I = \langle I_{\alpha, \beta} \rangle_{\alpha, \beta}$를 얻는다. 이는 시스템 내 정보 흐름의 일반적인 양을 포착한다.
5. **레이어 그래프(Graph of Layers, G) 구성:** $I_{\alpha, \beta}$ 값은 $M$개의 노드를 가진 단일 레이어 가중치 그래프 $G$의 엣지 가중치로 사용될 수 있으며, 각 노드는 하나의 레이어를 나타낸다.
6. **백본 그래프(Backbone Graph, G') 구성:** 시각화 및 분석을 위해, $G$의 엣지를 $I_{\alpha, \beta}$ 값의 내림차순으로 추가하여 단일 연결된 구성 요소를 형성할 때까지 백본 그래프 $G'$를 구성한다.

## 📊 Results

1. **결합 맵 격자(CMLs) 분석:**

   - $M=5$개의 확산적으로 결합된 카오스 로지스틱 맵으로 구성된 CML을 연구한 결과, 평균 다중 레이어 상호 정보량($I$)이 Fully Developed Turbulence (FDT), Pattern Selection (PS), Spatio-temporal Intermittency (STI)와 같은 다양한 동적 위상을 성공적으로 구별했다.
   - $I$는 FDT 위상에서 결합 강도 $\epsilon$에 따라 단조롭게 증가하며 정보 흐름의 양을 정량화했고, 카오스 억제 또는 다중 밴드 카오스 어트랙터 개시와 같은 질적 변화를 감지하여 시스템의 스칼라 순서 매개변수로 활용될 수 있음을 보였다.
   - 표준 기호화 기반 상호 정보량($I_{\text{SYMB}}$)은 이러한 미묘한 동역학을 포착하지 못했다.
   - 레이어 그래프 $G$의 시각적 분석을 통해 동적 위상에 따라 다른 정보 흐름 패턴(예: FDT에서의 링형 구조)을 확인할 수 있었다.
   - **확장성 평가 ($M=200$ CMLs):** $M=200$개 맵에 대해 백본 그래프 $G'$는 각 동적 위상에서 고유한 구조(FDT에서는 체인, PS에서는 비상호작용 커뮤니티, STI에서는 약간 겹치는 밀집 커뮤니티)를 보여주어 고차원 시스템의 동역학을 질적으로 묘사하는 방법을 제공했다.

2. **금융 불안정성 분석:**
   - 1998년부터 2013년까지 NYSE와 NASDAQ에 상장된 35개 주요 미국 기업의 주가 시계열에 적용되었다.
   - 평균 다중 레이어 상호 정보량($I$)은 주요 금융 불안정기(예: 1998-1999년 닷컴 버블, 2007-2012년 서브프라임 모기지 위기)를 높은 피크로 명확히 식별했다.
   - 이러한 위기 기간은 주가 동기화 증가(높은 $I$)로 특징지어졌으며, 안정기(낮은 $I$)와 명확히 구분되었다.
   - 표준 기호화 기반 분석은 이러한 세부 사항을 효과적으로 포착하지 못했다.
   - 레이어 네트워크의 최대 스패닝 트리(MST)는 구조적 차이를 보였다: 위기 기간에는 전체 노드의 약 50%와 연결된 대규모 허브가 존재했지만, 경제 안정기에는 차수 분포가 더 균등했다.

## 🧠 Insights & Discussion

- 제안된 다중 레이어 Visibility Graph 접근법은 다변량 시계열 분석을 위한 강력하고 대안적인 방법을 제공한다.
- 이 방법은 표준 기호화 절차의 일반적인 문제점(예: 임의적인 분할)에 영향을 받지 않으며, 고차원 결합 카오스 맵의 동적 위상 개시와 레이어(맵) 간의 상호 정보량 증감/감소를 포착하고 정량화할 수 있다.
- 금융 시계열 분석에 적용하여 다중 레이어 측정값이 다른 표준 방법들과 달리 금융 안정 기간과 위기를 쉽게 구별할 수 있음을 보여주었으며, 의사 결정 지원 도구로 효과적으로 사용될 수 있음을 시사한다.
- 이 방법은 유체 역학에서 신경과학, 사회 과학에 이르기까지 동역학이 잘 이해되지 않거나 알려지지 않은 모든 상황에서 유연하게 사용될 수 있다.
- 본 연구는 시스템의 다양한 변수들 간의 정보 흐름 특성화를 중심으로 다루었지만, 이 접근 방식은 일반적으로 다층 네트워크의 특정 구조적 서술자와 실제 동적 시스템의 속성 간의 관계를 연구하는 길을 열어준다. 이는 모든 종류의 동적 시스템을 분류하기 위한 기능 기반 자동 도구 구축의 첫걸음이 될 것으로 기대된다.

## 📌 TL;DR

다변량 시계열 분석은 고차원 시스템에서 정보 추출이 어렵다는 문제에 직면한다. 본 논문은 다변량 시계열을 다중 레이어 Visibility Graph로 변환하는 비모수적 방법을 제안하며, 각 레이어는 단변량 시계열의 수평 Visibility Graph이다. 이 방법은 레이어 간 차수 분포의 상호 정보량을 활용하여 정보 흐름과 상호 의존성을 정량화한다. 그 결과, 결합된 카오스 맵의 동적 위상 전환 및 동기화를 성공적으로 식별하고 정량화했으며, 금융 시계열 데이터에서 위기 기간을 표준 방법보다 정확하게 구별해냈다. 이는 복잡한 동적 시스템을 이해하기 위한 일반적이고 확장 가능하며 견고한 도구를 제공한다.
