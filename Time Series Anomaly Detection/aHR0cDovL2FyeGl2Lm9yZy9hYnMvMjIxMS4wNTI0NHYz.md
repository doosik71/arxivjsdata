# Deep Learning for Time Series Anomaly Detection: A Survey

ZAHRA ZAMANZADEH DARBAN, GEOFFREY I. WEBB, SHIRUI PAN, CHARU C. AGGARWAL, MAHSA SALEHI

## 🧩 Problem to Solve

시계열 이상 탐지(Time Series Anomaly Detection, TSAD)는 금융, 경제, 지구 과학, 제조, 헬스케어 등 광범위한 분야에서 생산 결함, 시스템 오류, 건강 이상 징후와 같은 예측 불가능하거나 새로운 이벤트를 식별하는 데 매우 중요합니다. 시계열 데이터의 방대한 크기와 복잡한 패턴은 전통적인 탐지 방식으로는 효과적으로 처리하기 어렵습니다. 딥러닝 모델이 이러한 복잡성을 다루는 데 강력한 도구로 부상했지만, 최근 몇 년간 등장한 최신 딥 이상 탐지 모델, 특히 표현 학습(representation learning) 방법론을 포괄적으로 다루는 구조화되고 체계적인 조사가 부족한 실정입니다. 따라서 이 연구는 딥러닝 기반 TSAD의 최신 기술을 종합적으로 검토하고, 분류 체계를 제시하며, 실무적인 가이드라인과 미래 연구 방향을 제시하는 것을 목표로 합니다.

## ✨ Key Contributions

- **새로운 분류 체계:** 시계열 딥 이상 탐지 모델을 예측 기반(forecasting-based), 재구성 기반(reconstruction-based), 표현 학습 기반(representation-based), 하이브리드(hybrid)의 네 가지 주요 범주로 분류하고, 각 범주를 사용된 딥 신경망 아키텍처(예: RNN, CNN, GNN, Transformer, AE, VAE, GAN)에 따라 세분화했습니다.
- **종합적인 최신 리뷰:** 2024년까지의 시계열 이상 탐지(TSAD) 최신 기술에 대한 철저한 검토를 제공하여 해당 분야의 주요 방향과 신흥 트렌드를 파악할 수 있도록 했습니다.
- **벤치마크 및 데이터셋:** 이 분야에서 사용되는 주요 벤치마크 및 데이터셋을 컴파일하고 분류했으며, 연구자들의 쉬운 접근을 위해 하이퍼링크를 제공했습니다.
- **실무자를 위한 가이드라인:** 특정 요구사항과 데이터 특성에 기반하여 적절한 딥러닝 아키텍처, 데이터셋, 모델을 선택하는 방법에 대한 실용적인 가이드라인을 제시했습니다.
- **이상 현상의 기본 원리:** 시계열 데이터에서 발생하는 다양한 유형의 이상 현상(예: 전역, 상황별, 계절별, 추세, 형태 이상)에 대한 기본 원리를 논의하여 이상 현상의 본질을 이해하도록 돕습니다.
- **평가 지표 및 해석 가능성:** 평가 지표 선택 가이드라인과 함께 모델의 동작 및 결정을 이해하고 설명하는 데 도움이 되는 모델 해석 가능성에 대한 상세한 논의를 포함했습니다.

## 📎 Related Works

이전에는 이상 탐지 분야에 대한 여러 문헌 조사(예: [26], [140], [24], [17], [20])와 평가 리뷰 논문([153], [101])이 있었습니다. 그러나 시계열 데이터에 특화된 딥 이상 탐지 방법론에 대한 조사는 [37]이 유일하며, 이마저도 DAEMON [33], TranAD [171], DCT-GAN [114], Interfusion [117] 등 최근 몇 년간 등장한 광범위한 최신 TSAD 방법론을 충분히 다루지 못했고, 표현 학습(representation learning) 방법론이 분류 체계에 포함되지 않는 한계를 가지고 있었습니다.

## 🛠️ Methodology

이 조사는 딥러닝 기반 시계열 이상 탐지(TSAD) 모델을 네 가지 주요 접근 방식과 그에 따른 딥러닝 아키텍처로 분류합니다.

- **모델 분류 체계:**
  - **예측 기반 모델 (Forecasting-Based Models):**
    - 과거 데이터를 기반으로 다음 시점이나 시퀀스를 예측하고, 예측된 값과 실제 값 사이의 편차(예측 오차)를 이상 점수로 활용합니다.
    - 주요 아키텍처: RNN (LSTM, GRU), CNN (TCN), GNN, HTM, Transformer.
    - 예시: `LSTM-AD`는 LSTM을 사용하여 시계열의 장기적인 패턴을 학습하고 예측 오차를 통해 이상을 탐지합니다. `DeepAnt`는 CNN을 활용하여 시계열 패턴의 작은 편차를 효율적으로 탐지합니다.
  - **재구성 기반 모델 (Reconstruction-Based Models):**
    - 정상 데이터의 저차원 잠재 표현(latent representation)을 학습하고, 이로부터 원래 데이터를 재구성합니다. 이상 데이터는 정상 데이터와 다르기 때문에 재구성 오차가 크게 나타나며, 이를 이상 점수로 활용합니다.
    - 주요 아키텍처: Autoencoder (AE, SAE, DAE, CAE), Variational Autoencoder (VAE, CVAE, HVAE), Generative Adversarial Networks (GAN).
    - 예시: `DAGMM`은 AE와 가우시안 혼합 모델(GMM)을 결합하여 잠재 공간의 확률 분포를 학습합니다. `OmniAnomaly`는 VAE와 확률론적 RNN을 사용하여 다변량 데이터의 견고한 표현을 학습합니다.
    - AE의 재구성 오차 계산:
      $$A_S^w = \left\|X_{t-w:t} - \text{Dec}(\text{Enc}(X_{t-w:t}, \phi), \theta)\right\|^2$$
    - VAE의 손실 함수:
      $$\text{loss} = \left\|X_{t-w+1:t} - g(Z_{t-w+1:t})\right\|^2 + KL(N(\mu_x, \sigma_x), N(0,1))$$
    - GAN의 Minimax 게임:
      $$\min_G \max_D V(D,G) = E_{x \sim p(X)}[\log D(X_{t-w+1:t})] + E_{z \sim p(Z)}[\log(1 - D(Z_{t-w+1:t}))]$$
  - **표현 학습 기반 모델 (Representation-Based Models):**
    - 시계열 데이터의 풍부하고 견고한 잠재 표현을 학습하여, 이를 이상 탐지(후속 작업)에 활용합니다. 라벨링된 데이터가 부족한 시나리오에 특히 유용합니다.
    - 주요 아키텍처: Transformer, CNN (ResNet, TCN). 주로 자기 지도(self-supervised) 대조 학습(contrastive learning) 방식을 사용합니다.
    - 예시: `TS2Vec`은 계층적 Transformer 아키텍처와 대조 학습을 사용하여 다중 스케일 컨텍스트 정보를 포착합니다.
  - **하이브리드 모델 (Hybrid Models):**
    - 다양한 접근 방식의 강점을 통합하여 시계열 이상 탐지 성능을 향상시킵니다. 예측과 재구성을 동시에 수행하거나, GNN, VAE, LSTM 등을 결합합니다.
    - 주요 아키텍처: AE, RNN, GNN을 결합한 모델.
- **학습 방식 (Learning Schemes):** 라벨링된 데이터의 유무에 따라 비지도(unsupervised), 지도(supervised), 준지도(semi-supervised), 자기 지도(self-supervised) 방식으로 분류됩니다. 대부분의 모델은 라벨이 부족한 현실을 반영하여 비지도 또는 준지도 방식을 사용합니다.
- **입력 유형:** 개별 시점(point) 또는 과거 이력이 포함된 슬라이딩 윈도우(window)를 입력으로 사용합니다.
- **이상 유형:** 점 이상(point anomaly) 또는 부분 시퀀스 이상(subsequence anomaly)을 탐지합니다.
- **기타 특성:** 모델의 해석 가능성(interpretability), 확률론적 특성(stochasticity), 점진적 학습(incremental learning) 능력, 단변량/다변량 시계열(Univariate/Multivariate Time Series) 지원 여부, 시간적/공간적 의존성(temporal/spatial dependencies) 포착 여부 등을 고려합니다.

## 📊 Results

이 조사는 MSL, SMAP, SMD, SWaT와 같은 4가지 다변량 시계열(MTS) 데이터셋에서 15개의 최신 TSAD 모델에 대한 F1 점수 및 F1$_{PA}$ 점수 비교 결과를 제시합니다.

- **최신 모델의 성능 향상:** DACAD (2024), CARLA (2023), TimesNet (2023)과 같은 최근 개발된 모델들은 DAGMM (2018), LSTM-VAE (2018), OmniAnomaly (2018)와 같은 이전 모델들에 비해 일반적으로 더 높은 F1 및 F1$_{PA}$ 점수를 달성하며 우수한 성능을 보였습니다. 특히 DACAD는 MSL, SMAP, SMD 데이터셋에서 다른 모델들을 능가하는 성능을 나타냈습니다. 이는 시계열 이상 탐지 기술이 시간이 지남에 따라 지속적으로 발전하고 있음을 시사합니다.
- **주요 벤치마크 데이터셋:**
  - **다변량 시계열(MTS) 데이터셋:** MSL [92], SMAP [92], SMD [115], SWaT [129], PSM [1], WADI [7] 등이 가장 일반적으로 사용되는 벤치마크입니다.
  - **단변량 시계열(UTS) 데이터셋:** Yahoo [93], KPI [25], NAB [5], UCR [44] 등이 널리 사용됩니다.
    이러한 데이터셋들은 다양한 TSAD 모델의 성능을 평가하고 비교하는 데 중요한 역할을 합니다.

## 🧠 Insights & Discussion

시계열 이상 탐지 분야는 상당한 발전을 이루었음에도 불구하고, 여전히 여러 주요 과제를 안고 있습니다.

- **비정상성(Non-stationarity):** 현실 세계의 시스템은 환경 조건에 따라 매우 동적으로 변하며, 시계열 데이터 분포가 자주 변경되는 비정상성을 가집니다. 이는 딥러닝 모델이 지속적으로 업데이트되고 실시간으로 이상을 탐지할 수 있도록 온라인 또는 점진적 학습(incremental training) 방식을 요구합니다.
- **고차원 다변량 시계열(High-dimensional Multivariate Time Series):** 고차원에서는 데이터가 희박해지고, 시간적 종속성(temporal dependencies)과 차원 간의 관계(inter-dimensional relationships)를 동시에 고려해야 하므로 이상 탐지가 특히 어렵습니다.
- **라벨 부족(Lack of Labeled Data):** 라벨링된 이상 데이터가 매우 적기 때문에 비지도, 준지도 또는 자기 지도 학습 방식이 필수적입니다. 그러나 이는 많은 정상 인스턴스를 이상으로 잘못 분류하는 오탐(false positive)을 야기할 수 있으므로, 오탐을 최소화하고 탐지 재현율(recall rate)을 높이는 메커니즘 개발이 핵심 과제입니다.
- **노이즈(Noise):** 시계열 데이터셋은 노이즈의 존재 여부와 분포가 크게 다를 수 있으며, 노이즈는 모델을 취약하게 만들고 입력 데이터의 성능을 저해할 수 있습니다.
- **해석 가능성(Interpretability):** 이상 탐지가 진단 도구로 사용될 때, 이상 현상의 원인을 설명할 수 있는 해석 가능성은 필수적입니다. 하지만 현재 연구는 주로 탐지 정확도에 초점을 맞추고 해석 가능성 문제는 충분히 다루지 못하고 있습니다.
- **주기적 부분 시퀀스 이상(Periodic Subsequence Anomalies):** 주기적으로 반복되는 이상 부분 시퀀스 탐지는 문헌에서 드물게 다루어지지만, 사기 탐지 등 다양한 응용 분야에서 중요한 의미를 가질 수 있는 과제입니다.

이 연구는 최신 딥러닝 기반 TSAD 모델, 산업 응용, 그리고 데이터셋을 탐색하고 식별하는 것을 주요 목표로 했습니다. 시계열의 특성, 이상 유형, 딥러닝 모델의 구조 등 다양한 관점에서 64개의 최신 딥 모델을 종합적으로 논의하고 분류했습니다. 앞으로 이러한 과제들을 극복하기 위한 활발한 연구 노력이 필요함을 강조합니다.

## 📌 TL;DR

- **문제:** 복잡하고 대규모 시계열 데이터에서 나타나는 예측 불가능한 이상 현상(예: 시스템 오류, 질병 징후)을 효과적으로 탐지하기 위한 딥러닝 기반 방법론의 최신 동향을 체계적으로 정리하고 미래 연구 방향을 제시하는 포괄적인 개요의 필요성.
- **제안 방법:** 예측 기반, 재구성 기반, 표현 학습 기반, 하이브리드 방식의 딥러닝 모델을 중심으로 TSAD 방법론을 분류하고, 각 모델의 아키텍처(RNN, CNN, GNN, HTM, Transformer, AE, VAE, GAN 등), 학습 방식, 입/출력, 해석 가능성 등을 종합적으로 분석. 또한, 실제 적용 사례, 데이터셋, 평가 지표 및 실무 가이드라인을 제공.
- **주요 발견:** 최신 딥러닝 모델(예: DACAD, CARLA, TimesNet)이 기존 모델 대비 높은 성능을 보이며 이상 탐지 기술이 발전하고 있음을 확인. 그러나 비정상성, 고차원 데이터, 라벨 부족, 노이즈, 해석 가능성, 주기적 이상 탐지 등 해결해야 할 여러 과제가 여전히 존재함을 강조.
