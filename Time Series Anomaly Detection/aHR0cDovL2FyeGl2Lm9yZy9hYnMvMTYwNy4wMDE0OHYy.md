# LSTM-based Encoder-Decoder for Multi-sensor Anomaly Detection

Pankaj Malhotra, Anusha Ramakrishnan, Gaurangi Anand, Lovekesh Vig, Puneet Agarwal, Gautam Shroff

## 🧩 Problem to Solve

기계 장치에 부착된 센서에서 수집되는 시계열 데이터에는 종종 센서로 포착되지 않는 외부 요인으로 인해 본질적으로 예측 불가능한(unpredictable) 특성이 나타납니다. 이러한 경우, 정상성(stationarity)에 의존하는 수학적 모델이나 예측 오류를 사용하는 기존의 예측 기반 이상 감지 모델은 효과적으로 작동하지 못합니다. 본 연구는 예측 불가능한 시계열을 포함하여 다양한 시계열 데이터에서 견고하게 이상을 감지하는 방법을 찾는 것을 목표로 합니다.

## ✨ Key Contributions

- **LSTM 기반 인코더-디코더(EncDec-AD) 제안**: '정상' 시계열 동작을 재구성하도록 학습하고 재구성 오류를 사용하여 이상을 감지하는 LSTM 기반 인코더-디코더 모델을 제안합니다.
- **다양한 시계열에 대한 견고성 입증**: 예측 가능, 예측 불가능, 주기적, 비주기적, 준주기적 등 다양한 유형의 시계열에서 이상을 효과적으로 감지할 수 있음을 보여줍니다.
- **짧고 긴 시계열 처리 능력**: 짧은(길이 30) 시계열부터 긴(길이 500) 시계열까지 모두에서 이상을 감지할 수 있음을 입증합니다.
- **비정상 데이터가 희소하거나 없는 시나리오에 적합**: 모델은 '정상' 시퀀스만을 사용하여 훈련되므로, 비정상 데이터가 부족한 실제 환경에서 특히 유용합니다.

## 📎 Related Works

- **예측 기반 이상 감지 모델**:
  - EWMA (Exponentially Weighted Moving Average) (Basseville & Nikiforov, 1993)
  - SVR (Support Vector Regression) (Ma & Perkins, 2003)
  - 딥 LSTM 기반 예측 모델 (Malhotra et al., 2015; Chauhan & Vig, 2015; Yadav et al.)
- **비시간적 재구성 모델**:
  - 노이즈 제거 오토인코더(Denoising autoencoders) (Sakurada & Yairi, 2014)
  - 딥 빌리프 네트워크(Deep Belief Nets) (Wulsin et al., 2010)

## 🛠️ Methodology

1. **LSTM 인코더-디코더 모델 훈련**:
   - 주어진 시계열 $X = \{x^{(1)}, x^{(2)}, ..., x^{(L)}\}$ (각 $x^{(i)} \in R^{m}$은 $m$차원 벡터)을 재구성하도록 LSTM 인코더-디코더를 훈련합니다.
   - **훈련 데이터**: 오직 '정상' 시계열 인스턴스만 사용합니다.
   - **인코더**: 입력 시계열의 고정 길이 벡터 표현을 학습합니다.
   - **디코더**: 인코더의 표현을 사용하여 시계열을 재구성합니다.
   - **재구성 순서**: (Sutskever et al., 2014)와 유사하게 시계열을 역순으로 재구성하도록 훈련합니다. 즉, 목표 시계열은 $\{x^{(L)}, x^{(L-1)}, ..., x^{(1)}\}$입니다.
   - **손실 함수**: 정상 훈련 시퀀스 $s_{N}$에 대해 재구성 오류의 L2 norm을 최소화합니다:
     $$ \sum*{X \in s*{N}} \sum\_{i=1}^{L} \left\|x^{(i)} - x'^{(i)}\right\|^{2} $$
        여기서 $x'^{(i)}$는 $x^{(i)}$의 재구성된 값입니다.
2. **이상 가능성 계산**:
   - 각 시점 $t_{i}$에서 재구성 오류 벡터 $e^{(i)} = |x^{(i)} - x'^{(i)}|$를 계산합니다.
   - 정상 검증 세트 $v_{N1}$의 오류 벡터를 사용하여 정규 분포 $N(\mu, \Sigma)$의 파라미터 $\mu$와 $\Sigma$를 최대 우도 추정(MLE)으로 추정합니다.
   - 각 점 $x^{(i)}$에 대한 이상 점수 $a^{(i)}$를 계산합니다:
     $$ a^{(i)} = (e^{(i)} - \mu)^{T} \Sigma^{-1} (e^{(i)} - \mu) $$
   - **임계값 설정**: 감독 설정에서, $a^{(i)} > \tau$이면 해당 점을 '이상'으로 분류합니다. 임계값 $\tau$는 검증 세트 $v_{N2}$ 및 $v_{A}$에서 $F_{\beta}$ 점수를 최대화하도록 학습됩니다 ($F_{\beta}$는 정밀도(P)와 재현율(R)을 조합한 지표, $\beta < 1$은 재현율보다 정밀도에 더 가중치를 둡니다).

## 📊 Results

- **성능 지표**: 모든 데이터셋에서 $F_{\beta}$ 점수와 양성 우도비(TPR/FPR)가 높게 나타났습니다. 특히 양성 우도비가 1.0보다 현저히 높아, EncDec-AD가 비정상 지점에 대해 정상 지점보다 유의미하게 높은 이상 점수를 부여함을 시사합니다.
- **다양한 시계열 유형에 대한 효과**:
  - 주기적인 시계열 (Power Demand, Space Shuttle) 및 준주기적인 시계열 (ECG) 모두에서 이상 감지에 성공했습니다.
  - 예측 불가능한 시계열 (Engine-NP)에서 특히 우수한 성능을 보였습니다. 기존 LSTM-AD 모델이 Engine-NP에서 낮은 $F_{0.05}$ 점수(0.03)와 TPR/FPR(1.9)을 보인 반면, EncDec-AD는 $F_{0.1}$ 점수(0.93)와 TPR/FPR(7.6)로 훨씬 뛰어난 성능을 달성했습니다.
- **시계열 길이에 대한 견고성**: 짧은 시계열(길이 30)과 긴 시계열(길이 500) 모두에서 이상을 감지할 수 있음을 입증했습니다.

## 🧠 Insights & Discussion

- LSTM 인코더-디코더 기반 재구성 모델은 시계열 이상 감지를 위한 유망한 접근 방식임을 보여줍니다.
- 특히 예측 불가능한 시계열에서 이상을 감지할 수 있다는 점이 중요합니다. 많은 기존 이상 감지 모델은 시계열이 예측 가능하다는 전제에 의존하지만, EncDec-AD는 이러한 제약 없이 작동하므로 더 견고한 모델입니다.
- 긴 시계열(최대 500 길이)에서도 이상을 감지하는 능력은 LSTM 인코더-디코더가 정상 동작에 대한 견고한 모델을 학습한다는 것을 시사합니다.
- 비정상 데이터가 부족하거나 없는 실제 시나리오에서 훈련에 정상 데이터만 사용한다는 점은 큰 장점입니다.

## 📌 TL;DR

본 논문은 센서 데이터에서 예측 불가능한 시계열 이상을 감지하기 위한 새로운 LSTM 기반 인코더-디코더(EncDec-AD) 모델을 제안합니다. 이 모델은 '정상' 시퀀스만을 학습하여 재구성 오류를 통해 이상을 식별하며, 예측 가능/불가능, 주기적/비주기적, 짧거나 긴 시계열 등 다양한 유형의 데이터에서 기존 예측 기반 모델보다 견고하고 우수한 성능을 입증했습니다.
