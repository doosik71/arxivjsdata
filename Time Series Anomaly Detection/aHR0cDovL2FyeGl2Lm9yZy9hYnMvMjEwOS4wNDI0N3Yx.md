# DAE : Discriminatory Auto-Encoder for multivariate time-series anomaly detection in air transportation

Antoine Chevrot, Alexandre Vernotte, Bruno Legeard

## 🧩 Problem to Solve

항공 감시 시스템, 특히 ADS-B (Automatic Dependent Surveillance-Broadcast) 프로토콜은 항공기 수 증가에 따라 중요성이 커지고 있지만, 암호화 및 인증 기능 부재로 인해 **False Data Injection Attacks (FDIA)** 와 같은 사이버 보안 위협에 취약합니다. 공격자는 가짜 감시 정보를 주입하여 항공 교통 관제사(ATC)를 속일 수 있으며, 이는 심각한 안전 문제로 이어질 수 있습니다. 이 논문은 이러한 **다변량 시계열 데이터(multivariate time-series data)에서 FDIA를 포함한 이상 징후를 효과적으로 탐지하는 모델**을 개발하는 것을 목표로 합니다.

## ✨ Key Contributions

- **DAE (Discriminatory Auto-Encoder) 모델 제안**: 시계열 데이터의 변동성을 처리하는 새로운 비대칭 오토인코더. 단일 인코더가 여러 디코더에 연결되어 시계열 이상 탐지에 사용되는 것은 이 연구가 처음입니다. 각 디코더는 특정 비행 단계(예: 상승, 순항, 하강) 데이터를 학습합니다.
- **포괄적인 데이터 프레임워크 구축**: 데이터 정제, 특징 추출, 모델 훈련을 위한 데이터 직렬화를 포함하는 재현 가능한 프레임워크를 제공합니다.
- **실제적이고 재현 가능한 검증 시나리오 및 데이터셋 생성**: FDI-T 도구를 사용하여 다양한 유형의 이상 징후(실제 및 인위적)를 포함하는 평가 데이터셋을 구축하여 다른 모델과의 벤치마크 기반을 제공합니다.
- **DAE의 우수성 입증**: 제안된 DAE 모델이 기존 머신러닝 이상 탐지 모델들에 비해 전반적으로 더 나은 성능(정확도 및 탐지 속도)을 달성함을 실험적으로 보여줍니다.

## 📎 Related Works

- **ADS-B 보안 솔루션**:
  - **MLAT (Multilateration)**: 여러 수신기에서 ADS-B 메시지의 도착 시간(TOA) 차이를 측정하여 항공기 위치를 파악, 이상 탐지에 활용될 수 있으나, FDIA에 취약할 수 있음.
  - **물리 계층(Physical Layer) 정보 활용**: 신호 강도, 도플러 시프트 측정, Mode-S 센서의 클럭 시스템 등을 이용한 침입 탐지 시스템.
  - **암호화**: 신원 기반 암호화 또는 공개 키 기반 구조(PKI)를 사용하여 ADS-B 메시지의 기밀성 및 인증 확보 시도.
- **머신러닝 기반 이상 탐지**:
  - **비감독 학습(Unsupervised Learning)**:
    - **은닉 마르코프 모델(HMM)**: ADS-B 프로토콜의 숨겨진 상태를 예측하고 공격 시 편차 분석에 사용되지만, RNN 기반 모델에 비해 정확도나 FPR에서 이점 없음.
    - **오토인코더(Auto-Encoder, AE)**: LSTM 또는 GRU와 결합되어 시계열 데이터의 이상 탐지에 효과적임 (예: LSTM-AE).
    - **변분 오토인코더(Variational Auto-Encoder, VAE)**: 입력 데이터를 확률 분포의 파라미터로 매핑하는 확률적 접근 방식. LSTM-VAE 모델이 Support Vector Data Description (SVDD)와 결합되어 이상 임계값을 자동으로 결정하는 데 사용되기도 함.
    - **Isolation Forest**: 빠르고 가벼우며, 이전에 본 데이터와 유사한 이상 징후를 탐지하는 데 효과적이나, 오탐률(FPR)이 높을 수 있음.

## 🛠️ Methodology

DAE는 비대칭 LSTM 기반 오토인코더로, 시계열 데이터의 변동성을 다루기 위해 단일 인코더와 여러 디코더를 사용합니다.

1. **문제 정의**: 길이가 $N$인 다변량 시계열 $x=\{x_1, x_2, \dots, x_N\}$에서 특정 시간 윈도우 $W_{t-T:t}$가 비정상인지 여부를 탐지합니다. 각 윈도우는 **식별 기능 (discrimination feature)** $D_{t-T:t}$와 연관되어 비행 단계와 같은 외부 요인으로 인한 데이터 형태의 차이를 반영합니다.
2. **모델 아키텍처 (Figure 2)**:
   - **입력 데이터**: 다변량 시계열 시간 윈도우 (RNN용 3차원 배열)와 각 윈도우와 연결된 식별 데이터 (1차원 배열, 예: 비행 단계).
   - **정렬 계층 (Sorting Layer)**: 식별 기능에 따라 배치 데이터를 미니 배치로 분리하고, 각 미니 배치를 인코더로 전달합니다. 원본 순서를 기억하여 나중에 재구성합니다.
   - **인코더 (Encoder)**: 데이터의 시간적 종속성을 처리하기 위해 양방향 LSTM (Bi-LSTM) 계층을 사용합니다. 긴 시퀀스에서도 장기 종속성을 학습할 수 있도록 합니다.
   - **잠재 공간 (Latent Space)**: 인코더가 생성한 압축된 표현으로, ADS-B 데이터의 정상 패턴과 시간 의존성을 포착합니다.
   - **식별된 디코더 (Discriminated Decoders)**: DAE의 핵심적인 차별점입니다. 정렬 계층에서 분리된 미니 배치 각각에 대해 별도의 디코더가 존재합니다. 각 디코더는 단일 LSTM 계층으로 구성되며, 특정 비행 단계에 특화되어 학습됩니다.
   - **연결 계층 (Concatenation Layer)**: 훈련 중 정렬 계층이 기억한 순서에 따라 디코더의 출력을 재구성합니다.
3. **임계값 계산 및 이상 탐지**:
   - **이상 점수 (Anomaly Score)**: 재구성된 데이터와 원본 입력 데이터 간의 유사성 점수입니다. 평균 제곱 오차(Mean Squared Error) 등을 사용하여 계산하며, 높을수록 정상에 가깝습니다.
   - $$ \text{Anomaly}(W*{t-T:t}) = \frac{1}{n} \sum*{i=0}^{n} 1-(x_i - \hat{x_i})^2 $$
   - **임계값 설정**: 각 디코더의 출력 분포가 다르기 때문에, 각 디코더에 대해 별도의 임계값이 계산됩니다. 이 연구에서는 **3-시그마 규칙($\tau = \mu + 3\sigma$)**을 사용하여 훈련 데이터의 이상 점수 분포에서 임계값을 결정합니다. 이는 낮은 오탐률(FPR)을 유지하면서 이상 징후를 효과적으로 탐지하는 데 도움을 줍니다.
4. **데이터셋 생성 및 전처리**:
   - **데이터 수집**: OpenSky Network에서 ADS-B 이력 데이터를 Traffic Python 도구를 사용하여 수집합니다.
   - **전처리**: Scifly 도구를 사용하여 데이터 정제(디코딩 오류, 센서 부정확성으로 인한 큰 이상치 제거), 다운샘플링(초당 여러 메시지 -> 2초당 1개), TFRecord 형식으로 직렬화합니다.
   - **특징**: 고도(Altitude), 연속 거리 변화량(Consecutive Delta), 추적 변화량(Tracking Delta), 수직 속도(Vertical Rate), 지상 속도(Groundspeed), 비행 단계(Phases, 식별 기능으로 사용) 등이 사용됩니다. 위도/경도와 추적(heading) 같은 원래 특징은 지역 독립성과 불연속성 회피를 위해 변화량(delta) 특징으로 변환됩니다.
   - **FDI-T (False Data Injection Testing framework)**: ATC 전문가가 FDIA 시나리오를 설계하고 실제와 같은 이상 징후를 생성하여 평가 데이터셋을 만듭니다.

## 📊 Results

DAE는 ADS-B 시계열 이상 탐지에서 기존 모델들(LSTM-AE, VAE-SVDD, Isolation Forest) 대비 우수한 성능을 보였습니다.

- **전체 데이터셋(Total Dataset)**: DAE는 **F1-score 0.738**을 기록하여 다른 모델들(LSTM-AE: 0.544, VAE-SVDD: 0.440)보다 20% 이상 높은 성능을 보였습니다. Isolation Forest는 0.797로 높았으나, 이는 높은 오탐률(FPR 0.132)에 기인합니다. DAE는 **FPR 0.010**으로 매우 낮게 유지하면서도 높은 F1-score를 달성했습니다.
- **특정 이상 시나리오**:
  - **Made-up Crashes**: DAE는 **F1-score 0.955**로 압도적인 성능을 보이며, LSTM-AE (0.005)나 VAE-SVDD (0.573)에 비해 월등히 우수했습니다. 이는 DAE의 특화된 디코더가 일반적인 하강 궤적과 충돌 상황을 더 잘 구분했음을 시사합니다.
  - **Velocity Drift**: DAE는 **F1-score 0.939**로 역시 가장 좋은 성능을 보였습니다.
  - **Ryanair Hijack**: DAE는 **Recall 0.301, F1-score 0.439**로 LSTM-AE (Recall 0.637, F1-score 0.778)보다 낮은 수치를 보였으나, **FPR 0.017**로 LSTM-AE (0.001)에 비해 약간 높음에도 불구하고, 실제 비상 상황 시작 전에 이상 징후를 더 빠르게 감지하는 반응성을 보여주었습니다 (Figure 9 참조).
  - **Constant Position Offset**: 모든 모델이 낮은 F1-score를 보이며 이 시나리오에 취약했습니다 (DAE: 0.097, LSTM-AE: 0.060, VAE-SVDD: 0.107). 이는 작은 오프셋이 모델의 경보를 충분히 트리거하지 못했기 때문입니다.
  - **World Data (유럽 외부 데이터)**: DAE는 **Accuracy 0.989, FPR 0.011**로 우수한 일반화 성능을 보였습니다. 이는 DAE가 지역 독립적인 특징과 데이터 처리 방식을 통해 훈련되지 않은 지역의 데이터에서도 잘 작동함을 의미합니다.
- **훈련 속도**: Tesla V100 GPU에서 에포크당 평균 26분 소요.

## 🧠 Insights & Discussion

- **DAE의 효과**: 특화된 디코더 덕분에 DAE는 충돌과 같은 비정상적인 상황을 정상적인 하강 작업과 효과적으로 구별하며, 낮은 오탐률(FPR)을 유지합니다. 이는 단일 디코더를 사용하는 LSTM-AE와 VAE-SVDD보다 뛰어난 성능을 보입니다.
- **반응성 vs. 지속성**: Ryanair Hijack 시나리오에서 DAE는 이상 징후를 빠르게 감지하지만, 비행 경로 변경 이후에는 정상으로 돌아가는 경향이 있습니다. 이는 `DESCENT` 디코더가 활성화되어 이륙 공항 접근 시 비행 활동(혼잡 관리, 수평 비행) 변화에 덜 민감하기 때문일 수 있습니다.
- **Limitations 및 개선점**:
  - **데이터의 신뢰성**: 훈련 데이터 소스(센서, OpenSky Network)의 진정성이 모델 성능의 전제 조건입니다.
  - **공격의 은밀성**: 공격자가 ADS-B 프로토콜과 비행 계획을 신중하게 준수하는 경우, 탐지되지 않을 수 있는 허용 오차 범위가 존재합니다.
  - **온라인 학습 부재**: 현재 DAE는 온라인 학습을 지원하지 않으므로, 최신 ADS-B 데이터로 실시간 업데이트될 수 없습니다.
  - **도구 편향(Tool Bias)**: FDI-T를 통한 시나리오 생성은 특정 유형의 이상 탐지를 용이하게 할 수 있으나, 비지도 학습 모델의 강건성 입증에는 유용합니다.
  - **디코더 최적화**: 모든 DAE 디코더가 동일한 하이퍼파라미터와 아키텍처를 가졌지만, 비행 단계별 복잡도에 따라 디코더의 깊이나 크기를 다르게 설정하여 성능을 더욱 향상시킬 수 있습니다.
  - **FPR 관리**: 오탐(false positives)으로 인한 불필요한 조치를 피하기 위해, "4 또는 5 시그마 규칙"과 같은 추가적인 소프트 임계값을 도입하여 이상 징후의 심각도를 판단하고 오탐을 필터링할 수 있습니다.
- **지역 독립성**: 특징 선택과 전처리 덕분에 DAE는 훈련되지 않은 지역의 데이터에서도 낮은 FPR을 보여, 모델이 지역 독립적이며 특정 지역 모델을 여러 개 훈련할 필요가 없음을 입증합니다.

## 📌 TL;DR

이 논문은 ADS-B 프로토콜의 False Data Injection Attacks (FDIA)와 같은 사이버 보안 위협에 대응하기 위한 **다변량 시계열 이상 탐지 모델 DAE (Discriminatory Auto-Encoder)**를 제안합니다. DAE는 비행 단계(상승, 순항, 하강)를 식별 기능으로 활용하여 **단일 인코더와 여러 개의 특화된 디코더**를 사용하며, 각 디코더는 해당 비행 단계 데이터를 학습합니다. 실제 데이터와 FDI-T로 생성된 인위적 이상 징후를 포함하는 데이터셋을 구축하여 DAE의 성능을 평가한 결과, DAE는 기존 LSTM-AE, VAE-SVDD, Isolation Forest 모델들에 비해 **높은 정확도와 F1-score, 낮은 오탐률(FPR)을 달성**했으며, 특히 충돌과 같은 이상 징후 탐지에서 우수한 성능을 보였습니다. 또한, 모델의 지역 독립적인 특성과 빠른 이상 감지 반응성을 확인했습니다.
