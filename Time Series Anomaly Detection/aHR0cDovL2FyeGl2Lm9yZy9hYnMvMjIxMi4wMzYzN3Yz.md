# 시계열 데이터의 비지도 이상 탐지: 최신 방법들에 대한 광범위한 평가 및 분석

Nesryne Mejri, Laura Lopez-Fuentes, Kankana Roy, Pavel Chernakov, Enjie Ghorbel, Djamila Aouada

## 🧩 Problem to Solve

시계열 데이터의 비지도 이상 탐지(Unsupervised Anomaly Detection, UAD)는 다양한 분야에서 중요하게 다뤄지고 있지만, 실제 환경 제약을 고려한 최신 기술들에 대한 포괄적이고 광범위한 평가가 부족합니다. 기존 연구들은 주로 정밀도(precision), 재현율(recall), F1-점수와 같은 표준 성능 지표에만 의존하여 모델 크기, 안정성, 이상 유형에 대한 일반화 능력 등 실제 적용 가능성에 필수적인 측면들을 간과했습니다. 또한, 통일된 실험 프로토콜의 부재로 인해 연구마다 보고되는 결과가 크게 달라 직접적인 비교가 어렵다는 문제점이 있습니다.

## ✨ Key Contributions

본 논문은 시계열 데이터의 비지도 이상 탐지 기법들에 대한 심층적인 평가 연구를 제안하며, 다음을 포함한 핵심적인 기여를 합니다:

- (i) 시계열 데이터에 특화된 정교한 성능 지표(Tatbul et al., 2018의 범위 기반 지표)를 사용하여 평가합니다.
- (ii) 모델 크기(매개변수 수 및 메모리 사용량)와 모델 안정성(다섯 번의 반복 실행을 통한 평균 및 표준 편차 분석)을 연구합니다.
- (iii) 이상 유형(Lai et al., 2021의 분류에 따른 지점별/패턴별 이상)에 따른 탐지 기법들의 성능 분석을 제공합니다.
- (iv) 모든 실험에 대해 명확하고 통일된 프로토콜을 따릅니다.
- (v) 딥러닝(DL) 기반 방법뿐만 아니라 전통적인 머신러닝(ML) 방법도 함께 비교하여 실제 적용 가능성에 대한 통찰력을 제공합니다.

## 📎 Related Works

- **기존 평가 연구의 한계:** Choi et al. (2021), Lai et al. (2021), Kim et al. (2022), Schmidl et al. (2022), Audibert et al. (2022), Darban et al. (2022), Liu et al. (2022), Paparrizos et al. (2022), Belay et al. (2023) 등 많은 평가 연구들이 있었으나, 대부분 표준 성능 지표에만 초점을 맞추고 모델 크기, 안정성, 범위 기반 지표, 이상 유형 분석 등을 간과했습니다.
- **Point Adjustment (PA) 프로토콜에 대한 비판:** Xu et al. (2018)에 의해 도입된 PA 프로토콜은 이상 감지 성능을 과대평가할 수 있다는 비판(Kim et al., 2022)이 제기되었습니다.
- **ML vs. DL 방법 비교의 중요성:** Wu and Keogh (2021) 및 Audibert et al. (2022)는 전통적인 ML 방법이 여전히 시계열 이상 탐지에서 유효함을 강조했지만, 최근 연구(Darban et al., 2022; Liu et al., 2022, 2023)는 DL 기반 작업에만 초점을 맞추는 경향이 있습니다.

## 🛠️ Methodology

본 논문은 5가지 데이터셋(SWaT, MSL, SMAP, UCR, TODS)과 통일된 프로토콜을 사용하여 총 9가지 비지도 이상 탐지 방법을 평가했습니다.

1. **이상 유형 분류:**

   - **지점별(Point-wise) 이상:**
     - **전역 이상(Global outliers):** 시계열의 나머지 지점들과 크게 벗어나는 지점. ($||X_t - \hat{X}_t|| > \delta$, $\delta = \lambda\sigma(X)$)
     - **문맥적 이상(Contextual outliers):** 주변 지점들과 상당히 다른 개별 지점. ($||X_t - \hat{X}_t|| > \delta$, $\delta = \lambda\sigma(X_{t-k:t+k})$)
   - **패턴별(Pattern-wise) 이상:**
     - **Shapelet 이상:** 예상과 다른 Shapelet을 포함하는 비정상적인 서브 시퀀스.
     - **계절성 이상(Seasonal outliers):** 전체 시퀀스에 대해 예상치 못한 계절성을 갖는 서브 시퀀스.
     - **추세 이상(Trend outliers):** 추세가 중요하게 변경된 서브 시퀀스.

2. **이상 탐지 패러다임:**

   - **클러스터링 기반(Clustering-based):** 정상 시계열의 특징 공간 $N_n$을 정의하고, $f(X) \notin N_n$인 경우 이상 탐지. (예: OC-SVM, iForest)
   - **밀도 추정 기반(Density estimation-based):** 정상 시계열의 확률 밀도 함수 $p_{\theta}$를 추정하고, $L(\theta|X) > \tau$인 경우 이상 탐지. (예: LOF, DA-GMM)
   - **거리 기반(Distance-based):** 시계열 $X$와 참조 $R$ 간의 거리 $D(X,R)$를 정의하고, $D(X,R) > \delta$인 경우 이상 탐지. (예: Dynamic Time Warping, DAMP)
   - **재구성 기반(Reconstruction-based):** 정상 시계열을 정확히 재구성하는 모델을 학습하고, 재구성 오류 $||X-\hat{X}|| > \delta$인 경우 이상 탐지. (예: Auto-Encoders, USAD)
   - **예측 기반(Forecasting-based):** 과거 관측을 기반으로 미래 상태를 예측하고, 예측 오차 $|| \hat{X}_i - X_i || > \delta$인 경우 이상 탐지. (예: ARIMA, GDN)
   - **하이브리드(Hybrid):** 재구성 및 예측 방법을 결합하여 전역 및 지역 이상을 동시에 탐지. (예: MTAD-GAT)

3. **평가 방법:**

   - **데이터셋:** SWaT, MSL, SMAP (실제 다변량), UCR (실제 단변량, 낮은 이상 비율), TODS (합성 다변량, 5가지 이상 유형 주석 포함).
   - **평가 지표:**
     - **표준 지표:** 정밀도(Precision), 재현율(Recall), F1-점수.
     - **시계열 재정의 지표(Tatbul et al., 2018):** Precision$_{T}$, Recall$_{T}$, F1-score$_{T}$. 예측과 실제 이상 구간 간의 겹침(overlap) 크기, 위치, 카디널리티를 고려하며, flat, front, middle, back의 4가지 위치 바이어스(location bias)를 사용합니다.
   - **모델 안정성:** 각 실험을 5회 반복하여 평균과 표준 편차를 보고합니다.
   - **이상 유형에 대한 일반화:** TODS 데이터셋을 사용하여 5가지 이상 유형별 탐지율을 분석합니다.
   - **모델 크기:** 딥러닝 모델의 매개변수 수와 메모리 사용량(MB)을 보고합니다.
   - **전처리/후처리:** 데이터 정규화(Min-Max Normalization) 및 Point Adjustment (PA) 프로토콜의 적용 유무에 따른 성능을 비교합니다.

4. **평가 대상 모델:**
   - **Shallow ML:** OC-SVM, iForest, ARIMA, DAMP
   - **Deep Learning:** DA-GMM, THOC, USAD, GDN, MTAD-GAT

## 📊 Results

- **표준 지표 성능 (PA 미적용 시):**
  - MTAD-GAT가 SWaT, MSL, SMAP 데이터셋에서 일반적으로 가장 우수한 성능을 보였으나, TODS에서는 다른 방법들보다 낮은 성능을 기록했습니다.
  - DAMP는 UCR 데이터셋에서 모든 DL 방법보다 훨씬 높은 F1-점수를 달성하며 ML 방법의 유효성을 보여주었습니다.
  - OC-SVM은 THOC, USAD와 같은 일부 DL 방법과 고차원 데이터셋에서 비슷한 성능을 보였습니다.
  - 전반적으로 DL 방법이 더 정밀하지만, 일부 ML 방법은 재현율 지향적입니다.
- **Point Adjustment (PA)의 영향:** PA 적용 시 모든 방법의 성능이 크게 향상되었으며, 특히 iForest는 F1-점수가 17%에서 55%로 급증했습니다. 그러나 PA는 성능을 과대평가하고 실제 적용성을 왜곡할 수 있음을 확인했습니다.
- **데이터셋 복잡성:** 단변량인 UCR 데이터셋은 낮은 이상 비율 때문에 탐지가 어려웠습니다. SWaT과 같은 자연적이지만 인위적으로 유도된 이상은 탐지하기 쉬웠습니다.
- **시계열 재정의 지표 성능:**
  - 표준 지표와 비교했을 때 성능에 상당한 차이가 있었습니다. 이는 재정의 지표가 예측과 실제 이상 구간 간의 겹침 크기, 위치 등을 고려하기 때문입니다.
  - GDN과 USAD가 경쟁력 있는 결과를 보였습니다. MTAD-GAT는 하이브리드 방법임에도 불구하고 여기서는 표준 지표만큼의 우위를 보이지 못했습니다.
  - 예측 기반 기법(ML 및 DL)이 가장 높은 성능을 보여, 대부분의 이상이 국소적임을 시사했습니다.
  - 위치 바이어스(flat, front, middle, back)는 전체 F1-점수에 큰 변화를 주지 않았지만, MSL 및 SMAP 데이터셋에서는 middle 및 back 바이어스에서 성능이 향상되었습니다.
  - 모든 방법은 재정의 지표에서 낮은 성능을 보였는데, 이는 이상 구간의 경계를 정확히 식별하는 데 어려움이 있음을 나타냅니다.
- **모델 안정성:** ARIMA, OC-SVM, DAMP와 같은 확정적(deterministic) 방법이 가장 안정적이었으며, DL 방법 중에서는 DAGMM이 가장 안정적이었습니다.
- **모델 크기:** GDN은 모든 데이터셋에서 가장 적은 수의 매개변수를 가졌으며, 이는 USAD보다 약 300배 적은 수치였습니다. GDN은 복잡한 모델 아키텍처 없이도 효과적인 성능을 달성할 수 있음을 보여주었습니다.
- **이상 유형에 대한 일반화:**
  - 집단적 추세(Collective trend) 이상이 가장 탐지하기 어려운 유형으로 나타났습니다.
  - ARIMA와 GDN이 다양한 이상 유형에 대해 가장 좋은 일반화 능력을 보였습니다.
  - OC-SVM은 전역 지점(Global point) 및 집단적 Shapelet 이상 탐지에 뛰어났습니다.
  - USAD는 집단적 이상(collective outliers)에 강했으며, DAGMM은 계절성 이상에 효과적이었으나 Shapelet 이상에는 약했습니다.
  - MTAD-GAT는 하이브리드임에도 불구하고 집단적 이상 탐지에 실패했습니다.

## 🧠 Insights & Discussion

- **최적의 방법은 상황 의존적:** 특정 시나리오나 이상 유형에 따라 가장 적합한 방법이 달라지므로, 연구자들은 알고리즘의 효과적인 적용 조건을 명확히 제시해야 합니다.
- **예측 기반 방법의 일관성:** 예측 기반 접근 방식은 시계열에 특화된 범위 기반 지표에서 가장 일관된 성능을 보이는 경향이 있습니다.
- **전통적인 ML 방법의 유효성:** 전통적인 ML 방법은 딥러닝 방법과 비슷한, 심지어 더 나은 성능을 보이는 경우도 있어 여전히 유효하며, 특히 재현율을 중시하는 애플리케이션에 적합합니다.
- **PA 프로토콜의 문제점:** Point Adjustment (PA) 프로토콜은 탐지기 성능을 과대평가하여 실제 적용에 대한 오해를 불러일으킬 수 있습니다.
- **데이터셋의 도전 과제:** 고차원 다변량 시계열은 물론, 이상 비율이 매우 낮은 단변량 시계열도 탐지하기 어렵습니다.
- **이상 경계 탐지의 어려움:** 대부분의 모델은 범위 기반 지표에서 낮은 성능을 보여 이상 경계를 정확히 탐지하는 데 어려움이 있음을 시사합니다.
- **실용적 고려사항:** 모델 안정성 및 메모리 소비는 방법마다 크게 다르므로, 실제 하드웨어 제약을 고려한 모델 선택에 중요한 요소입니다.

## 📌 TL;DR

시계열 비지도 이상 탐지 분야의 포괄적인 평가 부족 문제를 해결하기 위해, 본 논문은 4가지 ML 및 5가지 DL 모델을 5가지 데이터셋에 대해 광범위하게 평가했습니다. 평가는 표준 지표 외에도 시계열 특화 범위 기반 지표, 모델 안정성, 모델 크기, 그리고 5가지 이상 유형에 대한 일반화 능력을 포함했습니다. MTAD-GAT는 표준 지표에서 강세를 보였으나, PA 프로토콜은 성능을 과대평가하는 경향이 있었습니다. 놀랍게도 DAMP, OC-SVM과 같은 전통적인 ML 방법이 범위 기반 지표에서 일부 DL 모델보다 우수하거나 경쟁력 있는 성능을 보였습니다. 예측 기반 방법은 범위 기반 지표에서 일관된 성능을 보였으며, 집단적 추세 이상이 가장 탐지하기 어려운 유형으로 나타났습니다. 대부분의 방법은 이상 경계를 정확히 식별하는 데 어려움을 겪었으며, 모델 안정성과 크기는 실용적 적용에 있어 중요한 고려사항임을 확인했습니다.
