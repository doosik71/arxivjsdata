# 단변량 시계열에서의 이상 탐지: 최신 기술 동향 조사

Mohammad Braei, Dr.-Ing. Sebastian Wagner

## 🧩 Problem to Solve

시계열 데이터의 이상 탐지는 오랜 기간 중요한 연구 분야였습니다. 최근 통계적, 머신러닝, 딥러닝 방법론이 급증하고 있지만, 이 세 가지 주요 범주에 걸친 광범위하고 비교 가능한 평가 연구가 부족합니다. 이로 인해 연구자들은 특정 유형의 시계열 데이터에 어떤 이상 탐지 방법이 가장 적합한지 판단하기 어렵습니다.

## ✨ Key Contributions

- **20가지 단변량 이상 탐지 방법론 비교 분석:** 통계적 방법, 고전적 머신러닝 방법, 딥러닝 방법을 포괄하는 20가지 최신 이상 탐지 알고리즘을 선정하여 비교 평가했습니다.
- **공개 벤치마크 데이터셋 활용:** 공개적으로 이용 가능한 5가지 벤치마크 시계열 데이터셋(Yahoo Services Network traffic, NYC Taxi Dataset)을 사용하여 신뢰할 수 있는 평가를 수행했습니다.
- **정확도(AUC) 및 계산 시간 분석:** 각 방법론의 이상 탐지 정확도(AUC-Value)와 학습 및 추론에 소요되는 계산 시간을 분석하여 성능에 대한 심층적인 통찰을 제공했습니다.
- **데이터 유형별 적합성 제시:** 특정 데이터 유형에 더 적합한 방법론에 대한 일반적인 지침을 제시했습니다.

## 📎 Related Works

- **초기 통계적 접근:** Tukey (1979)의 통계적 접근 방식 및 Chang et al. (1988)의 우도비 검정(LRT) 사용 제안.
- **M-Competition:** Makridakis Competition과 같은 시계열 예측 방법론 비교 대회. Makridakis et al. (2018)은 통계적 예측 방법과 머신러닝 예측 방법을 비교한 연구를 수행했습니다.
- **특정 데이터/알고리즘 비교 연구:**
  - Almaguer-Angeles et al. (2019): IoT 데이터셋에서 22개 머신러닝 알고리즘 비교.
  - Chakraborty et al. (1992): 신경망 접근 방식과 ARMA 모델 비교.
  - Lazarevic et al. (2003): 단일 데이터셋에서 LOF, SVM 등 다양한 클러스터링 기법 비교.
  - Munir et al. (2019): Yahoo Webscope 데이터셋에서 FuseAD를 LOF, iForest, OC-SVM, PCA, TwitterAD, DeepAnT와 비교.
- **시계열 클러스터링의 한계:** Keogh and Lin (2005)은 시계열 서브시퀀스 클러스터링의 의미 없음을 지적했습니다.

## 🛠️ Methodology

- **대상 방법론:**
  - **통계적 방법:** AR, MA, ARMA, ARIMA, SES (Simple Exponential Smoothing), DES (Double Exponential Smoothing), TES (Triple Exponential Smoothing), PCI (Prediction Confidence Interval).
  - **고전적 머신러닝 방법:** K-Means (STSC), DBSCAN, LOF (Local Outlier Factor), Isolation Forest, One-Class SVM (OC-SVM), XGBoost.
  - **딥러닝 방법:** MLP (Multi-Layer Perceptron), CNN (Convolutional Neural Network), CNN_B (CNN + Batch Normalization), CNN_Residual (CNN + Residual Blocks), WaveNet, LSTM (Long Short-Term Memory), GRU (Gated Recurrent Unit), Autoencoder.
- **데이터셋:** 5개의 단변량 시계열 데이터셋 (UD1-UD4: Yahoo 서비스 네트워크 트래픽 실제/합성 데이터, NYCT: 뉴욕시 택시 수요 데이터).
- **데이터 전처리:**
  - **표준화:** 각 데이터셋에 대해 평균($$\mu$$)을 0, 표준편차($$\sigma$$)를 1로 만드는 표준화($$\hat{x} = \frac{x - \mu}{\sigma}$$)를 수행했습니다.
  - **계절성/추세 제거:** 일부 모델(예: ARIMA의 $d$ 파라미터)은 데이터의 추세나 계절성을 제거하는 차분(differencing)을 적용했습니다. 신경망은 비정상성 추세 및 계절성을 자동으로 감지할 수 있는지에 대한 논의도 포함됩니다.
- **평가 지표:**
  - **F-Score:** 관련 연구에서 사용되는 지표로 언급되었으나, 주요 평가 지표는 아닙니다.
  - **AUC (Area Under the ROC-Curve):** 이상 탐지 알고리즘의 주요 정확도 측정 지표로 사용되었습니다. 무작위 이상 지점에 무작위 정상 지점보다 높은 이상 점수를 부여할 확률을 나타냅니다.
  - **계산 시간:** 총 학습 시간과 예측(추론) 시간을 합산하여 비교했습니다.
- **실험 설정:**
  - 데이터 분할: 학습 데이터 30%, 테스트 데이터 70% (딥러닝 모델의 경우 학습 데이터의 10%를 검증 셋으로 사용).
  - 하이퍼파라미터 튜닝: Naive Model Metric (NMM, $$ \frac{MSE*{Target model}}{MSE*{NaiveModel}} $$)을 최소화하는 방향으로 튜닝하여 예측 모델의 성능을 최적화했습니다. 목표는 NMM을 1 미만으로 유지하는 것입니다.
  - 소프트웨어: Python, Statsmodels, Scikit-learn, TensorFlow, Keras.
  - 하드웨어: 2xIntel Xeon CPU, 12.4GB RAM, 1xTesla K80 GPU.

## 📊 Results

- **UD1-UD4 데이터셋(점/집단 이상)에서의 성능:**
  - **정확도(AUC):** 통계적 방법(AR, MA, ARIMA, ES 등)이 가장 우수한 성능을 보였습니다. 상위 5개 알고리즘 중 4개가 통계적 방법이었습니다. 딥러닝 방법은 전반적으로 낮은 AUC 값을 기록했습니다.
  - **계산 시간:** AR, MA 모델이 가장 빨랐습니다. 딥러닝 방법은 학습 단계가 길어 전반적으로 계산 시간이 매우 길었습니다. SES, ES 등 일부 통계적 방법은 많은 머신러닝 방법보다 느렸습니다.
- **NYCT 데이터셋(맥락적 이상)에서의 성능:**
  - **정확도(AUC):** 놀랍게도 딥러닝 방법(특히 LSTM)이 통계적 방법보다 훨씬 높은 AUC 값을 달성하며 우수한 성능을 보였습니다. 통계적 방법은 매우 낮은 AUC 값을 기록했습니다.
  - **맥락적 이상에 대한 민감도:** NYCT 데이터셋의 이상은 맥락적 이상(값 자체는 정상이나 특정 상황에서 이상)인 반면, UD1-UD4의 이상은 주로 점 이상 또는 집단 이상이었기 때문입니다. 통계 모델은 이러한 맥락적 이상에 과적합되는 경향을 보인 반면, 딥러닝은 유연한 하이퍼파라미터 튜닝을 통해 더 잘 적응했습니다.
  - **추론 시간:** 딥러닝 방법의 대부분은 추론 시간이 매우 짧았지만, LSTM 및 GRU와 같은 순환 신경망은 추론 시간도 상당히 길어 대부분의 머신러닝 방법을 능가했습니다.

## 🧠 Insights & Discussion

- **이상 유형별 방법론 적합성:**
  - **점 이상 및 집단 이상:** 전통적인 통계적 방법(예: AR, MA)은 데이터 생성 프로세스에 기반을 두어 이러한 유형의 이상 탐지에서 머신러닝 및 딥러닝 방법보다 일반적으로 더 정확하고 빠르며, 하이퍼파라미터 수가 적어 최적화가 용이합니다.
  - **맥락적 이상:** 데이터셋이 주로 맥락적 이상을 포함하는 경우, 신경망(특히 딥러닝)이 통계적 방법보다 훨씬 높은 AUC 값을 달성할 수 있음을 보여주었습니다. 이는 딥러닝 모델의 유연성과 다양한 하이퍼파라미터 조정을 통해 맥락적 특성을 더 잘 포착할 수 있기 때문입니다.
- **계산 시간 고려 사항:** 통계적 방법은 일반적으로 계산 시간이 짧아 실시간 온라인 이상 탐지에 유리합니다. 딥러닝 방법은 학습 시간이 길고, 일부 순환 신경망은 추론 시간도 길어 특정 시나리오에서는 적용에 한계가 있을 수 있습니다.
- **예측과의 차이점:** 단변량 시계열 예측 분야에서는 통계적 방법이 머신러닝 및 딥러닝 방법을 압도하는 경향이 있었던 것과 달리, 이상 탐지에서는 딥러닝이 특정 유형의 이상(맥락적 이상)에 대해 우수한 성능을 보일 수 있음을 시사합니다.

## 📌 TL;DR

- **문제:** 단변량 시계열 이상 탐지에서 통계, 머신러닝, 딥러닝 방법론 간의 포괄적인 비교 평가 부족.
- **방법:** 20가지 방법론(통계 7, ML 6, 딥러닝 7)을 5개 벤치마크 데이터셋에서 AUC 및 계산 시간을 기준으로 평가.
- **결과:**
  - **점/집단 이상:** 통계적 방법(AR, MA)이 가장 높은 정확도와 빠른 계산 시간을 보였습니다.
  - **맥락적 이상:** 딥러닝 방법(LSTM)이 통계적 방법을 능가하는 정확도를 보였습니다.
  - **계산 비용:** 딥러닝은 일반적으로 학습 시간이 길고, 순환 신경망은 추론 시간도 긴 편이었습니다.
