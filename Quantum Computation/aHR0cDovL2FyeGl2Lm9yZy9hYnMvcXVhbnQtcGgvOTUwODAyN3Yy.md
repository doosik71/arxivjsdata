# 양자 컴퓨터에서 소인수 분해 및 이산 로그를 위한 다항 시간 알고리즘
Peter W. Shor

## 🧩 Problem to Solve
이 논문은 고전 컴퓨터에서는 해결하기 어려운 것으로 알려져 있으며 여러 암호 시스템(예: RSA)의 기반이 되는 두 가지 중요한 수학적 문제, 즉 **정수 소인수 분해**와 **이산 로그 계산**을 효율적으로 해결하는 것을 목표로 합니다. 강한 처치 테제(Strong Church's Thesis)는 어떤 물리적 컴퓨팅 장치도 튜링 머신에 의해 다항 시간 내에 시뮬레이션될 수 있다고 주장하지만, 양자 역학의 특성이 이러한 가정을 무효화할 수 있음을 보여줍니다. 이 논문은 양자 역학적 특성을 활용하는 가상의 양자 컴퓨터에서 이 문제들을 다항 시간 내에 해결할 수 있는 알고리즘을 제시합니다.

## ✨ Key Contributions
*   **소인수 분해 및 이산 로그 문제의 양자 컴퓨터에서의 다항 시간 해결 가능성 입증:** 고전 컴퓨터에서는 지수 시간이 소요되는 것으로 알려진 정수 소인수 분해 및 이산 로그 문제를 양자 컴퓨터에서는 입력 크기(숫자의 자릿수)에 대해 다항 시간 내에 해결할 수 있음을 보이는 효율적인 무작위 알고리즘을 제시합니다.
*   **양자 푸리에 변환(Quantum Fourier Transform)의 핵심 역할:** 두 알고리즘 모두에서 핵심적인 서브루틴으로 양자 푸리에 변환을 활용합니다. 특히 $q$가 2의 거듭제곱일 때 효율적인 구현 방법을 제시합니다.
*   **가역 모듈러 지수 연산(Reversible Modular Exponentiation)의 중요성 강조:** 양자 계산의 가역성 요구사항을 충족시키기 위한 모듈러 지수 연산의 가역적 구현 방법을 상세히 설명합니다.
*   **기존 암호 시스템에 대한 중대한 영향 시사:** 현재의 공개키 암호 시스템(예: RSA)의 보안 근간을 뒤흔드는 결과로, 양자 컴퓨터의 잠재적 파괴력을 보여줍니다.

## 📎 Related Works
*   **컴퓨팅 및 양자 역학:**
    *   **Church, Turing, Post (1936):** 계산 가능 함수와 비계산 가능 함수의 구분 및 처치 테제.
    *   **Benioff (1980, 1982a, 1982b):** 양자 역학이 튜링 머신의 계산 능력을 구현하기에 충분함을 보임.
    *   **Feynman (1982, 1986):** 양자 역학이 튜링 머신보다 더 강력한 계산 능력을 가질 수 있음을 처음 제안.
    *   **Deutsch (1985, 1989):** 양자 튜링 머신 및 양자 회로를 정의하고 양자 컴퓨팅의 잠재력 명시적으로 탐구.
    *   **Deutsch and Jozsa (1992), Berthiaume and Brassard (1992a, 1992b):** 양자 컴퓨터가 고전 컴퓨터보다 빠르게 정확히 해결할 수 있는 문제를 제시.
    *   **Bernstein and Vazirani (1993), Simon (1994):** 양자 컴퓨터가 고전 컴퓨터보다 기하급수적으로 더 빠른 속도로 해결할 수 있는 오라클 문제를 제시하여 본 논문의 아이디어에 영감을 줌.
*   **정수론 및 암호학:**
    *   **Miller (1976):** 무작위화를 사용하여 소인수 분해 문제를 원소의 오더 찾기로 환원하는 방법.
    *   **Rivest, Shamir, Adleman (1978):** RSA 공개키 암호 시스템.
    *   **Lenstra et al. (1990), Lenstra and Lenstra (1993), Gordon (1993):** 고전 컴퓨터에서 가장 빠른 소인수 분해 및 이산 로그 알고리즘인 수체 체(Number Field Sieve).
    *   **Odlyzko (1995), Knill (1995):** 소인수 분해 알고리즘의 후처리 단계 효율성 개선에 대한 사적 의견.
*   **양자 컴퓨터 구현:**
    *   **Cirac and Zoller (1995), DiVincenzo (1995), Sleator and Weinfurter (1995), Chuang and Yamamoto (1995):** 양자 컴퓨터 설계에 대한 제안.
    *   **Landauer (1995a, 1995b), Unruh (1995), Chuang et al. (1995), Palma et al. (1995):** 양자 컴퓨터 구현의 난관(디코히어런스, 정밀도)에 대한 논의.

## 🛠️ Methodology
이 논문의 핵심 방법론은 **양자 컴퓨터의 병렬 처리 능력**과 **양자 푸리에 변환(QFT)**을 활용하여 고전적으로 어려운 두 가지 문제(소인수 분해, 이산 로그)를 해결하는 것입니다.

### 1. 양자 컴퓨터 모델
*   **양자 게이트 어레이 (Quantum Gate Arrays):** 고전적인 비순환 회로와 유사하게 양자 비트를 조작하는 게이트의 시퀀스로 구성됩니다.
*   **양자 비트 (Qubits):** $n$개의 컴포넌트를 가진 시스템의 상태는 $2^n$차원 힐베르트 공간의 단위 벡터로 표현되며, **중첩(superposition)** 상태를 가집니다: $\sum_{i=0}^{2^n-1} a_i |S_i\rangle$, 여기서 $\sum_i |a_i|^2 = 1$입니다.
*   **측정:** 측정 시 특정 기저 상태 $|S_i\rangle$를 관측할 확률은 $|a_i|^2$이며, 측정 후 시스템은 관측된 상태로 투영(project)됩니다.
*   **양자 게이트:** 양자 상태를 변환하는 데 사용되는 **유니타리 행렬(Unitary Matrix)**로 표현되는 국소 변환입니다. 모든 1-비트 게이트와 하나의 2-비트 게이트(제어 NOT 게이트)는 보편적인 양자 계산이 가능하게 합니다.

### 2. 가역 모듈러 지수 연산 (Reversible Modular Exponentiation)
*   양자 계산은 본질적으로 **가역적(reversible)**이어야 합니다. 즉, 출력 상태로부터 입력 상태를 유일하게 추론할 수 있어야 합니다.
*   고전적인 계산을 양자 컴퓨터에서 수행하려면 가역적으로 만들어야 하며, 이를 위해 Toffoli 게이트나 Fredkin 게이트와 같은 범용 가역 게이트가 사용됩니다.
*   **$a \rightarrow (a, x^a \pmod n)$** 계산을 위한 가역 게이트 어레이를 구성합니다. 이는 양자 소인수 분해 알고리즘의 핵심 서브루틴입니다.
    *   반복 제곱법(repeated squaring)과 모듈러 곱셈을 사용하여 $x^a \pmod n$을 계산합니다.
    *   중간 계산에 사용되는 작업 비트(work bits)는 Bennett의 방법론을 사용하여 0으로 재설정하여 양자 간섭 패턴에 영향을 미치지 않도록 합니다.

### 3. 양자 푸리에 변환 (Quantum Fourier Transform, QFT)
*   상태 $|a\rangle$를 다음 상태로 변환하는 유니타리 행렬 $A_q$를 구현합니다:
    $$ |a\rangle \rightarrow \frac{1}{\sqrt{q}} \sum_{c=0}^{q-1} \exp\left(\frac{2\pi iac}{q}\right) |c\rangle $$
*   $q=2^l$인 경우, QFT는 $l(l-1)/2$개의 양자 게이트($R_j$와 $S_{j,k}$)를 사용하여 다항 시간 $O((\log q)^2)$ 내에 효율적으로 구현될 수 있습니다. 이는 고전적인 고속 푸리에 변환(FFT) 알고리즘의 양자 버전입니다.

### 4. 소인수 분해 알고리즘 (Order-Finding Algorithm)
정수 $n$의 인수를 찾기 위해 먼저 $x \pmod n$의 오더 $r$ (즉, $x^r \equiv 1 \pmod n$을 만족하는 최소 양의 정수 $r$)을 찾습니다.
1.  $n^2 \le q < 2n^2$를 만족하는 2의 거듭제곱 $q$를 선택합니다.
2.  두 개의 양자 레지스터를 초기화합니다: $\frac{1}{\sqrt{q}} \sum_{a=0}^{q-1} |a\rangle |0\rangle$. (첫 번째 레지스터를 균일 중첩 상태로 만듭니다.)
3.  두 번째 레지스터에 $x^a \pmod n$을 가역적으로 계산합니다: $\frac{1}{\sqrt{q}} \sum_{a=0}^{q-1} |a\rangle |x^a \pmod n\rangle$.
4.  첫 번째 레지스터에 양자 푸리에 변환 $A_q$를 적용합니다:
    $$ \frac{1}{q} \sum_{a=0}^{q-1} \sum_{c=0}^{q-1} \exp\left(\frac{2\pi iac}{q}\right) |c\rangle |x^a \pmod n\rangle $$
5.  두 레지스터를 측정하여 $|c\rangle$와 $|x^k \pmod n\rangle$를 얻습니다.
6.  측정된 $c$ 값을 사용하여 $d/r$이 $c/q$에 근접하는 분수임을 이용, 연분수(continued fraction) 확장을 통해 $r$을 찾습니다. $c/q \approx d/r$인 경우, $|c/q - d/r| \le 1/(2q)$ 관계가 성립합니다.
7.  오더 $r$을 찾으면, 고전적인 알고리즘 $\text{gcd}(x^{r/2}-1, n)$을 사용하여 $n$의 인수를 얻습니다.

### 5. 이산 로그 알고리즘
소수 $p$, 생성자 $g$, 그리고 $x$가 주어졌을 때, $g^r \equiv x \pmod p$를 만족하는 $r$을 찾습니다.
1.  $p < q < 2p$를 만족하는 2의 거듭제곱 $q$를 선택합니다.
2.  세 개의 양자 레지스터를 초기화합니다: $\frac{1}{p-1} \sum_{a=0}^{p-2} \sum_{b=0}^{p-2} |a\rangle |b\rangle |0\rangle$.
3.  세 번째 레지스터에 $g^a x^{-b} \pmod p$를 가역적으로 계산합니다: $\frac{1}{p-1} \sum_{a=0}^{p-2} \sum_{b=0}^{p-2} |a\rangle |b\rangle |g^a x^{-b} \pmod p\rangle$.
4.  첫 번째와 두 번째 레지스터에 양자 푸리에 변환 $A_q$를 적용합니다.
5.  세 레지스터를 측정하여 $|c\rangle, |d\rangle, |y\rangle$를 얻습니다. 여기서 $y \equiv g^k \pmod p$입니다.
6.  측정된 $(c, d)$ 쌍은 $rc+d$가 $q$의 정수배에 매우 가깝다는 정보를 제공하며, 이를 통해 $r$을 추론할 수 있습니다.
7.  $\left| \frac{c(p-1) - \{c(p-1)\}_q}{q} r + \frac{d}{q} \right|$ 이 작다는 조건을 이용하여 $r$ 값을 찾습니다.

## 📊 Results
*   **소인수 분해:** $n$을 소인수 분해하는 데 필요한 단계는 양자 컴퓨터에서 비트 수 $\log n$에 대해 점근적으로 $O((\log n)^2 (\log \log n)(\log \log \log n))$입니다. 이는 고전적인 수체 체(Number Field Sieve) 알고리즘의 지수 시간 $O(\exp(c(\log n)^{1/3}(\log \log n)^{2/3}))$에 비해 기하급수적으로 빠릅니다.
*   **이산 로그:** 이산 로그를 계산하는 데 필요한 단계 또한 양자 컴퓨터에서 다항 시간 내에 이루어집니다. 이는 고전적인 알고리즘(예: Gordon의 수체 체 변형)의 지수 시간에 비해 훨씬 빠릅니다.
*   **성공 확률:** 각 실험에서 오더 $r$이나 이산 로그 $r$을 찾을 확률이 충분히 높으므로, 실험을 다항 번 반복하여 높은 확률로 정확한 값을 찾을 수 있습니다.

## 🧠 Insights & Discussion
*   **암호학에 대한 중대한 영향:** 이 연구는 현재 널리 사용되는 공개키 암호 시스템(예: RSA)의 보안을 완전히 무너뜨릴 수 있는 잠재력을 보여주었습니다. 이러한 시스템의 안전성은 소인수 분해 및 이산 로그 문제의 어려움에 기반하고 있기 때문입니다.
*   **양자 컴퓨터의 실현 가능성 문제:** 실제 양자 컴퓨터를 구축하는 것은 여전히 엄청난 공학적, 물리학적 난제에 직면해 있습니다. 특히 **디코히어런스(decoherence)** (양자 중첩 상태가 환경과의 상호작용으로 깨지는 현상)와 **정밀도(precision)** 유지가 가장 큰 장애물로 꼽힙니다. 양자 오류 수정 코드에 대한 연구가 진행 중이지만, 규모 확장은 여전히 미해결 과제입니다.
*   **강한 처치 테제에 대한 도전:** 양자 컴퓨터의 등장은 '어떤 물리적 컴퓨팅 장치도 튜링 머신에 의해 다항 시간 내에 시뮬레이션될 수 있다'는 강한 처치 테제(Strong Church's Thesis)에 의문을 제기합니다. 양자 역학은 고전 역학으로는 효율적으로 시뮬레이션하기 어려운 계산 능력을 제공합니다.
*   **새로운 문제 해결 영역:** 이산 로그와 소인수 분해 외에도 양자 컴퓨터로 효율적으로 해결할 수 있는 다른 어려운 문제들이 있을 수 있습니다 (예: 격자에서 짧은 벡터 찾기). NP-완전 문제 해결 가능성은 여전히 이론 컴퓨터 과학의 "성배"이며, 아직 양자 컴퓨터가 이를 해결할 만큼 강력한지는 불분명합니다.
*   **고전 계산과의 상호작용:** 알고리즘은 양자 계산과 고전적 후처리(예: 연분수 알고리즘, GCD)를 결합합니다. 이는 양자 컴퓨터가 모든 계산을 담당하는 것이 아니라, 고전 컴퓨터가 비효율적인 특정 병목 구간을 해결하는 데 특화될 수 있음을 시사합니다.

## 📌 TL;DR
피터 쇼어(Peter W. Shor)의 이 획기적인 논문은 **양자 컴퓨터가 고전 컴퓨터에서는 지수 시간이 걸리는 정수 소인수 분해 및 이산 로그 문제를 다항 시간 내에 해결할 수 있음**을 증명합니다. 핵심 방법론은 **양자 푸리에 변환(QFT)**과 **가역 모듈러 지수 연산**을 활용하여 오더 찾기 알고리즘을 구현하는 것입니다. 이 결과는 현재의 공개키 암호 시스템(예: RSA)의 보안을 근본적으로 위협하며, 양자 컴퓨터의 잠재력과 함께 **디코히어런스** 및 **정밀도**와 같은 실제 구현의 난제에 대한 심층적인 논의를 촉발했습니다.