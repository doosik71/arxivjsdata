# Deep learning for surgical instrument recognition and segmentation in robotic-assisted surgeries: a systematic review

Fatimaelzahraa Ali Ahmed, Mahmoud Yousef, Mariam Ali Ahmed, Hasan Omar Ali, Anns Mahboob, Hazrat Ali, Zubair Shah, Omar Aboumarzouk, Abdulla Al Ansari, Shidin Balakrishnan

## 🧩 Problem to Solve

로봇 보조 최소 침습 수술(MIS)에서 수술 도구를 인식하고 분할하는 것은 수술 기술 발전에 중요한 기여를 합니다. 그러나 딥러닝(DL) 모델을 효과적으로 훈련하기 위한 대규모의 정확하게 주석이 달린 데이터셋이 부족합니다. 수동 주석 작업은 노동 집약적이고 시간이 많이 소요되며 전문 외과 의사의 귀중한 시간을 소비합니다. 또한, 다양한 조명 조건, 시각적 방해물, 수술 장면의 복잡성, 도구 간의 유사성, 역동적인 수술 환경으로 인해 기존 방법론은 정확한 도구 감지 및 분할에 한계가 있습니다. 따라서 방대한 로봇 보조 수술(RAS) 비디오 데이터를 활용하여 수술 교육, 분석 및 자동화를 향상시키기 위한 자동화되고 정확하며 효율적인 수술 도구 인식 및 분할 방법이 절실히 필요합니다.

## ✨ Key Contributions

이 체계적인 문헌 검토는 로봇 보조 최소 침습 수술(MIS)에서 수술 도구 인식 및 분할을 위한 딥러닝(DL) 모델의 적용에 대한 포괄적인 분석을 제공하며, 48개의 관련 연구를 검토하여 다음과 같은 핵심 기여를 합니다.

* **포괄적인 DL 모델 평가**: 다양한 DL 방법론(CNN, U-Net, ResNet, 트랜스포머, GAN) 및 아키텍처의 효과를 평가하여 수술 도구 감지 및 분할의 정확성과 효율성을 크게 향상시켰음을 보여줍니다.
* **광범위한 임상 적용 식별**: 실시간 수술 중 안내, 종합적인 수술 후 평가, 객관적인 수술 기술 평가 등 다양한 임상 시나리오에서 DL의 잠재력을 강조합니다.
* **교육 및 훈련에 대한 영향 강조**: DL이 기술 평가의 정확성을 높이고 수술 훈련 프로그램의 전반적인 품질을 변화시키는 중요한 역할을 수행함을 입증합니다.
* **주요 과제 및 한계 제시**: 효과적인 모델 훈련을 위한 대규모의 정확하게 주석이 달린 데이터셋의 필요성과 노동 집약적인 수동 주석 과정의 병목 현상과 같은 현재의 한계를 명확히 합니다.
* **미래 연구 방향 제시**: 감지 및 분할 프로세스 자동화, 환경 변화에 대한 모델 견고성 향상, 다양한 수술 전문 분야로의 적용 확장, 증강 현실(AR)과 같은 신기술과의 통합을 포함한 미래 연구를 위한 핵심 영역을 제안합니다.

## 📎 Related Works

이 논문은 로봇 수술 분야에서 인공지능(AI)의 다양한 활용에 대한 기존의 여러 문헌 검토와는 차별화됩니다.

* **기존 문헌 검토와의 차별점**: 이전 연구(예: Knudsen et al. 2024, Zhang et al. 2024, Amin et al. 2024, Moglia et al. 2021, Ward et al. 2021)는 검색 범위가 넓거나 최신 연구를 다루지 않는 경우가 많았습니다. 본 검토는 로봇 수술에서 딥러닝 기술에 초점을 맞추고, 2017년부터 2024년까지의 연구를 포함하며, 6개의 주요 데이터베이스를 사용하여 PRISMA 가이드라인에 따른 체계적인 접근 방식을 따랐습니다.
* **딥러닝의 등장**: 딥러닝은 1986년에 처음 제시되었고 2009년 ImageNet의 출현으로 현대적 시대가 시작되었지만, 로봇 보조 수술 비디오의 수술 주석 분야에는 2017년에야 도입되었습니다.
* **기존 이미지 처리의 한계**: 전통적인 이미지 처리 기술 및 수동 방법은 시간 소모적이고 노동 집약적이며, 도구 감지 및 분할과 같은 작업에서 딥러닝 모델이 제공하는 정밀도가 부족함을 언급했습니다 (Ansari et al. 2022, Dakua et al. 2019, Yusuf et al. 2022).
* **데이터셋 생성의 어려움**: 정확하게 레이블링된 대표성 있는 데이터 부족이 DL 활용의 주요 과제로 지적되었습니다 (Kawka et al. 2021, Kitaguchi et al. 2022).
* **일부 DL 네트워크의 성능**: Faster R-CNN, Mask R-CNN, SSD와 같은 DL 네트워크가 도구 인식에 사용되었지만, 수술 장면의 복잡성 등으로 인해 정확도에 여전히 과제가 있음을 언급했습니다 (Lee et al. 2021, Kletz et al. 2019).

## 🛠️ Methodology

이 체계적인 문헌 검토는 PRISMA 가이드라인 (Page et al. 2021)에 따라 수행되었으며, 다음 단계를 거쳤습니다.

1. **데이터베이스 검색**: PubMed, Scopus, IEEE Xplore, Embase, Medline, Web of Science의 6개 데이터베이스를 사용하여 문헌을 검색했습니다.
    * **검색어**: 'surgery', 'deep learning', 'application'을 주요 검색어로 사용했으며, 'AI'와 'ML'도 포함하여 광범위한 문헌을 수집했습니다.
    * **기간**: 딥러닝이 로봇 보조 수술 주석 분야에 도입된 2017년부터 2024년까지 출판된 학술 논문을 대상으로 했습니다.
2. **선정 기준**:
    * **포함 기준**: 최소 침습 수술(MIS) 내 딥러닝 적용, 모든 유형의 로봇 보조 수술(수술 세부 분야 불문), 모든 유형의 딥러닝 알고리즘(CNN, GAN, 트랜스포머 등)을 보고한 논문.
    * **제외 기준**: 개방형 수술 및 로봇 보조가 아닌 최소 침습 절차, 딥러닝 기술을 사용하지 않고 AI 또는 ML 기술만 보고한 논문, 검토 논문 또는 메타 분석, 엄격한 방법론이나 충분한 설명이 부족한 논문, 수술 도구 주석과 관련 없는 딥러닝 적용을 보고한 논문.
3. **연구 선택 과정**:
    * 중복 항목 제거 후, Covidence 소프트웨어를 사용하여 제목과 초록을 기준으로 1248개의 논문을 선별했습니다.
    * 선별된 논문의 전문을 확보하고 포함 기준에 따라 추가 평가하여 최종적으로 48개의 연구를 포함했습니다.
    * 세 명의 저자가 독립적으로 연구 선택을 수행했으며, 이견은 토론을 통해 해결하고 합의가 이루어지지 않을 경우 네 번째 저자에게 자문을 구했습니다.
4. **데이터 추출**: 포함된 48개 연구에서 다음 정보를 추출했습니다.
    * 제목, 연도, 저자, 연구 목적, 연구의 한계, 딥러닝 모델, 주석 방법, 임상 적용, 사용된 데이터셋, 성능 지표 및 점수, 네트워크 아키텍처, 에포크 및 배치 크기, 학습률, 옵티마이저 및 손실 함수, 훈련에 사용된 하드웨어.
5. **데이터 합성 및 분석**:
    * 추출된 데이터는 임상 사용 사례, 딥러닝 모델, 주석 유형, 성능 지표, 데이터 및 데이터셋 특성, 하드웨어 및 계산 자원의 6가지 주요 매개변수를 기준으로 범주화되었습니다.
    * 이러한 범주 내에서 패턴, 추세 및 특이점을 식별하고, IoU 및 Dice 계수와 같은 성능 지표를 비교 분석하여 딥러닝 모델의 적용 및 성능에 대한 통찰력을 도출했습니다.

## 📊 Results

이 체계적인 문헌 검토를 통해 총 10,472개의 연구 중 48개의 연구가 최종 포함되었으며, 주요 결과는 다음과 같습니다.

* **주석 방법**:
  * 포함된 연구들은 객체 감지, 분류 및 위치 파악, 이진 분할, 의미론적 분할, 도구 부분 분할 등 다양한 주석 방법을 사용했습니다.
  * 의미론적 분할은 9개 연구에서 사용되었으며, 가위, 그리퍼, 집게 등 다양한 도구가 감지 및 분할되었습니다.
  * 두 연구에서 실시간 의미론적 분할이 성공적으로 시연되었습니다.
  * 다른 적용 분야로는 도구 존재 감지, 도구 모서리/중앙선/팁/조인트 감지 등이 있었습니다.
* **데이터셋**:
  * EndoVis2017/2018, ARAS-EYE, RoboTool, Multi-scenery Surgical Tool PUMCH와 같은 5개의 공개 데이터셋이 널리 사용되었습니다.
  * 10개 연구에서는 자체 개발한 비공개 데이터셋을 활용했습니다 (로봇 기관지 내시경, 부인과 자궁근종 절제술, 로봇 직장고정술, 근치적 전립선 절제술 등).
  * 대부분의 데이터가 돼지 모델에서 파생되어 인간 데이터 및 실제 주석 데이터의 부족이 확인되었습니다.
* **딥러닝 모델**:
  * **CNNs**가 가장 널리 사용되었으며(40개 연구), 그중 **ResNet** (28.6%)과 **U-Net** (26.2%)이 가장 많이 활용되었습니다.
  * **하이브리드 아키텍처**: ResNet과 DeeplabV3+, U-Net과 GAN 등 두 가지 이상의 기술을 결합하여 성능을 향상시키는 접근 방식이 많았습니다.
  * **전이 학습**: U-Net 및 ResNet (ResNet18, 34, 50, 101)과 같은 사전 훈련된 모델이 특정 주석 작업에 맞게 미세 조정되어 널리 사용되었습니다.
  * **YOLO 네트워크**: 3개 연구에서 실시간 객체 감지에 사용되었습니다.
  * **트랜스포머**: 8개 연구에서 Swin 트랜스포머를 CNN과 결합하여 사용하거나 Masked-Attention Transformers for Instrument Segmentation (MATIS)과 같은 자체 트랜스포머 기반 방법을 사용했습니다.
  * **GANs**: 5개 연구에서 합성 데이터 생성 및 증강에 CycleGAN과 같은 모델이 활용되었습니다.
* **훈련 지표**:
  * **학습률**: 일반적으로 $10^{-3}$으로 설정되었습니다.
  * **옵티마이저**: Adam이 25개 연구에서 가장 많이 사용되었습니다 (SGD, Adadelta 등도 사용).
  * **손실 함수**: 교차 엔트로피, 초점 손실, Jaccard 지수, DiCE, adversarial loss, 평균 제곱 오차 등 다양한 손실 함수가 작업 유형에 따라 사용되었습니다.
  * **배치 크기**: 2에서 150,000까지 다양했으며 평균은 8이었습니다.
  * **에포크**: 4에서 2,800까지 다양했으며 평균은 약 80이었습니다.
* **하드웨어**: NVIDIA GPU (GeForce GTX, Tesla, Quadro, RTX 시리즈)가 모델 훈련에 광범위하게 사용되었습니다. 특히 트랜스포머 모델은 4개의 NVIDIA Quadro RTX 8000 GPU와 같은 고사양 하드웨어를 필요로 했습니다.
* **성능 지표**:
  * **평균 IoU** (Intersection over Union; 13개 연구)와 **DiCE** (Diverse Counterfactual Explanations; 10개 연구)가 가장 많이 사용되었습니다.
  * 이진 분할 모델의 최대 DiCE 값은 97.10%, 최대 IoU는 96%였습니다.
  * 다른 평가 지표로는 정확도, 정밀도, 재현율, 평균 정밀도(mAP) 등이 있었으며, 도구 분류에서 91.53%의 정확도, 86.62%의 정밀도, 87.07%의 재현율이 보고되었습니다.
* **임상 적용**:
  * 48개 연구 중 32개 연구에서 임상 적용을 보고했습니다.
  * **가장 흔한 적용**: 기술 평가 (14개 연구), 수술 후 결과 분석 (10개 연구), 훈련 (6개 연구), 의사 결정 (6개 연구), 수술 워크플로우 분석 (5개 연구).
  * **덜 흔한 적용**: 외과 의사 인식 향상, 수술 내비게이션, 수술 작업 자동화, 수술 보고서 생성.

## 🧠 Insights & Discussion

이 체계적인 문헌 검토는 수술 도구 감지 및 분할에 딥러닝(DL) 모델을 적용하는 데 있어 상당한 진전과 함께 여러 중요한 통찰력을 제공합니다.

* **DL 모델의 다양성과 효과**:
  * **U-Net**과 **ResNet**은 이미지 분할 작업, 특히 수술 도구 감지 및 분할에서 강력한 성능을 보여주며 높은 정확도를 보고했습니다. U-Net은 스킵 연결을 통해 정밀한 위치 파악 및 문맥 정보 보존에 뛰어나고, ResNet은 잔여 학습 프레임워크를 통해 깊은 네트워크 훈련 시 기울기 소실 문제를 완화합니다.
  * **트랜스포머**는 CNN과 결합될 때 단일 이미지의 의미론적 분할에 효과적이지만, 상당한 계산 자원을 요구합니다. MATIS(Masked-Attention Transformers for Instrument Segmentation)와 같은 방법은 마스크된 변형 어텐션을 사용하여 인스턴스 분할을 향상시킵니다.
  * **GANs (Generative Adversarial Networks)**는 데이터 부족 문제를 해결하기 위한 최적의 해결책으로 합성 데이터를 생성하는 데 활용됩니다. CycleGAN과 같은 사전 훈련된 GAN 네트워크는 훈련 데이터셋을 보강하는 데 사용됩니다.
* **훈련 지표의 중요성**: 손실 함수는 DL 모델 성능을 제어하는 가장 중요한 하이퍼파라미터로, 이진 교차 엔트로피, 초점 손실, DiCE 손실 등이 이진 분할에 사용되고, 다중 클래스 분할에는 범주형 교차 엔트로피가 사용됩니다. Adam과 같은 최적화기는 모델 성능 향상에 필수적입니다.
* **수술 훈련 및 기술 평가에 미치는 영향**: DL 기반 도구 감지 및 분할은 수술 도구의 역학 및 상호 작용에 대한 심층 분석을 제공하여 수술 훈련 방법을 혁신합니다. 인스턴스 분할, 실시간 의미론적 분할, 도구 팁 감지 기술은 수술 기술의 객관적인 측정과 실시간 피드백을 가능하게 하여 초보 외과 의사의 학습 곡선을 단축하고 환자 결과를 개선합니다.
* **수술 전후 적용**:
  * **수술 후**: 수술 비디오 푸티지의 도구 분할 및 분석은 수술 후 검토를 통해 절차적 뉘앙스를 심층적으로 파악하고 합병증 또는 성공과 관련된 주요 순간을 식별하는 데 중요합니다. 이는 수술 방법의 지속적인 개선과 표준화를 지원하여 환자 안전과 의료 품질을 향상시킵니다.
  * **수술 중**: 실시간 도구 감지 및 분할은 수술 중 정밀도를 크게 향상시킵니다. 이는 상황 인식을 유지하고, 외과 의사의 인지 부담을 줄이며, 로봇 시스템과의 통합을 통해 로봇 팔 움직임을 최적화하여 수술 오류 위험을 줄입니다. 또한, 증강 현실(AR) 기술 개발에 기여하여 외과 의사의 시각적 인식을 향상시킬 수 있습니다.
* **수술팀 역학 및 의사소통에 미치는 영향**: AI 및 DL 기술의 통합은 실시간 데이터 및 시각화를 통해 팀 구성원 간의 동기화된 워크플로우를 촉진하여 의사소통 오류를 줄입니다. 이를 위해서는 기술 교육, 시뮬레이션 기반 훈련, 팀 조정 연습, 윤리 및 안전 훈련을 포함한 종합적인 교육 프로그램이 필요합니다.
* **윤리적 우려 및 데이터 프라이버시**: 환자 데이터 사용은 환자 프라이버시 및 데이터 보안과 관련된 중요한 윤리적 문제를 야기합니다. 정보에 입각한 동의 획득, 데이터 익명화(비식별화, 가명화), 암호화 및 엄격한 접근 제어와 같은 데이터 보안 조치, 기관 검토 위원회(IRB)의 윤리적 검토, 공식적인 데이터 공유 계약 및 대중에 대한 투명성이 필수적입니다.
* **한계점**: 이 검토는 DL 기술 활용의 주요 과제로 모델 검증을 위한 실제 수술 비디오 푸티지의 제한된 가용성을 지적합니다. 특히 인간 데이터의 부족과 돼지 모델에 대한 의존이 문제로 언급됩니다.
* **미래 방향**: 이러한 한계를 해결하기 위해 다양한 수술 절차에서 얻은 대규모의 주석 달린 데이터셋을 생성 및 공유하고, 실제 데이터 보완을 위한 합성 데이터 통합에 초점을 맞출 것을 제안합니다. 또한, 다양한 수술 환경 및 조명 조건에 걸쳐 일반화될 수 있는 견고한 모델을 개발하고, 트랜스포머 및 GAN과 같은 고급 DL 아키텍처를 활용하여 성능을 개선하는 것이 중요합니다. DL과 AR 기술의 융합도 유망한 미래 방향입니다.

## 📌 TL;DR

로봇 보조 수술에서 수술 도구의 정확하고 효율적인 자동 인식 및 분할은 주석 달린 데이터셋 부족으로 인해 어려움을 겪고 있습니다. 이 논문은 딥러닝(DL) 모델(CNN, U-Net, ResNet, 트랜스포머, GAN 등)을 활용한 48개 연구를 체계적으로 검토하여 도구 감지 및 분할의 정밀도와 효율성을 크게 향상시킬 수 있음을 보여줍니다. U-Net과 ResNet은 특히 효과적이며, 이러한 기술은 기술 평가, 수술 중 안내, 수술 후 분석과 같은 다양한 임상 응용 분야에서 중요한 역할을 합니다. 그러나 데이터 부족 및 모델의 일반화 능력은 여전히 주요 과제이며, 대규모 데이터셋 구축, 합성 데이터 통합, 그리고 증강 현실(AR)과의 융합이 미래 연구의 유망한 방향으로 제시됩니다.
