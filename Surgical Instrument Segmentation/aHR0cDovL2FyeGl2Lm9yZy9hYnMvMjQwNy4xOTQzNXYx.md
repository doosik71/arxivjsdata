# ASI-Seg: Audio-Driven Surgical Instrument Segmentation with Surgeon Intention Understanding

Zhen Chen, Zongming Zhang, Wenwu Guo, Xingjian Luo, Long Bai, Jinlin Wu, Hongliang Ren, Hongbin Liu

## 🧩 Problem to Solve

기존의 수술 도구 분할 알고리즘은 미리 정의된 범주의 모든 도구를 감지하여, 외과 의사의 의도에 따라 특정 도구를 분할하는 능력이 부족합니다. 외과 수술의 다양한 단계에서 외과 의사는 특정 도구에 대해 서로 다른 선호도와 초점을 가지므로, 외과 의사의 의도에 부합하는 분할 알고리즘이 필요합니다. 최근의 Segment Anything Model (SAM)은 프롬프트에 따른 객체 분할 능력을 보여주지만, 수술 중 수동 프롬프트 주석은 비실용적입니다.

## ✨ Key Contributions

* 외과 의사의 의도를 기반으로 오디오 기반 수술 도구 분할을 달성하는 ASI-Seg 프레임워크를 제안합니다.
* 오디오 명령으로부터 분할 의도를 해석하고 관련 도구 세부 정보를 검색하는 의도 지향적 멀티모달 퓨전 모듈을 고안합니다.
* 필요한 도구와 관련 없는 도구를 효과적으로 구별하기 위한 대조 학습 프롬프트 인코더를 고안합니다.
* EndoVis2018 및 EndoVis2017 데이터셋에 대한 광범위한 실험을 통해 의미론적 분할과 의도 지향적 분할 모두에서 ASI-Seg의 우수한 성능을 확인했습니다.

## 📎 Related Works

* **수술 도구 분할:** TernausNet [10], ISINet [7], Dual-MF [11], S3Net [12], Wang et al. [13] 등 다양한 접근 방식이 연구되었지만, 이들 연구는 미리 정의된 범주의 모든 도구를 직접 분할하며 외과 의사의 의도에 따른 특정 도구 분할 기능은 부족합니다.
* **의료 영상용 SAM:** SAM [14]은 다양한 시나리오에서 우수한 강건성과 적응성을 보여주며 의료 영상 분야에도 적용되고 있습니다. MedSAM [17], SurgicalSAM [26] 등 여러 연구 [17-19, 23-25]가 진행되었으나, 대부분 대규모 미세 조정에 엄청난 계산 자원을 요구하거나 추론 시 수동 주석을 프롬프트로 사용해야 하므로 임상 환경에서는 비실용적입니다.

## 🛠️ Methodology

ASI-Seg 프레임워크는 외과 의사의 오디오 명령을 분석하여 필요한 수술 도구를 분할합니다.

* **A. 의도 지향적 멀티모달 퓨전 (Intention-Oriented Multimodal Fusion)**
  * **오디오 의도 인식:** 원본 오디오 신호 $a$에서 16K Hz로 이산 오디오 신호 $a'$를 샘플링합니다. $a'$를 멜 스펙트로그램 $A_{mel}$로 변환하고 정규화하여 $A_{norm}$을 얻습니다. $A_{norm}$을 오디오 인코더 $E_A$와 오디오 분류기 $\phi$에 입력하여 외과 의사의 오디오 의도 $C = \phi(E_A(A_{norm}))$를 예측합니다.
  * **텍스트 퓨전:** 미리 준비된 도구 설명 은행 $\{B_k\}_{k=1}^K$에서 텍스트 인코더 $E_T$를 사용하여 텍스트 특징 $f_t$를 추출합니다. $K$개의 학습 가능한 쿼리 $f_c$를 초기화하고, $f_t$ 및 $f_c$를 상호 교차 어텐션을 통해 융합하여 도구 쿼리 $q \in \mathbb{R}^{K \times d}$를 형성합니다.
        $$q_t = \text{softmax}\left(\frac{Q_t K_c^T}{\sqrt{D}}\right) V_c$$
        $$q_c = \text{softmax}\left(\frac{Q_c K_t^T}{\sqrt{D}}\right) V_t$$
        $$q = \text{MLP}(\text{concat}(q_t, q_c))$$
  * **시각 퓨전:** 이미지 인코더 $E_I$를 통해 입력 이미지 $I$에서 이미지 특징 $f_i \in \mathbb{R}^{h \times w \times d}$를 추출합니다. 도구 쿼리 $q$와 이미지 특징 $f_i$ 사이의 유사도를 계산하여 유사도 행렬 시퀀스 $\{S_k | S_k = q_k \cdot f_i\}_{k=1}^K$를 얻습니다. $f_i$를 이 시퀀스에 추가하여 이미지 및 텍스트 정보가 모두 포함된 멀티모달 특징 $F = \{f_{i-t}^{(k)}\}_{k=1}^K$을 얻습니다.
        $$\{f_{i-t}^{(k)}\}_{k=1}^K = \{f_i \cdot S_k + f_i\}_{k=1}^K$$
  * **오디오 의도와 특징 할당:** 인식된 오디오 의도 $C$를 사용하여 멀티모달 특징 $F$를 필요한 특징 시퀀스 $F^+ = \{f_{i-t}^{(C)}\}$와 관련 없는 특징 시퀀스 $F^- = \{f_{i-t}^{(k)} | k \neq C\}_{k=1}^K$로 나눕니다.
* **B. 대조 학습 프롬프트 인코더 (Contrastive Learning Prompt Encoder)**
  * **구별 교차 어텐션:** 필요한 도구 특징 $F^+$와 관련 없는 도구 특징 $F^-$ 사이에 상호 교차 초점 메커니즘을 사용하여 분할할 도구의 고유한 속성에 대한 초점을 강화합니다. 교차 어텐션 $\text{Attention}(F^+, F^-)$을 계산하고 역잔류 메커니즘 $P^* = P - \text{Attention}(F^+, F^-)$를 적용하여 관련 없는 도구 특징과 유사한 정보를 제거합니다.
  * **대조 학습:** 필요한 도구 특징 $P$와 관련 없는 도구 특징 $N$, 그리고 Ground Truth 마스크로 필터링된 이미지 임베딩 $v$ 사이에 대조 학습 손실 $L_{CL}$을 설계하여 특징의 분별 능력을 강화합니다.
        $$L_{CL} = -\frac{1}{K} \sum_{n=1}^{K} \log \frac{\text{exp}(P^{(C)} \cdot v^{(C)} / \tau)}{\sum_{n=1}^{K} \text{exp}(P^{(C)} \cdot v^{(n)} / \tau)}$$
  * **마스크 디코더:** SAM [14] 마스크 디코더를 활용하여 필요한 도구의 마스크를 생성합니다. $P^*$를 전경 프롬프트로, $F^-$를 배경 프롬프트로 사용하여 분할을 수행합니다.
* **C. 최적화:** 이미지 인코더, 오디오 인코더, 텍스트 인코더는 고정하고, 경량 도구 분류기, 마스크 디코더, 의도 지향적 멀티모달 퓨전 및 대조 학습 프롬프트 인코더만 최적화합니다. 총 손실 함수는 $L = L_{DICE} + L_{CL}$로 구성됩니다.

## 📊 Results

* **데이터셋:** EndoVis2018 및 EndoVis2017 데이터셋을 사용하여 포괄적인 평가를 수행했습니다.
* **의미론적 분할:** EndoVis2018에서 82.37%, EndoVis2017에서 71.64%의 IoU를 달성하여 기존 최신 방법 및 의료 SAM을 능가했습니다. 특히, SurgicalSAM [26]보다 EndoVis2018에서 2.04%, EndoVis2017에서 1.70% 높은 IoU를 기록했습니다.
* **의도 지향적 분할:** EndoVis2018에서 64.18%, EndoVis2017에서 68.17%의 mc IoU를 달성하며 탁월한 성능을 보였습니다. EndoVis2018에서 SurgicalSAM [26]보다 5.31% 높은 mc IoU를 달성했으며, 다양한 수술 도구 범주에서 균형 잡힌 분할 성능을 입증했습니다. 정성적 비교(그림 2)를 통해 ASI-Seg가 수동 주석 없이도 정확한 마스크를 생성함을 확인했습니다.
* **강건성 연구:** "Bipolar Forceps"를 "Bipolyr Frocips"로 잘못 발음하는 등 오디오 명령에 명백한 오발음이 있을 때에도 ASI-Seg는 외과 의사의 의도를 올바른 도구 범주로 인식하고 정확한 분할을 완료하는 강건성을 보여주었습니다(그림 3).
* **모듈별 성능 분석 (Ablation Study):** 도구 설명 은행(Instrument Description Bank)은 mc IoU를 8.42% 증가시켰고, 대조 학습(Contrastive Learning)은 mc IoU를 4.98% 증가시켜 각 제안 모듈의 효과를 검증했습니다.

## 🧠 Insights & Discussion

ASI-Seg는 외과 의사의 오디오 명령을 해석하여 특정 수술 도구를 분할하는 실용적인 해결책을 제시합니다. 이는 기존 방법의 한계인 비의도적 모든 도구 분할 문제를 해결하고, SAM의 수동 프롬프트 필요성을 없애 임상 환경에서의 적용 가능성을 크게 높입니다. 특히, 오발음에 대한 강건성은 실제 수술실 환경에서의 유용성을 강화합니다. ASI-Seg는 외과 의사의 인지 부하를 줄이고 수술 워크플로우를 개선하여 수술 안전과 환자 결과를 향상시키는 데 크게 기여할 수 있습니다.

## 📌 TL;DR

**문제:** 기존 수술 도구 분할은 외과 의사의 의도를 반영하지 못하고 모든 도구를 분할하며, SAM은 수술실에서 비실용적인 수동 프롬프트를 요구합니다.
**방법:** ASI-Seg는 외과 의사의 오디오 명령을 통해 특정 도구를 분할하는 오디오 기반 프레임워크입니다. "의도 지향적 멀티모달 퓨전"으로 오디오 의도를 해석하고 도구 세부 정보를 검색하며, "대조 학습 프롬프트 인코더"로 필요한 도구와 관련 없는 도구를 구별하여 SAM 마스크 디코더를 안내합니다.
**결과:** EndoVis 데이터셋에서 의미론적 및 의도 지향적 분할 모두에서 최첨단 성능을 달성했으며, 의료 SAM 기반 방법들을 크게 능가했습니다. 오발음에도 강건하여 실제 수술 환경에서 수동 프롬프트 없이 외과 의사의 인지 부하를 줄이고 워크플로우를 개선할 수 있는 잠재력을 보여주었습니다.
