# SAM Meets Robotic Surgery: An Empirical Study on Generalization, Robustness and Adaptation

An Wang, Mobarakol Islam, Mengya Xu, Yang Zhang, Hongliang Ren

## π§© Problem to Solve

λ΅λ΄‡ μμ  λ¶„μ•Όμ—μ„ μμ  λ„κµ¬ λ° μ΅°μ§ λ¶„ν• μ€ λ„κµ¬ μ¶”μ  λ° μ„μΉ μμΈ΅μ— ν•„μμ μ΄μ§€λ§, κΈ°μ΅΄ λ”¥λ¬λ‹ λ¨λΈμ€ νΉμ • μμ  λ¶€μ„μ— λ§μ¶°μ Έ μμ–΄ μΌλ°ν™” λ¥λ ¥μ΄ μ ν•μ μ…λ‹λ‹¤. μµκ·Ό SAM(Segment Anything Model)μ€ μμ—° μ΄λ―Έμ§€ λ¶„ν• μ—μ„ λ›°μ–΄λ‚ μ„±λ¥μ„ λ³΄μ€μΌλ‚, μ΄λ¬ν• νμ΄λ°μ΄μ… λ¨λΈμ΄ λ³µμ΅ν• μμ  ν™κ²½μ—μ„ μ–Όλ§λ‚ μ μΌλ°ν™”λκ³  κ²¬κ³ ν•κ² μ‘λ™ν•λ”μ§€μ— λ€ν• μ—°κµ¬λ” λ¶€μ΅±ν•©λ‹λ‹¤. νΉν, SAMμ΄ μλ£ μμƒ λ¶„μ•Όμ—μ„ μ‹¤ν¨ν•  μ μλ‹¤λ” μ—°κµ¬ κ²°κ³Όλ“¤μ΄ μ κΈ°λλ©΄μ„, μμ  μ΄λ―Έμ§€ λ¶„ν•  μ‘μ—…μ— SAMμ κ°•λ ¥ν• νΉμ§• μ¶”μ¶ λ¥λ ¥μ„ μ–΄λ–»κ² ν™μ©ν•κ³  κ°μ„ ν•  μ μλ”μ§€ ν‰κ°€ν•λ” κ²ƒμ΄ μ¤‘μ”ν•©λ‹λ‹¤.

## β¨ Key Contributions

* **ν¬κ΄„μ μΈ μ‹¤μ¦ μ—°κµ¬**: λ΅λ΄‡ μμ  ν™κ²½μ—μ„ SAMμ κ²¬κ³ μ„±(Robustness)κ³Ό μ λ΅μƒ· μΌλ°ν™”(Zero-shot Generalization) λ¥λ ¥μ„ λ‹¤κ°λ„λ΅ ν‰κ°€ν–μµλ‹λ‹¤.
* **λ‹¤μ–‘ν• μ‹λ‚λ¦¬μ¤ λ¶„μ„**: ν”„λ΅¬ν”„νΈ κΈ°λ°(λ°”μ΄λ”© λ°•μ¤, ν¬μΈνΈ) λ° ν”„λ΅¬ν”„νΈ μ—†λ” μλ™ λ§μ¤ν¬ μƒμ„± μ‹λ‚λ¦¬μ¤μ—μ„μ μ„±λ¥μ„ λΉ„κµ λ¶„μ„ν–μµλ‹λ‹¤.
* **λ°μ΄ν„° μ†μƒμ— λ€ν• κ²¬κ³ μ„± ν‰κ°€**: 5κ°€μ§€ μ‹¬κ°λ„ μμ¤€μ—μ„ 18κ°€μ§€ μ ν•μ λ°μ΄ν„° μ†μƒ λ° κµλ€μ— λ€ν• SAMμ μ„±λ¥μ„ μ²΄κ³„μ μΌλ΅ μΈ΅μ •ν–μµλ‹λ‹¤.
* **SOTA λ¨λΈκ³Όμ λΉ„κµ**: μµμ‹  μ§€λ„ ν•™μµ λ¨λΈλ“¤κ³Ό SAMμ μ„±λ¥μ„ λΉ„κµν•μ—¬ ν”„λ΅¬ν”„νΈμ μ¤‘μ”μ„±μ„ κ°•μ΅°ν–μµλ‹λ‹¤.
* **SurgicalSAM μ μ•**: LoRA(Low-rank Adaptation)λ¥Ό μ‚¬μ©ν•μ—¬ SAMμ„ μμ  λ„λ©”μΈμ— νμΈνλ‹ν•κ³ , ν”„λ΅¬ν”„νΈ μ—†μ΄ ν΄λμ¤λ³„ λ§μ¤ν¬ μμΈ΅μ΄ κ°€λ¥ν• SurgicalSAMμ„ κ°λ°ν–μµλ‹λ‹¤.
* **ν•κ³„μ  μ‹λ³„**: SAMμ΄ μμ  λ„λ©”μΈμ—μ„ ν¬μΈνΈ κΈ°λ° ν”„λ΅¬ν”„νΈ, λ³µμ΅ν• μ¥λ©΄, λ°μ΄ν„° μ†μƒ ν•μ—μ„ νΉμ • ν•κ³„μ μ„ κ°€μ§€κ³  μμμ„ λ°ν€λƒμµλ‹λ‹¤.

## π“ Related Works

* **SAM (Segment Anything Model)** [14]: 10μ–µ κ° μ΄μƒμ λ§μ¤ν¬λ΅ ν•™μµλ νμ΄λ°μ΄μ… λ¨λΈλ΅, λ°”μ΄λ”© λ°•μ¤λ‚ ν¬μΈνΈμ™€ κ°™μ€ λ‹¤μ–‘ν• ν”„λ΅¬ν”„νΈλ¥Ό μ‚¬μ©ν•μ—¬ κ°μ²΄ λ§μ¤ν¬λ¥Ό μƒμ„±ν•λ” λ° λ›°μ–΄λ‚ μ„±λ¥μ„ λ³΄μ…λ‹λ‹¤.
* **SAMμ μλ£ μμƒ μ μ©**: Med SAM Adapter [22], SAMed [23] λ“± SAMμ„ μλ£ μμƒ λ¶„ν•  μ‘μ—…μ— μ μ©ν•κ³  κ°μ„ ν•κΈ° μ„ν• μ—°κµ¬λ“¤μ΄ μ§„ν–‰λμ—μµλ‹λ‹¤. μ΄λ“¤μ€ SAMμ νΉμ§• μ¶”μ¶ λ¥λ ¥μ„ ν™μ©ν•λ©΄μ„ μλ£ λ„λ©”μΈ μ§€μ‹μ„ ν†µν•©ν•κ±°λ‚, LoRA κΈ°λ° νμΈνλ‹ μ „λµμ„ μ‚¬μ©ν•©λ‹λ‹¤.
* **κΈ°μ΅΄ μμ  λ„κµ¬ λ¶„ν•  λ¨λΈ**: UNet [17], TernausNet [20], ISINet [5], TraSeTR [24], S3Net [3] λ“± λ‹¤μ–‘ν• μ§€λ„ ν•™μµ κΈ°λ° λ¨λΈλ“¤μ΄ μμ  λ„κµ¬ λ¶„ν•  λ¬Έμ λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄ μ μ‹λμ—μµλ‹λ‹¤.

## π› οΈ Methodology

1. **λ°μ΄ν„°μ…‹**: MICCAI EndoVis 2017 [2] λ° 2018 [1] μ±λ¦°μ§€μ—μ„ κ³µκ°λ λ΅λ΄‡ μμ  λ„κµ¬ λ¶„ν•  λ°μ΄ν„°μ…‹μ„ ν™μ©ν–μµλ‹λ‹¤.
2. **ν”„λ΅¬ν”„νΈ μƒμ„±**:
    * **λ°”μ΄λ”© λ°•μ¤ ν”„λ΅¬ν”„νΈ**: κ° λ„κµ¬μ— λ€ν• λ°”μ΄λ”© λ°•μ¤λ¥Ό μλ™μΌλ΅ λ μ΄λΈ”λ§ν•κ³  κ΄€λ ¨ ν΄λμ¤ μ •λ³΄λ¥Ό λ¶€μ—¬ν–μµλ‹λ‹¤.
    * **λ‹¨μΌ ν¬μΈνΈ ν”„λ΅¬ν”„νΈ**: κ° λ„κµ¬ λ§μ¤ν¬μ μ¤‘μ‹¬μ„ κ³„μ‚°ν•μ—¬ ν¬μΈνΈλ¥Ό μ–»μ—μµλ‹λ‹¤. SAMμ€ μ΄μ§„ λ§μ¤ν¬λ§ μμΈ΅ν•λ―€λ΅, λ„κµ¬λ³„ λ¶„ν• μ„ μ„ν•΄ ν”„λ΅¬ν”„νΈμ—μ„ μ κ³µλ ν΄λμ¤ μ •λ³΄λ¥Ό ν™μ©ν–μµλ‹λ‹¤.
3. **κ²¬κ³ μ„± ν‰κ°€**:
    * SAM [14]μ„ 18κ°€μ§€ μ ν•μ λ°μ΄ν„° μ†μƒ(μ΅μ, λΈ”λ¬, λ‚ μ”¨, λ””μ§€ν„Έ)κ³Ό 5κ°€μ§€ μ‹¬κ°λ„ μμ¤€μ—μ„ ν‰κ°€ν–μµλ‹λ‹¤.
    * λ°”μ΄λ”© λ°•μ¤ ν”„λ΅¬ν”„νΈμ™€ ν•¨κ» κ³µμ‹ κµ¬ν„ [7]μ„ λ”°λμµλ‹λ‹¤.
4. **μλ™ λ§μ¤ν¬ μƒμ„± (AMG)**:
    * ν”„λ΅¬ν”„νΈ μ—†μ΄ SAMμ μλ™ λ§μ¤ν¬ μƒμ„±(AMG) κΈ°λ¥μ„ ν™μ©ν•μ—¬ μ „μ²΄ μ΄λ―Έμ§€μ— λ€ν• μμ  μ¥λ©΄ λ¶„ν•  κ²°κ³Όλ¥Ό κΈ°λ³Έ μ„¤μ •μΌλ΅ μ΅°μ‚¬ν–μµλ‹λ‹¤.
5. **SurgicalSAM (λ§¤κ°λ³€μ ν¨μ¨μ  νμΈνλ‹)**:
    * **LoRA(Low-rank Adaptation) μ μ©**: SAM [14]μ μ‚¬μ „ ν•™μµλ μ΄λ―Έμ§€ μΈμ½”λ” κ°€μ¤‘μΉ $W_{\text{enc}}$λ” κ³ μ •ν•κ³ , κ²½λ‰μ LoRA λ μ΄μ–΄($\Delta W = W_A W_B$, λ­ν¬ $r=4$)λ¥Ό μ¶”κ°€ν•μ—¬ ν¨μ¨μ μΌλ΅ μ—…λ°μ΄νΈν–μµλ‹λ‹¤.
    * **λ§μ¤ν¬ λ””μ½”λ” μμ •**: μ›λμ λ§μ¤ν¬ λ””μ½”λ”λ¥Ό μμ •ν•μ—¬ ν”„λ΅¬ν”„νΈ μ—†μ΄ λ‹¤μ¤‘ ν΄λμ¤ μΉ΄ν…κ³ λ¦¬ λ μ΄λΈ”μ„ μμΈ΅ν•  μ μλ„λ΅ ν–μµλ‹λ‹¤. μ΄λ” μ΄μ§„ λ¶„ν• μ„ λ„μ–΄ μλ―Έλ΅ μ  λ¶„ν• (semantic segmentation)μ„ κ°€λ¥ν•κ² ν•©λ‹λ‹¤.
    * **μ†μ‹¤ ν•¨μ**: Cross Entropy μ†μ‹¤ $L_{\text{CE}}$μ™€ Dice μ†μ‹¤ $L_{\text{Dice}}$μ μ΅°ν•© $L = \lambda L_{\text{Dice}} + (1-\lambda)L_{\text{CE}}$μ„ μ‚¬μ©ν–μΌλ©°, $\lambda=0.8$λ΅ μ„¤μ •ν–μµλ‹λ‹¤.
    * **ν•™μµ μ„¤μ •**: ViTb λ²„μ „μ SAMμ„ μ‚¬μ©ν–μΌλ©°, 160 μ—ν­, λ°°μΉ ν¬κΈ° 12, μ΄κΈ° ν•™μµλ¥  0.001λ΅ νμΈνλ‹ν–μµλ‹λ‹¤. AdamW [15] μµμ ν™” λ„κµ¬λ¥Ό μ‚¬μ©ν–μΌλ©°, λ°μ΄ν„° μ¦κ°• κΈ°λ²•(λλ¤ ν”λ¦½, νμ „, ν¬λ΅­)μ„ μ μ©ν–μµλ‹λ‹¤.

## π“ Results

* **ν”„λ΅¬ν”„νΈ κΈ°λ° SAM**:
  * **λ°”μ΄λ”© λ°•μ¤ ν”„λ΅¬ν”„νΈ**: EndoVis17 λ° EndoVis18 λ°μ΄ν„°μ…‹μ—μ„ μ΄μ§„ λ° λ„κµ¬λ³„ λ¶„ν•  λ¨λ‘μ—μ„ κΈ°μ΅΄μ ν”„λ΅¬ν”„νΈ μ—†λ” μ§€λ„ ν•™μµ λ¨λΈλ“¤μ„ λ¥κ°€ν•λ” μ°μν• μ„±λ¥μ„ λ³΄μ€μµλ‹λ‹¤ (μ: EndoVis17μ—μ„ Binary IoU 89.19%, Instrument IoU 88.20%).
  * **λ‹¨μΌ ν¬μΈνΈ ν”„λ΅¬ν”„νΈ**: μ„±λ¥μ΄ ν¬κ² μ €ν•λμ–΄, SAMμ μ„±λ¥μ΄ ν”„λ΅¬ν”„νΈ ν’μ§μ— ν¬κ² μμ΅΄ν•¨μ„ λ³΄μ—¬μ£Όμ—μµλ‹λ‹¤.
* **μ§μ  ν‰κ°€ (ν”„λ΅¬ν”„νΈ κΈ°λ°)**: λ³µμ΅ν• μμ  μ¥λ©΄(κ·Έλ¦Όμ, λ¨μ… λΈ”λ¬, κ°€λ ¤μ§, λΉ› λ°μ‚¬, λ¶μ¶©λ¶„ν• μ΅°λ…, κ³Όλ„ν• λ°κΈ°, λ¨νΈν• λ΄‰ν•©μ‚¬, λ„κµ¬ μ†λ©, λ¶κ·μΉ™ν• λ„κµ¬ μμ„Έ)μ—μ„ λ§μ΅±μ¤λ½μ§€ λ»ν• λ¶„ν•  κ²°κ³Όλ¥Ό λ³΄μ€μµλ‹λ‹¤. νΉν κ²ΉμΉλ” λ„κµ¬λ‚ ν¬μΈνΈ ν”„λ΅¬ν”„νΈ μ‚¬μ© μ‹ νΉμ • λ„κµ¬ λ¶€λ¶„(ν„±, μ†λ©)μ„ μμΈ΅ν•μ§€ λ»ν•κ±°λ‚ μλ»λ ν΄λμ¤λ΅ λ¶„λ¥ν•λ” κ²½ν–¥μ΄ μμ—μµλ‹λ‹¤.
* **λ°μ΄ν„° μ†μƒμ— λ€ν• κ²¬κ³ μ„±**:
  * SAMμ μ„±λ¥μ€ λ°μ΄ν„° μ†μƒ μ‹¬κ°λ„μ— λΉ„λ΅€ν•μ—¬ ν¬κ² μ €ν•λμ—μµλ‹λ‹¤.
  * **JPEG μ••μ¶•** λ° **κ°€μ°μ‹μ• λ…Έμ΄μ¦**κ°€ λ¶„ν•  μ„±λ¥μ— κ°€μ¥ ν° μν–¥μ„ λ―Έ λ―Έμ³¤μΌλ©°, **λ°κΈ°**λ” λ―Έλ―Έν• μν–¥μ„ μ£Όμ—μµλ‹λ‹¤.
* **μλ™ λ§μ¤ν¬ μƒμ„± (AMG)**:
  * κ°„λ‹¨ν• μμ  μ¥λ©΄μ—μ„λ” μ λ§ν• κ²°κ³Όλ¥Ό λ³΄μ€μ§€λ§, λ³µμ΅ν• μ¥λ©΄μ—μ„λ” λ„κµ¬μ μ „μ²΄ κ΄€μ  λ¶€λ¶„μ„ μ •ν™•ν κµ¬λ¶„ν•κ±°λ‚ κ°λ³„ μ΅°μ§ κµ¬μ΅°λ¥Ό μƒνΈ μ—°κ²°λ λ‹¨μ„λ΅ μ‹λ³„ν•λ” λ° μ–΄λ ¤μ›€μ„ κ²μ—μµλ‹λ‹¤.
* **SurgicalSAM**:
  * νμΈνλ‹ ν›„ ν”„λ΅¬ν”„νΈ μ—†μ΄ λ„κµ¬λ³„ λ¶„ν• μ„ μν–‰ν•  μ μμ—μΌλ©°, EndoVis18 κ²€μ¦ μ„ΈνΈμ—μ„ 71.38%μ mIoU μ μλ¥Ό λ‹¬μ„±ν–μµλ‹λ‹¤. μ΄λ” μ΄λ―Έμ§€ λ‹¨λ… λ° λ‹¨μΌ μ‘μ—… μ•„ν‚¤ν…μ²λ΅λ” μµμ‹  κΈ°μ  λ¨λΈκ³Ό λ™λ“±ν• μμ¤€μ μ λ§ν• κ²°κ³Όμ…λ‹λ‹¤.
  * μ¶”κ°€ ν•™μµλ λ§¤κ°λ³€μλ” 18.28MBμ— λ¶κ³Όν•μ—¬ νμΈνλ‹ μ „λµμ ν¨μ¨μ„±μ„ μ…μ¦ν–μµλ‹λ‹¤.
  * SurgicalSAM λν• λ°μ΄ν„° μ†μƒ(νΉν λΈ”λ¬ μ†μƒ)μ— λ€ν•΄ μƒλ‹Ήν• μ„±λ¥ μ €ν•λ¥Ό λ³΄μ€μµλ‹λ‹¤.

## π§  Insights & Discussion

* SAMμ€ λ΅λ΄‡ μμ  λ¶„ν• μ—μ„ λ›°μ–΄λ‚ μ λ΅μƒ· μΌλ°ν™” λ¥λ ¥μ„ λ³΄μ—¬μ£Όμ§€λ§, μ΄λ” κ³ ν’μ§μ λ°”μ΄λ”© λ°•μ¤ ν”„λ΅¬ν”„νΈμ— ν¬κ² μμ΅΄ν•©λ‹λ‹¤. ν”„λ΅¬ν”„νΈ ν’μ§μ΄ λ‚®κ±°λ‚ μ—†λ” κ²½μ° μ„±λ¥μ΄ ν„μ €ν λ–¨μ–΄μ§‘λ‹λ‹¤.
* λ³µμ΅ν• μμ  ν™κ²½(νμ•΅, λ°μ‚¬, λΈ”λ¬, κ·Έλ¦Όμ λ“±)κ³Ό λ„κµ¬μ νΉμ • λ¶€λ¶„(κ²ΉμΉ¨, μ†λ©) λ¶„ν• μ—μ„ SAMμ€ ν•κ³„μ μ„ λ“λ¬λƒμµλ‹λ‹¤. μ΄λ” SAMμ΄ μμ  μ¥λ©΄μ λ―Έλ¬ν• νΉμ§•μ„ μ •ν™•ν•κ² ν¬μ°©ν•μ§€ λ»ν•¨μ„ μ‹μ‚¬ν•©λ‹λ‹¤.
* SAMμ€ λ‹¤μ–‘ν• λ°μ΄ν„° μ†μƒμ— λ€ν•΄ μ¶©λ¶„ν κ²¬κ³ ν•μ§€ λ»ν•λ©°, μ„±λ¥ μ €ν•κ°€ μ‹¬κ°ν–μµλ‹λ‹¤. μ΄λ” μ‹¤μ  μμ  ν™κ²½μ λ¶ν™•μ‹¤μ„±μ— λ€ν• μ μ© κ°€λ¥μ„±μ„ μ ν•ν•©λ‹λ‹¤.
* LoRAλ¥Ό μ΄μ©ν• νμΈνλ‹ μ „λµ(SurgicalSAM)μ€ SAMμ„ νΉμ • λ„λ©”μΈμ— ν¨κ³Όμ μΌλ΅ μ μ‘μ‹ν‚¤λ” μ λ§ν• λ°©λ²•μ…λ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ ν”„λ΅¬ν”„νΈ μ—†μ΄λ„ ν΄λμ¤λ³„ μλ―Έλ΅ μ  λ¶„ν• μ΄ κ°€λ¥ν•΄μ§€λ©°, μ΄λ” μ‹¤μ  μμ  μ‘μ—…μ— λ€ν• μ‹¤μ©μ  μ¤‘μ”μ„±μ„ κ°€μ§‘λ‹λ‹¤.
* κ²°λ΅ μ μΌλ΅, μ¶”κ°€μ μΈ λ„λ©”μΈλ³„ νμΈνλ‹ μ—†μ΄λ” SAMμ΄ ν•μ„ μμ  μ‘μ—…μ— λ°”λ΅ μ μ©λ  μ¤€λΉ„κ°€ λμ–΄ μμ§€ μ•λ‹¤κ³  ν•  μ μμµλ‹λ‹¤. SAMμ μΌλ°ν™” λ¥λ ¥κ³Ό κ²¬κ³ μ„±μ„ λ”μ± ν–¥μƒμ‹ν‚¤κΈ° μ„ν•΄μ„λ” κ΄‘λ²”μ„ν• ν‰κ°€μ™€ ν™•μ¥μ΄ ν•„μ”ν•©λ‹λ‹¤.

## π“ TL;DR

λ³Έ μ—°κµ¬λ” SAM(Segment Anything Model)μ΄ λ΅λ΄‡ μμ  λ¶„μ•Όμ—μ„ μ–Όλ§λ‚ μ μΌλ°ν™”λκ³  κ²¬κ³ ν•μ§€ μ‹¤μ¦μ μΌλ΅ λ¶„μ„ν–μµλ‹λ‹¤. SAMμ€ λ°”μ΄λ”© λ°•μ¤ ν”„λ΅¬ν”„νΈ μ‚¬μ© μ‹ λ›°μ–΄λ‚ μ λ΅μƒ· μΌλ°ν™” μ„±λ¥μ„ λ³΄μ€μΌλ‚, ν¬μΈνΈ κΈ°λ° ν”„λ΅¬ν”„νΈλ‚ ν”„λ΅¬ν”„νΈ μ—†λ” ν™κ²½, κ·Έλ¦¬κ³  λ°μ΄ν„° μ†μƒ λ° λ³µμ΅ν• μμ  μ¥λ©΄μ—μ„λ” μ„±λ¥μ΄ ν¬κ² μ €ν•λμ—μµλ‹λ‹¤. μ΄λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄ LoRAλ¥Ό μ‚¬μ©ν•μ—¬ SAMμ„ νμΈνλ‹ν• SurgicalSAMμ„ μ μ•ν–μΌλ©°, μ΄λ” ν”„λ΅¬ν”„νΈ μ—†μ΄ ν΄λμ¤λ³„ λ§μ¤ν¬ μμΈ΅μ΄ κ°€λ¥ν•μ—¬ μμ  λ„λ©”μΈμ— λ€ν• ν¨κ³Όμ μΈ μ μ‘ κ°€λ¥μ„±μ„ λ³΄μ—¬μ£Όμ—μµλ‹λ‹¤. κ²°κ³Όμ μΌλ΅ SAMμ€ μ¶”κ°€μ μΈ λ„λ©”μΈλ³„ νμΈνλ‹ μ—†μ΄λ” μ‹¤μ  μμ  μ‘μ—…μ— λ°”λ΅ μ μ©ν•κΈ° μ–΄λ µλ‹¤κ³  κ²°λ΅ μ§€μ—μµλ‹λ‹¤.
