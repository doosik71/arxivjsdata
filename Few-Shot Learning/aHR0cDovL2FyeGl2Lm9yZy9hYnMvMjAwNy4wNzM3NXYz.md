# CONCEPT LEARNERS FOR FEW-SHOT LEARNING

Kaidi Cao, Maria Brbíc, Jure Leskovec

## 🧩 Problem to Solve

소수의 레이블된 예시만으로 새로운 작업에 일반화하는 능력, 즉 퓨샷 학습(Few-shot Learning)은 기계와 인간 수준의 성능 격차를 좁히는 데 있어 근본적인 과제입니다. 인간은 구조화되고 재사용 가능한 개념(concepts)을 통해 새로운 작업에 빠르게 적응하고 결정에 대한 추론을 제공합니다. 그러나 기존 메타 학습(meta-learning) 방법들은 학습된 표현에 어떠한 구조도 부여하지 않고 복잡한 표현을 학습하여 일반화 능력과 해석 가능성이 제한적입니다.

## ✨ Key Contributions

* **인간 해석 가능한 개념 기반 메타 학습 방법론 제안**: COMET(COncept MEta-learning for few-shoT learning)을 제안하여, 인간이 해석 가능한 개념 차원을 따라 학습함으로써 일반화 능력을 향상시킵니다.
* **반구조화된 측정 공간 학습**: 단일 비구조적 측정 공간을 학습하는 대신, 고수준 개념을 반구조화된 측정 공간으로 매핑하고, 독립적인 개념 학습기(concept learners)의 출력을 효과적으로 결합합니다.
* **뛰어난 성능 달성**: 미세한 이미지 분류, 문서 분류, 새로운 생물학 데이터셋(Tabula Muris)에서의 세포 유형 주석 등 다양한 도메인의 퓨샷 작업에서 강력한 메타 학습 기준 모델들을 크게 능가합니다. 특히, 가장 어려운 1-샷 학습 작업에서 6-15%의 상대적 성능 향상을 달성했습니다.
* **내재적 해석 가능성 제공**: 기존 방법들과 달리, 모델 예측 뒤에 숨겨진 추론을 제공하여 해석 가능한 메타 학습 접근 방식을 제시합니다. 이는 퓨샷 학습 환경에서 모델 예측에 대한 신뢰도를 높이는 데 중요합니다.
* **도메인 불가지론적(Domain-agnostic) 접근**: 사전 정의된 개념뿐만 아니라 비지도 방식으로 자동 추출된 노이즈가 있는 개념에도 효과적으로 작동함을 보여줍니다.
* **새로운 생물학 메타 학습 데이터셋 및 벤치마크 공개**: 쥐의 여러 장기에서 수집된 단일 세포 전사체 데이터인 Tabula Muris를 기반으로 교차 장기 세포 유형 분류 작업을 위한 새로운 데이터셋과 벤치마크를 개발했습니다.

## 📎 Related Works

* **퓨샷 학습**: 적은 수의 예시로 학습하는 문제를 다루는 초기 연구들 (Miller et al., 2000; Fei-Fei et al., 2006; Koch et al., 2015).
* **메타 학습**: 모델의 일반화 능력을 최적화하는 "학습하는 방법을 학습"하는 접근 방식 (Schmidhuber, 1987; Bengio et al., 1992).
* **거리 기반 메타 학습**: Prototypical Networks (Snell et al., 2017), Matching Networks (Vinyals et al., 2016), Relation Networks (Sung et al., 2018), DeepEMD (Zhang et al., 2020) 등 데이터 포인트 간의 거리 측정을 통해 새로운 작업에 일반화하는 방법. COMET은 Prototypical Networks를 기반으로 개념 기반 프로토타입을 도입하여 확장합니다.
* **최적화 기반 메타 학습**: MAML (Finn et al., 2017)과 같이 빠른 적응을 위한 좋은 초기화 매개변수를 학습하는 방법.
* **구성성(Compositionality)**: 베이지안 확률적 프로그램 학습을 통해 개별 스트로크를 결합하여 필기체 인식을 수행한 연구 (Lake et al., 2011; 2015), 더 나아가 심층 구성 표현을 사용한 퓨샷 이미지 분류 (Tokmakov et al., 2019) 등.
* **해석 가능성**: 개별 특징의 중요도를 추정하는 방법 (Grad-CAM, LIME, SHAP 등)과 고수준 인간 이해 가능 개념을 사용하여 예측을 설명하는 방법 (TCAV, Ghorbani et al., 2019) 등이 있습니다.

## 🛠️ Methodology

COMET은 인간 인지 방식의 구조화된 형태에 영감을 받아, 고수준의 인간 해석 가능한 개념 차원을 따라 일반화 가능한 표현을 학습하는 메타 학습 방법입니다.

1. **개념 정의**:
    * $N$개의 개념 $C = \{c^{(j)}\}_{j=1}^N$은 사전 지식으로 주어지거나 추출됩니다. 각 개념 $c^{(j)} \in \{0,1\}^D$는 이진 벡터로, $D$차원 입력에서 $j$번째 개념을 설명하는 데 사용될 차원을 나타냅니다.
    * 개념은 분리되거나 중첩될 수 있으며, 노이즈가 있거나 불완전해도 괜찮습니다. (예: CUB 데이터셋의 새의 부위, Gene Ontology 용어, WordNet의 상위어, 자동 추출된 시각적 랜드마크).

2. **개념 학습기(Concept Learners)**:
    * 전체 입력 차원에 걸쳐 단일 매핑 함수 $f_{\theta}: \mathbb{R}^D \to \mathbb{R}^M$를 학습하는 대신, COMET은 미리 정의된 개념의 하위 공간에 대해 개별 임베딩 함수 $f^{(j)}_{\theta}: \mathbb{R}^D \to \mathbb{R}^M$를 학습합니다.
    * 이러한 $f^{(j)}_{\theta}$를 "개념 학습기"라고 하며, 딥 뉴럴 네트워크로 매개변수화된 비선형 함수입니다.
    * 각 개념 학습기 $j$는 입력 $x_i$에 개념 마스크 $c^{(j)}$를 적용한 후 임베딩을 생성합니다: $f^{(j)}_{\theta}(x_i \circ c^{(j)})$. (여기서 $\circ$는 아다마르 곱(Hadamard product)입니다.)

3. **개념 프로토타입(Concept Prototypes)**:
    * 각 개념 학습기는 해당 개념에 특화된 프로토타입 $p^{(j)}_k$를 각 클래스 $k$에 대해 생성합니다.
    * 클래스 $k$의 개념 프로토타입 $p^{(j)}_k$는 해당 클래스에 속하는 서포트 세트 $S_k$의 데이터 포인트 임베딩의 평균 벡터로 계산됩니다.
    $$ p^{(j)}_k = \frac{1}{|S_k|} \sum_{(x_i,y_i) \in S_k} f^{(j)}_{\theta}(x_i \circ c^{(j)}) $$

4. **예측 및 손실 함수**:
    * 쿼리 데이터 포인트 $x_q$가 주어지면, 모든 개념에 대한 개념 임베딩을 계산하고, 각 클래스의 개념 프로토타입과의 거리를 측정합니다.
    * 모든 개념에 걸쳐 정보를 집계하여(거리의 합을 취함) 지원 클래스에 대한 확률 분포를 얻습니다.
    * $k$번째 클래스에 $x_q$를 할당할 확률은 다음과 같습니다.
    $$ p_{\theta}(y=k|x_q) = \frac{\exp(-\sum_j d(f^{(j)}_{\theta}(x_q \circ c^{(j)}), p^{(j)}_k))}{\sum_{k'} \exp(-\sum_j d(f^{(j)}_{\theta}(x_q \circ c^{(j)}), p^{(j)}_{k'}))} $$
    * 여기서 $d$는 유클리드 거리 함수를 사용하며, 배치 정규화(batch normalization)가 거리를 비교 가능하게 하는 데 중요합니다.
    * 손실은 실제 클래스에 대한 음의 로그 가능도 $L_{\theta} = -\log p_{\theta}(y=k|x_q)$로 계산되며, COMET은 에피소드 방식으로 이 손실을 최소화하여 훈련됩니다.

5. **해석 가능성 메커니즘**:
    * **로컬 개념 중요도 점수**: 쿼리 포인트 $x_q$가 주어진 클래스 $k$로 분류될 때, 특정 개념 $j$의 중요도 점수는 쿼리의 개념 임베딩 $f^{(j)}_{\theta}(x_q \circ c^{(j)})$와 클래스 $k$의 개념 프로토타입 $p^{(j)}_k$ 사이의 역거리로 얻어집니다. 이 점수는 개별 예측에 대한 추론을 제공합니다.
    * **글로벌 개념 중요도 점수**: 관심 있는 쿼리 포인트 집합(예: 전체 클래스)에 대해 개념 프로토타입과 개념 임베딩 간의 평균 역거리를 계산하여 글로벌 개념 중요도 점수를 부여합니다. 이는 특정 개념의 전반적인 중요도에 대한 통찰력을 제공합니다.
    * **국소적으로 유사한 예시 발견**: 고정된 개념 $j$에 대해, 데이터 포인트의 개념 임베딩과 클래스 $k$의 개념 프로토타입 $p^{(j)}_k$ 사이의 거리를 기반으로 데이터 포인트를 순위 매길 수 있어, 특정 개념과 유사한 패턴을 공유하는 예시를 찾을 수 있습니다.

## 📊 Results

* **기준 모델 대비 압도적인 성능**: CUB, Tabula Muris, Reuters 데이터셋 모두에서 FineTune, MatchingNet, MAML, RelationNet, MetaOptNet, DeepEMD, ProtoNet 등 모든 기준 모델을 크게 능가합니다.
  * 1-샷 및 5-샷 작업에서 가장 성능이 좋은 기준 모델 대비 평균 9.5% 및 9.3%의 정확도 향상을 달성했습니다.
  * 특히 ProtoNet 기준 모델 대비 1-샷 작업에서 19-23%의 정확도 향상을 보였습니다.
* **개념 수의 영향**: 개념의 수가 증가함에 따라 COMET의 성능이 꾸준히 향상됩니다. CUB 데이터셋에서 전체 이미지 개념에 "부리" 개념 하나만 추가해도 ProtoNet 성능이 1-샷에서 10%, 5-샷에서 5% 향상되었습니다. 수천 개의 중복되거나 노이즈가 있는 개념이 있어도 성능이 저하되지 않고 유지됩니다.
* **가중치 공유 및 앙상블 비교**: 개념 학습기 간 가중치를 공유하는 COMET도 ProtoNet 앙상블보다 훨씬 우수한 성능을 보여, 성능 향상이 단순히 모델 용량 증가나 단순 앙상블 효과 때문이 아님을 입증했습니다.
* **비지도 개념 주석 활용**: CUB, Flowers 데이터셋에서 자동 추출된 시각적 랜드마크와 Tabula Muris, Reuters 데이터셋에서 무작위 선택된 특징 마스크를 개념으로 사용하여도 COMET은 기준 모델들을 능가하며, 인간 정의 개념 대비 1-2% 정도의 정확도 손실만 발생했습니다.
* **해석 가능성 정량적/정성적 검증**:
  * **글로벌 설명**: Tabula Muris 데이터셋에서 COMET의 글로벌 중요도 점수는 차등 발현 유전자를 통해 추정된 실제 중요 Gene Ontology 용어와 0.71의 평균 Recall@20으로 매우 잘 일치합니다. CUB 데이터셋에서는 "부리", "배", "이마"와 같은 직관적으로 중요한 새의 특징을 올바르게 식별했습니다.
  * **로컬 설명**: 쿼리 포인트에 대한 개념 중요도 점수를 통해 예측에 가장 관련 있는 특징을 시각적으로 정확하게 반영합니다.
  * **국소적 유사 패턴**: 특정 개념(예: 새의 배)에 대해 이미지의 유사성을 정렬하여, 프로토타입을 잘 반영하는 이미지와 그렇지 않은 이미지(예: 배가 잘 보이지 않는 이미지)를 찾아낼 수 있으며, 이는 잘못 주석된 개념을 식별하는 데 유용합니다.

## 🧠 Insights & Discussion

COMET은 인간의 인지 방식, 즉 구조화되고 재사용 가능한 개념을 활용하는 것이 퓨샷 학습의 핵심 과제인 일반화 능력과 해석 가능성을 동시에 해결할 수 있음을 보여줍니다. 기존 메타 학습 방법들이 복잡하고 비구조적인 표현 학습에 초점을 맞춘 반면, COMET은 각 개념에 특화된 반구조화된 측정 공간을 학습하고 이를 통합함으로써 이러한 한계를 극복합니다.

이 연구의 중요한 시사점은 다음과 같습니다.

* **인간 중심의 접근**: 모델이 인간이 이해할 수 있는 방식으로 추론하고 설명할 수 있도록 설계함으로써, 특히 의료나 국방과 같이 신뢰가 중요한 분야에서 퓨샷 학습 모델의 채택 가능성을 높입니다.
* **정확도와 해석 가능성의 양립**: COMET은 해석 가능성을 제공하면서도 최첨단 기준 모델들을 크게 능가하는 정확도를 달성하여, 이 두 가지 목표가 상충되지 않음을 입증합니다.
* **다양한 도메인 적용 가능성 및 견고성**: 컴퓨터 비전, 자연어 처리, 그리고 새롭게 제시된 생물학 데이터셋에 걸쳐 효과를 입증하며, 사전 지식으로 주어진 개념뿐만 아니라 노이즈가 있거나 비지도 방식으로 추출된 개념에도 강력한 성능을 보여줍니다. 이는 실제 환경에서의 적용 가능성을 높입니다.
* **새로운 생물학적 메타 학습 벤치마크**: Tabula Muris 데이터셋을 활용한 교차 장기 세포 유형 분류 작업은 생물학 분야에서 퓨샷 학습 연구를 확장할 수 있는 중요한 기여를 합니다.

COMET의 주요 한계는 명시적으로 언급되지 않았지만, 개념의 정의(인간이 제공하든, 자동 추출하든)가 여전히 필요하다는 점과 매우 많은 수의 개념 학습기를 사용하는 경우 계산 복잡성이 증가할 수 있다는 점이 있을 수 있습니다. 그러나 논문은 개념이 노이즈가 있거나 불완전해도 효과적으로 작동하며, 가중치 공유를 통해 계산 효율성을 높일 수 있음을 보여줌으로써 이러한 우려를 완화합니다.

## 📌 TL;DR

**문제**: 퓨샷 학습은 소수의 데이터로 일반화하기 어렵고, 기존 메타 학습 모델은 구조화되지 않은 표현으로 인해 해석이 불가능했습니다.

**해결책**: COMET은 인간 해석 가능한 개념(concepts)을 활용하는 메타 학습 방법입니다. 각 개념에 대한 독립적인 '개념 학습기'를 통해 반구조화된 측정 공간을 학습하고, 이들을 결합하여 예측을 수행합니다.

**핵심 결과**: COMET은 컴퓨터 비전, NLP, 생물학 등 다양한 도메인에서 SOTA 모델 대비 1-샷 작업에서 6-15%의 상대적 정확도 향상을 보였습니다. 또한, 로컬 및 글로벌 개념 중요도 점수를 통해 모델 예측에 대한 내재적 해석 가능성을 제공하며, 노이즈가 있는 개념이나 자동 추출된 개념에도 효과적으로 작동합니다.
