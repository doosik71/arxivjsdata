# On Episodes, Prototypical Networks, and Few-Shot Learning

Steinar Laenen, Luca Bertinetto

## π§© Problem to Solve

λ³Έ λ…Όλ¬Έμ€ Few-Shot Learning (FSL) λ¶„μ•Όμ—μ„ λ„λ¦¬ μ‚¬μ©λλ” μ—ν”Όμ†λ“ ν•™μµ(episodic learning)μ μ μ©μ„±κ³Ό ν•„μ”μ„±μ„ μ¬μ΅°λ…ν•©λ‹λ‹¤. νΉν Matching Networks λ° Prototypical Networksμ™€ κ°™μ€ λΉ„λ¨μμ (nonparametric) FSL λ°©λ²•λ΅ μ—μ„ μ—ν”Όμ†λ“ ν•™μµμ΄ ν•­μƒ ν•„μμ μΈμ§€, κ·Έλ¦¬κ³  λ°μ΄ν„° ν¨μ¨μ„± μΈ΅λ©΄μ—μ„ μ–΄λ–¤ μν–¥μ„ λ―ΈμΉλ”μ§€ λ¶„μ„ν•κ³ μ ν•©λ‹λ‹¤. κΈ°μ΅΄μ—λ” ν›λ ¨κ³Ό ν‰κ°€ ν™κ²½μ„ μΌμΉμ‹ν‚¤κΈ° μ„ν•΄ μ—ν”Όμ†λ“ ν•™μµμ΄ μ¤‘μ”ν•λ‹¤κ³  μ—¬κ²¨μ΅μµλ‹λ‹¤.

## β¨ Key Contributions

* μ—ν”Όμ†λ“ ν•™μµμ€ Matching Networks λ° Prototypical Networksμ™€ κ°™μ€ λΉ„λ¨μμ  FSL λ°©λ²•λ΅ μ μ„±λ¥μ— ν•΄λ΅μΈ μ μμμ„ λ³΄μ…λ‹λ‹¤.
* μ—ν”Όμ†λ“ ν•™μµμ€ ν›λ ¨ λ°°μΉ λ‚΄μ—μ„ μ μ©ν• μƒν” κ°„μ κ±°λ¦¬ μ(distance pairs)μ„ μ„μλ΅ λ¬΄μ‹ν•μ—¬ λ°μ΄ν„° λΉ„ν¨μ¨μ„±μ„ μ΄λν•¨μ„ μ…μ¦ν•©λ‹λ‹¤.
* μ—ν”Όμ†λ“ ν•™μµμ€ λ¶ν•„μ”ν• ν•μ΄νΌνλΌλ―Έν„°($\{w, n, m\}$)λ¥Ό λ„μ…ν•λ©°, μ΄λ” μ‹ μ¤‘ν• νλ‹μ„ μ”κµ¬ν•©λ‹λ‹¤.
* μ—ν”Όμ†λ“ ν•™μµμ„ μ‚¬μ©ν•μ§€ μ•λ” Neighbourhood Component Analysis (NCA) κΈ°λ°μ λΉ„λ¨μμ  λ€μ•μ€ ν›¨μ”¬ κ°„λ‹¨ν•κ³  ν•μ΄νΌνλΌλ―Έν„°κ°€ μ μΌλ©°, μ—¬λ¬ FSL λ°μ΄ν„°μ…‹μ—μ„ μ„±λ¥μ„ ν–¥μƒμ‹ν‚µλ‹λ‹¤.
* λ³Έ λ…Όλ¬Έμ—μ„ μ μ•ν•λ” NCA λ³€ν•μ€ λ§¤μ° κ°„λ‹¨ν•¨μ—λ„ λ¶κµ¬ν•κ³  μµμ‹  FSL λ°©λ²•λ“¤κ³Ό κ²¬μ¤„ λ§ν•κ±°λ‚ λ” μ°μν• λ¶„λ¥ μ •ν™•λ„λ¥Ό λ‹¬μ„±ν•©λ‹λ‹¤.

## π“ Related Works

* **λ©”νƒ€ ν•™μµ λ° μ—ν”Όμ†λ“ ν•™μµ:** MAML, Matching Networks, Prototypical Networksμ™€ κ°™μ€ μ΄κΈ° λ©”νƒ€ ν•™μµ λ°©λ²•λ“¤μ€ ν›λ ¨μ„ μ—ν”Όμ†λ“ ν•νƒλ΅ κµ¬μ„±ν•λ” κ²ƒμ μ¤‘μ”μ„±μ„ κ°•μ΅°ν–μµλ‹λ‹¤.
* **ν¬λ΅μ¤ μ—”νΈλ΅ν”Ό κΈ°λ° λΉ„ν:** μµκ·Ό SimpleShot, Meta-Baseline λ“±μ€ ν‘μ¤€ ν¬λ΅μ¤ μ—”νΈλ΅ν”Ό μ†μ‹¤λ΅ μ‚¬μ „ ν•™μµλ μ„λ² λ”©μ„ μ‚¬μ©ν•μ—¬ κΈ°μ΅΄ λ©”νƒ€ ν•™μµ λ°©λ²•μ„ λ¥κ°€ν•  μ μμμ„ λ³΄μ—¬, μ—ν”Όμ†λ“μ μ¤‘μ”μ„±μ— μλ¬Έμ„ μ κΈ°ν–μµλ‹λ‹¤.
* **Neighbourhood Component Analysis (NCA):** Goldberger et al. [21]μ— μν•΄ μ μ•λ NCAλ” λ³Έ λ…Όλ¬Έμ—μ„ PNs λ° MNsμ™€ μ μ‚¬ν• κ±°λ¦¬ κΈ°λ° μ†μ‹¤ ν•¨μλ¥Ό μ‚¬μ©ν•μ§€λ§ μ—ν”Όμ†λ“ κ°λ… μ—†μ΄ λ°°μΉ λ‚΄ λ¨λ“  μƒν” κ°„μ κ΄€κ³„λ¥Ό ν™μ©ν•©λ‹λ‹¤.
* **λ°μ΄ν„° ν¨μ¨μ„± κ΄€λ ¨ μ—°κµ¬:** Raghu et al. [36], Bai et al. [3], Chen et al. [8] λ“±μ€ λ©”νƒ€ ν•™μµμ μ—ν”Όμ†λ“ μ „λµμ λΉ„ν¨μ¨μ„±μ„ λ‹¤λ£¨μ—μΌλ©°, νΉν μ§€μ›/μΏΌλ¦¬ λ¶„λ¦¬μ μν–¥μ„ λ¶„μ„ν–μµλ‹λ‹¤.
* **λ€μ΅° ν•™μµ(Contrastive Learning):** NCA μ†μ‹¤ ν•¨μλ” μκΈ° μ§€λ„ ν•™μµ λ° ν‘ν„ ν•™μµμ—μ„ μ‚¬μ©λλ” λ€μ΅° μ†μ‹¤ ν•¨μμ™€ μ μ‚¬μ μ΄ μμµλ‹λ‹¤ (Appendix C).

## π› οΈ Methodology

1. **λΉ„κµ λ€μƒ μ„ μ •:** μ—ν”Όμ†λ“ λ‚΄μ—μ„ λΉ„λ¨μμ  λ¶„λ¥κΈ°(nearest neighbor)λ¥Ό μ‚¬μ©ν•λ” Matching Networks (MNs)μ™€ Prototypical Networks (PNs)λ¥Ό μ‚¬λ΅€ μ—°κµ¬ λ€μƒμΌλ΅ μ„ μ •ν–μµλ‹λ‹¤. μ΄λ“¤μ€ ν…μ¤νΈ μ‹ μ μ‘(adaptation)μ΄ μ—†μ–΄ μ‹¤ν— μ„¤κ³„κ°€ μ©μ΄ν•©λ‹λ‹¤.
2. **λ°μ΄ν„° λΉ„ν¨μ¨μ„± λ¶„μ„:** μ—ν”Όμ†λ“ ν•™μµμ΄ μ§€μ›(support) λ° μΏΌλ¦¬(query) μ„ΈνΈλ΅ λ°°μΉλ¥Ό λ¶„ν• ν•¨μΌλ΅μ¨ μ–Όλ§λ‚ λ§μ€ μ μ©ν• κ±°λ¦¬ μ(distance pairs)μ„ λ¬΄μ‹ν•λ”μ§€ μμ‹μ μΌλ΅, κ·Έλ¦¬κ³  κ²½ν—μ μΌλ΅ λ¶„μ„ν–μµλ‹λ‹¤ ($O(w^2(m^2+n^2))$).
3. **μ†μ‹¤ ν•¨μ:**
    * **L$_{PNs}$ (Prototypical Networks):** ν΄λμ¤λ³„ ν”„λ΅ν† νƒ€μ…κ³Ό μΏΌλ¦¬ μ΄λ―Έμ§€ κ°„μ μ ν΄λ¦¬λ“ κ±°λ¦¬ κΈ°λ° μ†ν”„νΈλ§¥μ¤ μ†μ‹¤.
    * **L$_{MNs}$ (Matching Networks):** μΏΌλ¦¬ μ΄λ―Έμ§€μ™€ μ§€μ› μ„ΈνΈ λ‚΄ κ°λ³„ μ΄λ―Έμ§€ κ°„μ μ ν΄λ¦¬λ“ κ±°λ¦¬ κΈ°λ° μ†ν”„νΈλ§¥μ¤ μ†μ‹¤.
    * **L$_{NCA}$ (Neighbourhood Component Analysis):** λ°°μΉ λ‚΄ λ¨λ“  μ΄λ―Έμ§€ κ°„μ κ±°λ¦¬ μμ„ ν™μ©ν•μ—¬ κ°™μ€ ν΄λμ¤ λ‚΄ κ±°λ¦¬λ” μµμ†ν™”ν•κ³  λ‹¤λ¥Έ ν΄λμ¤ κ°„ κ±°λ¦¬λ” μµλ€ν™”ν•λ” μ†μ‹¤. μ§€μ›/μΏΌλ¦¬ μ„ΈνΈ κµ¬λ¶„μ΄ μ—†μµλ‹λ‹¤.
4. **μ£Όμ” μ°¨μ΄μ  λ¶„μ„ λ° Ablation Study:** PNs, MNs, NCA κ°„μ μ„Έ κ°€μ§€ μ£Όμ” μ°¨μ΄μ μ„ λ°”νƒ•μΌλ΅ μΌλ ¨μ ablation μ‹¤ν—μ„ μν–‰ν–μµλ‹λ‹¤.
    * **I. μΏΌλ¦¬/μ§€μ› μ„ΈνΈ λ¶„λ¦¬ μ—¬λ¶€:** NCAλ” λ¨λ“  λ°°μΉ λ‚΄ μ΄λ―Έμ§€ κ°„μ κ±°λ¦¬λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.
    * **II. ν”„λ΅ν† νƒ€μ… μƒμ„± μ—¬λ¶€:** PNsλ§ ν”„λ΅ν† νƒ€μ…μ„ μ‚¬μ©ν•©λ‹λ‹¤.
    * **III. μƒν”λ§ λ°©μ‹:** μ—ν”Όμ†λ“ ν•™μµμ€ ν΄λμ¤ μλ¥Ό κ³ μ •ν•κ³  λ€μ²΄(with replacement) μƒν”λ§μ„ ν•λ” λ°λ©΄, ν‘μ¤€ NCAλ” κ· μΌν•κ² μƒν”λ§ν•κ³  κ° μ—ν¬ν¬λ§λ‹¤ λ¨λ“  μ΄λ―Έμ§€λ¥Ό ν• λ²μ”© λ°©λ¬Έν•©λ‹λ‹¤ (λ€μ²΄ μ—†μ).
5. **ν‰κ°€ λ°©λ²•:** ν•™μµλ μ„λ² λ”© ν•¨μ $f_{\theta}$λ¥Ό μ‚¬μ©ν•μ—¬ k-NN, Nearest Centroid, Soft Assignments μ„Έ κ°€μ§€ λ°©μ‹μΌλ΅ FSL λ¶„λ¥λ¥Ό μν–‰ν•λ©°, Nearest Centroid λ°©μ‹μ΄ κ°€μ¥ ν¨κ³Όμ μ„μ„ ν™•μΈν–μµλ‹λ‹¤.
6. **μ‹¤ν— μ„¤μ •:** miniImageNet, CIFAR-FS, tieredImageNet λ°μ΄ν„°μ…‹κ³Ό ResNet-12 λ°±λ³Έμ„ μ‚¬μ©ν–μµλ‹λ‹¤. μ„λ² λ”©μ€ μ¤‘μ•™ν™” λ° μ •κ·ν™”ν–μµλ‹λ‹¤.

## π“ Results

* **NCAμ μ°μμ„±:** NCAλ΅ ν•™μµλ μ„λ² λ”©μ€ λ¨λ“  λ°°μΉ ν¬κΈ°μ—μ„ μ—ν”Όμ†λ“ λ°©μ‹μΌλ΅ ν›λ ¨λ PNs λ° MNsλ³΄λ‹¤ μ§€μ†μ μΌλ΅ λ” λ‚μ€ μ„±λ¥μ„ λ³΄μ€μµλ‹λ‹¤ (Fig. 2, Fig. 5).
* **ν•μ΄νΌνλΌλ―Έν„° λ―Όκ°λ„:** PNs λ° MNsλ” μ—ν”Όμ†λ“ κµ¬μ„± ν•μ΄νΌνλΌλ―Έν„°($\{w, m, n\}$)μ— λ§¤μ° λ―Όκ°ν–μµλ‹λ‹¤ (Fig. 2). μµμ μ μ—ν”Όμ†λ“ μ„¤μ •μ€ κΈ°μ΅΄ λ…Όλ¬Έλ³΄λ‹¤ λ” λ‚μ€ μ„±λ¥μ„ λ³΄μ€μ§€λ§, μ—¬μ „ν NCAμ—λ” λ―ΈμΉμ§€ λ»ν–μµλ‹λ‹¤.
* **λ¬΄μ‘μ„ μ„λΈμƒν”λ§κ³Όμ λ“±κ°€μ„±:** μ—ν”Όμ†λ“ μ „λµμ€ λ°°μΉ λ‚΄ μ‚¬μ© κ°€λ¥ν• μ „μ²΄ κ±°λ¦¬ μ μ¤‘ μΌλ¶€λ¥Ό λ¬΄μ‘μ„λ΅ λ²„λ¦¬λ” κ²ƒκ³Ό μ‹¤μ§μ μΌλ΅ λ™μΌν•λ©°, μ΄λ” μ„±λ¥ μ €ν•λ΅ μ΄μ–΄μ§‘λ‹λ‹¤ (Fig. 3).
* **Ablation κ²°κ³Ό:** μ§€μ›/μΏΌλ¦¬ μ„ΈνΈ λ¶„λ¦¬λ¥Ό λΉ„ν™μ„±ν™”ν•κ³  λ°°μΉ λ‚΄ λ¨λ“  μƒν” κ°„μ κ±°λ¦¬λ¥Ό ν™μ©ν•λ©΄(μ¦‰, NCA λ°©μ‹μΌλ΅ μ „ν™ν•λ©΄) PNsμ μ„±λ¥ μ†μ‹¤μ΄ μ™„μ „ν νλ³µλμ—μµλ‹λ‹¤ (Fig. 4). ν”„λ΅ν† νƒ€μ… κ³„μ‚° μ—¬λ¶€λ” 5-μƒ·μ—μ„ μ•½κ°„μ μν–¥μ„ λ―Έμ³¤μ§€λ§, S/Q λ¶„λ¦¬ μ κ±°μ ν¨κ³Όκ°€ ν›¨μ”¬ μ»Έμµλ‹λ‹¤.
* **μµμ‹  λ°©λ²•λ΅ κ³Όμ λΉ„κµ:** λ³Έ λ…Όλ¬Έμ κ°„λ‹¨ν• NCA κµ¬ν„μ€ ResNet-12 λ°±λ³Έμ„ μ‚¬μ©ν•λ” μ—¬λ¬ μµμ‹  FSL λ°©λ²•λ“¤κ³Ό λΉ„κµν–μ„ λ•, κ²½μλ ¥ μκ±°λ‚ λ•λ΅λ” λ” μ°μν• μ •ν™•λ„λ¥Ό λ‹¬μ„±ν–μµλ‹λ‹¤ (Table 2).

## π§  Insights & Discussion

* **μ—ν”Όμ†λ“ ν•™μµμ λΉ„ν¨μ¨μ„±:** μ—ν”Όμ†λ“ ν•™μµ, νΉν μ§€μ› μ„ΈνΈμ™€ μΏΌλ¦¬ μ„ΈνΈμ μ—­ν•  λ¶„λ¦¬λ” λΉ„λ¨μμ  FSL λ°©λ²•μ—μ„ λ°μ΄ν„° ν™μ©λ„λ¥Ό μ €ν•΄ν•λ” μ£Όμ” μ›μΈμ…λ‹λ‹¤. μ΄λ” μ†μ‹¤ κ³„μ‚°μ— κΈ°μ—¬ν•λ” μλ³„ κ±°λ¦¬μ μλ¥Ό κ°μ†μ‹μΌ ν•™μµ μ‹ νΈλ¥Ό λΉ„ν¨μ¨μ μΌλ΅ λ§λ“­λ‹λ‹¤.
* **λ‹¨μμ„±κ³Ό μ„±λ¥:** NCAλ” μ—ν”Όμ†λ“ κ΄€λ ¨ ν•μ΄νΌνλΌλ―Έν„°λ¥Ό μ κ±°ν•μ—¬ ν›λ ¨ μ μ°¨λ¥Ό ν¬κ² λ‹¨μν™”ν•λ©΄μ„λ„ μ„±λ¥μ„ ν–¥μƒμ‹ν‚µλ‹λ‹¤. μ΄λ” FSLμ—μ„ λ³µμ΅ν• λ©”νƒ€ ν•™μµ λ©”μ»¤λ‹μ¦μ΄ ν•­μƒ ν•„μ”ν• κ²ƒμ€ μ•„λ‹μ„ μ‹μ‚¬ν•©λ‹λ‹¤.
* **κ±°λ¦¬ μμ μ¤‘μ”μ„±:** μΌλ°μ μΌλ΅ λ” λ§μ€ κΈμ • λ° λ¶€μ • κ±°λ¦¬ μμ„ ν™μ©ν• μλ΅ μ„±λ¥μ΄ ν–¥μƒλμ§€λ§, κΈμ •/λ¶€μ • μμ κ· ν•κ³Ό λ°°μΉ λ‚΄ ν΄λμ¤ μλ„ μ¤‘μ”ν• μ”μ†μ…λ‹λ‹¤.
* **ν‰κ°€ μ „λµμ μ—­ν• :** Nearest Centroid λ¶„λ¥κ°€ Soft Assignmentsλ³΄λ‹¤ μ°μν• μ„±λ¥μ„ λ³΄μΈ κ²ƒμ€ λ¨λΈ μΊλ¦¬λΈλ μ΄μ…(calibration) λ¶€μ΅± λ•λ¬ΈμΌ μ μμµλ‹λ‹¤. ν›λ ¨ ν΄λμ¤μ™€ ν‰κ°€ ν΄λμ¤κ°€ λ¶„λ¦¬λμ–΄ μμ„ λ•, λ¨λΈμ΄ λ³΄μ •λ ν™•λ¥ μ„ μƒμ„±ν•μ§€ λ»ν•  μ μμΌλ©°, μ΄λ΅ μΈν•΄ Soft Assignmentsκ°€ μ•„μ›ƒλΌμ΄μ–΄μ— λ” λ―Όκ°ν•κ² λ°μ‘ν•  μ μμµλ‹λ‹¤.
* λ³Έ μ—°κµ¬λ” μµμ‹  κΈ°μ  μƒνƒλ¥Ό κ°μ„ ν•λ” κ²ƒλ³΄λ‹¤ μ—ν”Όμ†λ“ ν•™μµ κ΄€ν–‰μ— λ€ν• μ΄ν•΄λ¥Ό λ†’μ΄λ” λ° μ¤‘μ μ„ λ‘μ—μµλ‹λ‹¤.

## π“ TL;DR

Few-shot learningμ—μ„ λ„λ¦¬ μ“°μ΄λ” μ—ν”Όμ†λ“ ν•™μµμ€ Matching Networks λ° Prototypical Networks κ°™μ€ λΉ„λ¨μμ  λ°©λ²•λ΅ μ—μ„ **μ¤νλ ¤ μ„±λ¥μ„ μ €ν•΄ν•κ³  λ°μ΄ν„° λΉ„ν¨μ¨μ„±μ„ μ΄λ**ν•λ©°, λ¶ν•„μ”ν• ν•μ΄νΌνλΌλ―Έν„°λ¥Ό λ„μ…ν•©λ‹λ‹¤. λ³Έ λ…Όλ¬Έμ€ μ§€μ›(support) λ° μΏΌλ¦¬(query) μ„ΈνΈ λ¶„λ¦¬ μ—†μ΄ λ°°μΉ λ‚΄ λ¨λ“  μƒν” κ°„μ κ΄€κ³„λ¥Ό ν™μ©ν•λ” **λΉ„μ—ν”Όμ†λ“μ  Neighbourhood Component Analysis (NCA) κΈ°λ° λ°©λ²•μ΄ ν›¨μ”¬ κ°„λ‹¨ν•κ³  ν¨μ¨μ μ΄λ©°, λ” λ†’μ€ λ¶„λ¥ μ •ν™•λ„λ¥Ό λ‹¬μ„±**ν•¨μ„ μ‹¤ν—μ μΌλ΅ μ…μ¦ν–μµλ‹λ‹¤. NCAλ” μµμ‹  FSL λ°©λ²•λ΅ κ³Ό κ²½μν•κ±°λ‚ λ¥κ°€ν•λ” μ„±λ¥μ„ λ³΄μ΄λ©°, λ―Έλ μ—°κµ¬λ¥Ό μ„ν• κ°•λ ¥ν•κ³  λ§¤λ ¥μ μΈ λ² μ΄μ¤λΌμΈμ΄ λ  μ μμµλ‹λ‹¤.
