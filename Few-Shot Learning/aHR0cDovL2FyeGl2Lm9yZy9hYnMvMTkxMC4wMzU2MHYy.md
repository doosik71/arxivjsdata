# When Does Self-supervision Improve Few-shot Learning?

Jong-Chyi Su, Subhransu Maji, Bharath Hariharan

## 🧩 Problem to Solve

기존 기계 학습 알고리즘은 새로운 태스크 학습에 방대한 양의 훈련 데이터를 요구합니다. 이는 레이블 데이터 확보가 어려운 바이오, 의료 분야 등에서 실질적인 문제가 됩니다. Few-shot 학습은 제한된 훈련 데이터(novel 클래스)만으로 새로운 개념을 빠르게 학습하려 하지만, 베이스(base) 클래스 분류를 위해 훈련된 특징 표현은 novel 클래스에 필요한 중요한 의미 정보를 간과할 수 있습니다. 특히 베이스 데이터셋이 작거나 클래스 구분이 어려울 때 이러한 문제가 더욱 두드러집니다.

이 논문은 자기 지도 학습(SSL)이 다음 질문들에 답할 수 있는지 탐구합니다:

1. SSL이 few-shot 설정에서 베이스 클래스에 대한 과적합을 방지하고 novel 클래스 성능을 향상시킬 수 있는가?
2. 이러한 이점이 다양한 도메인과 더 어려운 태스크에 일반화되는가?
3. 레이블 없는 이미지조차 얻기 어려운 도메인에서 SSL이 성능을 향상시킬 수 있는가?

## ✨ Key Contributions

* **SSL의 few-shot 학습 개선 효과 확인:** 추가 훈련 데이터 없이도, 자기 지도 태스크를 보조 태스크로 활용함으로써 기존 few-shot 학습 기법의 성능을 4%-27% 향상시킴을 여러 벤치마크에서 입증했습니다. 이는 데이터셋이 작고 내부 이미지($D_s = D_{ss}$)만 사용했을 때도 유효했습니다.
* **어려운 태스크에서 더 큰 이점:** 훈련 세트가 작거나 태스크가 더 어려울 때(예: 낮은 해상도, 흑백 이미지, 적은 훈련 샘플), SSL의 이점이 더욱 커진다는 것을 발견했습니다.
* **도메인 시프트의 영향 분석:** 메타 학습에 사용되는 이미지($D_s$)와 자기 지도 학습에 사용되는 이미지($D_{ss}$)의 분포(도메인)가 다를 경우, SSL이 오히려 성능을 저하시킬 수 있음을 체계적으로 분석했습니다.
* **효과적인 이미지 선택 기법 제안:** 대규모의 일반적인 레이블 없는 이미지 풀($D_p$)에서 주어진 대상 데이터셋($D_s$)에 대해 자기 지도 학습에 적합한 이미지를 자동으로 선택하는 기법을 제안했으며, 이는 성능을 더욱 향상시켰습니다.

## 📎 Related Works

* **Few-shot 학습:** MAML (Model-Agnostic Meta-Learning) [16], Prototypical Networks (ProtoNet) [55], Matching Networks [61] 등이 있으며, 본 연구는 ProtoNet을 기반으로 실험했습니다.
* **자기 지도 학습 (SSL):** 이미지의 회전 예측 [20], 직소 퍼즐 해결 [41], 컨텍스트 예측 [13], 대조 학습 [9] 등 다양한 방법이 제안되었습니다. 본 연구에서는 직소 퍼즐과 회전 예측 태스크를 활용했습니다.
* **다중 태스크 학습 (Multi-task learning):** 여러 태스크 목표를 함께 훈련하여 각 태스크의 성능을 향상시키는 기법이며, 본 연구는 자기 지도 태스크와 few-shot 학습이 상호 이점을 제공한다는 것을 보였습니다.
* **도메인 선택 (Domain selection):** 지도 학습에서 사전 학습을 위한 소스 도메인 선택 [12, 39], SSL에서 소스 도메인의 중요성 [21] 등을 다룬 선행 연구들이 있으며, 본 연구는 few-shot 학습 맥락에서 도메인 시프트 효과와 도메인 선택 방법을 탐구했습니다.

## 🛠️ Methodology

이 연구는 few-shot 학습을 위한 메타 학습 접근 방식과 자기 지도 학습을 결합한 프레임워크를 사용합니다.

1. **공동 손실 함수:** 지도 학습 손실($L_s$)과 자기 지도 학습 손실($L_{ss}$)을 결합한 최종 손실 $L := L_s + L_{ss}$를 사용하여 공유 특징 백본을 훈련합니다. 이로써 자기 지도 손실은 표현 학습을 위한 데이터 의존적 정규화 역할을 합니다.
2. **지도 학습 손실 ($L_s$):**
    * 대부분의 결과는 ProtoNet [55] 기반의 메타 학습자를 사용하여 제시됩니다. 이는 에피소드식 훈련(episodic training)을 통해 베이스 클래스 $D_b$에서 샘플링된 N-way K-shot 태스크를 학습합니다.
    * MAML [16] 및 표준 교차 엔트로피 손실(softmax classifier)을 사용하는 다른 메타 학습자도 함께 평가했습니다.
3. **자기 지도 학습 손실 ($L_{ss}$):** 다음 두 가지 효과적인 태스크를 사용합니다.
    * **직소 퍼즐 태스크:** 입력 이미지 $x$를 3x3 영역으로 나누어 무작위로 재배열하여 $\hat{x}$를 얻고, 순열 인덱스(35가지 중 하나)를 목표 레이블 $\hat{y}$로 예측합니다.
    * **회전 예측 태스크:** 입력 이미지 $x$를 $0^\circ, 90^\circ, 180^\circ, 270^\circ$ 중 한 각도로 회전시켜 $\hat{x}$를 얻고, 회전 각도 인덱스를 목표 레이블 $\hat{y}$로 예측합니다.
    * 두 태스크 모두 교차 엔트로피 손실을 사용합니다.
4. **이미지 도메인 분석 및 선택:**
    * SSL에 사용되는 이미지 도메인($D_{ss}$)과 메타 학습에 사용되는 이미지 도메인($D_s$)이 같을 때($D_s = D_{ss}$)와 다를 때($D_s \neq D_{ss}$)의 효과를 분석합니다.
    * **도메인 선택 기법:** 대규모 레이블 없는 이미지 풀($D_p$)에서 자기 지도 학습에 사용할 이미지를 선택하기 위해 "도메인 가중치" 모델을 사용합니다. ResNet-101 특징 기반으로 $D_s$의 이미지를 긍정 클래스로, $D_p$의 이미지를 부정 클래스로 하는 이진 로지스틱 회귀 분류기를 훈련합니다. 이 분류기의 예측을 기반으로 $p(x \in D_s) / p(x \in D_p)$ 비율에 따라 상위 이미지를 선택하여 $D_{ss}$를 구성합니다.

## 📊 Results

* **SSL의 일관된 성능 향상:** 직소 퍼즐 태스크는 ProtoNet baseline의 7개 데이터셋(mini-ImageNet, tiered-ImageNet, Birds, Cars, Aircrafts, Dogs, Flowers) 모두에서 5-way 5-shot 분류 정확도를 향상시켰습니다. 상대 오류율은 4.0%에서 27.8%까지 감소했습니다. 회전 예측 태스크도 대부분의 데이터셋에서 향상을 보였습니다.
* **어려운 태스크에서 더 큰 이점:** 저해상도, 흑백 이미지, 또는 훈련 데이터 수가 20%로 감소된 "더 어려운" 태스크 설정에서 SSL의 이점이 더욱 두드러졌습니다. 예를 들어, Cars 데이터셋의 5-way 5-shot 분류에서 원래 데이터셋 대비 20% 훈련 데이터 설정에서 SSL을 통해 얻는 정확도 향상이 0.7%에서 7.0%로 크게 증가했습니다.
* **메타 학습자 전반에 걸친 일반화:** 직소 퍼즐 손실을 Softmax, MAML, ProtoNet과 같은 다양한 메타 학습자와 결합했을 때, 모든 경우에서 평균 5-way 5-shot 정확도가 향상되었습니다. SSL과 함께 훈련된 ProtoNet이 모든 데이터셋에서 가장 좋은 성능을 보였습니다.
* **SSL 단독으로는 불충분:** SSL만으로 훈련된 모델은 무작위 초기화보다는 우수했지만, 지도 학습된 모델에 비해 현저히 낮은 성능을 보였습니다(예: 평균 32.9% 대 85.5%). 이는 SSL이 사전 훈련보다는 특징 정규화 역할을 한다는 것을 시사합니다.
* **도메인 시프트의 부정적 영향:** 자기 지도 학습에 사용되는 레이블 없는 이미지의 도메인 분포가 메타 학습의 도메인과 다를수록 SSL의 효과가 감소하며, 때로는 성능을 저하시킬 수 있음을 확인했습니다.
* **효과적인 이미지 선택의 중요성:** 제안된 도메인 선택 기법(중요도 가중치 사용)은 대규모 레이블 없는 이미지 풀에서 이미지를 무작위로 선택하는 경우보다 모든 5개 데이터셋에서 훨씬 뛰어난 성능 향상을 가져왔습니다. 이는 "SSL 20% 데이터셋" (데이터셋 내의 20% 레이블 있는 이미지만으로 SSL 수행)을 능가하는 결과였습니다.

## 🧠 Insights & Discussion

이 연구는 자기 지도 학습(SSL)이 few-shot 학습, 특히 적은 데이터 환경에서 강력한 보조 도구임을 명확히 보여줍니다. SSL은 데이터 의존적 정규화 역할을 하여 네트워크가 베이스 클래스에 과적합되는 것을 방지하고, novel 클래스에 유용한 더 일반화된 의미론적 특징을 학습하도록 돕습니다. 흥미롭게도, SSL의 이점은 태스크가 더 어려울수록(예: 데이터셋이 작거나 입력 품질이 낮을수록) 더욱 커집니다. 이는 SSL이 제한된 정보를 가진 환경에서 모델의 견고성을 높이는 데 특히 효과적임을 시사합니다.

또한, SSL에 사용되는 레이블 없는 데이터의 도메인 분포가 중요하다는 점을 강조합니다. 도메인이 너무 다르면 SSL이 오히려 해가 될 수 있습니다. 이를 해결하기 위해, 대규모의 일반적인 이미지 풀에서 대상 도메인과 유사한 이미지를 자동으로 선택하는 효과적인 방법을 제안하여 실용적인 가치를 더했습니다. 시각화를 통해 SSL 모델이 배경 잡음 대신 전경 영역에 더 집중하는 경향을 보여주어, 배경 특징과 클래스 레이블 간의 우발적인 상관관계를 피하는 데 도움이 될 수 있음을 시사했습니다.

이 연구는 대규모 외부 데이터셋에 의존하지 않고도 작은 데이터셋 내의 이미지로 SSL을 활용할 수 있다는 점에서 중요한 실용적 이점을 제공합니다. 향후 연구는 대조 학습(contrastive learning) [3, 22, 24, 38, 58]과 같은 다른 SSL 태스크의 효과를 탐구하고, SSL이 지도 및 자기 지도 태스크 전반에 걸쳐 일반화를 어떻게 개선하는지에 대한 경험적 분석을 심화할 수 있습니다 [1, 66].

## 📌 TL;DR

Few-shot 학습에서 자기 지도 학습(SSL)은 중요한 역할을 합니다. 이 연구는 SSL이 **적은 데이터 환경**과 **어려운 태스크**에서 few-shot 메타 학습자(예: ProtoNet)의 **성능을 4%-27% 향상**시킬 수 있음을 발견했습니다. 또한, SSL에 사용되는 **레이블 없는 이미지의 도메인이 다를 경우 성능이 저하될 수 있음**을 체계적으로 분석하고, 대규모 풀에서 **유사 도메인 이미지를 자동으로 선택하는 기법을 제안**하여 성능을 더욱 개선했습니다. 이는 SSL이 few-shot 학습의 특징 정규화 및 일반화에 필수적이며, 적절한 데이터 선택이 중요함을 시사합니다.
