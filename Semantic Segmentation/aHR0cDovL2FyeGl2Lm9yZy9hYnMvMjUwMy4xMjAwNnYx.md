# ROS-SAM: High-Quality Interactive Segmentation for Remote Sensing Moving Object

Zhe Shan, Yang Liu, Lei Zhou, Cheng Yan, Heng Wang, Xia Xie

## 🧩 Problem to Solve

대규모 원격 탐사 비디오 데이터의 가용성이 증가함에 따라 고품질 인터랙티브 분할의 중요성이 부각되고 있습니다. 하지만 원격 탐사 비디오 내 움직이는 객체(RSVMO)는 크기가 작고, 특징이 모호하며, 객체 밀도가 높고, 프레임별 주석 비용이 높다는 문제로 인해 기존 방법론으로는 고품질 분할을 달성하기 어렵습니다. 특히 Segment Anything Model (SAM) [23]은 일반적인 시각 작업에서 강력한 성능을 보이지만, 원격 탐사 데이터에서는 도메인 간극, 불분명한 마스크 경계, 작은 객체들이 다운샘플링 과정에서 사라지는 문제 등으로 인해 효과적인 분할이 어려웠습니다.

## ✨ Key Contributions

- 원격 탐사 특화 지식과 마스크 디코더 최적화를 통합하여 고품질 예측을 달성하는 ROS-SAM을 제안했습니다.
- 학습 시 다양한 스케일의 객체를 포함하고, 추론 시 단일 객체에 대한 고품질 추론에 초점을 맞춘 새로운 데이터 파이프라인을 제안했습니다.
- 실험 결과, 제안된 데이터 파이프라인이 IoU를 6% 향상시켰고, ROS-SAM은 기존 SAM 대비 IoU를 13% 향상시켰음을 입증했습니다.
- 기존 원격 탐사 객체 추적 데이터셋에서 평가했을 때, ROS-SAM이 수동 주석과 유사한 마스크를 생성하며 강력한 제로샷(zero-shot) 성능을 보여주었습니다.

## 📎 Related Works

- **비디오 원격 탐사 (Video Remote Sensing):** 저해상도, 다양한 스케일, 높은 노이즈 등 고유한 특성으로 인해 기존 시각 알고리즘에 큰 도전 과제를 제시합니다. 초기 연구는 주로 특징 추출, 시간적 관계 설정, 시공간 정보 포착을 통한 객체 추적에 초점을 맞췄습니다. 비디오 객체 분할은 객체 추적보다 더 실용적이고 복잡한 작업으로 간주됩니다.
- **SAT-MTB 데이터셋 [25]:** 위성 비디오를 위한 멀티태스크 벤치마크 데이터셋으로, 객체 추적, 탐지, 분할 작업을 포함하지만, 제한된 비디오 수와 불완전한 주석으로 인해 고품질 원격 탐사 비디오 분할에는 한계가 있습니다.
- **SAM 미세 조정 (Fine-tuning SAM):** SAM의 강력한 사전 지식과 제로샷 능력을 유지하면서 새로운 특정 작업에 적응시키는 것이 핵심 과제입니다.
  - **Adapter [3, 4]:** 작은 양의 데이터로 작업별 지침을 주입할 수 있는 유연한 추가 네트워크 계층입니다.
  - **LoRA (Low-Rank Adaptation) [14]:** 매개변수 효율적인 미세 조정 방법으로, 트랜스포머 아키텍처 내에 학습 가능한 선형 프로젝션 계층을 도입하여 고수준 컨텍스트 특징을 추출하는 SAM의 능력을 복원하는 데 도움을 줍니다. LoRA는 저랭크 행렬을 사용하여 가중치 변경을 표현함으로써 사전 학습된 모델에 대한 의존도와 미세 조정 중 과적합 위험을 줄입니다.

## 🛠️ Methodology

ROS-SAM은 세 가지 주요 혁신과 재설계된 데이터 파이프라인을 기반으로 합니다.

1. **LoRA 기반 이미지 인코더 미세 조정:**

   - SAM의 이미지 인코더(ViT 기반)의 모든 Transformer 계층에 LoRA [14]를 적용하여 원격 탐사 도메인별 정보를 효율적으로 주입합니다. 특히 Q (Query) 및 V (Value) 행렬에 저랭크 분해 행렬을 도입하여 원본 모델의 성능 저하 없이 새로운 작업에 빠르게 적응할 수 있도록 합니다.
   - 이미지 인코더의 마지막 블록을 고정 해제(unfreeze)하고 업데이트하여, 특징 식별 능력을 향상시키고 복잡한 장면(예: 비행기와 탑승교)에서 관련 객체에 집중할 수 있도록 돕습니다.

2. **마스크 디코더 및 고품질 마스크 디코더 강화:**

   - HQ-SAM [21]에서 영감을 받아, 이미지 인코더의 초기 및 최종 단계 특징을 통합하도록 마스크 디코더를 수정합니다. 이는 고수준 객체 컨텍스트와 저수준 에지 정보를 결합하여 고품질 마스크 예측을 생성합니다.
   - 기존 HQ-SAM과 달리, SAM의 마스크 디코더를 고정하지 않습니다. 대신, 원본 SAM 마스크 디코더와 HQ-SAM 마스크 디코더의 매개변수를 교대로 업데이트하는 방식으로 동시에 미세 조정하여 RSVMO에 대한 SAM의 적용성을 강화하고 제로샷 능력을 유지합니다.

3. **학습 및 추론을 위한 데이터 파이프라인 재설계:**
   - **학습 파이프라인:**
     - 대규모 지터링(Large-Scale Jittering, LSJ) [11]을 활용하여 다양한 객체 스케일에 대한 모델의 일반화 능력을 향상시킵니다.
     - 원격 탐사 객체가 고정된 방향을 갖지 않으므로, 무작위 회전(random rotations)을 도입하여 학습 샘플의 다양성을 높입니다.
     - 사전 학습된 SAM의 매개변수는 고정하고, LoRA 및 수정된 디코더의 "빨간색" 구성 요소만 학습 가능하게 합니다.
     - Binary Cross-Entropy (BCE) Loss와 Dice Loss를 조합하여 마스크 예측 토큰을 감독하고, SAM 마스크와 ROS-SAM 마스크 간에 네트워크 가중치를 교대로 업데이트합니다.
   - **추론 파이프라인:**
     - 프롬프트 정보 기반으로 객체 근처의 $N \times 512 \times 512$ 크기 패치를 잘라냅니다(하나의 객체만 중앙에 오도록).
     - 바이큐빅(bicubic) 보간법을 사용하여 패치를 $N \times 1024 \times 1024$로 업샘플링합니다 (실험을 통해 2배 업샘플링이 최적임을 확인).
     - 이 패치들을 ROS-SAM에 순차적으로 입력하고 메모리에 저장합니다.
     - 마지막으로, 패치들을 프롬프트의 위치 정보에 기반하여 전체 마스크로 복원합니다.

## 📊 Results

- **정량적 결과:**

  - **SAT-MTB 데이터셋:** 재설계된 데이터 파이프라인만으로 IoU 및 BIoU를 6% 이상 향상시켰으며, ROS-SAM은 기존 SAM 대비 IoU를 13% 향상시켜 50.54%를 달성했습니다.
  - **개별 구성 요소 기여도:** 각 제안된 방법(추론 파이프라인, 학습 파이프라인의 LSJ 및 무작위 회전, 마스크 디코더 강화, 이미지 인코더 미세 조정)이 예측 정확도 향상에 유의미하게 기여함을 Ablation Study를 통해 확인했습니다.
  - **SOTA 비교:** SAM, SAM2, HQ-SAM 등 기존 최첨단 알고리즘과 비교하여 ROS-SAM이 가장 우수한 성능을 보였습니다.
  - **정적 이미지 데이터셋:** iSAID [48] 및 NPWS VHR-10 [43]과 같은 정적 원격 탐사 데이터셋에서도 적용 가능하며 우수한 성능(iSAID IoU 73.22%, NPWS VHR-10 IoU 87.46%)을 보여 일반화 능력을 입증했습니다.

- **정성적 (제로샷) 결과:**
  - SatSOT [66], VISO [60], OOTB [60]와 같은 원격 탐사 객체 추적 데이터셋에서 뛰어난 제로샷 성능을 시연했습니다. 해상도, 센서 유형, 촬영 시간/위치 차이에도 불구하고 고품질의 분할 마스크를 일관되게 생성했습니다.
  - 기존 SAM이 비행기를 네 갈래 별 모양으로 예측하거나 열차를 제대로 분할하지 못하는 반면, ROS-SAM은 비행기 엔진 위치와 같은 세부 사항까지 정확하게 식별하며 수동 주석과 매우 유사한 예측을 수행했습니다.
  - 명확한 특징을 가진 객체(예: 선박)의 경우 거의 완벽한 결과를 보였으며, 근접한 객체들 사이에서도 정확한 분할을 달성했습니다.

## 🧠 Insights & Discussion

- **의의:** ROS-SAM은 일반적인 시각 모델(SAM)과 원격 탐사 작업 간의 도메인 간극을 효과적으로 줄여 RSVMO의 고품질 인터랙티브 분할을 가능하게 합니다.
- **주요 시사점:**
  - 원격 탐사에서 SAM의 도메인 적응은 매우 중요하며, LoRA 및 이미지 인코더의 깊은 계층 미세 조정이 효과적인 방법임이 확인되었습니다.
  - 마스크 디코더의 개선, 특히 다단계 특징 통합 및 교대 업데이트는 픽셀 단위 정확도와 경계 품질을 크게 향상시킵니다.
  - 원격 탐사 이미지의 고유한 특성(큰 크기, 작은 객체, 다양한 스케일)을 처리하기 위해서는 스케일 다양성을 위한 학습 파이프라인(LSJ, 무작위 회전)과 고품질 추론을 위한 프롬프트 기반 크롭 및 업샘플링을 포함하는 맞춤형 데이터 파이프라인이 필수적입니다.
- **한계점:** 비행기 엔진 수와 같은 미세한 세부 사항을 정확히 구별하는 데 어려움이 있을 수 있으며, 수동 주석이 사전 지식에 기반한 시각적으로 구별하기 어려운 객체의 경우 정확한 형태 예측이 어려울 수 있습니다.
- **향후 전망:** ROS-SAM은 원격 탐사 비디오 분석에서 미세한 분할을 발전시키는 강력한 도구가 될 것으로 기대됩니다.

## 📌 TL;DR

**문제:** 기존 SAM은 원격 탐사 영상의 작은 움직이는 객체에 대한 고품질 인터랙티브 분할에 한계가 있으며, 도메인 간극, 마스크 경계의 부정확성, 작은 객체 소실 등의 문제가 있음.
**방법:** ROS-SAM은 LoRA 기반 이미지 인코더 미세 조정 및 깊은 네트워크 레이어 강화를 통해 도메인 적응과 특징 식별력을 향상시킴. HQ-SAM 기반 마스크 디코더를 개선하여 글로벌 컨텍스트와 로컬 경계 디테일을 통합하고, 원본 디코더와 번갈아 최적화함. 학습 시 스케일 다양성을 위한 LSJ 및 무작위 회전, 추론 시 고품질 단일 객체 예측을 위한 프롬프트 기반 중앙 크롭 및 업샘플링을 포함하는 새로운 데이터 파이프라인을 설계함.
**결과:** SAT-MTB 데이터셋에서 IoU 13% 향상 (파이프라인만으로 6% 향상). 다른 정적 및 객체 추적 데이터셋에서도 뛰어난 제로샷 성능과 높은 분할 품질을 입증하며, 원격 탐사 객체의 복잡한 특성을 효과적으로 처리하고 수동 주석에 가까운 정밀한 마스크를 생성함.
