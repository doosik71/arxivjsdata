# 의료 영상 분할에서 SAM 2가 SAM보다 나은가?

Sourya Sengupta, Satrajit Chakrabarty, and Ravi Soni

## 🧩 해결하려는 문제

최근 출시된 Segment Anything Model 2 (SAM 2)가 기존 Segment Anything Model (SAM)에 비해 의료 영상 분할, 특히 제로샷(zero-shot) 프롬프트 기반 분할에서 우수한 성능을 보이는지 평가하는 것이 주요 연구 문제입니다. 자연 영상과 대비, 질감, 형태가 크게 다른 의료 영상 영역에서 SAM 2가 SAM의 더 나은 대안이 될 수 있는지 확인하는 것이 중요합니다.

## ✨ 주요 기여

* MRI, CT, 초음파, 피부경 검사(dermoscopy), 내시경 등 다양한 영상 양식의 11개 공개 데이터셋에서 24가지 고유한 장기-양식 조합에 대해 SAM과 SAM 2의 성능을 광범위하게 비교 평가했습니다.
* (i) 여러 양성 프롬프트(multiple positive prompts)와 (ii) 양성 및 음성 프롬프트(positive and negative prompts)를 결합한 두 가지 점 프롬프트(point-prompt) 전략을 사용하여 평가를 수행했습니다.
* SAM 2가 의료 영상 분할에서 SAM을 전반적으로 능가하지 못하며, 일부 경우에만 약간 더 나은 성능을 보임을 발견했습니다.
* 특히 저대비 영상 양식(CT, 초음파)에서는 SAM 2가 SAM보다 성능이 저조하고, MRI에서는 동등하거나 약간 더 우수하며, 피부경 검사 및 내시경에서는 유사한 성능을 보임을 확인했습니다.
* 음성 프롬프트가 SAM 2의 성능을 SAM보다 훨씬 더 크게 향상시킬 수 있음을 발견했으며, 이는 SAM 2가 저대비 영상에서 경계선 유실 문제를 겪을 수 있음을 시사합니다.
* 두 모델 모두 특히 대상 기관의 경계가 불분명할 때 과분할(over-segmentation) 문제가 있음을 관찰했습니다.

## 📎 관련 연구

* **Segment Anything Model (SAM)**: Meta가 공개한 원본 SAM 모델에 대한 연구 [1].
* **의료 영상에서의 SAM 적용 및 평가**: 의료 영상 분야에서 SAM의 성능을 평가하고 미세 조정하며, 다양한 프롬프트 전략을 통합하려는 기존 연구들 [2-8].
* **Segment Anything Model 2 (SAM 2)**: SAM의 업데이트 버전으로, 2D 이미지 분할 및 비디오 분할 기능을 확장한 모델 [9].

## 🛠️ 방법론

* **SAM 모델:**
  * 이미지 인코더: Vision Transformer (ViT) 아키텍처 기반으로 이미지에서 고수준 특징 추출.
  * 프롬프트 인코더: 점, 박스, 텍스트 등 사용자 입력을 처리하여 이미지 특징과 정렬되는 특징 공간으로 인코딩.
  * 마스크 디코더: 이미지 인코더와 프롬프트 인코더의 특징을 결합하여 최종 분할 예측을 생성하며, Two-Way Transformer와 $IoU$ 예측 헤드를 포함.
* **SAM 2 모델:**
  * 원본 SAM의 기능을 확장하여 비디오 분할 및 시공간적 시퀀스에서 객체 추적을 지원하도록 설계됨.
  * 비디오 데이터 처리를 위해 메모리 어텐션, 메모리 인코더, 메모리 뱅크 등의 새로운 구성 요소를 포함.
  * 단일 프레임 2D 이미지 분할의 경우 SAM과 동일한 프롬프트 가능 마스크 디코더를 사용하지만, 비디오 분할에 필요한 시간적 조건화 기능은 사용하지 않음.
* **프롬프트 전략 (점 프롬프트 활용):**
    1. **다중 양성 프롬프트:** 하나의 프롬프트는 대상 구조의 중심 근처에 배치하고, 나머지 프롬프트는 구조 내부에 무작위로 배치.
    2. **양성 및 음성 프롬프트 결합:** 하나의 양성 프롬프트는 대상 구조의 중심 근처에 배치하고, 두 개의 음성 프롬프트는 구조 외부(양성 프롬프트 및 서로 간의 거리를 최대화)에 배치.
* **데이터셋:** 11개 공개 의료 영상 데이터셋(CT, MRI, 초음파, 피부경 검사, 내시경)에서 24가지 장기-양식 조합을 평가. 복부 장기, 심장 구조, 태아 머리, 피부 병변, 용종 등이 포함됨.
* **전처리:** CT, MRI, 초음파 데이터는 이미지 강도의 0.5 및 99.5 백분위수를 사용하여 최소-최대 정규화 후 [0, 255] 범위로 스케일링. 내시경 및 피부경 검사 데이터는 강도 값 변경 없음.
* **평가 지표:** Dice Similarity Coefficient (DSC)를 사용하여 모델 성능을 정량적으로 비교.

## 📊 결과

* **일반적인 성능 추세:** SAM과 SAM 2 모두 양성 프롬프트 수가 증가함에 따라 Dice Similarity Coefficient (DSC)가 전반적으로 향상되는 경향을 보였습니다.
* **영상 양식별 성능 (양성 프롬프트만 사용 시):**
  * **CT 및 초음파:** SAM 2가 SAM보다 일관되게 저조한 성능을 보였습니다. 이는 저대비 의료 영상 양식에서 SAM 2의 한계를 시사합니다.
  * **MRI:** SAM 2가 일부 경우 SAM과 동등하거나 약간 더 나은 성능을 보였습니다. MRI는 상대적으로 대비가 높은 양식입니다.
  * **피부경 검사 및 내시경:** SAM 2가 SAM과 매우 유사한 성능을 보였습니다.
* **음성 프롬프트의 영향:**
  * 음성 프롬프트를 추가하는 것은 SAM과 SAM 2 모두의 성능을 크게 향상시켰습니다.
  * SAM 2의 경우 음성 프롬프트로 인한 성능 향상이 SAM보다 더 크게 나타날 수 있음을 발견했습니다. 이는 SAM 2가 저대비 환경에서 경계선을 놓치는 경향이 있지만, 음성 프롬프트의 도움으로 일반화 능력이 크게 향상될 수 있음을 나타냅니다.
* **정성적 결과:** 정량적 결과는 다양한 양식의 이미지에 대한 질적 비교를 통해 시각적으로도 확인되었습니다. 단일 양성 프롬프트와 양성 및 음성 프롬프트의 조합에 따른 분할 결과의 개선이 관찰되었습니다.
* **과분할 문제:** 두 모델 모두 대상 기관의 경계가 불분명할 때 과분할(over-segmentation) 문제를 겪는 경향을 보였습니다.

## 🧠 통찰 및 논의

* SAM 2는 비디오 분할이라는 새로운 기능을 도입했음에도 불구하고, 2D 의료 영상 분할에서는 기존 SAM에 비해 전반적인 성능 향상을 제공하지 않습니다. 특히 CT나 초음파와 같은 저대비 의료 영상 양식에서는 SAM보다 더 좋지 않은 선택이 될 수 있습니다.
* 음성 프롬프트는 SAM 2가 더 잘 일반화하고, 특히 저대비 영상에서 나타나는 경계선 유실 단점을 보완하는 데 매우 중요하며, 경우에 따라 SAM보다 더 큰 성능 향상을 가져올 수 있습니다.
* 두 모델 모두 여전히 불분명한 경계선에서의 과분할 문제라는 한계를 가지고 있습니다.
* 향후 연구에서는 3D 의료 영상 및 바이오 이미징 타임랩스 비디오에 대한 보다 심층적인 분석이 필요합니다.

## 📌 TL;DR

**문제:** 의료 영상 분할에서 SAM 2가 기존 SAM보다 우수한가?
**방법:** MRI, CT, 초음파 등 5가지 의료 영상 양식의 11개 데이터셋에 걸쳐 24개 장기/병변에 대해 SAM과 SAM 2를 다양한 점 프롬프트 전략(단일/다중 양성, 양성+음성)으로 비교 평가.
**주요 발견:** SAM 2는 저대비 의료 영상(CT, 초음파)에서 SAM보다 성능이 떨어지지만, MRI에서는 유사하거나 약간 더 좋다. 음성 프롬프트는 SAM 2의 성능을 크게 향상시키며, 이는 저대비 영상에서의 경계선 유실 문제를 보완한다. 전반적으로 2D 의료 영상 분할에서 SAM 2가 SAM보다 크게 우수하지 않다.
