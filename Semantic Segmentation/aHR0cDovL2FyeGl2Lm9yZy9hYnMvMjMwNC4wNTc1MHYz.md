# Segment Anything Is Not Always Perfect: An Investigation of SAM on Different Real-world Applications

Wei Ji, Jingjing Li, Qi Bi, Tingwei Liu, Wenbo Li, Li Cheng

## 🧩 Problem to Solve

최근 출시된 Segment Anything Model (SAM)은 전례 없이 큰 규모의 데이터셋(SA-1B)으로 사전 학습되어 프롬프트 기반의 객체 분할에서 뛰어난 일반화 능력을 보여줍니다. 그러나 이 연구는 SAM이 **다양한 실제 시나리오 및 응용 분야(자연 이미지, 농업, 제조, 원격 탐사, 헬스케어)에서 얼마나 효과적으로 작동하고 일반화될 수 있는지**를 심층적으로 조사하여 SAM의 실제적인 이점과 한계를 종합적으로 이해하는 것을 목표로 합니다. 특히, 저조도, 새의 눈 시점, 안개, 비와 같은 다양한 조건이나 깊이, 적외선, CT, MRI와 같은 다양한 입력 양식을 사용하는 컴퓨터 비전 분야의 여러 실제 응용에서 SAM의 성능을 평가하고 분석합니다.

## ✨ Key Contributions

- **다양한 실제 응용 분야(자연 이미지, 농업, 제조, 원격 탐사, 헬스케어)에서 SAM의 성능에 대한 포괄적인 질적 및 양적 조사**를 수행했습니다.
- **SAM의 장점과 한계점**을 상세히 분석하고 논의했습니다.
  - **일반적인 장면에서의 뛰어난 일반화 능력**: 특히 대상 영역이 주변과 뚜렷이 구분될 때 효과적입니다.
  - **강력한 사전 지식 요구**: 복잡한 장면(예: 작물 분할, 안저 이미지 분할)에서는 더 많은 수동 프롬프트와 사전 지식이 필요하며, SAM은 전경 마스크를 선호하는 경향이 있습니다. 그림자 감지 등 특정 시나리오에서는 전경 편향으로 인해 성능이 저조합니다.
  - **저대비 응용 분야에서 효과 감소**: 투명하거나 위장된 객체와 같이 주변 요소와 유사한 객체 분할에서는 강건성 개선의 여지가 큽니다.
  - **전문 데이터에 대한 이해 제한**: 의료 및 산업 시나리오와 같은 전문 데이터에서는 불만족스러운 결과를 보이며, 특히 Box 및 Everything 모드에서 두드러집니다. Click 모드에서도 도메인별 지식이 요구됩니다.
  - **작고 불규칙한 객체에 대한 도전**: 원격 탐사 및 농업 분야의 불규칙한 건물이나 작은 도로와 같은 객체 분할에서는 완전한 분할을 생성하는 데 어려움이 있습니다.
- **SAM의 미래 개발 방향 및 잠재적인 연구 과제**를 제시하여 제네릭 세그멘테이션의 발전을 위한 통찰력을 제공했습니다.

## 📎 Related Works

- **기초 모델(Foundation Models)**: OpenAI의 GPT [13], ChatGPT, 그리고 비전 분야의 CLIP [42]과 같은 선구적인 연구들을 언급하며 SAM의 배경을 설명합니다.
- **Segment Anything Model (SAM)**: Meta AI Research에서 출시한 프롬프트 기반의 SAM [28] 자체를 주요 대상 모델로 삼으며, 1100만 개 이상의 이미지와 10억 개의 마스크를 포함하는 SA-1B 데이터셋으로 사전 학습되었다는 점을 강조합니다.
- **다양한 세분화 작업 및 데이터셋**:
  - **자연 이미지**: Salient Object Segmentation (ReDWeb-S [32]), Camouflaged Object Segmentation (COD10K [10]), Transparent Object Segmentation (Trans10K-v2 [50]), Shadow Detection (데이터셋 [18, 20]).
  - **농업**: Crop Segmentation (데이터셋 [15]), Pest and Leaf Disease Monitoring (데이터셋 [8]).
  - **제조**: Anomaly Detection (MVTec AD [3]), Surface Defect Detection (데이터셋 [17]).
  - **원격 탐사**: Building Extraction (데이터셋 [16]), Road Extraction (데이터셋 [37]).
  - **헬스케어**: Joint Optical Disc and Cup Segmentation (RIGA benchmark [1]), Polyp Segmentation (데이터셋 [2]), Skin Lesion Segmentation (데이터셋 [36]).
- **정량적 비교를 위한 최신 SOTA 모델**: VST [33], ICONet [59], EDNet [48], Gate [55], PFNet [34], IS-Net [41], SegMaR [26], PFNet+ [35], ZoomNet [39], DSC [21], DSDNet [56], MTMT [6], SINetV2 [9], HitNet [19], DGNet [22], FAPNet [57], CFA-Net [58], HSNet [54] 등 각 벤치마크의 전용 최신 모델들과 SAM의 성능을 비교합니다.

## 🛠️ Methodology

이 연구는 SAM의 성능을 평가하기 위해 질적(Qualitative) 및 양적(Quantitative) 조사를 모두 수행했습니다.

- **질적 조사 (Qualitative Investigation)**:

  - SAM의 세 가지 프롬프트 모드 (Click Mode, Box Mode, Everything Mode, 각각 SAM$_{1}$, SAM$_{2}$, SAM$_{3}$로 지칭)를 사용하여 다양한 실제 응용 분야(자연 이미지, 농업, 제조, 원격 탐사, 헬스케어)에서 시각적 세분화 결과를 분석했습니다.
  - 각 모드에 따라 사용자의 상호 작용 수준과 모델의 자율성을 평가했습니다 (SAM$_{1}$은 높은 상호 작용, SAM$_{3}$는 자동화된 접근 방식).
  - 다양한 이미지에서 SAM의 장점(예: 객체 위치 식별 능력)과 한계점(예: 세부 정보 캡처, 저대비 객체 처리, 전문 데이터 이해)을 시각적으로 검토했습니다.

- **양적 조사 (Quantitative Investigation)**:
  - 8개의 대표적인 세분화 벤치마크 데이터셋(DUTS, COME15K-Diff, VT1000, DIS-TE4, COD10K, SBU, CDS2K, ColonDB)을 사용하여 SAM의 성능을 측정했습니다.
  - **평가 지표**: Mean Absolute Error (MAE)를 사용하여 모델의 성능을 평가했습니다. MAE 값이 낮을수록 성능이 우수합니다.
  - **SAM 결과 추출**: [23]의 방식에 따라, SAM$_{2}$ (Box mode)를 사용하여 입력 이미지 내에서 $N$개의 잠재적 객체 마스크 $\{P_{n}\}_{n=1}^{N}$을 추론했습니다.
  - 주어진 Ground-Truth $G$와 각 예측 마스크 $P_{n}$ 간의 Intersection over Union (IoU) 점수 $\{\text{IoU}_{n}\}_{n=1}^{N}$를 계산하여, 가장 높은 IoU를 가진 마스크를 최종 결과로 선택했습니다.
  - SAM 모델의 다양한 백본 (ViT-B, ViT-L, ViT-H)에 따른 성능도 비교했습니다.

## 📊 Results

- **질적 결과**:

  - **자연 이미지**: 일반적인 돌출 객체 분할에서는 강력한 성능을 보였으나, 미세한 디테일 포착, 위장/투명 객체 분할, 그림자 감지, 잡음이 많은 배경에서는 어려움을 겪었습니다.
  - **농업**: 해충 및 잎 질병 모니터링에서는 뛰어난 일반화 능력을 보였지만, 작물 분할에서는 사전 학습 데이터의 편향(작물/땅을 배경으로 취급)으로 인해 만족스럽지 못했습니다.
  - **제조**: 이상 감지에서는 강력한 인식 능력을 보였으나, 표면 결함 감지에서는 SAM$_{1}$ (Click Mode)은 수용 가능한 성능을 보인 반면 SAM$_{3}$ (Everything Mode)는 유의미한 결과를 내지 못하여 전문가의 사전 지식의 중요성을 강조했습니다.
  - **원격 탐사**: 규칙적인 형태의 객체(건물)는 잘 분할했으나, 작거나 식별하기 어려운 대상(작은 건물, 도로)에서는 개선의 여지가 있었습니다.
  - **헬스케어**: SAM$_{1}$ (Click Mode)은 충분한 사람의 프롬프트가 주어질 경우 인상적인 성능을 보였지만, 광학 디스크 및 컵 분할과 같이 높은 전문 지식이 요구되는 작업에서는 심각한 단점을 드러냈습니다. SAM$_{2}$ (Box Mode) 및 SAM$_{3}$ (Everything Mode)의 성능은 저조했습니다.

- **양적 결과**:
  - 8개 벤치마크 데이터셋에 대한 MAE 점수 비교 결과, SAM (ViT-H 백본 사용 시에도)은 **각 애플리케이션을 위해 특별히 설계된 최신 전용 모델에 비해 상당한 성능 격차**를 보였습니다.
  - 특히, 산업용 은폐 결함 감지 (CDS2K)에서 MAE가 $0.265$로 최신 DGNet ($0.089$) 대비 $17.6\%$의 성능 차이를 보였으며, 그림자 감지 (SBU)에서도 MAE $0.183$로 최신 MTMT ($0.029$) 대비 $15.4\%$의 큰 차이를 보였습니다.
  - 이는 SAM의 강력한 일반화 능력에도 불구하고, **특정 도전적인 시나리오 및 응용 분야에서는 여전히 상당한 연구 및 개선이 필요함**을 시사합니다.

## 🧠 Insights & Discussion

이 연구는 SAM이 자연 이미지 분할에서는 강력한 일반화 능력을 보이지만, **복잡하거나 특수한 실제 시나리오(예: 헬스케어, 제조, 원격 탐사)에서는 여전히 상당한 한계**를 가진다는 것을 보여줍니다.

- **제한 사항 및 개선점**:

  - **도메인 특화 모델 및 데이터셋의 필요성**: 현재 SAM은 일반적인 이미지에 최적화되어 있으므로, 의료, 산업, 원격 탐사 등 특정 응용 분야의 특성을 반영한 전용 대규모 데이터셋과 SAM 모델의 개발이 필수적입니다.
  - **추가 프롬프트 모드 탐색**: 현재의 Click, Box, Everything 모드 외에 음성, 제스처 등 사용자 친화적인 추가 프롬프트 모드를 탐색하여 상호작용성을 높일 수 있습니다.
  - **새로운 사전 학습 전략**: SA-1B는 픽셀 단위 예측 작업에 적합한 대규모 데이터셋이므로, SAM이 산업/의료 애플리케이션을 위한 새로운 사전 학습 모델로 활용될 수 있습니다. 메트릭 학습 [27]과 같은 기술을 SA-1B에 적용하여 특징 표현 능력을 강화하는 것도 고려할 수 있습니다.
  - **다중 모달리티 통합**: 저대비 또는 저조도 장면과 같은 도전적인 시나리오에 대한 강건성을 높이기 위해 깊이 [24, 40] 및 열화상 [45]과 같은 보완적인 정보 소스(multi-modalities)를 통합하는 것이 필요합니다.
  - **비디오 SAM으로의 확장**: 정적 이미지를 넘어 동적 비디오 입력 [30, 53]을 처리할 수 있는 Video SAM의 개발도 중요한 연구 과제입니다.
  - **준지도 학습 응용**: SAM의 뛰어난 성능과 다용성은 준지도 세분화 [29]와 같은 관련 작업에서 유망한 도구가 될 수 있습니다. 적절한 점, 경계 상자 또는 스크리블 프롬프트를 사용하여 의사 라벨(pseudo-labels)을 생성하는 데 활용될 수 있습니다.

- **의미**: SAM은 비전 기초 모델 분야에 중요한 진전을 가져왔지만, 진정으로 모든 것을 분할하는 '완벽한' 모델이 되기 위해서는 여전히 많은 도전 과제를 해결해야 합니다. 이 연구는 미래의 연구가 SAM의 강점을 활용하면서도 특정 도메인 요구사항과 어려운 시나리오를 해결하는 방향으로 나아가야 할 필요성을 강조합니다.

## 📌 TL;DR

Meta AI의 SAM은 방대한 SA-1B 데이터로 사전 학습되어 일반 객체 분할에 탁월하지만, 본 연구는 **다양한 실제 응용 분야(농업, 제조, 원격 탐사, 헬스케어)에서 그 한계를 조사**했습니다. 질적 및 양적 평가 결과, SAM은 **저대비 객체, 작고 불규칙한 객체, 전문적인 데이터(의료 이미지, 산업 결함, 그림자)에서는 성능이 저조**했으며, 종종 수동 프롬프트와 도메인 전문 지식이 요구됩니다. 양적 비교에서도 SAM은 각 분야의 **최신 전용 모델 대비 성능 격차**를 보였습니다. 따라서, 향후 연구는 특정 애플리케이션에 특화된 SAM 개발, 다중 모달리티 통합, 새로운 프롬프트 모드, 그리고 SA-1B를 활용한 효율적인 사전 학습 전략에 중점을 두어야 합니다.
