# Generalized Few-Shot Semantic Segmentation in Remote Sensing: Challenge and Benchmark

Clifford Broni-Bediako, Junshi Xia, Jian Song, Hongruixuan Chen, Mennatullah Siam, Naoto Yokoya

## 🧩 해결하고자 하는 문제

원격 탐사 분야에서 제한된 라벨 데이터로 학습하는 것은 중요한 문제이지만, 특히 새로운 클래스에 대한 일반화 성능과 기존 학습 클래스에 대한 성능 유지를 동시에 요구하는 **일반화된 소수 학습 의미론적 분할(Generalized Few-Shot Semantic Segmentation, GFSS)**에 대한 전용 벤치마크 데이터셋이 부재합니다. 기존 원격 탐사 소수 학습 벤치마크는 주로 새로운 클래스 분할(1-way)에 초점을 맞추었으며, 실용적인 시나리오에서 중요한 기반 클래스 성능 유지는 간과되었습니다. 이 연구는 서브미터 수준의 토지 피복 지도화에서 이 격차를 해소하고자 합니다.

## ✨ 주요 기여

* **OEM-GFSS (OpenEarthMap Generalized Few-Shot Semantic Segmentation) 데이터셋 공개:** OpenEarthMap 데이터셋의 8개 클래스를 15개의 세분화된 토지 피복 클래스로 확장한 서브미터 수준의 데이터셋을 제시합니다.
* **원격 탐사 GFSS 최초의 벤치마크 제공:** 원격 탐사 이미지 이해 분야에서 GFSS를 위한 최초의 벤치마크를 제시하고, 기준선 모델 및 도전 과제 우승자들의 결과를 포함한 성능 평가를 제공합니다.

## 📎 관련 연구

* **위성 이미지 데이터셋:** OpenSentinalMap [14], LoveDA [25], DynamicEarthNet [23], DeepGlobe [6] 등이 토지 피복 지도화와 같은 지도 학습 작업에 활용되었습니다. LoveDA 및 DeepGlobe는 교차 도메인 소수 학습 의미론적 분할에 사용되었으나, GFSS 벤치마크로는 제안된 바 없습니다.
* **소수 학습:** 이미지 분류 (예: Prototypical Networks [20]) 및 의미론적 분할 (예: multiscale 접근법 [18], dense pixel-to-pixel affinity [19])에서 활발히 연구되었습니다. 원격 탐사 분야에서는 장면 분류 [4] 및 토지 피복 지도화 [16, 25, 26, 29]에 대한 소수 학습 연구가 있었으며, iSAID-5i 벤치마크 [29]는 새로운 클래스 분할(1-way)에 초점을 맞췄습니다. 본 연구는 기반 클래스와 새로운 클래스를 모두 분할하는 N-way GFSS라는 더 현실적인 설정을 다룹니다.

## 🛠️ 방법론

이 연구는 새로운 데이터셋을 구축하고 이를 기반으로 한 도전 과제 및 벤치마크를 제시합니다.

* **데이터셋 구축 (OEM-GFSS):**
  * OpenEarthMap 테스트 세트에서 이미지들을 샘플링하여 408개의 1024x1024 크기 이미지를 선정했습니다.
  * 기존 OpenEarthMap의 8개 클래스를 15개의 세분화된 클래스(8개 신규 클래스, 7개 기존 수정/유지 클래스)로 확장했습니다.
  * 각 픽셀을 수동으로 라벨링하고, 두 명의 추가 주석가가 품질 검사를 수행하며 불일치 시 세 번째 검증자가 확인하는 방식으로 고품질의 주석을 확보했습니다.
  * 전체 15개 클래스를 학습(기반) 7개, 검증(새로운) 4개, 테스트(새로운) 4개로 분리하여 데이터셋을 258개 학습, 50개 검증, 100개 테스트 이미지로 나눴습니다.
  * 학습 세트는 기반 클래스 이미지만 포함하며 백본 네트워크 사전 학습에 사용되고, 검증 및 테스트 세트는 5-shot, 4-novel, 7-base 클래스 설정의 GFSS 작업을 위한 지원(support) 및 질의(query) 세트를 포함합니다.
* **도전 과제 및 벤치마크 설정:**
  * CVPR 2024와 연계된 L3D-IVU 워크숍에서 CodLab 플랫폼을 통해 두 단계의 도전 과제로 진행되었습니다.
  * **기준선 모델:** 최신 GFSS 방법인 DIaM [10]을 사용했습니다. 이는 기반 클래스의 성능 저하를 방지하기 위해 지식 증류(knowledge distillation) 항을 활용하는 변환적 추론(transductive inference) 메커니즘을 기반으로 합니다.
  * **평가 지표:** 기반 클래스 mIoU ($m_{\text{base}}$), 새로운 클래스 mIoU ($m_{\text{novel}}$), 그리고 최종 순위 결정에 사용된 가중합 ($0.4 \times m_{\text{base}} + 0.6 \times m_{\text{novel}}$)을 사용했습니다.

## 📊 결과

* **정성적 결과:** 기준선 모델은 새로운 클래스(예: 주차 공간, 차량/화물 트레일러) 분할에서 어려움을 겪었으나, 대부분의 기반 클래스는 비교적 잘 분할했습니다. 이는 변환적 추론 방식이 테스트 세트의 도전 과제에 대처하는 데 도움이 되었음을 시사합니다.
* **정량적 결과 (표 2):**
  * **1단계 (검증 세트):** FoMA [8]가 새로운 클래스 mIoU 및 최종 가중합 점수에서 다른 모든 방법을 능가하여 우승했습니다. 이는 시각-언어 기반 모델로부터 라벨을 풍부하게 하고 지식을 증류하는 전략 덕분입니다. ClassTrans [27]는 클래스 불균형 처리 덕분에 기반 클래스 mIoU에서 가장 좋은 성능을 보였습니다.
  * **2단계 (테스트 세트):** SegLand [17]가 학습기 앙상블 기법을 통해 상당한 차이로 전체 1위를 차지했습니다.

## 🧠 통찰 및 논의

* **GFSS의 중요성:** 이 연구는 GFSS 설정이 기존의 소수 학습보다 원격 탐사 분야에서 더 현실적이고 도전적임을 강조합니다. 모델이 새로운 클래스에 적응하면서도 기존 클래스에 대한 성능을 유지하는 능력은 실제 적용에 필수적입니다.
* **벤치마크의 가치:** OEM-GFSS 데이터셋과 도전 과제는 원격 탐사 분야에서 제한된 라벨 데이터 학습 문제를 해결하기 위한 연구를 장려하는 데 기여합니다.
* **모델의 강점과 약점:** 기준선 모델은 새로운 클래스에서 어려움을 겪었지만, 변환적 추론은 전반적인 성능에 긍정적인 영향을 미쳤습니다. 도전 과제 우승자들의 다양한 전략(앙상블, 클래스 유사성 활용, 기반 모델 지원, 프롬프트 학습)은 GFSS 문제 해결에 다양한 접근 방식이 유효함을 보여줍니다.
* **향후 연구 방향:** 공개된 벤치마크는 원격 탐사에서 소수 라벨 데이터 학습이라는 어려운 문제에 대한 더 많은 연구를 촉진할 것입니다. 특히 기반 모델의 활용 및 기존 지식의 효과적인 전이, 그리고 치명적인 망각 문제 해결에 대한 심도 있는 탐구가 필요합니다.

## 📌 TL;DR

이 논문은 원격 탐사에서 기반 클래스와 새로운 클래스 모두에 대한 성능 유지를 목표로 하는 **일반화된 소수 학습 의미론적 분할(GFSS)**을 위한 첫 번째 벤치마크를 제안합니다. 기존 OpenEarthMap 데이터셋을 15개 세분화된 클래스로 확장한 **OEM-GFSS 데이터셋**을 공개하고, CVPR 2024 워크숍에서 관련 도전 과제를 주최했습니다. DIaM을 기준선으로 설정하고, 도전 과제 참가자들의 다양한 방법론(앙상블, 클래스 유사성 학습, 기반 모델 활용 등)을 평가했습니다. 결과적으로, SegLand, ClassTrans, FoMA 등이 우수한 성능을 보이며 GFSS 분야의 가능성과 향후 연구 방향을 제시했습니다.
