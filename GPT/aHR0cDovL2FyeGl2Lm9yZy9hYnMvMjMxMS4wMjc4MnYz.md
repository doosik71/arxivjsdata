# Towards Generic Anomaly Detection and Understanding: Large-scale Visual-linguistic Model (GPT-4V) Takes the Lead

Yunkang Cao, Xiaohao Xu, Chen Sun, Xiaonan Huang, and Weiming Shen

## 🧩 Problem to Solve

기존의 이상 탐지(Anomaly Detection) 모델은 특정 도메인이나 데이터 양식에 맞춰 설계되는 경향이 있어 일반성이 부족합니다. 이러한 모델은 종종 저수준 특성에 집중하며, 고수준의 데이터 이해 능력이 필요한 다음과 같은 과제들을 간과합니다:

* **데이터 유형 및 카테고리 이해:** 이미지, 비디오, 포인트 클라우드, 시계열 등 다양한 데이터 유형과 그에 따른 카테고리별 정상 상태 정의.
* **정상 상태에 대한 기준 설정:** 데이터의 고수준 이해를 바탕으로 정상적인 패턴이나 행동에 대한 기준을 추론하는 능력.
* **데이터 부합성 평가:** 주어진 데이터가 설정된 정상 기준에 얼마나 부합하는지 평가하여 이상 여부를 판단하는 능력.

최근 대규모 멀티모달 모델(LMM)의 발전에도 불구하고, GPT-4V(ision)와 같은 최신 LMM이 이러한 다방면의 이상 탐지 작업을 얼마나 효과적으로 수행하고 일반적인 이상 탐지 및 이해의 리더가 될 수 있는지에 대한 탐색이 필요합니다.

## ✨ Key Contributions

* GPT-4V를 활용하여 이미지, 비디오, 포인트 클라우드, 시계열 데이터 등 **다양한 양식**과 산업, 의료, 논리, 비디오 감시, 3D 이상 탐지 및 지역화 등 **다중 도메인**에 걸친 이상 탐지 및 이해 가능성을 광범위하게 조사하고 입증했습니다.
* 클래스 정보, 인간 전문 지식, 참조 이미지와 같은 **추가적인 단서들을 프롬프트로 통합**하여 GPT-4V의 이상 탐지 성능을 향상시키는 방법을 제시했습니다.
* GPT-4V가 제로샷(zero-shot) 및 원샷(one-shot) 설정에서 전역적(global) 및 미세립(fine-grained) 의미 패턴을 효과적으로 탐지하고 설명하여, 정상과 비정상 인스턴스를 정확하게 구분할 수 있음을 입증했습니다.
* GPT-4V가 이상 탐지를 위해 **자동적으로 추론**할 수 있는 능력을 가지고 있음을 확인했습니다.
* 프롬프트의 양이 증가함에 따라 GPT-4V의 성능이 향상될 수 있음을 보여주었습니다.
* GPT-4V가 일반적인 이상 탐지 및 이해 분야에서 유망한 성능을 보여주어 이 분야에 새로운 연구 방향을 제시했습니다.

## 📎 Related Works

* **기존 이상 탐지 기술:** MVTec AD [6], MVTec-LOCO [7], MVTec 3D [8]와 같은 산업 분야 데이터셋을 활용한 이미지 및 3D 포인트 클라우드 이상 탐지 연구. 재구성 기반 [23, 35], GAN 기반 [61], 자기지도 학습 기반 [82, 88], 사전 학습 기반 [28, 60] 등 의료 이상 탐지 방법론.
* **대규모 멀티모달 모델 (LMMs):** GPT-4V [101] 외에 PaLM 2 [4], InstructBLIP [27], MiniGPT-4 [113] 등 강력한 추론 능력을 가진 LMM의 발전.
* **프롬프트 엔지니어링:** GPT-4V [101], SoM [100], SAM [50]과 같은 모델 및 프롬프트 엔지니어링 기법을 활용한 시각적 정보 처리.
* **포인트 클라우드 처리:** CPMF [16]와 같이 포인트 클라우드를 깊이 이미지로 변환하여 이미지 기반 모델을 활용하는 접근법.

## 🛠️ Methodology

이 연구는 GPT-4V(ision) 모델을 활용하여 다양한 양식과 도메인에서 이상 탐지 및 이해 능력을 평가했습니다. 핵심 접근 방식은 효과적인 프롬프트 설계와 광범위한 평가 시나리오입니다.

* **GPT-4V 활용:** OpenAI의 GPT-4V 모델을 핵심 엔진으로 사용했습니다. 현재 GPT-4V는 이미지 형식의 시각적 입력만 받습니다.
* **프롬프트 디자인:** GPT-4V의 이상 탐지 작업을 효과적으로 유도하기 위해 네 가지 유형의 프롬프트를 조합하여 사용했습니다:
  * **작업 정보 프롬프트 (Task Information Prompt):** "이미지에 이상 또는 특이점이 포함되어 있는지 확인하십시오."와 같이 명확한 작업을 제시합니다.
  * **클래스 정보 프롬프트 (Class Information Prompt):** 데이터 클래스를 명시하여 GPT-4V의 이해를 돕습니다. 예: "{CLS}와 관련된 이미지에 이상이나 결함이 있는지 확인하십시오."
  * **정상 기준 프롬프트 (Normal Standard Prompt):** 인간의 전문 지식을 바탕으로 정상 상태에 대한 구체적인 기준을 언어로 제공합니다. 예: "아침 식사 박스에는 오렌지 2개, 복숭아 1개, 시리얼, 견과류, 바나나 조각이 있어야 합니다; 과일은 도시락 왼쪽, 시리얼은 오른쪽 상단, 견과류와 바나나 조각은 오른쪽 하단에 있어야 합니다."
  * **참조 이미지 프롬프트 (Reference Image Prompt):** 언어 프롬프트와 함께 정상 참조 이미지를 제공하여 정상 기준과 입력 이미지 간의 정렬을 돕습니다. 예: "첫 번째 이미지는 정상입니다. 두 번째 이미지에 이상이나 결함이 있는지 확인하십시오."
* **평가 설정:**
  * **제로샷 (Zero-shot) 설정:** 언어 프롬프트만 제공하여 모델의 일반화 능력을 평가했습니다.
  * **원샷 (One-shot) 설정:** 하나의 정상 참조 이미지를 언어 프롬프트와 함께 제공하여 성능 향상을 평가했습니다.
* **평가 범위 (모달리티 및 도메인):**
  * **양식:** 이미지 (산업, 의료, 논리), 비디오 (보행자, 교통), 포인트 클라우드, 시계열 데이터.
  * **도메인:** 산업 검사, 의료 진단, 비디오 감시 등 다양한 실제 시나리오를 포함하여 총 15개의 다양한 데이터셋을 활용했습니다.
* **특정 양식 처리 방식:**
  * **포인트 클라우드:** CPMF [16] 방법론에 따라 포인트 클라우드를 다중 뷰 깊이 이미지로 변환한 후 GPT-4V에 입력했습니다.
  * **비디오:** 비디오 데이터셋에서 대표적인 두 개의 스틸 이미지를 선택하여 프롬프트로 사용했습니다.
  * **시계열:** 시계열 데이터를 이미지(그래프)로 플로팅하여 시각적 입력으로 GPT-4V에 전달했습니다.
  * **이상 지역화:** SoM [100]의 접근 방식을 채택하여 원본 이미지와 함께 마스크 및 번호가 매겨진 시각적 프롬프트(이미지-마스크 쌍)를 생성하여 GPT-4V에 입력했습니다. 이는 픽셀 수준 마스크 예측 작업을 마스크 수준 분류 작업으로 전환하여 복잡도를 줄였습니다.

## 📊 Results

GPT-4V는 광범위한 평가를 통해 이상 탐지 및 이해 작업에서 탁월한 잠재력을 보여주었습니다.

* **다중 양식 및 다중 도메인 이상 탐지:**
  * 이미지, 포인트 클라우드, X-ray 등 다양한 데이터 양식과 산업, 의료, 보행자, 교통, 시계열 등 여러 도메인에 걸쳐 제로샷 및 원샷 설정에서 일관되고 강력한 성능을 입증했습니다.
* **전역적 및 미세립 의미 이해:**
  * **전역적 의미:** 교통 이상 탐지에서 일반적인 교통 흐름과 불규칙한 사건을 구별하는 등 전반적인 이상 패턴을 성공적으로 인식했습니다.
  * **미세립 의미:** 산업 이미지 이상 탐지에서 촛불의 약간 기울어진 심지, 병 입구 주변의 미세한 긁힘 등 복잡한 데이터 내의 미묘한 이상을 정확하게 탐지하고 지역화했습니다.
* **자동 추론 및 설명 능력:**
  * 논리 이상 탐지에서 복잡한 정상 기준(예: 아침 식사 박스의 구성 및 배치 규칙)을 자동으로 추론하고, 이미지가 이러한 기준에서 벗어나는 이유에 대한 상세하고 해석 가능한 설명을 제공했습니다.
* **프롬프트 증가에 따른 성능 향상:**
  * 클래스 정보, 인간 전문 지식, 참조 이미지와 같은 추가적인 컨텍스트 및 정보를 프롬프트로 제공할수록 GPT-4V의 이상 탐지 정확도가 크게 향상됨을 확인했습니다. 특히, 정상 참조 이미지는 모델이 정상 기준을 더 잘 이해하는 데 기여했습니다.
* **이상 지역화:**
  * SoM [100]에서 제시된 시각적 프롬프트(이미지-마스크 쌍)의 도움을 받아 산업 및 의료 이미지에서 뒤틀린 전선이나 구멍과 같은 이상을 정확하게 식별하고 지역화하는 능력을 보여주었습니다.
* **관찰된 한계점:**
  * **복잡한 시나리오 및 미세한 이상:** 산업 애플리케이션의 매우 복잡하거나, 육안으로 식별하기 어려운 미묘한 이상(예: 끊어진 케이블), 또는 정확한 계수(예: 와셔 개수)가 필요한 경우 탐지에 어려움을 겪을 수 있습니다.
  * **의료 분야의 보수적 답변:** 의료 분야에서는 윤리적 제약으로 인해 충분한 정보가 부족할 때 보수적이고 확신 없는 답변을 제공하는 경향이 있었습니다.
  * **렌더링 아티팩트 오인:** 포인트 클라우드 이상 탐지에서 렌더링 과정에서 인위적으로 도입된 요소를 이상으로 오인하는 경우가 있었습니다.

## 🧠 Insights & Discussion

* **함의:** GPT-4V의 이상 탐지 능력은 다재다능하고 적응력이 뛰어난 AI 모델 분야에서 중요한 진전을 나타냅니다. GPT-4V는 다양한 양식과 분야에서 이상을 식별하고, 포괄적이고 미묘한 의미론적 이해를 제공하며, 이상을 추론하고 프롬프트에 반응하는 능력을 보여줍니다. 이는 기존의 저수준, 도메인/양식 특정 이상 탐지 모델이 제공하지 못했던 고수준의 이해와 추론을 가능하게 함으로써 일반적인 이상 탐지 및 이해에 새로운 지평을 열었습니다.
* **한계점:**
  * **정성적 결과의 지배:** 본 연구의 분석은 주로 정성적 평가에 의존하여 모델의 이상 탐지 성능에 대한 객관적인 정량적 지표가 부족합니다.
  * **제한적인 평가 범위:** 평가 범위가 제한된 사례 또는 시나리오에 국한되어 실제 이상 탐지 작업에서 발생하는 다양한 도전 과제를 완전히 포착하지 못할 수 있습니다.
  * **단일 상호 작용 평가:** 대부분 단일 라운드 대화에 중점을 두었으며, GPT-4V의 문맥 내 학습 능력을 더욱 자극할 수 있는 다중 라운드 상호 작용의 깊이를 충분히 탐색하지 못했습니다.
  * **실제 적용의 제약:** 매우 복잡한 산업 시나리오나 의료 분야의 윤리적 제약으로 인해 자신감 있는 답변을 제공하는 데 한계가 있으며, 미세한 세부 사항이나 계수에서 약점을 보였습니다.
* **향후 연구 및 개선 방향:**
  * **정량적 분석:** Precision, Recall, F1-score, AUC-ROC, MAP와 같은 정량적 지표를 통합하여 모델 성능을 보다 객관적으로 평가해야 합니다.
  * **평가 범위 확장:** 다양한 조명 조건, 이미지 기반 탐지에서의 가림 현상, 시계열 데이터의 다양한 이상 유형 등 실제 시나리오를 포함하여 평가 범위를 확장해야 합니다.
  * **다중 라운드 상호 작용 평가:** GPT-4V의 반복 학습 및 피드백 적응 능력을 활용하는 다중 라운드 대화를 탐색하여 성능을 향상시켜야 합니다.
  * **인간 피드백 통합:** 도메인 전문가의 피드백 루프를 활용하여 복잡하거나 미묘한 이상에 대한 GPT-4V의 이해를 정교화해야 합니다.
  * **보조 데이터 통합:** 추가 센서 판독값이나 메타데이터와 같은 보조 데이터를 통합하여 GPT-4V의 이해도와 정확도를 높이는 방안을 모색해야 합니다.
  * **전문 모델과의 비교:** GPT-4V의 특정 강점과 약점을 파악하기 위해 전문 이상 탐지 모델과의 비교 평가가 필수적입니다.
  * **실시간 성능 평가:** 실시간 이상 탐지 응용 프로그램을 위한 모델의 적합성을 보장하기 위해 GPT-4V의 실시간 성능을 평가해야 합니다.
  * **전이 학습 평가:** 특정 이상 탐지 작업을 위한 GPT-4V 미세 조정에서 전이 학습의 효과를 평가하여 모델의 적응성을 높여야 합니다.
  * **하이브리드 모델 개발:** GPT-4V의 언어적 능력과 다른 머신러닝/딥러닝 접근 방식을 결합한 하이브리드 모델 개발을 통해 이상 탐지 문제를 해결해야 합니다.

## 📌 TL;DR

이 논문은 기존 이상 탐지 모델의 도메인/양식별 한계를 극복하기 위해 GPT-4V를 활용한 **일반적인 이상 탐지 및 이해** 가능성을 탐구했습니다. 연구팀은 **클래스 정보, 인간 전문 지식, 참조 이미지** 등 다양한 프롬프트를 GPT-4V에 제공하여 **이미지, 비디오, 포인트 클라우드, 시계열** 등 여러 양식과 **산업, 의료, 논리, 비디오 감시** 등 광범위한 도메인에서 **제로샷/원샷 이상 탐지 및 지역화** 능력을 평가했습니다. 주요 결과는 GPT-4V가 **전역적 및 미세립 의미 패턴을 효과적으로 탐지하고 설명**할 수 있으며, **자동 추론 능력**을 보여주고, 프롬프트가 많아질수록 성능이 향상됨을 입증했다는 것입니다. 일부 복잡한 시나리오나 미세한 세부 사항 인식에서 한계점도 있었으나, GPT-4V는 일반적인 이상 탐지 분야에서 매우 유망한 성능과 잠재력을 제시하며 새로운 연구 방향을 열었습니다.
