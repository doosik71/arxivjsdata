# ASURVEY ON ATTENTION MECHANISMS FOR MEDICAL APPLICATIONS: ARE WE MOVING TOWARDS BETTER ALGORITHMS?

Tiago Gonçalves, Isabel Rio-Torto, Luís F. Teixeira, Jaime S. Cardoso

## 🧩 Problem to Solve

최근 딥러닝에서 어텐션 메커니즘(Attention mechanisms)과 트랜스포머(Transformers)의 인기가 높아지면서 의료 분야에도 활발히 적용되고 있습니다. 하지만 의료는 고위험(high-stake) 결정이 수반되는 분야이므로, 이러한 고성능 알고리즘이 의료 애플리케이션의 요구 사항에 실제로 부합하는지, 특히 예측 성능 향상, 모델 복잡도, 그리고 해석 가능성 측면에서 면밀히 검토해야 할 필요가 있습니다. 본 연구는 문헌에서 제시된 어텐션 메커니즘의 주장과 잠재력을 비판적으로 분석하고, 실제 의료 영상 분류 작업에서 이들의 영향을 실험적으로 평가하여 이러한 질문에 답하고자 합니다.

## ✨ Key Contributions

- **어텐션 메커니즘의 광범위한 문헌 검토:** 의료 영상 분류, 분할, 의료 보고서 이해 등 다양한 의료 애플리케이션에서 머신러닝(트랜스포머 포함) 내 어텐션 메커니즘의 활용 사례를 광범위하게 검토했습니다.
- **의료 영상 분류 실험 연구:** 세 가지 다른 사용 사례(당뇨망막병증, 피부 병변, 흉부 병리)에 대한 의료 영상 분류 실험을 수행하여, 기존 딥러닝 아키텍처에 어텐션 메커니즘을 통합하는 과정, 예측 능력 분석, 그리고 후처리 설명(post-hoc explanation) 방법을 통해 생성된 살리언시 맵(saliency map)의 시각적 평가를 진행했습니다.
- **비판적 분석:** 어텐션 메커니즘에 대해 문헌에서 제시된 주장과 잠재력에 대한 비판적 분석을 제공했습니다.
- **미래 연구 방향 제시:** 의료 애플리케이션의 미래 과제와 어텐션 메커니즘이 이러한 과제에 어떻게 기여할 수 있는지에 대한 논의를 제시했습니다.

## 📎 Related Works

- **어텐션 개념의 역사적 배경:** Koch and Ullman [1987], Itti and Koch [2000], Tsotsos et al. [1995] 등은 시각 탐색 문제 해결을 위한 선택적 시각 어텐션의 중요성을 제기했습니다.
- **초기 어텐션 모델 및 연구:** Bahdanau et al. [2015]는 RNN 기반 인코더-디코더 구조에서 어텐션 메커니즘을 도입하여 신경망 기계 번역의 성능을 향상시켰습니다. Borji and Itti [2012], Cho et al. [2015], Chaudhari et al. [2021] 등은 어텐션 메커니즘에 대한 초기 설문조사 및 분류를 제시했습니다.
- **컴퓨터 비전 분야의 어텐션:** Hu et al. [2018a]의 Squeeze-and-Excitation (SE) 블록과 Woo et al. [2018]의 Convolutional Block Attention Module (CBAM)은 채널 및 공간 어텐션의 대표적인 예시입니다.
- **트랜스포머 아키텍처:** Vaswani et al. [2017]은 오직 어텐션만을 사용하여 재귀 및 컨볼루션을 완전히 대체한 트랜스포머 아키텍처를 제안했습니다. Dosovitskiy et al. [2021]은 이를 컴퓨터 비전 분야에 적용한 Vision Transformer (ViT)를 발표했습니다.
- **의료 분야 트랜스포머 설문조사:** Shamshad et al. [2022]는 의료 영상 분석을 위한 트랜스포머 기반 아키텍처의 활용에 대한 선구적인 검토를 제공했습니다.

## 🛠️ Methodology

본 연구는 세 가지 의료 사용 사례(당뇨망막병증, 피부 병변, 흉부 삼출)에 대해 다음과 같은 실험 프로토콜을 사용했습니다.

1. **백본 모델 (Backbone Models):**
   - DenseNet-121 [Huang et al., 2017]
   - ResNet-50 [He et al., 2016]
2. **어텐션 메커니즘 통합:**
   - **Squeeze-and-Excitation (SE) 블록 [Hu et al., 2018a]:** DenseNet-121 및 ResNet-50 백본에 통합. 채널별 특징 반응을 적응적으로 재조정합니다.
   - **Convolutional Block Attention Module (CBAM) [Woo et al., 2018]:** 채널 어텐션 모듈과 공간 어텐션 모듈을 결합하여 백본에 통합.
3. **트랜스포머 기반 모델:**
   - **Data-efficient image Transformer (DeiT-Ti) [Touvron et al., 2021]:** Vision Transformer에서 영감을 받은 아키텍처로, 기존 CNN 백본과 유사한 수의 파라미터를 가집니다.
4. **데이터:** APTOS2019 (당뇨망막병증), ISIC2020 (피부 병변), MIMIC-CXR (흉부 삼출)의 세 가지 의료 영상 분류 데이터셋을 사용했습니다. 각 데이터셋의 1%, 10%, 50%, 100% 훈련 데이터를 사용하여 저데이터 환경에서의 성능도 평가했습니다.
5. **후처리 해석 가능성 (Post-model Interpretability):**
   - DeepLIFT [Shrikumar et al., 2017] 및 Layer-wise Relevance Propagation (LRP) [Bach et al., 2015] 방법을 사용하여 예측에 가장 크게 기여한 영상 영역을 시각화하는 살리언시 맵(saliency maps)을 생성했습니다. DeiT의 경우 LRP 어트리뷰션을 생성하는 Chefer et al. [2021]의 프레임워크를 사용했습니다.
6. **데이터 전처리 및 증강:**
   - 모든 이미지를 $224 \times 224$로 크기 조정하고, 각 RGB 채널에 Z-정규화를 적용했습니다.
   - 임의 회전, 임의 이동, 임의 스케일링, 임의 수평 뒤집기 등의 아핀 변환(affine transformations)을 통해 데이터 증강을 수행했습니다.
7. **훈련:**
   - 교차 엔트로피(Cross-entropy) 손실 함수, Adam 옵티마이저, 학습률 $1 \times 10^{-6}$, 300 에포크, 배치 크기 $[2, 32]$를 사용했습니다. 불균형 데이터셋에는 클래스 가중치를 적용했습니다.

## 📊 Results

- **예측 성능:**
  - 어텐션 메커니즘을 통합한 모델은 백본 모델 대비 예측 성능(정확도)이 항상 향상되는 것은 아니며, 오히려 저하되는 경향도 보였습니다.
  - 트랜스포머 기반 아키텍처(DeiT)도 백본 모델과 유사한 성능을 달성했으며, 저데이터 환경에서 어텐션의 명확한 이점은 발견되지 않았습니다.
- **모델 복잡도:**
  - SE 및 CBAM 어텐션 블록을 통합하면 백본 모델의 파라미터 수가 증가하여 모델 복잡도가 증가했습니다.
  - DeiT는 DenseNet-121과 비슷한 파라미터 수를 가졌으나, ResNet-50 및 어텐션이 추가된 ResNet-50 모델보다는 적었습니다.
- **후처리 해석 가능성:**
  - 생성된 살리언시 맵은 종종 노이즈가 많고, 어텐션 메커니즘의 유무에 따른 시각적 명확성이나 특정 영역 집중도에서 일관된 개선을 보이지 않았습니다.
  - 모델 백본에 따라 살리언시 맵의 양상이 크게 달라졌으며, ResNet 기반 모델이 DenseNet 기반 모델보다 시각적으로 덜 노이즈한 결과를 보였습니다.
  - DeiT의 LRP 살리언시 맵은 일부 경우에서 상대적으로 명확한 영역을 강조하는 것으로 나타났으나, 전반적인 해석에는 여전히 높은 주관성이 존재했습니다.

## 🧠 Insights & Discussion

- **예측 성능에 대한 비판적 관점:** 어텐션 메커니즘이 딥러닝 알고리즘의 예측 성능을 자동으로 개선한다는 기존의 주장은 본 연구의 실험 결과와 상충됩니다. 어텐션은 항상 이점을 가져오지 않으며, 문헌에 보고된 미미한 성능 향상에 대해서는 더 강력한 통계적 검증이 필요합니다.
- **모델 복잡도의 증가:** 컴퓨터 비전 분야에서 어텐션 메커니즘의 통합은 모델의 파라미터 수를 증가시키며, 이는 모델 복잡도가 감소한다는 일반적인 인식과 다릅니다. 어텐션의 이점이 단순히 파라미터 증가로 인한 것인지, 아니면 어텐션 메커니즘 자체의 본질적인 기능 때문인지에 대한 의문을 제기합니다.
- **해석 가능성의 주관성:** 살리언시 맵을 통한 해석 가능성 평가는 여전히 매우 주관적입니다. 어텐션 메커니즘이 "가장 관련성 높은 특징"을 학습한다는 주장을 살리언시 맵만으로 완전히 신뢰하기 어렵습니다. 의료와 같은 고위험 분야에서는 이러한 해석 맵의 의미와 품질에 대한 객관적인 기준과 임상 커뮤니티의 검증이 시급합니다.
- **미래 과제:** 어텐션 기반 모델, 특히 트랜스포머의 인기는 계속될 것이지만, 이들이 알고리즘의 투명성과 해석 가능성을 실제로 향상시키는지는 불분명합니다. 내재적으로 해석 가능한(intrinsically interpretable) 어텐션 기반 아키텍처를 설계하고, 학습된 특징의 품질을 객관적으로 평가할 수 있는 기술 개발이 필요합니다.

## 📌 TL;DR

본 논문은 딥러닝의 어텐션 메커니즘(트랜스포머 포함)이 의료 애플리케이션에 적합한지 비판적으로 평가합니다. 기존 CNN 백본(DenseNet-121, ResNet-50)에 SE 및 CBAM 어텐션 블록을 추가한 모델과 Vision Transformer (DeiT-Ti)를 세 가지 의료 영상 분류 작업에 적용하여 예측 성능, 모델 복잡도, 그리고 후처리 살리언시 맵 기반의 해석 가능성을 분석했습니다. 결과적으로 어텐션 메커니즘은 예측 성능을 일관되게 향상시키지 않으며, 모델 복잡도를 증가시키는 경향이 있습니다. 또한, 살리언시 맵을 통한 해석 가능성 평가는 여전히 주관적이고 노이즈가 많아, 어텐션이 의료 딥러닝의 투명성과 해석 가능성을 자동으로 높인다는 일반적인 주장에 대한 회의적인 시각을 제시합니다. 이는 의료 분야에서 더 객관적이고 임상적으로 유효한 해석 가능성 평가 방법 개발의 필요성을 강조합니다.
