# Hardware Implementation of Deep Network Accelerators Towards Healthcare and Biomedical Applications

Mostafa Rahimi Azghadi, Corey Lammie, Jason K. Eshraghian, Melika Payvand, Elisa Donati, Bernab ́e Linares-Barranco, and Giacomo Indiveri

## 🧩 Problem to Solve

딥러닝(DL)은 의료 및 헬스케어 분야(모니터링, 진단, 치료 등)에서 중요한 역할을 하고 있으나, 현재 주로 사용되는 고성능 컴퓨팅 플랫폼(GPU, 클라우드)은 비용, 전력 소비, 데이터 프라이버시 문제 등으로 인해 의료 IoT 및 PoC(Point-of-Care) 장치와 같은 엣지 환경에 효율적으로 적용하기 어렵습니다. 무어의 법칙(Moore's Law)이 둔화되는 반면, DL의 연산 수요는 기하급수적으로 증가하여 하드웨어 병목 현상이 심화되고 있으며, 이는 특히 전력 효율과 비용이 중요한 엣지 의료기기 분야에서 혁신적인 하드웨어 가속기 개발의 필요성을 제기합니다.

## ✨ Key Contributions

- 의료 애플리케이션에 초점을 맞춰 DL 가속화를 위한 3가지 최신 및 기존 하드웨어 기술(CMOS, 멤리스터, FPGA)의 활용을 최초로 논의합니다.
- FPGA에 생체 의료 작업을 구현하거나 멤리스터 크로스바(crossbar)에서 시뮬레이션하는 방법에 대한 튜토리얼을 제공합니다.
- 이벤트 기반 뉴로모픽 프로세서가 생체 의료 신호 처리를 위한 DL 가속기를 어떻게 보완할 수 있는지 최초로 설명합니다.
- 제시된 연구 결과의 재현을 가능하게 하는 오픈소스 코드와 데이터를 제공합니다.

## 📎 Related Works

- **일반 DL 가속기**: Nvidia GPU, Google TPU.
- **전용 임베디드 가속기**: Nvidia Jetson/Xavier, Movidius Neural Compute Stick, Nvidia Clara Embedded.
- **CMOS 칩**: Cambricon-x, Eyeriss, Origami, ConvNet 프로세서, Envision, Neural 프로세서, LNPU, DNPU, Thinker, UNPU, Google Edge TPU, Intel Nervana NNP-I, Huawei Ascend 310 등 다양한 엣지 AI 칩이 의료 영상 및 시퀀스 데이터 처리에 적합하게 개발되었습니다.
- **FPGA 기반 가속기**: ECG 이상 감지, 질량 분석 기반 암 진단, BCI(Brain-Computer Interface), EEG(뇌전도) 처리 등에서 활용되었습니다.
- **멤리스터 기반 DNN(MDNN)**: 심장 부정맥 분류, 유방암 진단 등 소규모 생체 의료 작업에서 시뮬레이션 및 일부 물리적 구현이 시도되었습니다.
- **스파이킹 뉴로모픽 프로세서**: DYNAP-SE, SpiNNaker, TrueNorth, Loihi, ODIN/MorphIC 등이 EMG(근전도), ECG(심전도), HFO(고주파 진동), EEG, LFP(국소장 전위) 신호 처리와 같은 생체 의료 애플리케이션에 활용되었습니다.

## 🛠️ Methodology

- **하드웨어 기술 분석**: CMOS, 멤리스터, FPGA 기술을 활용하여 헬스케어 분야에서 효율적인 딥 네트워크 가속기를 개발하는 방법을 설명했습니다.
- **뉴로모픽 보완성 탐구**: 스파이킹 뉴로모픽 프로세서가 DL 가속기를 보완하여 생체 의료 신호 처리에 어떻게 활용될 수 있는지 탐구했습니다.
- **벤치마크 태스크**: EMG(근전도) 신호와 DVS(Dynamic Vision Sensor) 또는 APS(Active Pixel Sensor) 시각 입력을 결합한 손 제스처 분류 작업을 벤치마크로 사용했습니다.
- **FPGA 구현**:
  - OpenCL을 사용하는 OpenVINO Toolkit FPGA 플랫폼에서 고정 소수점(fixed-point) 파라미터 표현을 사용했습니다.
  - PyTorch로 훈련된 모델은 Caffe의 `.prototxt` 및 `.caffemodel` 파일로 변환되었습니다.
  - 모든 가중치와 바이어스는 MATLAB의 Fixed-point 툴박스를 사용하여 고정 소수점 형태로 변환되었고, PipeCNN을 통해 필요한 RTL 라이브러리 생성 및 호스트 실행 파일과 FPGA 비트스트림 컴파일이 이루어졌습니다.
- **멤리스터 DNN(MDNN) 시뮬레이션**:
  - 오픈소스 시뮬레이션 플랫폼인 MemTorch를 사용하여 사전 훈련된 DNN(PyTorch)을 MDNN으로 변환했습니다.
  - 컨볼루션 연산은 "언롤링(unrolling)" 기법을 사용하여 MAC(Multiply-Accumulate) 연산으로 변환되었습니다.
  - 1T1R(1-Transistor-1-Resistor) 크로스바와 이중 컬럼 방식을 사용하여 부호 있는 가중치를 표현했습니다.
  - 실험적으로 관찰된 멤리스터의 비이상성(예: 유한한 컨덕턴스 상태, R_ON 및 R_OFF 분포의 소자 간 가변성)을 VTEAM 모델과 Pt/Hf/Ti RRAM 파라미터를 사용하여 시뮬레이션에 반영했습니다.
  - 모델 튜닝은 선형 회귀(linear regression)를 통해 수행했습니다.
- **평가 지표**: 분류 정확도(Accuracy), 에너지 소비(Energy), 추론 시간(Inference time), 에너지-지연 곱(Energy-Delay Product, EDP)을 비교했습니다.

## 📊 Results

- **CMOS DNN 가속기**: Table II에 제시된 많은 엣지 AI CMOS 칩들은 수백 mW의 전력 소비와 수 Giga-operation/second (GOP/s)의 연산 능력을 보여, 다양한 의료 영상 및 시퀀스 데이터 처리 작업에 적합함을 입증했습니다.
- **멤리스터 DNN (MDNN) 시뮬레이션**: 시뮬레이션 결과, 멤리스터의 소자 간 가변성($\sigma$)이 증가할수록 MDNN의 성능 저하가 확인되었습니다 (Fig. 8). 하지만 이상적인 MDNN 시뮬레이션은 GPU 및 FPGA 대비 에너지와 추론 시간에서 _수십에서 수백 배의_ 현저한 개선을 보였지만, 이는 특정 네트워크 아키텍처에 최적화된 결과이며, ADC(Analog-to-Digital Converter) 오버헤드와 멤리스터의 제한된 내구성(endurance) 등 해결해야 할 과제가 있습니다.
- **FPGA 성능**: FPGA는 맞춤형 DNN 구현을 통해 CPU 대비 215배, GPU 대비 8배 높은 전력 효율(EEG 처리의 경우)과 낮은 지연 시간을 보여주었습니다. 이는 맞춤형 설계 기법을 통해 달성 가능합니다.
- **벤치마크 비교 (Table V)**:
  - **정확도**: EMG와 DVS (스파이킹) 또는 EMG와 APS (비-스파이킹) 데이터 퓨전 시 가장 높은 정확도를 보였습니다. 특히 Loihi (스파이킹 CNN)는 96.0%의 정확도를 달성하여 임베디드 GPU (95.4% CNN), FPGA (94.8% CNN), 멤리스터 (94.8% CNN)를 능가했습니다.
  - **에너지/추론 시간/EDP**: 멤리스터 구현은 GPU/FPGA 대비 에너지 (예: CNN 퓨전에서 4.90 $\mu$J vs 32.1 mJ) 및 추론 시간 (1.2 $\mu$s vs 6.9 ms)에서 _수십에서 수백 배의_ 현저한 개선을 보이며, EDP 또한 훨씬 낮았습니다. 스파이킹 하드웨어 (Loihi, ODIN+MorphIC) 역시 GPU/FPGA 대비 약 두 자릿수 높은 EDP 개선을 나타냈습니다.
  - **단일 센서 (EMG-only)**: EMG 신호만으로는 분류 정확도가 약 10% 감소했는데, 이는 스파이킹 학습 알고리즘의 미성숙 또는 아역치(subthreshold) 신호 정보 손실 때문일 수 있습니다.
  - **센서 퓨전의 이점**: DVS(스파이킹 시각)와 EMG(스파이킹) 데이터의 퓨전은 SNN에서 긍정적인 성능 향상을 보인 반면, 비-스파이킹의 불일치 데이터 표현 (EMG+APS)은 DNN에서 미미하거나 심지어 성능 저하를 야기했습니다. 이는 다양한 센서 메커니즘에서 일관된 데이터 표현(예: 모두 스파이크 형태)이 뉴럴 네트워크에 더 유익할 수 있음을 시사합니다.

## 🧠 Insights & Discussion

- **CMOS 기술의 지배력**: 현재 헬스케어 분야의 DL 추론 엔진은 편리성, 성숙한 소프트웨어 플랫폼(TensorFlow, PyTorch), 강력한 커뮤니티 지원 덕분에 CMOS(GPU, ASIC 포함)가 지배적입니다.
- **엣지 DL의 도전 과제**: 전력/자원 제약, 훈련 데이터 분포를 넘어선 일반화 능력, 데이터셋 편향, AI 알고리즘 책임 문제, 의료인과 DL 간의 워크플로우 통합 부족 등이 주요 과제입니다.
- **뉴로모픽 프로세서의 잠재력**: SNN 기반 뉴로모픽 프로세서는 전력 효율성(EDP)을 수십에서 수백 배 향상시키고 실시간 처리가 가능하여 "상시 작동(always-on)" 모니터링이 필요한 웨어러블 기기 및 엣지 의료 시스템에 이상적입니다.
- **MDNN의 한계**: 멤리스터는 MAC 병렬화 및 인메모리 컴퓨팅에서 상당한 이점을 제공함에도 불구하고, 생체 의료 분야에서의 MDNN 활용은 미미하며 대부분 시뮬레이션 단계에 머물러 있습니다. 제한된 내구성, 불일치(mismatch), 아날로그 노이즈 축적 등 소자 자체의 비이상성을 극복하기 위한 재료, 회로, 시스템 설계 분야의 추가 연구가 필요합니다.
- **FPGA의 장점**: FPGA는 ASIC 대비 개발 시간이 짧고, GPU 대비 전력 소비가 낮습니다. 맞춤형 DNN 구성요소(예: MAC 병렬화, 효율적인 순환 상태 업데이트) 구현을 통해 상당한 에너지 효율성(GPU 대비 DL 가속에서 10배 이상)을 제공하며, 휴대용 저비용 PoC 장치 및 헬스케어 IoT에 유용합니다.
- **환자별 모델 튜닝**: 환자 간 고유한 생체 신호의 가변성 때문에 필수적입니다. 전이 학습(transfer learning)을 통해 일반 모델을 환자별 데이터에 맞게 튜닝할 수 있으며, 이는 온라인(온칩) 또는 오프라인(오프칩)으로 수행될 수 있습니다. 온라인 튜닝은 데이터 버퍼링이 필요하고, 오프라인 튜닝은 민감한 환자 데이터의 원격 저장 및 처리 시 프라이버시 문제를 야기할 수 있습니다.
- **데이터 표현 일관성의 중요성**: 다양한 감각 메커니즘에서 생성된 데이터가 일관된 표현(예: 모두 스파이크 형태)을 가질 때 뉴럴 네트워크가 더 큰 이점을 얻을 수 있다는 가설을 제시하며, 이는 모든 생물학적 해석이 단계적(graded) 또는 스파이킹 활동 전위로 표현되는 생물학적 원리와도 일치합니다.

## 📌 TL;DR

**문제**: 딥러닝(DL)의 높은 연산 수요는 의료 IoT 및 PoC(Point-of-Care) 장치와 같은 엣지 헬스케어 환경에서 DL의 효율적이고 광범위한 배포를 저해합니다.

**방법**: 이 논문은 헬스케어 분야에서 딥 뉴럴 네트워크(DNN)를 가속화하기 위한 세 가지 하드웨어 기술(CMOS, FPGA, 멤리스터)을 탐구합니다. 또한, 저전력 보완 솔루션으로 스파이킹 뉴럴 네트워크(SNN)와 뉴로모픽 프로세서를 조사합니다. EMG 및 시각 데이터를 사용한 손 제스처 분류 작업을 통해 이러한 플랫폼들의 성능을 벤치마킹했습니다.

**주요 발견**: CMOS 가속기는 성숙했지만 전력 소비가 높습니다. FPGA는 유연성, 낮은 전력, 특정 작업에 대한 맞춤화 능력 사이에서 균형을 제공합니다. 멤리스터 기반 DNN은 시뮬레이션에서 _수십에서 수백 배_ 우수한 에너지 효율성과 추론 시간을 보이지만, 소자 비이상성과 내구성 문제에 직면해 있습니다. 스파이킹 뉴로모픽 프로세서는 상시 작동 모니터링을 위한 상당한 전력 효율(EDP)을 입증했으며, 단일 양식 작업에서 정확도 저하가 있을 수 있음에도 불구하고, 다양한 센서에서 일관된 스파이크 기반 데이터 표현이 이점을 제공함을 보여주었습니다.
