# 의료 분야에서 딥러닝 방법을 사용한 시계열 예측

MOHAMMAD AMIN MORID, OLIVIA R. LIU SHENG, JOSEPH DUNBAR

---

## 🧩 해결할 문제

기존 기계 학습(ML) 방법은 의료 예측 분석에 적용될 때 고유한 문제에 직면합니다.

- **고차원 데이터**: 의료 데이터의 고차원적 특성으로 인해 새로운 작업마다 적절한 특징 세트를 선택하는 데 많은 노동력과 시간이 소요됩니다.
- **시간적 패턴 활용 부족**: ML 방법은 환자 데이터의 순차적 특성을 포착하기 위해 특징 공학(feature engineering)에 크게 의존하지만, 의료 사건의 시간적 패턴과 종속성을 적절히 활용하지 못하는 경우가 많습니다.

이 논문은 이러한 고차원 및 시간적 문제를 해결하여 다양한 의료 예측 작업에서 유망한 성능을 보이는 딥러닝(DL) 방법을 체계적으로 검토하고, DL의 발전 방향, 핵심 연구 격차, 그리고 미래 연구 기회를 식별하고자 합니다.

## ✨ 주요 기여

이 연구는 의료 분야에서 환자의 정형 시계열 데이터를 활용하는 딥러닝 예측 모델에 대한 체계적인 문헌 검토를 수행했으며, 다음 10가지 주요 연구 흐름과 기술적 특성에 따라 기여 내용을 분류했습니다.

1. **DL 모델**: 시계열 예측에 사용되는 딥러닝 모델 아키텍처 (주로 RNN 및 그 변형).
2. **결측값 처리**: 환자 데이터의 결측값을 다루는 방법.
3. **시간적 불규칙성 처리**: 방문 간격 및 특징 발생의 불규칙성을 처리하는 방법.
4. **환자 표현**: 환자 데이터를 딥러닝 모델 입력에 적합하게 표현하는 방법 (순차 또는 행렬).
5. **정적 데이터 포함**: 인구 통계학적 정보와 같은 정적 데이터를 모델에 통합하는 방법.
6. **어텐션 메커니즘**: 예측 과정에서 중요도에 따라 다른 가중치를 부여하는 방법.
7. **해석 가능성**: 딥러닝 모델의 예측 결과를 의료 전문가가 이해할 수 있도록 해석하는 전략.
8. **의료 온톨로지 통합**: 의료 도메인 지식을 딥러닝 모델에 통합하는 방법.
9. **학습 전략**: 비용 민감 학습, 다중 작업 학습, 전이 학습과 같은 고급 학습 기법.
10. **확장성**: 모델이 다양한 데이터셋 및 대규모 데이터에 얼마나 잘 일반화되고 확장되는지.

또한, 각 연구 흐름 내에서 주요 연구 통찰력을 요약하고, 비판적인 연구 격차를 식별하며, 미래 연구 기회를 제안했습니다.

## 📎 관련 연구

- **기존 ML의 한계**: 의료 데이터의 고차원성, 노동 집약적인 특징 선택, 시간적 순차성을 적절히 활용하지 못하는 점.
- **DL의 부상**: 고차원 원시/최소 가공 의료 데이터에서 의료 개념 및 환자 임상 데이터의 유용한 표현과 비선형 상호작용을 학습하는 능력으로 인해 주목받음.
- **선행 검토 연구**:
  - Pandey & Janghel (2019), Xiao et al. (2018): 의료 분야 DL 모델 및 적용 과제에 대한 광범위한 설명.
  - Yazhini & Loganathan (2019), Srivastava et al. (2017), Shamshirband et al. (2021): DL 모델의 다양한 적용 사례 요약.
  - Shickel et al. (2018): EHR 데이터 관련 연구에 초점을 맞춰 정보 추출, 표현 학습, 결과 예측, 계산적 표현형, 임상 데이터 비식별화 등 5가지 범주로 분류.
  - Si et al. (2021): EHR 표현 학습에 초점을 맞춰 입력 데이터, 전처리, 환자 표현, 학습 접근 방식 및 평가 속성 측면에서 연구 조사.
- **본 연구의 차별점**: 위 선행 연구들이 DL의 광범위한 적용 분야를 다루는 것과 달리, 본 연구는 **환자의 정형 시계열 데이터**를 활용한 DL 예측 모델에 초점을 맞추고, 불완전성, 다중 모드, 불규칙성, 방문 표현, 어텐션 메커니즘, 의료 도메인 지식 통합, 결과 해석, 확장성 등 **기술적 특성**에 대한 심층적인 분석을 제공하는 최초의 검토 연구입니다.

## 🛠️ 방법론

이 체계적인 문헌 검토의 주요 목표는 딥러닝 접근 방식을 사용하여 의료 분야에서 정형 시계열 예측에 대한 연구 결과를 추출하고 정리하며, 관련 미래 연구 기회를 식별하는 것입니다.

- **문헌 검색**:
  - **데이터베이스**: MEDLINE, IEEE, Scopus, ACM 디지털 라이브러리.
  - **검색 기간**: 2021년 2월 7일까지 발행된 논문 (2020년 논문을 포함하기 위해 2021년 11월 4일 재검색).
  - **가이드라인**: PRISMA 가이드라인 [34]을 따름.
- **포함 및 제외 기준**:
  - **포함**: 영어, 원본 연구, 동료 검토 저널 및 학회 논문, **딥러닝 방법**을 사용하여 **정형 환자 시계열 데이터**를 **의료 예측 작업**에 활용하는 연구 (주로 Shickel et al. (2018) [27]의 '결과 예측' 범주).
  - **제외**: 포스터, 사전 인쇄물(preprints), 비정형 데이터(이미지, 임상 노트 등) 기반 연구, 핵심 연구 특성(Table 1 참조)에 대한 주요 정보가 부족한 연구.
- **데이터 추출**: 각 연구에서 다음 10가지 핵심 특성에 중점을 두어 정보 추출:
  1. **Medical Task** (의료 과제)
  2. **Database** (데이터베이스)
  3. **Input Demographic/Vital Sign/Lab Test/Procedure Codes/Diagnosis Codes/Medication Codes/Others** (입력 특징)
  4. **Preprocessing** (전처리)
  5. **Patient Representation** (환자 표현)
  6. **DL Architecture** (DL 아키텍처)
  7. **Output Temporality** (출력 시간성)
  8. **Performance** (성능)
  9. **Benchmark** (벤치마크)
  10. **Interpretation** (해석)
- **데이터 분석**: 포함된 연구의 기술적 기여를 10가지 범주(환자 표현, 결측값 처리, DL 모델, 시간적 불규칙성 처리, 어텐션 메커니즘, 의료 온톨로지 통합, 정적 데이터 포함, 학습 전략, 해석, 확장성)로 분류하고, 각 범주별로 딥 환자 시계열 학습 접근 방식을 요약하며, 주요 접근 방식의 장단점을 비교하고 연구 격차를 식별했습니다.

## 📊 결과

- **최종 포함 연구**: 초기 1,524개 연구 중 중복 제거, 제목/초록 및 전문 검토를 거쳐 최종 77개 연구가 선정되었습니다.
- **출판 경향**: 대부분의 연구(77%)가 2018년 이후에 출판되어 의료 예측에 딥러닝 모델 적용에 대한 최근 연구 관심 증가를 보여줍니다.
- **주요 예측 작업**: 사망률, 심부전, 재입원, 다음 방문 진단 예측이 가장 많이 연구된 작업이었습니다.
- **주요 데이터 소스**: 공개적으로 사용 가능한 MIMIC (Medical Information Mart for Intensive Care) 데이터셋이 가장 인기 있는 데이터 소스였습니다.

- **핵심 연구 흐름별 주요 결과 요약**:
  - **환자 표현**:
    - 순차(sequence) 표현(57%)과 행렬(matrix) 표현이 사용됨.
    - 수치 입력(검사, 활력 징후)에는 순차 표현이, 범주형 입력(진단, 처치 코드)에는 행렬 표현이 주로 사용됨.
    - 의료 이벤트를 임베딩하기 위해 임베딩 레이어 학습, `word2vec` [101] 및 Skip-Gram [102]과 같은 사전 학습된 기법, 의료 코드 그룹핑 등이 활용됨.
    - EHR 데이터의 경우 사전 학습된 임베딩 레이어가 더 나은 성능을 보였고, AC 데이터의 경우 행렬 표현이 순차 표현보다 일반적으로 우수했습니다.
  - **결측값 처리**:
    - 0, 중앙값, 전후방 채우기(forward-backward imputation) 및 도메인 지식을 활용한 채우기 방식이 흔함.
    - 마스킹 벡터를 사용하거나 (Lipton et al., 2016 [74]) 결측 패턴을 직접 학습하는 방식 (Che et al., 2018 [36])이 더 효과적인 것으로 나타남 (약 $2\%$ $AUC$ 향상).
  - **딥러닝 모델**:
    - **RNN 기반 모델 (LSTM, GRU)** 및 그 양방향 변형 (Bi-LSTM, Bi-GRU)이 가장 많이 사용됨 (84%).
    - GRU는 일부 작업에서 LSTM보다 약 $1\%$ $AUC$ 이점을 보였으나, 다른 작업에서는 유의미한 차이가 없었습니다. GRU는 복잡성이 낮고 실행 시간이 빠릅니다.
    - **양방향 RNN**은 단방향 RNN보다 일관되게 우수한 성능을 보였습니다.
    - 단일 계층 RNN이 대부분(63%)이었으나, 다중 계층 RNN도 사용되었으며, 특징별 RNN 계층(channel-like architectures)이 더 성공적인 것으로 보고됨.
    - **목표 복제(target replication)**를 통해 여러 시간 단계에서 예측을 수행하는 것이 마지막 시간 단계에서만 예측하는 것보다 효과적일 수 있음이 입증됨.
    - **CNN**은 초기 연구에서 사용되었으나 RNN에 의해 성능이 능가되었고, 최근에는 RNN과 결합된 하이브리드 형태로 지역적 패턴을 포착하는 데 활용됩니다.
  - **시간적 불규칙성 처리**:
    - **방문 불규칙성**: 방문 간 시간 간격을 별도 입력으로 사용하거나, LSTM 내부 메커니즘을 수정하여 최근 방문에 높은 가중치를 부여.
    - **특징 불규칙성**: GRU 메모리 셀 학습 과정을 수정하여 각 입력 특징에 대한 고유한 감쇠(decay) 패턴을 추출.
  - **어텐션 메커니즘**:
    - **위치 기반(location-based) 어텐션**이 가장 흔하게 사용되며, 일반적으로 예측 성능 향상보다는 **모델 해석 가능성**을 높이는 데 중점을 둠.
    - 일부 연구에서는 예측 성능 향상을 보고 (예: 다음 방문 진단에서 $4\%$ $AUC$ 향상, 재입원 $F1-Score$ $2.4\%$ 향상, 사망률 $F1-Score$ $13\%$ 향상).
  - **의료 온톨로지 통합**:
    - **의료 온톨로지 트리 (CCS)** 및 **지식 그래프 (KnowLife)**를 순환 신경망의 임베딩 계층에 통합하여 심부전 예측 등에서 추상적인 의료 개념 표현을 강화하고 희귀 질환을 다루는 데 도움을 줌.
  - **정적 데이터 포함**:
    - 환자 인구 통계 및 과거 이력과 같은 정적 특징을 통합하는 4가지 접근 방식: 최종 완전 연결 계층에 추가, 독립적인 피드포워드 신경망 훈련, 모든 시간 지점에 반복 입력, 순환 신경망 내부 프로세스 수정.
  - **학습 전략**:
    - **비용 민감 학습**: 불균형 데이터셋에 대해 손실 함수를 수정하여 소수 클래스 오분류에 대한 페널티 증가 (신생아 뇌병증 예측 $AUC$ $3.7\%$ 증가, 재입원 $AUC$ $4\%$ 증가).
    - **다중 작업 학습**: 사망률, 입원 기간, 표현형을 공동으로 예측하여 기존 단일 작업 학습보다 유의미한 성능 향상 (약 $AUC$ $2\%$ 증가).
    - **전이 학습**: 가장 적게 연구되었으나 (단 1개 연구 [43]), 작업 및 도메인 적응 모두에서 효과가 입증됨.
  - **해석 가능성**:
    - 주로 어텐션 메커니즘의 가중치 매개변수를 통해 특정 방문 및 의료 코드가 예측에 미치는 영향을 시각화하는 방식이 사용됨 (개별 환자 수준).
    - DeepLIFT [105] 및 Shapley [106] 값을 사용하여 특징 중요도를 식별하는 방법도 활용됨.
  - **확장성**:
    - 일부 연구는 잘 알려진 딥 시계열 예측 모델의 대규모 병원 EHR 데이터셋 및 고차원 데이터에 대한 확장성을 확인했습니다.
    - 그러나 EHR 데이터에 효과적인 모델이 AC 데이터에는 효과적이지 않을 수 있다는 점이 지적됨.
    - 딥러닝 모델이 앙상블된 전통적인 지도 학습 모델과 유사한 성능을 보이는 경우가 많다는 결과도 나옴.

## 🧠 통찰력 및 논의

이 연구는 의료 분야 딥 시계열 예측의 다양한 기술적 측면을 심층적으로 분석하며 여러 중요한 통찰과 함께 연구 격차를 제시합니다.

- **환자 표현**:
  - 순차 및 행렬 표현 간의 일관된 비교가 부족하며, 데이터 희소성을 고려할 때 거친 시간 단위 추상화가 더 효과적일 수 있습니다.
  - 수치 및 범주형 입력을 결합하는 데 있어 수치 값을 '결측', '낮음', '정상', '높음', '비정상'과 같은 범주형으로 인코딩하는 방식이 가장 일반적이고 효과적입니다.
  - EHR 데이터에는 사전 학습된 임베딩(예: `word2vec`)이, AC 데이터에는 행렬 표현이 더 효과적입니다.
  - **연구 격차**: EHR 데이터에 대한 순차 및 행렬 방식의 광범위한 비교, 다양한 표현 방식이 환자 유사성 측정에 미치는 영향 분석, 수치 및 범주형 측정을 시너지 효과적으로 결합하는 방법 연구가 필요합니다.
- **결측값 처리**:
  - 의료 데이터의 결측값은 종종 정보성이 있으며, 이를 마스킹 벡터로 표현하거나 결측 패턴을 직접 학습하는 방법이 효과적입니다. 마스킹 벡터가 현재로서는 가장 권장되는 전략입니다.
  - **연구 격차**: 개별 특징의 결측이 예측 과정에 미치는 차등적 영향 평가, 도메인 전문가와 함께 각 특징 및 유형에 대한 결측의 잠재적 원인에 대한 포괄적인 분석이 요구됩니다.
- **딥러닝 모델**:
  - **RNN 기반 모델 (특히 GRU와 LSTM 및 이들의 양방향 변형)**은 순차적 데이터 특성을 효과적으로 학습하여 지배적인 아키텍처입니다. GRU는 복잡성이 낮아 선호될 수 있습니다.
  - **하이브리드 CNN/RNN 모델**은 CNN이 지역적 패턴을, RNN이 전역적 패턴을 포착하여 성능 향상에 유망합니다.
  - **특징별 RNN 계층(channel-wise learning)**과 **목표 복제(target replication)**는 특정 상황에서 유효한 성능 향상을 가져옵니다.
  - **연구 격차**: 희귀/흔한 질병, 만성/비만성 질환, 입원/외래 방문 등 다양한 의료 환경에서 최첨단 모델 간의 체계적인 비교, 다중 계층 RNN의 효과 명확화, AC 데이터에 대한 모델 일반화 가능성, 채널별 학습의 패턴 해석, 전문가 지식 통합, 의약품 투여량 및 빈도 예측과 같은 보다 현실적인 목표 설정이 필요합니다.
- **시간적 불규칙성 처리**:
  - 방문 불규칙성 처리를 위한 가장 일반적인 방법은 방문 간 시간 간격을 독립 변수로 사용하는 것입니다.
  - **연구 격차**: 방문 또는 특징 불규칙성을 다룰 때 순환 네트워크의 메모리 메커니즘을 조정하는 방법론에 대한 추가 벤치마킹 실험을 통해 주장이 견고하게 뒷받침되어야 합니다.
- **어텐션 메커니즘**:
  - 주로 **모델의 해석 가능성**을 높이는 데 사용되며, 위치 기반 어텐션이 가장 흔합니다.
  - **연구 격차**: 어텐션 메커니즘이 예측 성능에 미치는 차등적 효과에 대한 평가, 방문 수준 및 의료 코드 수준 어텐션의 개별 기여도 보고, 다양한 어텐션 메커니즘 간의 성능 및 해석 가능성 비교가 필요합니다.
- **의료 온톨로지 통합**:
  - 희귀 질환에 대한 데이터 부족을 보완하기 위해 의료 온톨로지 트리와 지식 그래프가 임베딩 계층에 활용됩니다.
  - **연구 격차**: 다양한 예측 작업 및 사례 연구를 위한 혁신적인 온톨로지 통합 아키텍처 확장이 필요합니다.
- **정적 데이터 포함**:
  - 정적 환자 데이터를 통합하는 네 가지 접근 방식이 있으나, 이들이 예측 성능에 미치는 차등적 영향에 대한 연구가 부족합니다.
  - **연구 격차**: 네 가지 접근 방식에 대한 의미 있는 벤치마킹 비교, 환자의 하위 집단별 모델 공정성 및 정확성 균형을 맞추기 위한 정적 특징 성능 사후 분석이 중요합니다.
- **학습 전략**:
  - **비용 민감 학습**: 불균형 데이터셋에 필수적이며, 오버샘플링/언더샘플링과 같은 전통적 ML 기법과의 병행 연구와 정확한 비용 절감 효과 계산이 필요합니다.
  - **다중 작업 학습**: 성능 향상을 보고하지만, 어떤 네트워크 계층이나 구성요소가 다른 작업 간에 공유되어야 하는지에 대한 명확한 이해가 부족합니다.
  - **전이 학습**: 가장 적게 연구되었으나, 데이터 부족 환경에서 사전 학습 모델의 적용 가능성을 높여 큰 잠재력을 가집니다.
  - **연구 격차**: 어떤 예측 작업이 가장 전이 가능하고, 어떤 아키텍처가 가장 유연하며, 전이 시 최소한의 튜닝이 필요한지에 대한 추가 연구가 필요합니다.
- **해석 가능성**:
  - 어텐션 메커니즘을 활용한 **개별 환자 수준의 시각화**가 가장 일반적인 해석 방법입니다. Shapley 및 DeepLIFT 같은 특징 중요도 측정은 복잡성이 낮아 권장됩니다.
  - **연구 격차**: 개별 수준 해석뿐만 아니라 임상 의사결정자에게 유용한 **인구 수준 해석 기술** 개발 및 적용이 필요합니다.
- **확장성**:
  - 대규모 고차원 EHR 데이터셋에 대한 딥러닝 모델의 확장성은 확인되었으나, AC 데이터에 대한 효과는 추가 조사가 필요합니다.
  - **연구 격차**: 고급 네트워크 아키텍처에 대한 대규모 데이터셋 분석, DL과 전통적 ML (단일 또는 앙상블) 간의 적절한 비교를 통해 DL 모델이 우수하거나 유사한 성능을 보이는 데이터 설정(특징 유형, 차원, 결측값)을 식별하는 것이 중요합니다.

## 📌 TL;DR

- **주요 문제**: 기존 ML은 고차원적이고 시간 의존적인 의료 데이터에서 특징 공학의 어려움과 시간적 패턴 활용 부족이라는 한계를 가집니다.
- **제안된 방법**: 본 논문은 의료 분야에서 환자의 정형 시계열 데이터를 활용한 딥러닝 예측 모델에 대한 체계적인 문헌 검토를 수행하여 10가지 기술적 연구 흐름을 식별했습니다.
- **핵심 결과**:
  - **RNN (특히 GRU 및 LSTM의 양방향 변형)이 의료 시계열 예측의 지배적인 딥러닝 아키텍처**이며, 종종 CNN과 결합하여 전역 및 지역적 패턴을 모두 포착합니다.
  - **환자 표현**은 데이터 유형에 따라 순차 또는 행렬 방식이 사용되며, EHR 데이터에는 사전 학습된 임베딩이, AC 데이터에는 행렬 표현이 효과적입니다.
  - **결측값 처리**에서는 정보성 결측값을 반영하기 위해 마스킹 벡터나 학습된 결측 패턴이 효과적입니다.
  - **어텐션 메커니즘**은 주로 모델 해석 가능성을 높이는 데 활용되며, 일부 경우 예측 성능 향상에도 기여합니다.
  - **의료 온톨로지** 통합은 희귀 질환 예측에서 데이터 부족 문제를 보완합니다.
  - **비용 민감 학습 및 다중 작업 학습**은 불균형 데이터셋 및 다양한 의료 결과 예측에서 성능을 향상시킬 수 있는 유망한 전략입니다.
  - **대규모 EHR 데이터셋에 대한 모델의 확장성은 확인**되었으나, 전통적인 ML 모델과의 비교에서 유사한 성능을 보이는 경우가 있어, 딥러닝이 확실한 이점을 제공하는 최적의 시나리오를 식별하는 추가 연구가 필요합니다.
- **시사점**: 미래 연구는 다양한 의료 환경에서 모델 아키텍처와 학습 전략에 대한 강력한 벤치마킹, 어텐션 메커니즘의 성능 영향에 대한 심층 분석, 전이 학습의 잠재력 탐색, 그리고 임상 의사결정을 위한 인구 수준 해석 기술 개발에 초점을 맞춰야 합니다.
