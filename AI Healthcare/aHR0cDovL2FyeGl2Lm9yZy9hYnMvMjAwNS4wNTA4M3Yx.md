# A Federated Learning Framework for Healthcare IoT devices

Binhang Yuan, Song Ge, Wenhui Xing

## 🧩 Problem to Solve

헬스케어 IoT 기기는 방대한 양의 데이터를 수집하지만, 데이터 프라이버시 및 보안에 대한 요구사항(예: HIPAA)으로 인해 각 기기가 데이터의 고립된 섬이 됩니다. 또한, 웨어러블 헬스케어 기기의 제한된 연산 및 통신 용량은 기존의 연합 학습(Federated Learning) 적용을 어렵게 만듭니다. 본 연구는 이러한 제약을 극복하고 분산된 헬스케어 IoT 데이터를 사용하여 딥러닝 모델을 효율적이고 안전하게 훈련시키는 프레임워크를 제안합니다.

## ✨ Key Contributions

- 헬스케어 IoT 기기를 위한 고급 연합 학습 프레임워크를 제안합니다.
- **네트워크 분할**: 딥 뉴럴 네트워크를 IoT 기기의 얕은 서브네트워크와 중앙 서버의 깊은 서브네트워크로 분할하여 대부분의 연산 부하를 서버로 옮깁니다.
- **활성화 및 기울기 희소화(Sparsification)**: 순전파 시 활성화($a_1$)와 역전파 시 기울기($da_1$)를 통신할 때, 상위 $K$($\le 10\%$)개의 요소만 전송하여 통신 오버헤드를 크게 줄입니다.
- **실증적 연구**: 제안된 프레임워크가 낮은 정확도 손실(2% 미만)을 유지하면서, 기존 연합 학습 대비 통신 트래픽을 0.2% 수준으로 현저히 줄임을 부정맥 탐지 작업에서 입증합니다.

## 📎 Related Works

- **연합 학습 (Federated Learning)**: 분산된 데이터로 중앙 서버에서 공유 모델을 훈련하는 개념 (Koneˇcn´y et al., 2016; McMahan et al., 2017).
- **SplitNN (Split Learning)**: 원시 데이터나 모델 세부 정보를 공유하지 않고 분산 딥러닝을 수행하는 모델 병렬화 기법 (Vepakomma et al., 2018; Singh et al., 2019). 본 연구의 네트워크 분할에 영감을 제공했습니다.
- **기울기 희소화 (Sparsification of Gradients)**: 훈련 중 통신 오버헤드를 줄이기 위해 기울기 정보의 일부만 전송하는 기법 (Stich et al., 2018; Alistarh et al., 2018).
- **수평 연합 학습 (Horizontal Federated Learning)**: 데이터셋이 동일한 피처 공간을 공유하지만 샘플이 다른 연합 학습 시나리오 (Yang ets al., 2019). 헬스케어 IoT 환경에 해당합니다.

## 🛠️ Methodology

1. **신경망 분해**:
   - 목표 함수 $f^*(x) = f_N(f_{N-1}(...(f_1(x)))))$를 근사하는 딥 뉴럴 네트워크를 분할합니다.
   - 각 IoT 기기($j$)는 데이터 $D_j$를 처리하는 첫 번째 얕은 구성 요소 $a_1 = f_{1,j}(x)$를 로컬에서 수행합니다.
   - 나머지 깊은 구성 요소 $y = f_N(...(f_2(a_1)))$는 중앙 집중식 서버에 할당됩니다.
   - 이러한 분할을 통해 에지 기기의 연산 부하를 크게 줄이면서 데이터 프라이버시 제약을 유지합니다.
2. **활성화 및 기울기 희소화**:
   - 기존 연합 학습의 모델 동기화와 달리, 제안된 프레임워크는 순전파에서 활성화($a_1$)를, 역전파에서 해당 기울기($da_1$)를 통신해야 합니다.
   - 네트워크 트래픽을 더욱 줄이기 위해, 각 반복에서 $a_1$과 $da_1$의 상위 $K$개($\le 10\%$) 요소만 통신하는 희소화 기법을 적용합니다.

## 📊 Results

- **수렴 및 정확도 손실**:
  - 중앙 집중식 서버의 기존 SGD와 비교했을 때, 제안된 프레임워크는 수렴에 있어서 미미한 지연만 보였습니다.
  - 부정맥 탐지 작업(PhysioNet 2017 데이터셋의 ResNet 아키텍처 사용)에서 최종 정확도 손실은 2% 미만이었습니다.
  - 16개, 32개, 64개의 IoT 기기 수에 관계없이 일관된 성능을 보였습니다.
- **통신 오버헤드 감소**:
  - FedAvg 및 SplitNN과 비교하여 단일 반복(각 기기당 배치 크기 32)에 필요한 네트워크 트래픽을 크게 줄였습니다.
  - FedAvg 대비 99.8% 감소를 달성했습니다.
  - SplitNN 대비 90% 감소를 달성했습니다.
  - 예: 16개 기기의 경우, FedAvg는 1.36GB, SplitNN은 32MB, 제안된 프레임워크는 3.2MB의 트래픽을 필요로 했습니다.

## 🧠 Insights & Discussion

- **의의**: 본 프레임워크는 헬스케어 IoT 기기의 고유한 도전 과제(프라이버시, 제한된 자원)를 지능적인 연산 분배와 통신 희소화를 통해 효과적으로 해결합니다. 이는 자원이 제한되고 프라이버시에 민감한 환경에서 강력한 딥러닝 모델의 사용을 가능하게 합니다.
- **한계 및 향후 연구**:
  - 활성화 및 기울기 희소화에 대한 정확도 손실 상한 및 수렴 보장에 대한 이론적 분석이 부족합니다.
  - 다중 센서 헬스케어 IoT 기기에서 여러 학습 작업을 동시에 관리할 수 있는 보다 포괄적인 시스템 설계가 필요합니다.
- **중요성**: 이 제안은 헬스케어 머신러닝 애플리케이션을 위한 프라이버시-민감형 에지 컴퓨팅 분야에서 흥미로운 방향을 제시합니다.

## 📌 TL;DR

**문제**: 헬스케어 IoT 기기는 데이터 프라이버시 문제와 제한된 연산/통신 자원으로 인해 기존 연합 학습 적용에 어려움을 겪습니다.
**방법**: 딥 뉴럴 네트워크를 IoT 기기의 얕은 부분과 중앙 서버의 깊은 부분으로 분할하고, 순전파 시 활성화($a_1$)와 역전파 시 기울기($da_1$) 중 상위 $K$개($\le 10\%$) 요소만 전송하는 희소화 기법을 통해 통신량을 획기적으로 줄이는 연합 학습 프레임워크를 제안합니다.
**결과**: 부정맥 탐지 작업에서 2% 미만의 정확도 손실을 유지하면서, 기존 연합 학습 대비 통신량을 99.8% (SplitNN 대비 90%) 절감하는 효율성을 입증했습니다.
