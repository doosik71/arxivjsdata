# Deep Learning for Time Series Anomaly Detection: A Survey

ZAHRA ZAMANZADEH DARBAN, GEOFFREY I. WEBB, SHIRUI PAN, CHARU C. AGGARWAL, MAHSA SALEHI

## 🧩 Problem to Solve

시계열 이상 탐지(Time Series Anomaly Detection, TSAD)는 금융 시장, 의료, 제조 등 광범위한 분야에서 생산 결함, 시스템 오류, 또는 예측치 못한 이벤트를 나타낼 수 있어 매우 중요합니다. 시계열 데이터의 방대한 규모와 복잡한 패턴으로 인해, 이상 패턴을 탐지하기 위한 전문화된 심층 학습 모델의 개발이 필수적입니다. 기존의 심층 이상 탐지 관련 설문조사들은 최근 몇 년간 등장한 DAEMON, TranAD, DCT-GAN, Interfusion과 같은 최신 방법론과 표현 학습(representation learning) 방법론을 포괄적으로 다루지 못했습니다. 따라서 연구자들이 다양한 응용 환경에 적합한 방법론을 식별하고 중요한 미래 연구 방향을 제시할 수 있는 체계적이고 포괄적인 최신 설문조사의 필요성이 제기되었습니다.

## ✨ Key Contributions

- **분류 체계(Taxonomy):** 시계열 데이터용 심층 이상 탐지 모델을 예측 기반(forecasting-based), 재구성 기반(reconstruction-based), 표현 기반(representation-based), 하이브리드(hybrid) 방법론으로 분류하고, 각 범주를 심층 신경망 아키텍처(예: RNN, CNN, AE, VAE, GAN, Transformer, GNN, HTM)에 따라 세분화하여 제시했습니다.
- **포괄적인 리뷰:** 2024년까지의 시계열 이상 탐지 분야 최신 기술에 대한 철저한 리뷰를 제공하여, 이 분야의 지배적인 방향과 신흥 트렌드를 명확히 설명합니다.
- **벤치마크 및 데이터셋:** 이 분야에서 사용되는 주요 벤치마크와 데이터셋을 정리하고 분류하며, 연구자들이 쉽게 접근할 수 있도록 하이퍼링크를 제공합니다.
- **실무자를 위한 가이드라인:** 특정 요구 사항과 작업 컨텍스트에 따라 적절한 심층 학습 아키텍처, 데이터셋 및 모델을 선택하는 데 도움이 되는 실용적인 가이드라인을 포함합니다.
- **근본 원리:** 시계열 데이터에서 다양한 유형의 이상 현상 발생에 대한 근본 원리를 논의하여 이상 현상의 본질과 효과적인 탐지 방법을 이해하는 데 기여합니다.
- **평가 지표 및 해석 가능성:** 평가 지표에 대한 광범위한 논의와 지표 선택 가이드라인, 그리고 모델의 행동과 결정을 이해하고 설명하는 데 도움이 되는 모델 해석 가능성에 대한 상세 논의를 제공합니다.

## 📎 Related Works

이상 탐지 분야는 1960년대부터 활발히 연구되어 왔습니다 [72]. 기존 문헌에는 여러 이상 탐지 설문조사 [26, 140, 24, 17, 20]와 평가 리뷰 논문 [153, 101]이 있지만, 시계열 데이터에 대한 심층 이상 탐지 방법론을 다룬 설문조사는 [37]이 유일했습니다. 하지만 [37]은 DAEMON [33], TranAD [171], DCT-GAN [114], Interfusion [117] 등 최근에 등장한 다양한 TSAD 방법과 표현 학습 방법론을 충분히 다루지 못했습니다.
전통적인 시계열 이상 탐지 방법으로는 통계 기반(예: ARIMA, EWMA) [186], 클러스터링 기반(예: k-평균) [133], 거리 기반(예: k-NN) [188], 밀도 기반(예: LOF, iForest) [50] 접근 방식이 있습니다. 이 논문은 이러한 전통적인 방법과 심층 학습 기반 모델의 차이점을 강조하며, 시계열 데이터의 복잡한 패턴을 모델링하는 데 있어 심층 신경망의 우수성을 제시합니다.

## 🛠️ Methodology

이 설문조사는 심층 이상 탐지 모델을 네 가지 주요 접근 방식과 심층 신경망 아키텍처를 기반으로 분류하고 설명합니다 (Fig. 2, 3 참조).

- **심층 모델의 일반 구성 요소:**

  - **입력 시계열(Input Time Series):** 단변량(Univariate) 또는 다변량(Multivariate) 시계열 데이터.
  - **전처리(Preprocessing):** 결측값 보간, 샘플링, 정규화 등이 포함될 수 있습니다.
  - **학습/추론(Learning/Inference):** 모델이 정상 패턴을 학습하는 핵심 단계입니다.
  - **점수 계산(Scoring):** 학습된 모델을 기반으로 이상 점수를 생성합니다. 일반적으로 재구성 오류($$|X - \hat{X}|^2$$)나 예측 오류($$|x_t - x'_t|$$)를 활용합니다.
  - **출력 레이블(Output Labels):** 임계값($$threshold$$)을 기준으로 이상 여부를 결정합니다. ($$|A_S| > threshold$$)

- **모델 분류 및 주요 아키텍처:**

  1. **예측 기반 모델 (Forecasting-Based Models):**
     - **개념:** 과거 데이터를 기반으로 다음 시점의 값을 예측하고, 실제 값과의 예측 오류를 이상 점수로 사용합니다.
     - **주요 아키텍처:** 순환 신경망(RNN, LSTM, GRU) [126, 28], 컨볼루션 신경망(CNN, TCN) [135, 78], 그래프 신경망(GNN) [45], 계층적 시간 메모리(HTM) [5], 트랜스포머(Transformer) [185].
  2. **재구성 기반 모델 (Reconstruction-Based Models):**
     - **개념:** 인코더-디코더 구조를 사용하여 정상 데이터의 저차원 표현을 학습하고 입력 데이터를 재구성합니다. 재구성 오류가 크면 이상으로 간주합니다.
     - **주요 아키텍처:** 오토인코더(AE, DAE, CAE) [150, 10], 변이형 오토인코더(VAE, CVAE) [184, 163], 생성적 적대 신경망(GAN) [111, 200].
  3. **표현 기반 모델 (Representation-Based Models):**
     - **개념:** 입력 시계열의 풍부하고 견고한 표현(latent space)을 학습하여, 이 표현 공간에서 이상 탐지를 수행합니다. 주로 자기 지도 학습(self-supervised learning) 방식을 사용합니다.
     - **주요 아키텍처:** 트랜스포머(TS2Vec) [190], 컨볼루션 신경망(TF-C, DCdetector, CARLA, DACAD) [196, 187, 42, 43].
  4. **하이브리드 모델 (Hybrid Models):**
     - **개념:** 두 가지 이상의 접근 방식(예: 예측 + 재구성) 또는 여러 아키텍처의 강점을 통합하여 성능을 향상시킵니다.
     - **주요 아키텍처:** AE와 RNN/GNN 결합 [197, 60], GAN과 RNN 결합 [13], GNN과 예측/재구성 결합 [199, 76].

- **이상 유형 (Section 2.4):**

  - **시간적 이상(Temporal Anomalies):** Global, Contextual, Seasonal, Trend, Shapelet 이상.
  - **측정치 간 이상(Intermetric Anomalies):** 다변량 시계열에서 측정치(변수) 간의 상관관계가 깨지는 현상 (Fig. 1b).
  - **시간-측정치 간 이상(Temporal-Intermetric Anomalies):** 시간적 및 측정치 간 종속성이 동시에 위반되는 경우.

- **학습 방식:** 비지도, 지도, 준지도, 자기 지도 학습. 대부분의 현실 시나리오에서는 레이블된 이상 데이터가 부족하므로 비지도 또는 자기 지도 방식이 선호됩니다.

## 📊 Results

부록 C의 Fig. 12는 MSL, SMAP, SMD, SWaT 네 가지 다변량 시계열 데이터셋에 대한 15개 최신 TSAD 모델의 F1 스코어(F1 score) 및 PA-F1 스코어(F1$_{PA}$ score)를 비교합니다.

- **최신 모델의 우수성:** DACAD (2024)는 MSL, SMAP, SMD 데이터셋에서 다른 모델들보다 전반적으로 뛰어난 성능을 보였습니다 (SWaT 데이터셋 결과는 제외). CARLA (2023)와 TimesNet (2023) 또한 이들 데이터셋에서 강력한 성능을 나타냈습니다.
- **성능 향상 추세:** DAGMM (2018), LSTM-VAE (2018), OmniAnomaly (2018)와 같은 구형 모델들은 일반적으로 최신 모델에 비해 낮은 점수를 기록했습니다. 이는 심층 이상 탐지 기술이 시간이 지남에 따라 크게 발전하여, 새로운 모델들이 더 높은 F1 및 F1$_{PA}$ 점수를 달성하고 있음을 시사합니다.
- **주요 데이터셋:** MSL, SMAP, SMD, SWaT는 다변량 시계열 이상 탐지에 가장 일반적으로 사용되는 데이터셋이며, Yahoo, KPI, NAB, UCR은 단변량 시계열에 자주 사용됩니다. (Table 3 참조).

이러한 결과는 최신 심층 학습 모델들이 복잡한 시계열 이상 패턴을 탐지하는 데 있어 상당한 발전을 이루었음을 보여줍니다.

## 🧠 Insights & Discussion

시계열 이상 탐지 분야에서 많은 발전이 있었음에도 불구하고, 여전히 극복해야 할 주요 도전 과제들이 존재합니다.

- **비정상성 및 동적 변화:** 실세계 시계열 데이터는 환경 변화에 따라 비정상적이고 동적으로 분포가 자주 변합니다. 따라서 심층 학습 모델은 온라인 또는 점진적 학습 접근 방식을 통해 지속적으로 업데이트되어야 실시간 이상 탐지에 효과적일 수 있습니다.
- **다변량 고차원 데이터:** 다변량 고차원 시계열 데이터에서 이상을 탐지하는 것은 데이터가 희소해지고, 시간적 종속성과 차원 간의 복잡한 관계를 동시에 고려해야 하므로 특히 어렵습니다.
- **레이블링된 이상 부재:** 현실 세계에서는 레이블된 이상 데이터가 매우 적거나 아예 없는 경우가 많으므로 비지도, 준지도 또는 자기 지도 학습 접근 방식이 필요합니다. 이로 인해 많은 정상 인스턴스가 이상으로 잘못 식별되는 오탐(false positives) 문제가 발생하며, 이를 최소화하고 재현율(recall rates)을 개선하는 메커니즘을 찾는 것이 핵심 과제입니다.
- **노이즈에 대한 취약성:** 시계열 데이터셋은 노이즈의 존재 여부와 분포가 매우 다양할 수 있으며, 입력 데이터의 노이즈는 모델의 성능을 저하시킬 수 있습니다.
- **해석 가능성 부족:** 이상 탐지는 진단 도구로 사용될 때 해석 가능성이 필수적이지만, 많은 연구가 탐지 정확도에만 집중하고 해석 가능성 문제는 간과하는 경향이 있습니다. 다변량 시계열 데이터와 확률적 심층 학습은 해석 가능성을 더욱 어렵게 만듭니다.
- **주기적 이상(Periodic Anomalies):** 주기적 이상 현상, 즉 시간이 지남에 따라 반복되는 비정상적인 서브시퀀스는 문헌에서 거의 다루어지지 않으며 탐지를 더욱 어렵게 만듭니다 (예: 사기 탐지에서 주기적으로 발생하는 이상 거래).

이 설문조사는 시계열 이상 탐지 분야의 최신 심층 학습 모델, 산업 응용 분야 및 데이터셋을 탐색하고 식별하는 것을 목표로 했습니다. 시계열의 특성, 이상 유형, 심층 학습 모델의 구조 등 다양한 관점에서 64개 최신 심층 모델을 종합적으로 논의하고 분류했습니다. 앞으로의 연구 노력은 이러한 도전 과제를 극복하는 데 집중되어야 합니다.

## 📌 TL;DR

시계열 이상 탐지(TSAD)는 광범위한 분야에서 중요하지만, 데이터의 복잡성과 기존 설문조사의 한계로 인해 최신 심층 학습 기반 TSAD 기술에 대한 포괄적이고 체계적인 검토가 필요했습니다. 이 설문조사는 예측, 재구성, 표현, 하이브리드 기반 모델이라는 새로운 분류 체계를 제시하고, 각 범주 내에서 RNN, CNN, AE, VAE, GAN, Transformer, GNN, HTM 등 다양한 심층 신경망 아키텍처를 상세히 검토했습니다. 최신 모델(DACAD, CARLA, TimesNet 등)이 F1 및 F1$_{PA}$ 점수에서 기존 모델보다 우수한 성능을 보여 이 분야의 지속적인 발전을 입증했습니다. 또한, 동적인 비정상성, 고차원 데이터, 레이블링 부족, 노이즈, 해석 가능성 부족, 주기적 이상 탐지 등의 주요 도전 과제를 식별하고 미래 연구 방향을 제시하여 이 분야의 연구자와 실무자에게 중요한 지침을 제공합니다.
