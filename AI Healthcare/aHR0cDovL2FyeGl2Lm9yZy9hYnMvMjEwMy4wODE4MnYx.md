# Deep Neural Network Based Ensemble learning Algorithms for the healthcare system (diagnosis of chronic diseases)

Jafar Abdollahi, Babak Nouri-Moghaddam, Mehdi Ghazanfari

## 🧩 Problem to Solve

만성 질환의 진단 및 의료 의사 결정을 지원하는 데 있어 기존의 단일 기계 학습 알고리즘은 충분히 효과적이거나 정확하지 않아, 많은 시나리오에서 성공적이지 못했습니다. 인적 오류를 최소화하고 시기적절하며 정확한 진단을 가능하게 할, 더 우수하고 효율적인 방법론 개발이 필요합니다.

## ✨ Key Contributions

- 만성 질환 진단을 위한 딥 신경망 기반 앙상블 학습(Deep Neural Network-based Ensemble Learning) 방법론을 제안합니다. 특히, "상위 10개" 기계 학습 알고리즘을 기본 학습기(base learners)로 사용하고 딥 신경망(Deep Neural Network)을 메타 학습기(meta-learner)로 활용하는 하이브리드 스태킹(Stacking) 접근 방식을 제시합니다.
- 제안된 방법론은 UCI 데이터셋을 사용하여 당뇨병, 심장 질환 및 유방암 진단에서 각각 99%, 99%, 98.5%의 매우 높은 정확도를 달성하여, 기준선(baseline) 알고리즘 및 다른 앙상블 방법론보다 우수한 성능을 입증했습니다.
- 만성 질환 진단에 사용되는 다양한 분류 알고리즘에 대한 포괄적인 검토 및 비교 분석을 제공합니다.

## 📎 Related Works

본 연구는 만성 질환 진단을 위해 다양한 기계 학습 및 인공 지능 기법을 적용한 선행 연구들을 참조했습니다. 주요 참조 연구들은 다음과 같습니다:

- **활동 추적 및 모니터링:** Lam et al.은 알츠하이머 환자 활동 추적에 SVM, RF, NB 등을 활용했습니다.
- **만성 질환 예측:** Chen et al.은 신경망 알고리즘을 사용하여 만성 질환을 효과적으로 예측했습니다.
- **의료 데이터 분석:** Babič et al.은 의사 결정 트리, NB, SVM, Apriori 알고리즘을 통해 의료 데이터를 분석하여 예측 모델을 생성했습니다.
- **심장 질환 위험 예측:** Paul et al.은 유전 알고리즘 기반 퍼지 시스템을 제안했습니다. Safdar et al.은 ANN, CART, 로지스틱 회귀로 심장 질환을 진단했습니다.
- **간 질환 진단 및 예측:** Yip et al.은 실험실 매개변수 기반 기계 학습 모델을 사용했습니다.
- **질병 예측 및 분류:** Zhang et al.은 신경망을 사용하여 의료 기록 기반 질병을 예측했고, TING-TINGZHAO1 et al.은 SVM을 활용했습니다.
- **ECG 분석 및 이상 탐지:** Lee et al.은 ECG 파형 이상 탐지 방법을 제안했고, Kumar et al.은 ECG 신호로 관상동맥 질환을 진단했습니다.
- **앙상블 학습:** Qummar et al.은 당뇨성 망막증 탐지를 위한 딥 러닝 앙상블 접근 방식을 사용했습니다. Abdollahi et al.은 유방암 전이 및 당뇨병 진단에 하이브리드 AI 및 유전 기반 앙상블 학습을 활용했습니다.

## 🛠️ Methodology

본 연구는 당뇨병, 유방암, 심장 질환 진단을 위한 하이브리드 신경망 기반 스태킹(Stacking) 앙상블 학습 모델을 제안합니다.

- **접근 방식:** 스태킹 일반화(Stacking Generalization) 기법을 활용한 신경망 기반 앙상블 학습.
- **기본 학습기(Base Learners):** 데이터 마이닝 분야에서 널리 사용되는 "상위 10개" 기계 학습 알고리즘들을 포함합니다. 이들은 선형 회귀, 로지스틱 회귀, 나이브 베이즈, K-최근접 이웃(K-NN), 의사 결정 트리, 랜덤 포레스트, 서포트 벡터 머신(SVM), CART, 배깅(Bagging), 부스팅(Boosting)입니다. 이 알고리즘들은 각 질병 데이터셋에 대해 훈련됩니다.
- **메타 학습기(Meta-Learner):** 기본 학습기들의 예측 결과를 입력으로 받아 최종 진단(분류)을 수행하는 딥 신경망(DeepNN)을 메타 학습기로 사용합니다.
- **데이터셋:** UCI 머신러닝 저장소에서 가져온 실제 만성 질환 환자 데이터셋 세 가지를 사용합니다.
  - **당뇨병 데이터셋:** Pima Indians Diabetes Dataset, 9개 변수, 768개 기록.
  - **유방암 데이터셋:** Breast Cancer Wisconsin (Diagnostic) Dataset, 32개 변수, 569개 기록.
  - **심장 질환 데이터셋:** Statlog (Heart) Dataset, 13개 변수, 270개 기록.
- **평가 지표:** 모델의 성능을 평가하기 위해 혼동 행렬(Confusion Matrix)과 ROC(Receiver Operating Characteristic) 곡선 분석을 사용합니다. 혼동 행렬을 기반으로 정확도(Accuracy), 민감도(Sensitivity), 특이도(Specificity), 양성 예측도(PPV), 음성 예측도(NPV)를 계산합니다.
  - 정확도: $$\text{Accuracy} = \frac{\text{TP} + \text{TN}}{\text{TP} + \text{FP} + \text{TN} + \text{FN}}$$
  - 민감도: $$\text{Sensitivity} = \frac{\text{TP}}{\text{TP} + \text{FN}}$$
  - 특이도: $$\text{Specificity} = \frac{\text{TN}}{\text{TN} + \text{FP}}$$
  - PPV: $$\text{PPV} = \frac{\text{TP}}{\text{TP} + \text{FP}}$$
  - NPV: $$\text{NPV} = \frac{\text{TN}}{\text{TN} + \text{FN}}$$

## 📊 Results

제안된 딥 신경망 기반 스태킹 앙상블 모델은 세 가지 만성 질환 데이터셋 모두에서 개별 분류 알고리즘 및 다른 앙상블 방법론보다 우수한 성능을 보였습니다.

- **개별 알고리즘 성능 비교:**
  - **당뇨병 (표 5):** 랜덤 포레스트(88%)가 가장 높았고, CART(58%)가 가장 낮았습니다.
  - **심장 질환 (표 6):** 랜덤 포레스트(84%)가 가장 높았고, 로지스틱 회귀(68%)가 가장 낮았습니다.
  - **유방암 (표 7):** 나이브 베이즈(89%)가 가장 높았고, CART(56%)가 가장 낮았습니다.
- **앙상블 및 제안된 딥 신경망 모델 성능 비교 (표 8, 9, 10):**
  - **당뇨병 (표 8):**
    - 배깅: 89%
    - 부스팅: 92%
    - 스태킹(일반): 98%
    - **제안된 딥 신경망(Deep NN): 99%**
  - **심장 질환 (표 9):**
    - 배깅: 92%
    - 부스팅: 94%
    - 스태킹(일반): 97%
    - **제안된 딥 신경망(Deep NN): 99%**
  - **유방암 (표 10):**
    - 배깅: 89%
    - 부스팅: 88%
    - 스태킹(일반): 98%
    - **제안된 딥 신경망(Deep NN): 98.5%**

전반적으로, 앙상블 알고리즘은 단일 알고리즘보다 효과적이었으며, 특히 딥 신경망을 메타 학습기로 사용한 스태킹 방법론이 모든 질환에서 가장 높은 정확도를 달성하며 뛰어난 예측 능력을 입증했습니다.

## 🧠 Insights & Discussion

인공지능(AI)과 기계 학습은 환자 데이터를 활용하여 만성 질환 진단 문제를 해결하는 데 중요한 잠재력을 가지고 있습니다. 본 연구의 결과는 앙상블 학습 알고리즘이 개별 알고리즘에 비해 예측 정확도, 민감도, 특이도 측면에서 일관되게 우수한 성능을 보임을 시사합니다.

제안된 딥 신경망 기반 스태킹(DeepNN-based stacking) 접근 방식은 시기적절하고 정확한 진단에 매우 효과적이며, 임상의가 간과할 수 있는 숨겨진 패턴을 식별하는 데 도움을 줍니다. 이러한 높은 정확도는 의료 의사 결정 지원 시스템으로서의 잠재적 가치를 강조합니다. 이 모델은 의료 전문가의 진단을 보완하고, 궁극적으로 환자 치료에 긍정적인 영향을 미칠 수 있습니다.

**한계점 및 향후 연구:** 모델의 성공은 필요한 변수의 존재, 충분히 큰 데이터베이스, 적은 결측치, 정확한 데이터 접근성 등 여러 요인에 달려 있습니다. 향후 연구에서는 인공지능을 신경학적 질환 진단에도 적용할 계획입니다.

## 📌 TL;DR

만성 질환 진단 시 단일 기계 학습 알고리즘의 부정확성과 비효율성을 개선하기 위해, 본 논문은 "상위 10개" 기계 학습 알고리즘을 기본 학습기로 사용하고 딥 신경망을 메타 분류기로 활용하는 하이브리드 스태킹 앙상블 모델(DeepNN_SG)을 제안했다. 이 모델은 UCI 데이터셋을 활용한 당뇨병(99%), 심장 질환(99%), 유방암(98.5%) 진단에서 기존 단일 및 다른 앙상블 방법론을 크게 능가하는 뛰어난 정확도를 달성하여 만성 질환 진단 시스템의 효율성과 신뢰성을 크게 향상시킬 수 있음을 보여주었다.
