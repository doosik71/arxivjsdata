# Distilling Knowledge from Deep Networks with Applications to Healthcare Domain

Zhengping Che, Sanjay Purushotham, Robinder Khemani, Yan Liu

## 🧩 Problem to Solve

최근 전자의료기록(EHR)의 기하급수적인 증가로 인해 계산 표현형(Computational Phenotyping) 연구에서 질병의 의미 있는 데이터 기반 표현 및 패턴을 발견할 긴급한 필요성이 대두되었습니다. 딥러닝 모델은 이러한 계산 표현형 작업에서 견고한 예측을 위해 우수한 성능을 보였지만, 임상 의사의 의사 결정에 필수적인 **모델 해석 가능성(model interpretability)** 문제가 있습니다. 따라서, 딥러닝 모델과 유사한 최첨단 성능을 달성하면서도 해석 가능한 특징(표현형)을 발견할 수 있는 새로운 데이터 기반 기계 학습 기술을 개발하는 것이 핵심 문제입니다.

## ✨ Key Contributions

- 최첨단 딥러닝 모델의 성능을 잘 알려진 **그라디언트 부스팅 트리(Gradient Boosting Trees, GBT)**를 사용하여 모방하는 **해석 가능한 모방 학습(Interpretable Mimic Learning)**이라는 새로운 지식 증류(knowledge distillation) 방법론을 제안합니다.
- **스택형 노이즈 제거 오토인코더(Stacked Denoising Autoencoder, SDA)** 및 **장단기 기억(Long Short-Term Memory, LSTM)**을 포함한 여러 딥러닝 아키텍처에 대한 광범위한 실험을 통해 제안된 해석 가능한 모방 학습 모델이 여러 딥러닝 모델에서 최첨단 성능을 달성할 수 있음을 보여주었습니다.
- 제안된 모델이 학습한 해석 가능한 특징과 의사 결정 규칙을 전문가 임상 의사에게 검증받았습니다. 또한, 신경망에서 추출된 특징을 사용하는 것이 소프트 레이블을 사용하는 것보다 모방 성능을 향상시키는지 여부를 조사하는 실험을 수행했습니다.

## 📎 Related Works

- **의료 분야의 딥러닝**: EHR 데이터 증가와 개인 맞춤형 의료(Personalized Healthcare)의 필요성으로 인해 계산 표현형에 딥러닝 기법 적용에 대한 관심이 증가했습니다. 이전 연구들($[9, 28, 11, 18, 30]$)은 딥러닝이 의료 분야에서 최첨단 성능을 보여주었으나, 학습된 특징의 해석 가능성 시도는 제한적이었습니다.
- **모델 해석 가능성**: 의료 분야에서는 모델 해석 가능성이 중요합니다. 의사 결정 트리(Decision Trees, $[36]$)는 해석하기 쉽지만, 결측값이 많은 의료 데이터셋에서는 성능이 좋지 않습니다. 컴퓨터 비전 분야에서 딥러닝 특징의 해석 가능성에 대한 연구($[13, 46, 40]$)가 있었으나, 딥 모델의 동작이 예상보다 복잡할 수 있음을 보여주었습니다.
- **모방 학습(Mimic Learning) 및 지식 증류(Knowledge Distillation)**: 얕은 모델이 딥러닝 모델과 동일한 함수를 학습할 수 있음을 보여주는 연구($[1]$)가 있었습니다. 또한, 모델 앙상블에서 단일 모델로 지식(dark knowledge)을 전달하는 효율적인 지식 증류 접근법($[20, 26]$)이 제안되었습니다.

## 🛠️ Methodology

본 논문에서는 딥러닝 모델의 성능을 모방하기 위해 그라디언트 부스팅 트리(GBT)를 사용하는 **해석 가능한 모방 학습(Interpretable Mimic Learning)** 방법을 제안합니다. 이 방법은 "GBTmimic" 모델이라고도 불리며, 해석 가능한 특징을 식별하면서 딥러닝 모델의 최첨단 분류 성능을 유지하는 것을 목표로 합니다. 두 가지 일반적인 GBTmimic 모델 파이프라인은 다음과 같습니다:

- **파이프라인 1 (신경망 추출 특징 활용)**:
  1. 입력 특징 $X$와 목표 $y$가 주어졌을 때, 스택형 노이즈 제거 오토인코더(SDA) 또는 장단기 기억(LSTM)과 같은 딥 신경망을 훈련합니다.
  2. 가장 높은 은닉층의 활성화 값을 딥 네트워크에서 추출된 특징 $X_{{nn}}$으로 사용합니다.
  3. 이 새로운 특징 $X_{{nn}}$을 로지스틱 회귀(Logistic Regression)와 같은 표준 분류기에 입력하여 동일한 분류 작업을 훈련하고, 분류기에서 얻은 소프트 예측 점수 $y_c$를 사용합니다.
  4. 마지막으로, 원시 입력 $X$와 소프트 목표 $y_c$를 사용하여 그라디언트 부스팅 회귀 트리(Gradient Boosting Regression Trees)로 모방 모델을 훈련하여 최소 평균 제곱 오차(minimum mean squared error)로 최종 출력 $y_m$을 얻습니다.
- **파이프라인 2 (딥 네트워크 직접 소프트 레이블 활용)**:
  1. 파이프라인 1과 유사하게 딥 신경망을 훈련하지만, 신경망의 예측 레이어에서 직접 얻은 소프트 예측 점수 $y_{{nn}}$을 사용합니다.
  2. 추출된 특징으로 추가 분류기를 훈련하는 대신, 소프트 예측 점수 $y_{{nn}}$을 모방 모델 훈련의 목표로 사용합니다. 즉, 원시 입력 $X$가 주어졌을 때 $y_{{nn}}$에 대해 최소 평균 제곱 오차를 출력하는 그라디언트 부스팅 트리를 훈련합니다.

두 파이프라인 모두 훈련 완료 후 최종 단계에서 훈련된 모방 모델을 원래 분류 작업에 직접 적용할 수 있습니다. GBT를 사용한 이 해석 가능한 모방 학습 모델은 예측을 모방하여 원본 복잡 모델의 성능을 유지하며, 의사 결정 규칙 및 트리 구조로부터 원본 모델보다 더 나은 해석 가능성을 제공합니다.

## 📊 Results

실제 임상 시계열 데이터셋인 VENT 데이터셋에 대한 실험 결과는 다음과 같습니다.

- **성능 비교**: 사망률(Mortality, MOR) 및 인공호흡기 비사용 일수(Ventilator Free Days, VFD) 예측 두 가지 분류 작업 모두에서 제안된 해석 가능한 모방 학습 방법(GBTmimic-\*)이 딥러닝 모델과 유사하거나 더 나은 성능(AUC 기준)을 달성했습니다.
  - MOR 작업에서는 **GBTmimic-LR-SDA**가, VFD 작업에서는 **GBTmimic-LR-DNN**이 최고의 성능을 기록했습니다.
  - 일반적으로 딥 네트워크의 최상위 계층 소프트 레이블만 사용하는 것(Pipeline 2)보다 로지스틱 회귀를 통해 딥 네트워크의 추출된 특징을 사용하는 것(Pipeline 1)이 DNN 및 SDA에서는 더 나은 예측 성능을 보였습니다. 그러나 LSTM 모델에서는 그렇지 않았는데, 이는 LSTM이 시간 의존성을 직접 모델링하기 때문으로 추정됩니다.
- **특징 유형의 영향**:
  - **시간 특징만 사용**: MOR 작업에서는 모든 특징을 사용했을 때와 시간 특징만 사용했을 때의 예측 성능 차이가 작았습니다. 반면 VFD 작업에서는 정적 특징을 추가하는 것이 예측 성능에 상대적으로 더 중요했습니다.
  - **정적 및 초기 시간 특징만 사용**: 정적 변수와 시간 특징의 초기 값만 사용했을 경우, 모든 모델에서 성능이 크게 저하되어 시간 특징만 사용한 모델보다도 좋지 않았습니다. 이는 시간 모델의 우수성을 더욱 뒷받침합니다.
- **해석 가능한 특징**:
  - GBT 및 GBTmimic 모델이 발견한 상위 중요 특징 중에는 Day 1의 MAP (Mean Airway Pressure), Day 1의 $\delta PF$ (PaO$_2$/FIO$_2$ Ratio 변화)와 같은 시간 특징이 많았습니다.
  - 정적 특징 중에서는 PIM2 (Pediatric Index of Mortality 2) 및 PRISM (Pediatric Risk of Mortality) 점수가 가장 유용했습니다.
  - 원본 GBT와 GBTmimic 모델은 일부 공통된 특징과 유사한 규칙을 공유하는 의사 결정 트리를 생성하여 의료 전문가가 모델을 이해하고 의사 결정에 활용하는 데 도움을 줄 수 있음을 보여주었습니다.
- **단일 의사 결정 트리 모방의 한계**: 단일 의사 결정 트리를 모방한 DTmimic 방법은 GBTmimic 방법보다 성능이 현저히 낮았습니다.

## 🧠 Insights & Discussion

이 논문은 그라디언트 부스팅 트리를 통한 딥 네트워크로부터의 지식 증류라는 새로운 접근 방식을 제안하여, 의료 분야에서 해석 가능한 특징과 예측 규칙을 학습할 수 있음을 보여주었습니다. 실제 임상 데이터셋에서 우리의 모방 학습 방법은 딥 모델과 유사하거나 더 나은 성능을 달성했으며, 이는 의료 분야의 미래 기계 학습 연구를 위한 매우 유망한 방향을 제시합니다.

- **시사점**: 딥러닝의 높은 예측 성능을 유지하면서도 모델의 "블랙박스" 특성을 해결하고 의료 전문가가 이해하고 신뢰할 수 있는 해석 가능한 모델을 제공할 수 있다는 점에서 큰 의미가 있습니다. 이를 통해 임상 의사 결정 지원 시스템의 채택률을 높이고 환자 관리의 질을 향상시킬 수 있습니다.
- **제한 사항 및 향후 연구**:
  - 의사 결정 규칙이나 트리 노드 특징과 같은 더 유용한 정보를 추출하여 진단 해석 가능성을 높이는 것을 목표로 합니다.
  - MIMIC-II와 같은 더 큰 의료 데이터셋에 제안된 접근 방식을 적용하여 방법론을 추가로 검증할 계획입니다.
  - 구조화된 딥 네트워크 모델과 같은 다른 최첨단 기계 학습 모델로 모방 방법을 확장하여 실제 응용 분야에서의 적용 가능성을 탐색할 계획입니다.

## 📌 TL;DR

본 논문은 의료 분야에서 딥러닝 모델의 높은 예측 성능을 유지하면서도 필수적인 **해석 가능성**을 제공하기 위한 **해석 가능한 모방 학습(Interpretable Mimic Learning)** 방법을 제안합니다. 이 방법은 딥러닝 모델(SDA, LSTM)의 '지식'(소프트 레이블 또는 추출된 특징)을 **그라디언트 부스팅 트리(GBT)**에 증류시켜, 원본 딥 모델과 유사하거나 더 나은 예측 성능을 달성하면서도 의료 전문가가 이해할 수 있는 **해석 가능한 특징과 의사 결정 규칙**을 제공합니다. 실제 임상 데이터셋에 대한 실험을 통해 이 접근 방식이 효율적이고 효과적임을 입증했습니다.
