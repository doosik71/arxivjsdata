# A review of Generative Adversarial Networks for Electronic Health Records: applications, evaluation measures and data sources

Ghadeer Ghosheh, Jin Li, and Tingting Zhu

## 🧩 Problem to Solve

전자 건강 기록(EHR)은 임상 연구 및 진료 시점 애플리케이션에 매우 유용하지만, 데이터 개인 정보 보호 문제와 같은 여러 과제로 인해 최적의 활용이 어렵습니다. 또한, EHR 데이터는 클래스 불균형, 결측치, 노이즈, 이질성, 불규칙한 샘플링 등 다양한 데이터 특성 관련 문제점을 가지고 있습니다. 딥 생성 모델, 특히 생성적 적대 신경망(GAN)은 이러한 문제들을 해결하면서 기본 데이터 분포를 학습하여 합성 EHR 데이터를 생성하는 데 큰 잠재력을 보여주지만, 해당 분야의 종합적인 검토는 부족합니다.

## ✨ Key Contributions

- **GAN을 활용한 EHR 애플리케이션 종합 검토**: EHRs를 위한 GAN의 주요 발전 사항과 제안된 방법론을 애플리케이션, 평가 지표, 데이터 소스 측면에서 상세히 검토합니다.
- **합성 EHR 데이터 품질 평가 지표 분류**: GAN이 생성한 합성 EHR 데이터의 품질을 평가하는 데 사용되는 광범위한 평가 지표들을 최초로 논의하고 분류합니다.
- **GANs for EHRs의 과제 및 권장 사례 제시**: 현재 연구의 한계점과 도전 과제를 분석하고, 미래 연구 방향과 권장 사례를 제안하여 헬스케어 및 머신러닝 분야의 새로운 연구를 장려합니다.
- **EHRs용 GAN 모델의 벤치마크 제공**: 검토된 연구에서 사용된 지표 및 데이터 세트 목록을 정리하여 향후 연구의 벤치마크로 활용될 수 있도록 합니다.

## 📎 Related Works

GAN 관련 기존 연구들은 주로 GAN 평가, 의료 영상 분야에서의 GAN 적용, 시계열 신호 및 관측 건강 데이터에서의 GAN 활용에 초점을 맞추고 있습니다. 그러나 본 논문은 **정형화된 EHR(structured EHR)**에 특화된 GAN의 적용, 평가, 과제를 다루며, 합성 샘플 생성뿐만 아니라 EHR의 다양한 데이터 문제를 완화하는 데 중점을 둡니다. 특히, 합성 EHR 데이터 품질 평가에 사용되는 광범위한 평가 지표를 논의하고 분류한 최초의 연구입니다.

## 🛠️ Methodology

본 연구는 2022년 1월까지 Google Scholar에서 "GAN" AND "EHR", "synthetic health data", "GAN" AND "Health" 키워드를 사용하여 관련 문헌을 식별하는 체계적인 문헌 검토 방법을 따랐습니다.

1. **문헌 식별 및 필터링**: 검색된 논문 중 GAN 이외의 생성 모델을 사용한 논문 및 중복 논문을 제외했습니다.
2. **GAN 원리 및 EHR 데이터 유형 개요**: GAN의 작동 원리(생성자 $G$와 판별자 $D$의 경쟁 학습) 및 아키텍처, 그리고 EHR 데이터의 주요 유형(표 형식, 시계열, 이질적 데이터)을 간략하게 소개합니다.
   - **GAN의 목적 함수**:
     $$ min*{G} max*{D} V(D,G) = E*{x}[\log D(x)] + E*{z}[\log(1-D(G(z)))] $$
3. **GANs for EHRs 애플리케이션 분류**: GAN을 활용한 EHR 관련 연구들을 다음 다섯 가지 주요 애플리케이션으로 분류하여 검토했습니다.
   - 다양한 유형의 EHR 생성 (표 형식, 시계열, 이질적)
   - 준지도 학습 및 데이터 증강
   - 결측치 보간 (Imputation of Missingness)
   - 치료 효과 추정
   - 개인 정보 보호
4. **평가 지표 및 데이터 소스 분석**: 각 애플리케이션에서 사용된 평가 지표와 의료 데이터 세트를 종합적으로 분석하고, 정량적/정성적 평가 방법을 상세히 설명합니다.
5. **과제 및 미래 방향 논의**: 검토된 내용을 바탕으로 GANs for EHRs 개발의 현재 도전 과제를 논의하고 미래 연구 방향을 제안합니다.

## 📊 Results

본 논문은 GAN을 활용한 EHR 관련 연구들을 다음과 같은 주요 범주로 분류하고 각 범주 내에서 사용된 모델, 과제, 데이터 세트, 평가 방법 등을 종합적으로 요약했습니다.

- **다양한 유형의 EHR 생성**:
  - **표 형식 EHR**: `medGAN`, `medWGAN`, `medBGAN`, `MC-medGAN`, `CorGAN`, `EMR-WGAN` 등이 이산형, 다중 범주형, 연속형 표 형식 데이터를 생성하고, 지역적 상관관계 및 훈련 안정성 개선에 기여했습니다.
  - **시계열 EHR**: `RGAN`, `RCGAN`, `SC-GAN`, `SynTEG`, `DualAAE`, `EHR-M-GAN` 등이 시계열 진단 이벤트, 약물-실험실 효과(DLE) 궤적, 환자 상태 및 약물 투여량 데이터를 생성하며 시간적 동역학을 포착합니다.
  - **이질적 EHR**: `WGAN`, `HGAN`, `EHR-M-GAN` 등이 인구통계, ICD 코드, 활력 징후 시계열 등 혼합형 EHR의 이질성을 모방하고 피처 간 종속성을 포착하는 데 중점을 두었습니다.
- **준지도 학습 및 데이터 증강**: `ehrGAN`, `SSL-GAN` 등이 클래스 불균형 및 레이블 없는 데이터 문제를 해결하기 위해 GAN 기반 데이터 증강 방법을 제안했습니다. 희귀 질환 감지 및 레이블링에 활용되었습니다.
- **결측치 보간 (Imputation of Missingness)**: `GAIN`, `Stackelberg-GAN`, `GRU-IGAN`, `E2GAN`, `MI-GAN`, `Bi-GAN` 등이 표 형식 및 시계열 EHR 데이터의 결측치를 효과적으로 보간하는 데 GAN 모델을 적용했습니다.
- **치료 효과 추정**: `GANITE`, `CWR-GAN`, `MGANITE`, `GAD`, `PSSAM-GAN` 등이 관측 데이터에서 잠재적 결과(counterfactuals)를 생성하고 교란 요인을 제어하여 개별화된 치료 효과(ITE)를 추정하는 데 활용되었습니다.
- **개인 정보 보호**: `DPGAN`, `PATE-GAN`, `AC-GAN`, `PART-GAN`, `ADS-GAN`, `HealthGAN`, `HCGAN` 등이 차등 프라이버시(Differential Privacy) 보장 또는 재식별성 최소화를 통해 개인 정보 보호를 강화한 합성 EHR 데이터 생성을 목표로 했습니다.
  - **차등 프라이버시($\epsilon$-Differentially Private) 정의**:
    $$ P(M(D*{1})\in S) \le e^{\epsilon} P(M(D*{2})\in S) $$
        여기서 $D_{1}$과 $D_{2}$는 단일 레코드만 다른 데이터 세트이며, $M$은 차등 프라이버시 알고리즘입니다.
- **평가 지표**:
  - **정량적 평가**:
    - **차원별 분포 유사성**: 차원별 확률, 평균, K-S 테스트, 지원 범위, Kullback-Leibler Divergence ($K_{KLD}$) 등을 사용합니다.
      $$ K*{KLD}(P,Q) = \int*{X} P(x)\log\frac{P(x)}{Q(x)}dx $$
    - **잠재 분포 유사성**: 잠재 공간 표현(LSR), 가중 잠재 차이, log-cluster 지표 등이 활용됩니다.
    - **결합 분포 유사성**: $K_{KLD}$, Jensen-Shannon Divergence ($J_{JSD}$), Wasserstein Distance ($W_{DDD}$), Maximum Mean Discrepancies ($M_{MMD}$), Discriminative score 등이 사용됩니다.
      $$ J*{JSD}(P,Q) = \frac{1}{2}KLD(P,M)+\frac{1}{2}KLD(Q,M) $$
            $$ W*{DDD}(P,Q) = \inf*{\gamma\in\Gamma} \int*{X\times X} \left\|x-y\right\|_{2}d\gamma(x,y) $$
            $$ M_{MMD}^2*k(P,Q):=E*{x,x'}[k(x,x')] + E*{y,y'}[k(y,y')] - 2E*{x,y}[k(x,y)] $$
    - **차원 간 관계 유사성**: 차원별 예측, Pearson 상관계수, 연관 규칙 마이닝(ARM), 빈번 연관 규칙(FAR) 등이 사용됩니다.
    - **개인 정보 보호**: 차등 프라이버시 보장, 멤버십 추론 공격, 속성 공개 공격, 모델 반전 공격, 식별성, privacy$_{loss}$, 정확 일치 테스트 등이 사용됩니다.
  - **정성적 평가**: 데이터 분포 및 임베딩 시각화, 환자 궤적 비교, 보간 테스트, 임상 전문가 평가, 제약 조건 위반 테스트 등이 이루어집니다.
- **데이터 소스**: MIMIC-III, Philips eICU, HiRID, AmsterdamUMCdb, UCI 머신러닝 저장소 데이터 세트, Kaggle, PhysioNet Challenge 데이터, SPRINT, MAGGIC, TWINs, IHDP, SEER, Nemours, UNOS 등 다양한 공개 및 비공개 EHR 데이터 세트가 활용되었습니다.

## 🧠 Insights & Discussion

- **평가 방법론의 부족**: 합성 데이터 평가를 위한 보편적인 방법론이 없어 연구 간 벤치마킹 및 SOTA 모델 결정이 어렵습니다. 연구 목적에 맞는 지표 선택과 함께 정량적/정성적 평가의 엄격한 통합이 필요합니다.
- **프라이버시-유사성 상충 관계**: GAN의 출력은 암묵적으로 프라이버시를 보호하지만, 민감한 EHR 데이터를 다룰 때는 의도치 않은 정보 유출 가능성이 존재합니다. 프라이버시와 데이터 유사성 간의 균형을 맞추는 것이 중요하며, 과도한 프라이버시 보장은 데이터 충실도와 유용성을 저해할 수 있습니다. 규제 기관과 협력하여 명확한 가이드라인을 수립해야 합니다.
- **다중 모드 및 다중 센터 EHR 생성**: EHR의 이질적인 특성과 다양한 모달리티(비정형 임상 기록, 의료 영상) 간의 상관관계를 포착하는 GAN 모델 개발이 필요합니다. 또한, 여러 기관의 데이터를 활용한 훈련은 대표성을 높이지만, 피처 불일치 및 분포 불일치 문제 해결을 위한 연구(예: 연합 학습)가 부족합니다.
- **투명한 보고 및 오픈 액세스**: 모델 가정, 하이퍼파라미터, 전처리 단계 등 훈련 방법론에 대한 투명하고 포괄적인 보고는 안전한 모델 배포와 결과 재현성을 위해 필수적입니다. 종단적 데이터 등 다양한 종류의 오픈 액세스 데이터 세트 확보 또한 중요합니다.
- **임상 애플리케이션 통합**: 의료 전문가들이 이해하기 어려운 현재의 정량적 평가 지표와 합성 데이터 간의 간극이 존재합니다. 임상의가 쉽게 이해할 수 있는 평가 방법을 개발하고, 임상의와의 공동 설계(co-design)를 통해 실제 임상 환경에서의 신뢰와 활용도를 높여야 합니다.

## 📌 TL;DR

EHR 데이터의 개인 정보 보호 및 품질 문제를 해결하기 위해 GAN이 합성 데이터 생성에 활용될 수 있음을 조명하는 종합 검토 논문입니다. 이 논문은 EHR용 GAN의 다양한 애플리케이션(데이터 생성, 증강, 보간, 치료 효과 추정, 개인 정보 보호), 평가 지표(정량적 및 정성적), 그리고 활용되는 데이터 소스들을 체계적으로 분류하고 설명합니다. 주요 논의는 평가 방법론의 표준화 부족, 프라이버시-유사성 상충 관계, 다중 모드 및 다중 센터 데이터 처리의 필요성, 투명한 보고의 중요성, 그리고 임상 적용을 위한 신뢰성 확보의 과제에 중점을 둡니다.
