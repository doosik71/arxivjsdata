# AI Readiness in Healthcare through Storytelling XAI

Akshat Dubey, Zewen Yang, Georges Hattab

## 🧩 Problem to Solve

- 인공지능(AI)의 헬스케어 분야 도입은 더디며, 주된 이유는 AI 모델의 신뢰성 부족과 의료 전문가의 모델 예측에 대한 주저함이다.
- 기존 설명 가능 인공지능(XAI) 기법들은 복잡한 AI 모델의 작동 방식을 보여주지만, 기계 학습 경험이 없는 도메인 전문가들이 이해하기에 적합하지 않다.
- 설명은 비전문가 청중의 목표, 관심사, 의사 결정 요구 사항에 맞춰 중요 데이터를 강조해야 하지만, 기존 연구는 다양한 작업을 위해 현재 사용 가능한 데이터셋을 활용하고 결합하여 청중 중심 설명을 제공하는 데 제한적이다.
- 기존 스토리텔링 XAI 프레임워크는 사용 가능한 데이터셋의 효과적인 활용 및 결합, 그리고 특정 작업을 위해 별도로 훈련된 모델에 의존하지 않고 엔드투엔드(end-to-end) 청중 중심 XAI를 달성하는 문제를 충분히 다루지 못하고 있다.

## ✨ Key Contributions

- 청중 중심 설명을 제공하기 위해 다중 작업 증류(multi-task distillation)와 해석 가능 기법을 결합한 스토리텔링 XAI 프레임워크를 개발했다.
- 이를 통해 복잡한 딥 뉴럴 네트워크도 모델 신뢰성을 해치지 않고 헬스케어 분야에서 사용될 수 있도록 한다.
- 개념 기반 설명 가능성(concept-based explainability)을 달성하여 의료 전문가에게는 인간이 이해할 수 있는 용어로, ML 전문가에게는 기술적인 해석을 제공한다.
- 모델 비의존적(model-agnostic) 및 모델 의존적(model-specific) 해석 방법을 모두 활용하고, 텍스트 정당화로 결과를 뒷받침한다.
- 다양한 출처의 다중 데이터셋을 사용하여 실제 시나리오에 더 잘 일반화되는 견고하고 일반화된 모델을 구축한다.

## 📎 Related Works

- **설명 가능 인공지능(XAI) 기법:** Local Interpretable Model-agnostic Explanations (LIME), SHapley Additive exPlanations (SHAP), GradCAM 등 기존의 포스트-혹(post-hoc) 및 시각화 기반 방법론들이 언급된다.
- **스토리텔링 XAI:** 대규모 언어 모델(LLM)을 사용하여 AI 예측을 설명하는 내러티브를 생성하는 SHAPstories 및 CFstories [9]와 내러티브를 통한 AI 시스템 설명을 탐구하는 XAINES 프로젝트 [12]가 선행 연구로 제시된다.
- **지식 증류(Knowledge Distillation):** 대규모 모델의 지식을 소규모 모델로 전이하는 개념 [13]이 본 연구의 핵심 방법론으로 활용된다.
- **다중 작업 학습(Multi-task Learning):** 여러 관련 작업을 동시에 처리하도록 모델을 훈련하는 접근 방식 [17]이 활용된다.
- **해석 가능 기법(Interpretability Techniques):** 모델 비의존적 방법(LIME, SHAP)과 모델 의존적 방법(어텐션 메커니즘, GradCAM)에 대한 일반적인 설명 및 관련 연구 [14, 18, 19]가 언급된다.

## 🛠️ Methodology

본 연구의 스토리텔링 XAI 프레임워크는 세 가지 주요 단계로 구성되며, 흉부 X-ray 분석 사용 사례에 중점을 둔다.

- **데이터셋 및 전처리:**
  - **흉부 X-ray 보고서 생성:** MIMIC-CXR-JPG [23] 및 Open-I [24] 데이터셋을 MedVill에서 전처리한 버전을 사용하며, Clinical T5 large를 통해 보고서를 요약하여 키워드 가중치를 높였다.
  - **흉부 X-ray 이상 탐지:** VinDr-CXR [27] 데이터셋의 수정 버전을 사용하여 14가지 이상을 탐지한다.
  - **폐 분할(Lung Segmentation):** Montgomery 데이터셋을 사용한다.
  - 모든 이미지는 JPEG 형식으로 변환되고, $[0, 1]$ 범위로 정규화되며, $512 \times 512$ 픽셀로 크기가 조정되었다.

- **방법론 (세 단계):**
  1. **개별 복합 딥 뉴럴 네트워크 훈련 (교사 모델):**
     - **이상 탐지 및 지역화:** ResNet50 백본의 CNN 기반 모델을 범주형 교차 엔트로피 손실과 평균 정밀도(mAP)를 사용하여 훈련한다.
     - **보고서 생성:** ResNet50 백본의 CNN-RNN-어텐션 모델을 이미지 캡셔닝 개념을 활용하여 마스크 손실로 훈련한다.
     - **이미지 분할:** 이상 탐지 모델과 동일한 백본에 마지막 레이어만 분할 작업에 맞게 수정하여 DICE 손실로 훈련한다.
  2. **지식 증류 (학생 모델):**
     - 얕은 CNN 뉴럴 네트워크를 학생 모델의 백본으로 사용하며, 여러 예측 헤드(이상 분류, 보고서 생성, 이미지 분할)를 가진다.
     - 지식 증류는 각 개별 교사 모델로부터 학생 모델의 해당 예측 헤드로 수행되며, 이 과정에서 다른 예측 헤드들은 고정(freeze)된다 (Algorithm 1 참조). 이 과정을 통해 학생 모델은 복잡한 교사 모델의 지식을 습득하여 모든 작업을 동시에 수행할 수 있게 된다.
  3. **해석 생성:**
     - 모델 비의존적 기법 (예: LIME)과 모델 의존적 기법 (예: GradCAM, GradCAM++)을 사용하여 이상 분류 및 흉부 X-ray 분할 모델의 결과를 해석한다.
     - 보고서 생성에는 어텐션 시각화 [32]를 사용하여 예측의 근거가 되는 문장의 특정 부분을 분석하고 추론한다.

## 📊 Results

- 지식 증류를 통해 훈련된 얕은 뉴럴 네트워크(학생 모델)에 흉부 X-ray 이미지를 입력했을 때, 모델은 폐를 정확하게 분할하고, 이상 탐지 모델은 침윤(infiltration), 경화(consolidation), 흉막 삼출(pleural effusion), 심비대(cardiomegaly)와 같은 영향을 받은 부위를 정확히 찾아내고 분류했다.
- 동시에, 동일한 모델이 방사선 전문의 및 의료 전문가를 위한 보고서 텍스트를 생성했다.
- LIME 해석, 생성된 보고서의 어텐션 맵 시각화, GradCAM 및 GradCAM++를 포함한 해석 가능 기법들이 성공적으로 적용되었다.
- 텍스트 정당화는 해석 가능 기법의 결과와 학생 모델의 예측을 모두 뒷받침하여 ML 전문가와 의료 전문가 모두에게 유용함을 입증했다.
- 다중 작업의 결합은 전반적인 예측 이해도를 향상시켰으며, 지식 증류를 통해 얕은 뉴럴 네트워크가 다양한 작업에 걸쳐 표현을 학습하고 해석 가능한 네트워크를 구축할 수 있음을 보여주었다.

## 🧠 Insights & Discussion

- **핵심 통찰 및 의의:**
  - 본 프레임워크는 개념 기반 설명을 통해 청중 중심의 설명 가능성을 가능하게 하여, ML 엔지니어와 헬스케어 전문가 간의 격차를 줄인다.
  - 지식 증류 덕분에 복잡한 딥 뉴럴 네트워크도 신뢰성을 해치지 않고 헬스케어 분야에서 사용될 수 있으며, 교사 모델이 아무리 복잡해도 학생 모델은 지식을 학습할 수 있다.
  - 여러 출처의 다중 데이터셋을 사용함으로써 모델이 실제 시나리오에서 더 잘 일반화되고 견고해지며, 이는 사용자 신뢰와 이해를 높인다.
  - 다중 작업 학습은 서로 다른 작업 간의 관계를 활용하여 제한된 데이터로부터도 효율적인 학습과 안정적이고 의미 있는 예측을 가능하게 한다.
- **논의점:**
  - **정보 과부하 우려:** 과도한 설명이나 정보가 오히려 이해를 방해할 수 있지만, 다양한 설명을 제공하는 것은 사용자 요구를 충족시키고 AI 모델에 대한 투명성과 신뢰를 높여 궁극적으로 만족도와 이해도를 향상시킬 수 있다.
  - **얕은 모델(shallow models) 사용 이유:** 과적합에 덜 취약하고 새로운 데이터셋에서 우수한 일반화 능력을 보이며, 특히 데이터가 제한적일 때 이점이 있다. 또한, 대부분의 해석 가능 방법이 근사 기법을 사용하므로 얕은 모델이 이러한 기준에 더 잘 부합한다.
- **한계점:**
  - 현재 사용자 인터페이스를 통한 XAI 결과와의 자유로운 상호작용 기능이 부족하다.
  - 이 프레임워크를 다른 도메인으로 확장할 때, 다양한 작업에 필요한 다양한 데이터셋을 수집하는 것이 어려울 수 있다.
  - 교사 모델에 대한 지원이 CNN 또는 RNN 기반 아키텍처로 제한되며, 트랜스포머 아키텍처의 경우 복잡성으로 인해 지식 증류 수행이 어렵다.
  - 입력이 이미지에만 국한되며, 멀티모달(multimodal) 또는 텍스트 전용 데이터에 대한 지원이 제한적이다.

## 📌 TL;DR

- **문제:** AI의 헬스케어 도입은 신뢰 부족과 비전문가에게 복잡한 XAI로 인해 제한적이다.
- **방법:** 복잡한 교사 모델로부터 얕은 학생 모델로의 다중 작업 지식 증류와 모델 비의존적(LIME) 및 모델 의존적(GradCAM, Attention) 해석 기법을 결합한 스토리텔링 XAI 프레임워크를 제안한다. 흉부 X-ray 분석(이상 탐지, 보고서 생성, 폐 분할)에 적용되었다.
- **주요 발견:** ML 전문가와 의료 전문가 간의 격차를 줄이며 청중 중심의 개념 기반 설명을 성공적으로 제공했다. 이 프레임워크는 다양한 데이터셋을 통해 견고하고 일반화된 모델을 가능하게 하며, 복잡한 딥 네트워크도 설명하여 신뢰와 이해를 증진시킨다.
