# Gaussian Grouping: Segment and Edit Anything in 3D Scenes

Mingqiao Ye, Martin Danelljan, Fisher Yu, and Lei Ke

## 🧩 Problem to Solve

최근 3D 가우시안 스플래팅(Gaussian Splatting)은 고품질 실시간 3D 장면 재구성 및 새로운 시점 합성을 가능하게 했지만, 미세한 객체 수준의 장면 이해 기능이 부족합니다. 기존 NeRF 기반 방법들은 연산 비용이 높고 최적화가 어려우며, 3D 편집 작업에 직접 적용하기 힘듭니다. 또한 2D Segment Anything Model ($\text{SAM}$)의 3D 확장도 3D 레이블의 부족과 높은 비용으로 인해 제한적이었습니다. 따라서 본 연구의 목표는 3D 장면의 외형 및 기하학적 정보 모델링을 넘어, 장면 내 모든 객체를 효과적으로 재구성하고 분할하여 다양한 3D 장면 편집 애플리케이션을 지원하는 효율적인 3D 표현을 개발하는 것입니다.

## ✨ Key Contributions

* **Gaussian Grouping 도입**: 3D 마스크 레이블 없이 $\text{SAM}$의 2D 제로샷(zero-shot) 분할 지식을 3D 장면의 '모든 것(anything)' 분할로 확장하는 최초의 3D 가우시안 스플래팅 기반 프레임워크를 제안합니다.
* **다양한 장면 편집 지원**: 제안하는 로컬 가우시안 편집(Local Gaussian Editing) 방식을 통해 3D 객체 제거, 인페인팅, 스타일 전송, 장면 재구성 등 다양한 하위 작업을 지원하며, 뛰어난 시각적 효과와 세밀한 조작성을 제공합니다.
* **고효율 학습 및 렌더링**: 빠르고 효율적인 학습 및 렌더링 프로세스를 통해 실시간 작업 요구 사항을 충족합니다.

## 📎 Related Works

* **3D 가우시안 모델**: 3D 가우시안 스플래팅 [15]은 3D 장면 재구성에서 뛰어난 성능을 보였지만, 객체/영역 수준의 의미론적 이해는 부족합니다.
* **방사장(Radiance Field) 기반 개방형 장면 이해**: 기존 $\text{NeRF}$ 기반 방법들 [16, 19, 44]은 픽셀 정렬 특징 벡터를 증류하거나 언어 필드를 학습하여 3D 의미론을 얻지만, 주로 의미 분할에 한정되며 정확한 마스크를 생성하기 어렵습니다.
* **3D에서의 SAM**: $\text{SAM}$ [17]의 2D 마스크를 3D 분할로 확장하는 연구 [4, 5, 57]가 있었으나, 대부분 단일 또는 소수의 객체에 초점을 맞춥니다.
* **방사장 기반 장면 편집**: $\text{NeRF}$ 기반 장면 편집 연구 [12, 19, 34]는 존재하지만, 복잡한 장면이나 객체 편집에 제약이 많거나 효율성이 떨어집니다.

## 🛠️ Methodology

제안하는 가우시안 그루핑(Gaussian Grouping)은 3D 가우시안 스플래팅을 확장하여 외형과 기하학적 모델링뿐만 아니라 장면의 각 인스턴스 및 사물(stuff)의 정체성을 포착합니다.

* **입력 전처리**:
  * $\text{SAM}$을 사용하여 각 다중 뷰 이미지에 대한 2D 마스크를 자동으로 생성합니다.
  * 훈련 시점 간 마스크 $\text{ID}$의 일관성을 위해 제로샷 트래커 [7]를 사용하여 마스크를 전파하고 연결하여 코히어런트한 다중 뷰 분할을 얻습니다. 이는 기존의 비용 기반 선형 할당 [44]보다 빠르고 강건합니다.
* **3D 가우시안 렌더링 및 그루핑**:
  * 각 가우시안에 새로운 파라미터인 **아이덴티티 인코딩(Identity Encoding)** (길이 16의 학습 가능한 압축 벡터)을 추가합니다.
  * 아이덴티티 인코딩의 구형 고조파($\text{SH}$) 차수는 뷰에 독립적인 인스턴스 $\text{ID}$를 모델링하기 위해 0으로 설정됩니다.
  * 미분 가능한 가우시안 렌더링을 통해 아이덴티티 인코딩을 최적화하며, 렌더링된 2D 마스크 아이덴티티 특징 $\text{E}_{\text{id}}$는 각 가우시안의 아이덴티티 인코딩 $\text{e}_{\text{i}}$의 가중치 합으로 계산됩니다:
        $$ \text{E}_{\text{id}} = \sum_{\text{i} \in \text{N}} \text{e}_{\text{i}} \alpha'_{\text{i}} \prod_{\text{j}=1}^{\text{i}-1} (1-\alpha'_{\text{j}}) $$
        여기서 $\alpha'_{\text{i}}$는 가우시안의 픽셀에 대한 영향 인자입니다.
* **그루핑 손실 ($\text{L}_{\text{id}}$)**: 두 가지 구성 요소로 이루어집니다.
  * **2D 아이덴티티 손실 ($\text{L}_{\text{2d}}$)**: $\text{E}_{\text{id}}$에 선형 레이어 $\text{f}$를 적용하여 $\text{K}$개의 클래스로 분류하고 표준 교차 엔트로피 손실로 감독합니다.
  * **3D 정규화 손실 ($\text{L}_{\text{3d}}$)**: 상위 $\text{k}$개의 가장 가까운 3D 가우시안의 아이덴티티 인코딩이 특징 공간에서 서로 가깝도록 강제하는 비지도 손실(KL 다이버전스)입니다. 이는 가려진 가우시안의 학습을 돕습니다:
        $$ \text{L}_{\text{3d}} = \frac{1}{\text{m}} \sum_{\text{j}=1}^{\text{m}} \text{D}_{\text{kl}}(\text{P}||\text{Q}) = \frac{1}{\text{mk}} \sum_{\text{j}=1}^{\text{m}} \sum_{\text{i}=1}^{\text{k}} \text{F}(\text{e}_{\text{j}}) \log \left( \frac{\text{F}(\text{e}_{\text{j}})}{\text{F}(\text{e}'_{\text{i}})} \right) $$
        여기서 $\text{F}$는 선형 레이어 $\text{f}$ 다음에 오는 소프트맥스(softmax) 연산을 포함하며, $\text{e}_{\text{j}}$는 샘플링된 3D 가우시안의 아이덴티티 인코딩이고 $\text{Q}$는 $\text{e}_{\text{j}}$의 $\text{k}$개 최근접 이웃으로 구성됩니다.
* **전체 손실**: 이미지 렌더링에 대한 기존 3D 가우시안 재구성 손실 $\text{L}_{\text{rec}}$과 그루핑 손실 $\text{L}_{\text{id}}$의 합으로 구성됩니다:
    $$ \text{L}_{\text{render}} = \text{L}_{\text{rec}} + \text{L}_{\text{id}} = \text{L}_{\text{rec}} + \lambda_{\text{2d}}\text{L}_{\text{2d}} + \lambda_{\text{3d}}\text{L}_{\text{3d}} $$
* **로컬 가우시안 편집**: 학습 후, 장면은 그룹화된 3D 가우시안으로 표현됩니다.
  * **3D 객체 제거**: 대상 가우시안 그룹을 단순히 삭제합니다.
  * **3D 장면 재구성**: 두 가우시안 그룹의 3D 위치를 교환합니다.
  * **3D 객체 인페인팅**: 객체 제거 후, 삭제 영역 근처에 새로운 가우시안을 추가하고 2D 인페인팅 결과에 따라 미세 조정합니다.
  * **3D 객체 색상 변경**: 해당 가우시안 그룹의 색상($\text{SH}$) 파라미터만 조정합니다.
  * **3D 객체 스타일 전송**: 해당 가우시안 그룹의 색상, 분산, 불투명도(필요에 따라 위치 및 크기) 파라미터를 미세 조정하며, 이미지 수준 스타일 전송 모델의 지도를 받습니다.

## 📊 Results

* **3D 분할 성능**:
  * $\text{LERF-Mask}$ 데이터셋에서 $\text{LERF}$ [16] 및 $\text{SA3D}$ [4]를 크게 능가하여 개방형 어휘 분할에서 두 배의 성능($\text{mIoU}$, $\text{mBIoU}$)을 달성했으며, 훨씬 선명하고 정확한 경계를 생성합니다.
  * $\text{Replica}$ 및 $\text{ScanNet}$ 데이터셋에서 파놉틱 분할(panoptic segmentation) 면에서 $\text{Panoptic Lifting}$ [44]보다 뛰어난 성능과 효율성(예: $\text{Replica}$에서 약 $\text{140 FPS}$ 대 $\text{10 FPS}$)을 보입니다.
  * $\text{SA3D}$가 객체 하나당 $\text{35}$분이 걸리는 데 비해, 가우시안 그루핑은 장면의 모든 객체를 $\text{9}$분 만에 분할하여 뛰어난 효율성을 보여줍니다.
  * $\text{DEVA}$ [7]의 2D 분할 오류도 3D 가우시안 표현의 공유를 통해 성공적으로 수정하는 강건함을 입증합니다.
* **재구성 품질**: 아이덴티티 인코딩을 도입하고 공동 학습해도 원래 가우시안 스플래팅의 $\text{3D}$ 재구성 품질과 속도에 미미한 영향만 미칩니다.
* **3D 장면 편집**:
  * **3D 객체 제거**: $\text{DFFs}$ [19]보다 우수하며, 대규모 객체를 배경에 아티팩트나 흐림 없이 깨끗하게 제거합니다.
  * **3D 객체 인페인팅**: $\text{SPIn-NeRF}$ [34]보다 공간적 세부사항과 다중 뷰 일관성을 더 잘 보존하며, 훨씬 빠른 학습/미세 조정 시간(1시간 + 20분 vs 5시간)을 자랑합니다.
  * **3D 객체 스타일 전송**: $\text{Instruct-NeRF2NeRF}$ [12]보다 더 일관되고 자연스러운 결과를 생성하며, 배경 영역의 세부사항을 충실히 보존합니다.
  * **다중 객체 편집**: 여러 객체에 대한 편집 작업(제거, 색상 변경 등)을 동시에 수행할 수 있으며, 각 작업이 서로 간섭하지 않습니다.
  * **정량적 편집 평가**: $\text{CLIP}$ 텍스트-이미지 방향 유사도 평가에서 인페인팅, 스타일 전송, 객체 제거 모두에서 최신 $\text{SOTA}$ 방법을 능가합니다.
* **어블레이션 연구**:
  * 마스크 교차 뷰 연결은 기존 방법보다 $\text{60}$배 빠르고 더 나은 재구성 및 분할 성능을 보입니다.
  * 아이덴티티 인코딩 차원은 $\text{16}$차원이 객체 분리 및 효율성에서 충분한 성능을 제공합니다.
  * 3D 정규화 손실의 $\text{K}$ 값은 $\text{K=5}$일 때 재구성과 객체 제거 정확도 사이에서 최적의 균형을 이룹니다. 2D와 3D 손실의 공동 감독은 "투명 곰(transparent bear)" 문제를 해결합니다.

## 🧠 Insights & Discussion

* **의미 및 시사점**: 가우시안 그루핑은 3D 가우시안의 이산적이고 그룹화된 표현을 통해 재구성뿐만 아니라 미세하고 개방형의 3D 장면 이해와 다목적 편집을 가능하게 합니다. $\text{NeRF}$와 달리 명시적인 가우시안 표현은 직접적인 객체 조작을 용이하게 합니다.
* **강점**:
  * 고품질의 시각적 재구성, 세밀한 분할, 효율적인 렌더링 및 편집이 가능합니다.
  * 고비용의 3D 레이블 없이 $\text{SAM}$의 강력한 2D 기능을 3D로 확장합니다.
  * $\text{NeRF}$ 기반 방법에 비해 훨씬 빠른 학습 및 렌더링 속도를 제공합니다.
  * 장면의 분리된 표현 덕분에 효율적인 로컬 편집이 가능하며, 대부분의 가우시안을 고정하여 여러 객체를 동시에 편집할 수 있습니다.
  * 2D 마스크 입력 오류에 대해서도 강건합니다.
* **한계점**:
  * 현재 정적인 3D 장면에 한정되며, 동적 모델링 기능이 부족합니다.
  * $\text{SAM}$의 '모든 것 마스크'는 직접적인 의미론적 언어 정보가 없으므로 $\text{Grounding-DINO}$ [26]와 같은 추가 모델에 의존합니다. 이는 복잡한 프롬프트에서 잘못된 마스크 예측으로 이어질 수 있습니다.
  * $\text{DEVA}$ [7]와 같은 제로샷 2D 연결의 정확도가 3D 분할 성능에 영향을 미칠 수 있습니다.
  * 향후 완전 비지도(unsupervised) 3D 가우시안 그루핑 연구가 필요합니다.

## 📌 TL;DR

이 논문은 3D 가우시안 스플래팅을 확장한 **가우시안 그루핑(Gaussian Grouping)**을 제안합니다. 이는 기존 3D 재구성 모델들이 부족했던 미세한 객체 수준의 장면 이해와 효율적인 편집 기능을 제공합니다. 각 3D 가우시안에 **아이덴티티 인코딩(Identity Encoding)**을 부여하고, $\text{SAM}$의 2D 마스크와 3D 공간 일관성을 활용하여 학습합니다. 이를 통해 **고품질 3D 재구성, 개방형 '모든 것' 분할, 그리고 객체 제거, 인페인팅, 스타일 전송 등 다양한 3D 장면 편집 작업을 빠르고 효과적으로 수행**할 수 있음을 보여줍니다.
