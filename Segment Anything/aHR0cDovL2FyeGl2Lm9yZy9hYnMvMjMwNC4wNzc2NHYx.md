# DEEP LEARNING UNIVERSAL CRATER DETECTION USING SEGMENTANYTHINGMODEL(SAM)

Iraklis Giannakis, Anshuman Bhardwaj, Lydia Sam and Georgios Leontidis

## 🧩 Problem to Solve

행성 탐사에서 운석구(크레이터)를 탐지하고 매핑하는 것은 행성 과학에서 매우 중요한 과정입니다. 그러나 기존에는 주로 수동으로 수행되어 노동 집약적이고 시간이 많이 소요되며, 최대 40%의 불일치가 발생하는 등 인적 오류에 취약했습니다. 또한, 기존의 머신러닝(ML) 기반 크레이터 탐지 방법들은 특정 유형의 데이터(예: DEM, LROC 이미지 등)에 대해 훈련되어 다른 데이터 소스, 각도, 행성 또는 설정에서는 신뢰도가 떨어지는 한계가 있었습니다. 이 논문은 데이터 유형, 측정 설정 또는 천체에 구애받지 않고 보편적으로 크레이터를 탐지할 수 있는 알고리즘의 필요성을 제기합니다.

## ✨ Key Contributions

* META AI의 Segment Anything Model (SAM)을 기반으로 하는 **범용 크레이터 탐지 체계**를 제안합니다.
* 추가 훈련 없이 낯선 객체와 이미지에 대해 **제로샷(zero-shot) 일반화** 능력을 통해 다양한 데이터 유형(위성 이미지, DEM 등), 천체(달, 화성, 포보스), 캡처 각도에서 크레이터 같은 객체를 성공적으로 식별합니다.
* SAM이 생성한 세그멘테이션 마스크 중 **원형 또는 타원형 모양 인덱스**를 사용하여 크레이터와 유사한 특징만 선별하는 방법을 도입합니다.
* 선별된 마스크에 **타원을 피팅**하여 탐지된 크레이터의 위치 및 크기/기하학적 정보를 복구합니다.
* 행성 과학에서 단일하고 보편적인 크레이터 탐지 알고리즘(CDA)의 기반을 마련하고, SAM을 행성 데이터의 패턴 인식을 위한 효과적인 도구로 제시합니다.

## 📎 Related Works

* **수동 매핑:** 기존의 크레이터 탐지 방식이었으나, 시간 소모적이고 확장성이 떨어지며 오류가 많았습니다.
* **반자동 크레이터 탐지 알고리즘(CDA):** 수동 매핑의 한계를 극복하기 위해 개발되었습니다.
* **다양한 ML 및 컴퓨터 비전 방법:**
  * Canny 엣지 탐지와 결합된 컨볼루션 신경망(CNN) [15].
  * 하이브리드 지도-비지도 머신러닝 [9].
  * Adaboost와 서포트 벡터 머신(SVM) [16].
  * U-Net (화성 익스프레스 미션 사진 [19], 화성 지형 데이터 [20], 달 DEM [13], LROC 사진 [10], 창어 1/2호 데이터 [7] 등 특정 데이터에 훈련).
* **분류:** 이미지 기반 및 디지털 고도 모델(DEM) 기반 접근 방식 [17, 18].
* **이전 ML 방법의 한계:** 특정 훈련 데이터에만 의존하여 다른 천체나 데이터 유형에는 신뢰성이 떨어졌습니다.
* **기초 모델(Foundation Models):** 최근 컴퓨터 비전 분야의 발전으로, 특히 META AI의 SAM [21]은 방대한 데이터로 훈련되어 제로샷 일반화 능력을 보여주며 이 논문의 핵심 요소입니다.

## 🛠️ Methodology

이 논문에서 제안하는 크레이터 탐지 파이프라인은 세 가지 주요 단계로 구성됩니다.

1. **SAM(Segment Anything Model)을 이용한 이미지 세그멘테이션:**
    * **입력:** 천체, 데이터 유형, 해상도 등에 제한 없이 모든 종류의 이미지 데이터(사진, DEM, 스펙트럼, 중력 등)를 입력으로 사용합니다.
    * SAM은 입력 이미지를 다양한 형태학적 특징으로 분할하여 세그멘테이션 마스크를 생성합니다.
    * SAM의 출력에는 세그멘테이션 마스크, 마스크의 픽셀 면적, 바운딩 박스, 마스크의 품질 및 안정성 점수 등이 포함됩니다.

2. **모양 분석 및 필터링:**
    * **원형-타원형 지수 계산:** 각 세그멘테이션 마스크에 대해 다음 지수를 계산합니다.
        * 원형 지수 $n$: 마스크의 면적($A$)으로부터 추정된 원의 둘레 $d = 2\pi\sqrt{A/\pi}$와 실제 마스크 둘레 $P$의 비율 $n = d/P$. 원형에 가까우면 $n \approx 1$입니다.
        * 타원형 주축 비율 $m$: 마스크에 피팅된 타원의 장축 $a$와 단축 $b$의 비율 $m = a/b$. 원형이면 $m \approx 1$입니다.
        * 타원형 지수 $q$: 피팅된 타원의 면적 $w = \pi ab$와 실제 마스크 면적 $A$의 비율 $q = w/A$. 타원형에 가까우면 $q \approx 1$입니다.
    * **임계값 적용:** $n \approx 1 \pm T$, $m \approx 1 \pm T$ (원형의 경우), $q \approx 1 \pm T$ (타원형의 경우)와 같은 조건을 사용하여 마스크를 원형 또는 타원형으로 분류합니다. 임계값 $T$는 데이터 유형에 따라 $0.1$에서 $0.5$ 사이로 조정될 수 있습니다.
    * 원형-타원형으로 분류되지 않은 마스크는 필터링하여 제거합니다.

3. **크레이터 피팅 및 후처리:**
    * 필터링을 통해 남은 마스크에 대해 Canny 필터를 적용하여 엣지를 추출합니다.
    * 마스크의 분류(원형 또는 타원형)에 따라 엣지에 원 또는 타원을 피팅하여, 각 크레이터의 장/단축($a, b$) 및 중심 좌표를 추출합니다.
    * **후처리 필터:** 중복되거나, 인공물(artefacts), 잘못된 양성(false positives)을 제거하기 위한 추가 필터를 적용합니다. 예를 들어, 너무 길쭉한 타원형 특징은 제거하고, 중심이 유사한 크레이터를 필터링하여 중앙 봉우리가 크레이터로 오인되는 것을 방지할 수 있습니다.

## 📊 Results

* **보편성 입증:** 제안된 SAM 기반 CDA는 특정 데이터나 천체에 대한 추가 훈련 없이도 달, 화성, 포보스 등 다양한 천체와 여러 유형의 데이터(DEM, LROC, HRSC, THEMIS, HiRISE, MRO 등)에서 크레이터를 성공적으로 탐지하고 매핑했습니다.
* **화성 데이터:** Mars Express HRSC 자연색 이미지에서 주요 특징들을 포착하고, 비전통적인 길쭉한 타원형 크레이터까지 정확하게 식별했습니다. 해상도 제약으로 인해 작은 크레이터는 누락될 수 있지만, 이미지 확대 시 올바르게 탐지되었습니다.
* **달 데이터:** DEM과 LROC 고해상도 경사 이미지에서도 크레이터 크기를 합리적으로 정확하게 추정했습니다. 이는 탐사선 카메라를 이용한 실시간 탐지 가능성을 시사합니다.
* **포보스 데이터:** 독특한 유형의 MRO 위성 거짓색(false-color) 이미지에서도 대부분의 크레이터를 최소한의 오탐 및 미탐으로 성공적으로 식별했습니다.
* **관찰된 한계:**
  * **해상도 제약:** 작은 크레이터는 해상도 문제로 누락될 수 있습니다 (확대 시 해결 가능).
  * **오탐(False Positives):** 일부 크레이터의 중앙 봉우리, 그림자, 원형의 고지대 지형 등이 원형/타원형이라는 이유로 크레이터로 잘못 식별되는 경우가 발생했습니다. 특정 임계값을 통해 제거할 수 있으나, 이는 실제 길쭉한 크레이터를 놓칠 가능성도 있습니다.
  * **미탐(False Negatives):** 탐지된 크레이터와 유사한 특징을 가진 일부 실제 크레이터가 누락되는 예측 불가능한 행동도 관찰되었습니다.
  * **임계값 튜닝:** 기하학적 지수(circularity/ellipticity index)의 임계값 $T$는 데이터 유형과 품질에 따라 조정해야 하며, 이는 오탐 및 미탐 간의 균형 문제가 발생할 수 있습니다.

## 🧠 Insights & Discussion

* **의미:** SAM 기반 CDA는 크레이터 탐지에 있어 보편적이고 제로샷 접근 방식을 제공하여, 기존 ML 방법의 데이터 특정적 한계를 극복하고 수동 작업을 크게 줄일 수 있음을 보여주었습니다. 이는 기초 모델이 행성 과학에서 일반적인 패턴 인식 도구로 활용될 가능성을 제시합니다.
* **장점:**
  * **보편성:** 다양한 천체, 데이터 유형 및 측정 설정에서 작동합니다.
  * **제로샷 일반화:** 새로운 영역에 대한 추가 훈련이나 레이블링된 데이터가 필요 없습니다.
  * **효율성:** 수고로운 수동 프로세스를 자동화합니다.
* **한계:**
  * **일반적인 모양 탐지:** SAM은 일반적인 모양 탐지기이므로, 크레이터가 아닌 원형/타원형 특징(예: 중앙 봉우리, 그림자, 고지대)을 오탐할 수 있습니다.
  * **임계값 튜닝:** 기하학적 지수의 임계값($T$)은 데이터에 따라 조정해야 하며, 이는 오탐과 미탐 사이의 트레이드오프를 야기할 수 있습니다.
  * **해상도 의존성:** 낮은 해상도에서는 작은 크레이터가 누락될 수 있습니다.
  * **예기치 않은 동작/불안정성:** 일부 유사한 크레이터가 탐지되지 않는 경우가 관찰되어 추가 연구가 필요합니다.
* **향후 연구:**
  * 오탐 및 미탐을 처리하기 위한 보다 정교한 필터나 후처리 기법을 추가할 수 있습니다.
  * **전이 학습(transfer learning)을 통한 SAM 미세 조정:** SAM을 기초 모델로 사용하여 다양한 천체와 행성 데이터 유형으로 구성된 잘 레이블링된 데이터셋으로 추가 훈련시킴으로써 SAM의 핵심 기능과 도메인 지식을 결합하여 보다 견고하고 정확한 CDA를 개발할 수 있을 것입니다.

## 📌 TL;DR

이 논문은 Meta AI의 Segment Anything Model (SAM)을 활용하여 행성 크레이터 탐지를 위한 범용 딥러닝 접근 방식을 제안합니다. 기존 수동 크레이터 매핑의 노동 집약성과 기존 ML 방법의 데이터 종속적 한계를 해결하는 것이 주요 목표입니다. 제안된 방법은 먼저 SAM을 사용하여 모든 행성 이미지에서 제로샷 세그멘테이션을 수행한 다음, 원형/타원형 모양 인덱스로 마스크를 필터링하고, 마지막으로 타원을 피팅하여 크레이터를 식별하고 측정합니다. 결과는 달, 화성, 포보스 등 다양한 천체의 여러 데이터 유형에서 SAM의 보편성을 보여주며 자동화 수준을 크게 향상시킵니다. 효과적이지만 오탐/미탐 및 해상도 의존성과 같은 한계가 있어, 향후 도메인별 전이 학습을 통한 SAM 미세 조정이 필요함을 시사합니다.
