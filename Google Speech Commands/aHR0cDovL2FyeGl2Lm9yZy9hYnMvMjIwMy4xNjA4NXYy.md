# 시간 도메인, 주파수 도메인, 켑스트럼 도메인 음향 특징의 음성 명령 분류를 위한 결합
Yikang Wang, Hiromitsu Nishizaki

## 🧩 Problem to Solve
음성 관련 분류 작업에서 주로 사용되는 주파수 도메인 특징(예: FBANK)과 켑스트럼 도메인 특징(예: MFCC) 외에도, 비음성 또는 약한 음성 관련 사운드 분류에는 시간 도메인 특징이 효과적일 수 있습니다. 기존 연구에서 제안된 시간 도메인 이진 음향 특징인 BSR(Bit Sequence Representation)은 MFCC에 비해 환경음 탐지에서 우수한 성능을 보였으나, 부동 소수점 값을 다룰 때 반올림 오차가 발생하는 문제가 있었습니다. 본 논문은 시간 도메인, 주파수 도메인, 켑스트럼 도메인 특징들이 서로 보완적인 관계에 있을 것이라는 가설을 설정하고, 이를 실험적으로 증명하여 다양한 노이즈 조건에서 음성 명령 분류의 정확도를 향상시키는 것을 목표로 합니다.

## ✨ Key Contributions
*   부동 소수점 값을 더 정밀하게 표현하기 위해 기존 BSR 특징을 개선한 **BSR-float16**을 제안했습니다.
*   서로 다른 도메인의 특징들 간의 보완성을 입증하기 위해 사후 확률 기반 점수 결합 방법을 사용하는 간단한 특징 융합 실험을 설계했습니다.
*   다양한 SNR(Signal-to-Noise Ratio) 조건에서 추출된 여러 음향 특징들의 분류 정확도와 점수 융합 후의 정확도를 비교하여, 다른 도메인의 특징들이 노이즈 강건성 측면에서도 보완적임을 보였습니다.

## 📎 Related Works
*   **전통적인 ASR 시스템:** HMM(Hidden Markov Model) 및 GMM(Gaussian Mixture Models) 기반 시스템에서는 주로 MFCC(Mel-frequency cepstral coefficients) [3, 4, 5]와 같은 지각적 증거에 기반한 음향 특징을 사용했습니다.
*   **DNN 기반 ASR 시스템:** 딥 뉴럴 네트워크(DNN) 기술의 발전과 함께 고차원 특징이 모델 복잡도에 미치는 영향이 줄어들면서 log Mel-filter bank coefficients (FBANK) [13, 14, 15]가 더 자주 사용됩니다.
*   **시간 도메인 특징의 활용:** 스피커 식별 [16, 17], 환경음 탐지 [18, 19], 화자 외적(paralinguistic) 분류 [20, 21]와 같은 음성 외 다른 오디오 분류 작업에서는 모든 음향 정보를 보존하는 원시 파형(raw waveform)이 선호됩니다 [22, 23, 24].
*   **기존 BSR 연구:** 이전 연구 [25, 26]에서 원시 파형 정보를 보존하고 2차원으로 확장한 시간 도메인 음향 특징인 BSR을 제안했으며, 환경 이벤트 인식에서 MFCC보다 우수한 성능과 강건성을 입증했습니다.

## 🛠️ Methodology
1.  **BSR-float16 특징 추출:**
    *   기존 BSR-int16이 부동 소수점 값 처리 시 발생하는 반올림 오차 문제를 해결하기 위해, IEEE 754 하프 정밀도 이진 부동 소수점 형식(float16)을 따라 정규화된 부동 소수점 샘플 값을 16비트 이진 시퀀스로 변환합니다.
    *   $$ \text{value} = (-1)^{\text{sign}} \times 2^{(E-15)} \times (1 + \sum_{i=1}^{10} b_{10-i} 2^{-i}) $$
        여기서 $\text{sign}$은 부호 비트 값, $E$는 지수 부분의 십진수 값, $b_j$는 $j$-번째 비트의 이진 값입니다.
    *   원래 1차원 파형(시간 길이 T)을 $T \times 16$ 형태의 2차원 특징으로 확장하며, 본 연구에서는 이를 "비트 펄스 파형(bit-pulse waveform)"으로 간주하여 분류 모델의 입력 채널로 사용합니다.
2.  **다른 특징 추출:**
    *   **Raw Waveform:** 16kHz 샘플링 레이트의 1초 PCM 파형(16,000 샘플)을 직접 사용합니다.
    *   **FBANK:** 전처리된 신호의 STFT(Short-Term Fourier Transform) 기반으로 멜 필터 뱅크를 적용하여 120차원 특징(39개 FBANK 특징, 1개 에너지 특징, 이들의 델타 및 더블 델타)을 추출합니다.
    *   **MFCC:** FBANK에 DCT(Discrete Cosine Transform)를 적용하여 39차원 특징(12개 정적 MFCC 특징, 1개 에너지 특징, 이들의 델타 및 더블 델타)을 추출합니다.
3.  **모델 아키텍처:** DCASE2020 Task1의 Trident ResNet 모델 구조를 참조하여, 각 특징에 최적의 분류 성능을 얻도록 모델 깊이와 파라미터를 조정했습니다. Raw waveform과 BSR-float16은 25개의 합성곱(Convolutional) 레이어, FBANK는 9개, MFCC는 11개의 합성곱 레이어로 구성된 ResNet 모델을 사용했습니다.
4.  **백엔드 점수 융합:**
    *   각 특징으로 개별 분류 모델을 훈련한 후, 테스트 결과 점수(posterior probabilities)를 선형 결합합니다.
    *   $Y_{fus} = \operatorname{argmax}(\sum_{i=1}^{n} \omega_i f_i(X))$
        여기서 $n$은 특징의 수, $f_i(X)$는 $i$-번째 특징에 해당하는 모델의 출력 확률 분포이며, $\omega_i$는 가중치($1/n$로 균등 배분)입니다.

## 📊 Results
*   **단일 특징 성능:** BSR-float16은 MFCC, FBANK, Raw Waveform과 비교했을 때 깨끗한 음성 데이터에서 경쟁력 있는 분류 정확도를 보였습니다.
*   **특징 간 보완성:**
    *   깨끗한 오디오 파일 및 환경 배경 노이즈(background noise) 조건에서는 BSR-float16, FBANK, MFCC의 조합이 최종 분류 정확도를 크게 향상시켰습니다. 이는 시간 도메인, 주파수 도메인, 켑스트럼 도메인 음향 특징들이 높은 보완성을 가짐을 증명합니다.
    *   혼동 행렬(confusion matrix) 분석 결과, BSR-float16과 FBANK는 다른 단어 인식 경향을 보이며 서로 다른 오류 패턴을 나타내어 보완성을 시사합니다.
*   **노이즈 강건성:**
    *   대부분의 경우 점수 융합 후 노이즈 강건성이 향상되었습니다.
    *   백색 노이즈(white noise) 및 핑크 노이즈(pink noise) 조건에서는 FBANK와 BSR-float16만 결합해도 좋은 성능을 얻을 수 있었는데, 이는 이 합성 노이즈 조건에서 MFCC가 다른 두 특징에 비해 보완성이 낮음을 시사합니다.
*   **정확도 향상:** 단일 특징 대비 점수 융합 후 분류 정확도가 2.17pt에서 4.54pt까지 향상되었습니다.

## 🧠 Insights & Discussion
*   이 연구는 시간, 주파수, 켑스트럼 도메인 특징들이 음성 명령 분류에서 상호 보완적이라는 중요한 통찰을 제공합니다. 특히 BSR-float16과 같은 시간 도메인 특징이 다른 도메인 특징들과 결합될 때 시너지를 발휘하여 분류 성능을 크게 향상시킬 수 있음을 입증했습니다.
*   단순한 선형 점수 융합 방법을 사용했음에도 불구하고, 깨끗한 환경 및 실제 환경 노이즈 상황에서 상당한 정확도 개선을 달성했습니다. 이는 각 특징이 음성의 다른 측면을 포착하며, 이들이 결합될 때 더욱 강건하고 정확한 표현을 제공한다는 것을 의미합니다.
*   합성 노이즈(백색/핑크 노이즈) 조건에서 MFCC의 보완성이 낮게 나타난 점은 노이즈 유형에 따라 특징들의 보완 관계가 달라질 수 있음을 시사하며, 이는 향후 연구에서 특정 노이즈 조건에 최적화된 특징 융합 전략을 탐색할 필요성을 제기합니다.
*   BSR-float16이 원시 파형 정보를 완전히 표현할 수 있다는 점은 스피커 인식과 같이 더 많은 화자 외적(paralinguistic) 정보가 필요한 미래 연구에 유용하게 활용될 수 있음을 시사합니다.
*   이 연구는 특징 도메인 간의 보완성이 다른 작업에도 일반화될 수 있는지에 대한 추가적인 탐구의 필요성을 제기합니다.

## 📌 TL;DR
음성 명령 분류의 정확도 향상을 위해 시간(BSR-float16), 주파수(FBANK), 켑스트럼(MFCC) 도메인의 음향 특징들을 결합하는 방법을 제안합니다. 특히, 부동 소수점 값 표현의 정밀도를 높인 새로운 BSR-float16 특징을 개발했습니다. 각 특징으로 훈련된 모델의 사후 확률 점수를 선형 융합한 결과, 깨끗한 환경 및 실제 환경 노이즈 조건에서 단일 특징 대비 분류 정확도가 최대 4.54pt 향상되어, 이질적인 특징들 간의 강력한 보완성을 입증했습니다. 이는 다양한 도메인의 음향 특징을 함께 활용함으로써 음성 인식 시스템의 성능과 노이즈 강건성을 효과적으로 개선할 수 있음을 시사합니다.