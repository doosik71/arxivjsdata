# Confidence Calibration in Vision-Language-Action Models

Thomas Zollo, Richard Zemel

## 🧩 Problem to Solve

로봇이 신뢰할 수 있는 행동을 하기 위해서는 높은 작업 성공률뿐만 아니라, 성공 가능성을 얼마나 신뢰할 수 있는지 정확하게 정량화할 수 있어야 합니다. 시각 관측과 자연어 지침을 저수준 로봇 동작 명령으로 변환하는 시각-언어-액션(VLA) 파운데이션 모델은 최근 로봇 공학에서 중요한 역할을 하고 있지만, 이러한 모델의 불확실성 정량화(uncertainty quantification) 능력은 충분히 탐구되지 않았습니다. 특히 VLA 모델이 잘 보정(calibrated)되었는지, 보정이 작업 진행에 따라 어떻게 변화하는지, 그리고 미보정(miscalibration)을 어떻게 개선할 수 있는지에 대한 기본적인 질문들이 해결되지 않은 상태입니다.

## ✨ Key Contributions

- **작업 성공률 대 보정 벤치마킹**: VLA 모델의 작업 성공률과 보정 오류 간의 관계를 여러 데이터셋과 VLA 변형 모델에 걸쳐 종합적으로 평가하여, 작업 성능이 좋을수록 보정 또한 우수하다는 것을 발견했습니다. 이는 작업 성능과 보정이 상충 관계에 있지 않음을 시사합니다.
- **프롬프트 앙상블 도입**: 의미론적으로 동등한 여러 지침 재구성(paraphrased instructions)에 걸쳐 VLA의 신뢰도를 평균화하는 가벼운 베이지안 기반 알고리즘인 프롬프트 앙상블을 제안했습니다. 이 방법은 일관되게 보정을 개선하여 기대 보정 오류(ECE)를 평균 20% 이상 감소시켰습니다.
- **작업 시간 범위에 따른 보정 분석**: 작업 시간 범위에 따른 보정 변화를 분석한 결과, 작업이 어느 정도 진행된 후에 신뢰도가 가장 높은 경우가 많다는 것을 발견하여, 위험을 인지한 개입을 위한 자연스러운 지점을 제시했습니다.
- **액션 차원별 스케일링**: 다양한 액션 차원 간에 차등적인 미보정(differential miscalibration)이 발생함을 밝히고, 각 액션 차원을 독립적으로 재보정하여 더 나은 신뢰도 추정치를 생성하는 액션 차원별 Platt 스케일링 방법을 제안했습니다.

## 📎 Related Works

- **신뢰도 보정(Confidence Calibration)**: 모델의 예측 확률이 실제 예측이 맞을 확률을 반영하는 정도를 의미합니다. 기대 보정 오류(ECE), 브라이어 점수(Brier Score), 음의 로그 우도(NLL) 등의 측정 지표를 사용하며, Platt 스케일링, 온도 스케일링(temperature scaling), 히스토그램 비닝(histogram binning)과 같은 사후 재보정(post-hoc recalibration) 방법론이 있습니다 (Guo et al., 2017; Platt, 1999). 앙상블 기법(Lakshminarayanan et al., 2017)과 드롭아웃(Gal and Ghahramani, 2016)도 보정 개선에 사용됩니다.
- **시각-언어-액션 모델(Vision-Language-Action Models)**: 시각 데이터와 자연어 지시를 입력으로 받아 로봇 액션을 출력하는 모델입니다 (Black et al., 2024; Kim et al., 2025; Zitkovich et al., 2023). 대규모 멀티모달 사전 학습을 활용하여 폭넓은 의미론적 및 시각운동적 사전 지식을 활용하지만, 액션 시퀀스의 불확실성을 신뢰성 있게 정량화하는 메커니즘이 부족합니다.
- **LLM의 보정(Calibration in LLMs)**: LLM의 신뢰도 추정에는 LLM에게 객관식 질문을 하거나(Kadavath et al., 2022), 모델의 텍스트 출력으로 신뢰도를 직접 표현하거나(Tian et al., 2023), 동일한 쿼리에 대해 여러 샘플 출력 간의 의미론적 일관성을 측정하는 방법(Kuhn et al., 2023) 등이 있습니다. 그러나 이러한 방법은 로봇 공학의 VLA 설정에 적용하기 어렵습니다.
- **로봇 공학의 불확실성 정량화(Uncertainty Quantification in Robotics)**: 확률론적 로봇 공학(probabilistic robotics) 분야에서 오래도록 연구되어 왔으며 (Thrun et al., 2005), 최근에는 제어 시스템의 모델 앙상블(Chua et al., 2018), 불확실성 기반 능동 탐색(Wang et al., 2024), 컨포멀 방법(conformal methods) 등이 연구됩니다.

## 🛠️ Methodology

본 연구에서는 VLA 정책의 신뢰도 보정 문제를 정식화하고, 미보정을 측정하는 표준 지표를 정의하며, 관찰된 미보정에 대한 두 가지 가벼운 해결책을 제시합니다.

- **신뢰도 정의**: 완벽하게 보정된 예측기는 $P(Y=1|C=c) = c$를 만족합니다. 여기서 $Y$는 작업 성공의 이진 지표, $C$는 로봇 정책이 보고한 신뢰도입니다.
- **베이스라인 신뢰도 추정**: OpenVLA와 RT-2 같은 많은 VLA는 로봇 액션 공간의 $D$개 차원 각각에 대해 이산 토큰 분포를 출력합니다. 각 차원 $d$에서 선택된 토큰에 할당된 확률을 사용하여 신뢰도 신호를 얻고, 이를 평균하여 단일 신뢰도 추정치 $c_t$를 계산합니다:
  $$c_t = \frac{1}{D} \sum_{d=1}^{D} \max_k p_{t,k}^{(d)}$$
- **보정 측정 지표**:
  - **기대 보정 오류 (ECE)**: $M$개의 빈(bin)으로 나누어 예측된 신뢰도와 실제 정확도 간의 차이를 측정합니다.
    $$\hat{\text{ECE}}_q = \left( \sum_{m=1}^{M} \frac{|B_m|}{N} |\text{acc}(B_m) - \text{conf}(B_m)|^q \right)^{1/q}$$
  - **브라이어 점수 (Brier Score)**: 예측 확률과 실제 결과 간의 평균 제곱 오차를 측정하는 적절한 점수 규칙(proper scoring rule)입니다.
    $$\text{BS} = \frac{1}{N} \sum_{i=1}^{N} (c_i - y_i)^2$$
  - **음의 로그 우도 (NLL)**: 높은 신뢰도로 잘못된 예측을 했을 때 더 큰 페널티를 부여하는 또 다른 적절한 점수 규칙입니다.
    $$\text{NLL} = -\frac{1}{N} \sum_{i=1}^{N} [y_i \log c_i + (1-y_i) \log (1-c_i)]$$
- **프롬프트 앙상블 (Prompt Ensembles)**:
  1. 보조 LLM을 사용하여 원본 지침의 $r$개 의미론적으로 동등한 재구성 $L_{\text{alt}}$을 생성합니다.
  2. 각 재구성된 지침 $l_{\text{alt}}^{(i)}$에 대해 베이스라인 방법으로 신뢰도 $c_t^{(i)}$를 추정합니다.
  3. 최종 신뢰도 추정치를 앙상블 평균으로 집계합니다: $c_t^{\text{ens}} = \frac{1}{r} \sum_{i=1}^{r} c_t^{(i)}$.
- **액션 차원별 스케일링 (Action-Wise Scaling)**:
  - 각 액션 차원 $d$에 대해 독립적인 아핀 변환 $g(c) = \sigma(\alpha c + \beta)$을 학습하여 Platt 스케일링을 적용합니다.
  - 재보정된 신뢰도 $\tilde{c}_t$는 각 차원의 변환된 신뢰도를 평균하여 계산됩니다:
    $$\tilde{c}_t = \frac{1}{D} \sum_{d=1}^{D} \sigma \left( \alpha_d \max_k p_{t,k}^{(d)} + \beta_d \right)$$
  - 이는 표준 Platt 스케일링과 달리 각 액션 차원의 고유한 미보정 문제를 해결하고자 합니다.

## 📊 Results

- **보정과 작업 성공률의 관계**: LIBERO 벤치마크의 세 가지 작업 스위트(Spatial, Object, Goal)와 OpenVLA 모델의 세 가지 변형(풀 정밀도, 8비트 양자화, 4비트 양자화)에 대한 실험 결과, 작업 오류율이 낮을수록(즉, 작업 성공률이 높을수록) 보정 오류가 낮아지는 일관된 경향을 보였습니다. 이는 다른 딥러닝 분야의 발견과 일치하며, VLA의 작업 성능 향상이 보정 개선으로 이어질 수 있음을 시사합니다.
- **프롬프트 앙상블의 효과**: 프롬프트 앙상블("Reprompt") 방법은 모든 모델, 데이터셋, 측정 지표(ECE$_1$, ECE$_2$, Brier score, NLL)에서 보정 오류를 일관되게 감소시켰습니다. ECE는 최대 40%까지, 평균적으로 20% 이상 감소했으며, Brier score와 NLL은 평균 5-10% 개선을 보였습니다. 이는 프롬프트 앙상블이 신뢰도 추정의 분산을 줄이는 데 효과적임을 보여줍니다.
- **작업 시간 경과에 따른 보정**: 작업 완료율 0%부터 약 50%까지 보정이 급격히 개선된 후, 보정 오류가 안정화되거나 다시 증가하는 경향을 보였습니다. 성공한 시도와 실패한 시도 간의 평균 신뢰도 차이는 작업 완료율 약 50% 지점에서 가장 컸습니다. 이는 로봇이 추가 정보를 수집한 후 중반에 더 신뢰할 수 있는 신뢰도 추정치를 제공할 수 있음을 의미하며, 위험 인지 개입을 위한 자연스러운 지점을 제시합니다.
- **액션 차원별 보정**: VLA가 예측하는 7가지 액션 차원(예: 카르테시안 변위, 회전, 그리퍼 토글) 간에 ECE$_1$이 최대 5배까지 차이가 나는 등 상당한 차등적 미보정을 확인했습니다. 액션 차원별 Platt 스케일링은 전역(global) Platt 스케일링 및 온도 스케일링보다 일관되게 보정 오류를 낮추었으며, 일부 경우 ECE를 20% 이상 개선했습니다. 이는 각 액션 차원을 독립적으로 재보정하는 것이 효과적임을 보여줍니다.

## 🧠 Insights & Discussion

본 연구는 VLA 모델의 신뢰도 보정에 대한 초기 답변을 제공합니다. 첫째, 작업 성능이 좋을수록 보정 오류가 낮아져, 작업 성능 최적화와 신뢰할 수 있는 신뢰도 추정이 상충 관계에 있지 않음을 발견했습니다. 이는 VLA 개발 시 두 가지 목표를 동시에 추구할 수 있음을 의미합니다. 둘째, 재구성된 자연어 지침 앙상블을 사용하는 훈련 없는(zero-training) 알고리즘이 ECE를 크게 줄여, 미보정의 일부가 언어 채널의 고분산 노이즈임을 시사합니다. 이는 지각적 섭동(perceptual perturbation)을 통한 신뢰성 있는 액션 예측의 가능성을 강조합니다. 셋째, 미보정이 시간과 액션 차원에 따라 균일하지 않다는 것을 발견했으며, 시간 범위 인지 모니터링 및 액션 차원별 Platt 스케일링과 같은 적응형 사후 보정 방법이 이러한 구조를 활용할 수 있음을 보여주었습니다.

본 연구의 한계점은 OpenVLA를 LIBERO 시뮬레이터에서만 사용했다는 점입니다. 이는 안정적인 보정 추정을 위해 필요한 통제된 환경과 수백 번의 롤아웃을 가능하게 하지만, 실제 세계의 센서 노이즈, 지연, 마모 등 물리적 요인이 신뢰도 보정에 미치는 영향을 정확히 모델링할 수 없습니다.

향후 연구는 다른 환경, 로봇 구현체, VLA 아키텍처(확산 기반 플래너, 연속 회귀 헤드 등)에 대한 신뢰도 보정 벤치마킹을 포함할 수 있습니다. 지침 재구성을 넘어 합성 조명 변화나 무작위 방해물 삽입과 같은 섭동 기법을 탐색하여 새로운 멀티모달 앙상블 기법을 개발할 수도 있습니다. 궁극적으로, 이러한 모델을 신뢰할 수 있는 실제 로봇 시스템의 핵심으로 만들기 위해서는 VLA의 보정에 대한 풍부한 연구가 필요합니다.

## 📌 TL;DR

VLA 모델의 신뢰도 보정에 대한 최초의 체계적인 연구로, **작업 성공률이 높을수록 보정 오류가 낮아진다**는 것을 밝혀 성능과 신뢰도 간의 상충 관계가 없음을 입증했습니다. 또한, **프롬프트 앙상블**을 통해 신뢰도 추정의 분산을 줄여 기대 보정 오류를 평균 20% 이상 개선했으며, **작업 진행 중반(약 50% 완료 시점)**에 신뢰도가 가장 높게 보정되어 위험 인지 개입의 기회를 제공함을 발견했습니다. 마지막으로, 액션 차원별로 미보정 정도가 다르므로 **액션 차원별 Platt 스케일링**과 같은 맞춤형 재보정 기법이 효과적임을 제시하며, VLA를 더욱 신뢰할 수 있는 로봇 시스템으로 만들기 위한 기반을 마련했습니다.
