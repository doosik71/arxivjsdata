# Generalized Zero-Shot Learning via Synthesized Examples

Vinay Kumar Verma, Gundeep Arora, Ashish Mishra and Piyush Rai

## 🧩 Problem to Solve

Zero-shot Learning (ZSL)은 훈련 중 보지 못한 클래스(unseen classes)의 객체를 분류하는 것을 목표로 합니다. 그러나 기존 ZSL 모델은 훈련 및 테스트 클래스가 서로 배타적이라는 가정 하에 작동하며, 이로 인해 실제 시나리오에서 테스트 데이터가 seen 클래스와 unseen 클래스를 모두 포함하는 Generalized Zero-Shot Learning (GZSL) 설정에서는 성능이 크게 저하됩니다. 특히, 기존 ZSL 모델은 seen 클래스 데이터로만 학습되기 때문에 테스트 시 seen 클래스를 예측하는 데 심하게 편향되는 문제가 발생합니다. 본 연구는 이러한 GZSL 설정에서의 seen 클래스 편향 문제를 완화하고, unseen 클래스에서도 강력한 분류 성능을 달성하는 모델을 개발하는 것을 목표로 합니다.

## ✨ Key Contributions

- **생성 프레임워크 제안:** 조건부 VAE(Variational Autoencoder) 기반의 생성 프레임워크인 SE-GZSL(Synthesized Examples for Generalized Zero-Shot Learning)을 제안합니다. 이 모델은 주어진 클래스 속성 벡터를 기반으로 seen/unseen 클래스의 새로운 예시(exemplars)를 효과적으로 생성할 수 있습니다.
- **피드백 기반 판별기(Discriminator) 도입:** 생성된 예시를 해당 클래스 속성 벡터에 매핑하도록 학습하는 다변량 회귀 분석기(discriminator)를 도입했습니다. 이 피드백 메커니즘은 생성기가 더 식별력 있고 클래스에 특화된 예시를 생성하도록 유도하여 생성 품질을 크게 향상시킵니다.
- **GZSL 편향 완화:** unseen 클래스에서 합성된 예시를 생성하고 이를 분류 모델 훈련에 활용함으로써, GZSL 설정에서 seen 클래스 예측에 대한 모델의 편향을 자연스럽게 완화합니다.
- **최첨단 성능 달성:** 여러 벤치마크 데이터셋(AwA1, AwA2, SUN, CUB, ImageNet)에서 표준 ZSL 및 GZSL 모두에서 여러 최첨단 방법(CVAE-ZSL, ALE, DEVISE 등)보다 뛰어난 성능을 보였습니다. 특히 GZSL의 조화 평균(Harmonic Mean)에서 높은 개선을 달성했습니다.
- **유연한 활용:** 생성된 예시들은 어떤 오프라인 분류 모델(예: SVM)이든 훈련하는 데 사용될 수 있으며, 모델은 레이블이 없는 예시를 활용하여 준지도 학습(semi-supervised learning) 설정에서도 작동할 수 있습니다.

## 📎 Related Works

- **매핑 기반 ZSL:** 인스턴스 특징을 클래스 속성 공간으로 직접 또는 간접적으로 매핑하는 방법 [18]. 테스트 시 가장 유사한 속성 벡터를 찾아 클래스를 예측합니다.
- **공유 임베딩 기반 ZSL:** seen 및 unseen 클래스 인스턴스를 클래스-속성 공간에 공동으로 임베딩하는 것을 학습하며 [26, 22], 허브니스(hubness) 문제 [6]와 같은 단점이 있습니다. ALE [1], DEVISE [7], SJE [2] 등이 이 범주에 속합니다.
- **파라미터 조합 기반 ZSL:** 클래스 속성을 사용하여 seen 클래스와 unseen 클래스 간의 관계를 계산하고, unseen 클래스의 파라미터를 seen 클래스 파라미터의 가중치 조합으로 표현하는 방법 [22, 24, 4]. CONSE [22], SYNC [4] 등이 있습니다.
- **생성 모델 기반 ZSL/GZSL:** unseen 클래스에 대한 합성된 레이블 예시를 생성하여 분류 모델을 훈련하는 접근 방식. 본 연구와 유사한 방향으로 [10]은 클래스 조건부 분포를 근사하여 샘플을 합성했고, [3]은 적대적 훈련을 사용하여 시각적 표현을 생성했습니다. GFZSL [30], CVAE-ZSL [21] 등도 생성 모델을 활용합니다. GZSL의 어려운 설정에서 이러한 생성 모델은 seen 클래스 편향을 완화하는 데 유망합니다 [5, 34].

## 🛠️ Methodology

본 연구는 조건부 VAE(Variational Autoencoder) 기반의 생성 모델을 제안하며, 이는 확률적 인코더($p_E(z|x)$), 조건부 생성기($p_G(x|z,a)$), 그리고 피드백 메커니즘을 위한 판별기/회귀분석기($p_R(a|x)$)로 구성됩니다.

1. **모델 구성:**

   - **인코더 ($p_E(z|x)$):** 입력 이미지 $x$를 비구조적 잠재 코드 $z$로 매핑합니다.
   - **조건부 생성기 ($p_G(x|z,a)$):** 잠재 코드 $z$와 클래스 속성 벡터 $a$를 조건으로 하여 이미지 $\hat{x}$를 생성합니다. 여기서 $z$는 클래스 독립적인 요소를, $a$는 클래스별 식별 정보를 나타내어 표현의 분리(disentangled representation)를 유도합니다.
   - **판별기/회귀분석기 ($p_R(a|x)$):** 입력 예시 $x$ (실제 또는 생성된 $\hat{x}$)를 해당 클래스 속성 벡터 $a$에 매핑하는 다출력 회귀 모델입니다. 생성기 품질 향상을 위한 피드백을 제공하고, 준지도 학습 시 레이블 없는 예시의 클래스 속성 분포 $p(a|x)$를 예측하는 데 사용됩니다.

2. **교대 학습 절차 (Alternating Optimization):**
   모델은 회귀분석기($R$)와 인코더-생성기($E, G$) 쌍을 교대로 최적화하는 방식으로 학습됩니다.

   - **회귀분석기 ($R$) 학습:**
     회귀분석기 $\theta_R$는 실제 seen 클래스 데이터와 생성된 데이터 모두에 대해 올바른 클래스 속성 $a$를 예측하도록 학습됩니다.

     - 지도 손실 (Supervised Loss) $L_{Sup}$:
       $$L_{Sup}(\theta_R) = -\mathbb{E}_{\{x_n,a_{y_n}\}}[p_R(a_{y_n}|x_n)]$$
     - 비지도 손실 (Unsupervised Loss) $L_{Unsup}$:
       $$L_{Unsup}(\theta_R) = -\mathbb{E}_{p_{\theta_G}(\hat{x}|z,a)p(z)p(a)}[p_R(a|\hat{x})]$$
     - 총 회귀분석기 손실 $L_R$:
       $$\min_{\theta_R} L_R = L_{Sup} + \lambda_R \cdot L_{Unsup}$$

   - **인코더 ($E$) 및 생성기 ($G$) 학습:**
     인코더 $\theta_E$와 생성기 $\theta_G$는 VAE 손실 외에도 회귀분석기로부터의 피드백을 활용하여 고품질의 클래스별 샘플을 생성하도록 학습됩니다.
     - VAE 손실 $L_{V AE}$:
       $$L_{V AE}(\theta_E,\theta_G) = -\mathbb{E}_{p_E(z|x),p(a|x)}[\log p_G(x|z,a)] + KL(p_E(z|x)||p(z))$$
     - 판별기 유도 일관성 손실 $L_c$: 생성된 $\hat{x}$가 $a$에 일관되도록 유도합니다.
       $$L_c(\theta_G) = -\mathbb{E}_{p_G(\hat{x}|z,a)p(z)p(a)}[\log p_R(a|\hat{x})]$$
     - 정규화 손실 $L_{Reg}$: 임의의 $z$와 $a$에서 좋은 클래스별 샘플을 생성하도록 장려합니다.
       $$L_{Reg}(\theta_G) = -\mathbb{E}_{p(z)p(a)}[\log p_G(\hat{x}|z,a)]$$
     - 분리 손실 $L_E$: $z$와 $a$의 독립성을 강화합니다.
       $$L_E(\theta_G) = -\mathbb{E}_{\hat{x}\sim p_G(\hat{x}|z,a)}KL[(p_E(z|\hat{x})||q(z))]$$
     - 총 인코더-생성기 학습 목표:
       $$\min_{\theta_G,\theta_E} L_{V AE} + \lambda_c \cdot L_c + \lambda_{reg} \cdot L_{Reg} + \lambda_E \cdot L_E$$

3. **최종 분류기 훈련:**
   학습된 생성 모델을 사용하여 unseen 클래스(그리고 선택적으로 seen 클래스)에 대한 레이블된 예시를 충분히 생성합니다. 이 합성된 예시들을 실제 seen 클래스 예시와 함께 사용하여 선형 SVM과 같은 일반 분류기를 훈련합니다. 이 접근 방식은 분류기가 seen 클래스뿐만 아니라 unseen 클래스에서도 학습되도록 하여 GZSL 설정에서의 편향 문제를 효과적으로 해결합니다.

## 📊 Results

- **GZSL 성능 향상:** SUN, CUB, AwA1, AwA2 데이터셋의 GZSL 설정(제안된 분할)에서 unseen 클래스 정확도($Acc_{Y_{ts}}$)와 조화 평균(Harmonic Mean, $H = (2 \cdot Acc_{Y_{tr}} \cdot Acc_{Y_{ts}})/(Acc_{Y_{tr}} + Acc_{Y_{ts}})$) 모두에서 기존 최첨단 방법들을 크게 능가했습니다. 이는 모델이 seen 클래스에 대한 편향을 성공적으로 완화하고 unseen 클래스에서 강력한 성능을 보여줌을 의미합니다. 예를 들어, AwA2 데이터셋에서 제안 모델은 조화 평균 62.8%를 달성하여 CVAE-ZSL (51.2%)을 포함한 다른 모든 모델을 앞섰습니다.
- **전통적인 ZSL 성능:** SUN, CUB, AwA1, AwA2, 그리고 대규모 ImageNet 데이터셋의 전통적인 ZSL 설정에서도 일관되게 우수한 per-class 정확도를 기록했습니다. ImageNet에서는 25.43%의 정확도로 CVAE-ZSL(24.7%)을 능가하며, 데이터셋의 규모와 복잡성에 관계없이 모델의 효과를 입증했습니다.
- **피드백 메커니즘의 중요성:** 피드백 메커니즘을 제거한 모델(SE-ZSL Without Feedback)과의 비교 실험을 통해 피드백 메커니즘과 정교하게 설계된 손실 함수가 모델 성능에 필수적임을 확인했습니다. 특히 CUB와 같은 세분화된 데이터셋에서 피드백 부재 시 성능 저하가 두드러졌습니다.
- **합성 샘플의 품질:** t-SNE 플롯을 사용하여 생성된 샘플의 분포와 실제 샘플의 분포를 비교한 결과, 두 분포가 상당 부분 중첩됨을 보여주며, 이는 모델이 실제 데이터 분포를 잘 모방하는 고품질의 샘플을 생성할 수 있음을 정성적으로 입증합니다.
- **생성된 예시 수의 영향:** 클래스당 생성되는 예시의 수를 변화시켰을 때, 분류 정확도는 생성 예시 수가 증가함에 따라 향상되고 빠르게 수렴함을 확인했습니다. 이는 적은 수의 생성 예시만으로도 효과적인 분류기를 훈련할 수 있음을 시사합니다.

## 🧠 Insights & Discussion

본 연구는 GZSL(Generalized Zero-Shot Learning) 문제 해결을 위한 강력한 생성 프레임워크를 제시합니다. 조건부 VAE 아키텍처와 판별기 기반 피드백 메커니즘의 결합은 고품질의 클래스별 예시를 생성하는 데 핵심적인 역할을 합니다. 이러한 합성 예시를 활용하여 분류 모델을 훈련함으로써, GZSL의 주요 과제인 seen 클래스 예측 편향을 효과적으로 완화할 수 있음을 성공적으로 입증했습니다. 이는 모델이 seen 클래스 데이터에만 의존하지 않고 unseen 클래스에 대한 지식을 활용하기 때문입니다.

모델은 레이블 없는 예시를 활용하여 준지도 학습 설정에서도 작동할 수 있는 유연성을 제공하며, 진정한 데이터 분포를 대표하는 예시를 생성하는 연속 공간 모델 학습의 효과를 강력히 시연했습니다.

**한계 및 향후 연구:**

- VAE 스타일 생성 모델을 사용했지만, 적대적 훈련(adversarial training)으로 확장하면 생성된 예시의 선명도와 사실성을 더욱 향상시킬 수 있을 것입니다 [12].
- 회귀분석기의 예측 능력이 전이 학습 ZSL(transductive ZSL) 설정 [29]에서 성능을 자연스럽게 향상시킬 수 있을 것으로 보이며, 이에 대한 탐구는 향후 연구 과제입니다.
- 소수의 레이블된 새로운 클래스 샘플을 획득하여 모델을 개선하는 few-shot learning의 온라인 설정으로 확장 가능성도 있습니다.

## 📌 TL;DR

본 논문은 GZSL(Generalized Zero-Shot Learning)에서 seen 클래스 편향 문제를 해결하기 위해, 피드백 기반 판별기를 갖춘 조건부 Variational Autoencoder(VAE) 기반의 생성 프레임워크를 제안한다. 이 모델은 주어진 클래스 속성 벡터를 기반으로 고품질의 클래스별 예시를 효과적으로 생성할 수 있다. 생성된 seen 및 unseen 클래스 예시로 오프라인 분류 모델을 훈련함으로써, seen 클래스에 대한 예측 편향을 성공적으로 완화하며 GZSL 및 표준 ZSL 설정 모두에서 최첨단 성능을 달성했다. 정량적 실험 결과와 t-SNE 분포 분석을 통해 생성된 샘플의 품질과 제안 모델의 효율성을 입증한다.
