# Synthesized Classifiers for Zero-Shot Learning

Soravit Changpinyo, Wei-Lun Chao, Boqing Gong, Fei Sha

## 🧩 Problem to Solve

학습 단계에서 레이블링된 예제가 없는 '미확인 클래스(unseen classes)'의 객체를, 레이블링된 예제가 있는 '확인된 클래스(seen classes)'와 연관시켜 정확하게 인식하는 것이 제로샷 학습(Zero-Shot Learning, ZSL)의 목표입니다. 본 논문은 다음과 같은 두 가지 핵심 과제를 해결하고자 합니다:

1. 미확인 클래스를 확인된 클래스와 어떻게 연관시킬 것인가?
2. 레이블링된 데이터가 없는 미확인 클래스에 대해 어떻게 최적의 판별 성능을 달성할 것인가?

## ✨ Key Contributions

- 제로샷 학습 문제를 매니폴드 학습(manifold learning) 관점에서 접근하고, 외부 정보에서 파생된 의미 공간(semantic space)과 시각적 특징 인식과 관련된 모델 공간(model space)을 정렬하는 새로운 아이디어를 제안합니다.
- 의미 공간과 모델 공간 모두에 존재하는 '팬텀 클래스(phantom classes)'를 도입합니다. 이들은 딕셔너리의 기저(bases) 역할을 하며, 실제 객체 분류기 합성을 통해 최적의 판별 성능을 달성하도록 레이블링된 데이터로부터 최적화될 수 있습니다.
- 객체 클래스로 구성된 그래프에서 매니폴드 임베딩을 학습함으로써 미확인 클래스 인식 문제를 해결하는 방법을 제시합니다. 구체적으로, 팬텀 클래스의 위치를 사용하여 그래프를 매개변수화하고, 기저 분류기(base classifiers)의 볼록 조합(convex combinations)을 통해 인식 모델(임베딩)을 도출하는 방법을 설명합니다.
- ImageNet Fall 2011 데이터셋(20,000개 이상의 미확인 클래스 포함)을 포함한 4가지 벤치마크 데이터셋에서 최신 제로샷 학습 방법론 대비 우수한 성능을 입증했습니다.

## 📎 Related Works

본 연구는 다음 선행 연구들과 관련이 있습니다:

- **의미 임베딩 활용:** 속성(attributes) [1, 25, 47], 단어 벡터(word vectors) [13, 33, 38, 44], 웹에서 마이닝된 지식 [10, 30, 37, 38] 등 클래스 레이블의 다양한 의미 임베딩을 활용하여 지식을 전이합니다.
- **임베딩 기반 방법론:** 입력 이미지 표현을 의미 공간으로 매핑한 후 클래스 임베딩이 나타내는 유사도 측정치를 통해 클래스 레이블을 결정합니다 [1, 2, 13, 14, 16, 22, 25, 28, 33, 44, 47]. 일부는 CCA [14, 15, 29]나 희소 코딩(sparse coding) [22, 50, 51]을 사용하여 새로운 표현을 파생합니다.
- **유사성 기반 방법론:** 클래스 간 유사성을 통해 미확인 클래스에 대한 분류기를 구축합니다 [10, 16, 17, 30, 37, 38]. 본 연구는 팬텀 클래스 도입으로 더 풍부한 모델링 유연성을 제공합니다.
- **기저 분류기의 볼록 조합:** 공유 표현을 사용한 다중 작업 학습(multi-task learning) [4]에서 영감을 받았지만, 미확인 클래스 데이터에 접근할 필요가 없습니다.
- [1]의 접근 방식은 본 방법론의 특별한 경우로 간주될 수 있습니다.
- [30]은 확인된 클래스의 사전 학습된 분류기를 조합하고, [33]은 사전 학습된 분류기의 결정 값을 활용하여 의미 임베딩을 가중 평균하는 방식을 사용합니다.
- [50, 51]은 시각 공간과 의미 공간을 정렬하는 유사한 아이디어를 제안하지만, 본 연구와는 다른 접근 방식을 취합니다.

## 🛠️ Methodology

본 논문의 접근 방식은 매니폴드 학습(manifold learning) 아이디어를 기반으로 하며, 다음과 같은 단계로 구성됩니다:

1. **매니폴드 정렬:** 객체 클래스가 의미 임베딩(예: 속성 또는 단어 벡터) $a_c$를 통해 가중치 그래프를 형성하는 '의미 공간'과, 시각적 특징 인식 모델(분류기) $w_c$가 좌표를 이루는 '모델 공간'을 정렬합니다.
2. **팬텀 클래스 도입:** 모델의 유연성을 높이기 위해 실제 객체에 직접 대응하지 않는 $R$개의 '팬텀 클래스'를 도입합니다. 각 팬텀 클래스는 의미 임베딩 $b_r$과 가상 분류기 $v_r$을 가집니다.
3. **가중치 그래프 구성:** 실제 클래스와 팬텀 클래스 간의 가중치 $s_{cr}$는 다음과 같이 정의되는 이분 그래프(bipartite graph)를 형성합니다:
   $$s_{cr} = \frac{\exp\{-d(a_c,b_r)\}}{\sum_{r=1}^{R} \exp\{-d(a_c,b_r)\}}$$
   여기서 $d(a_c,b_r) = (a_c - b_r)^T \Sigma^{-1} (a_c - b_r)$ 이며, 간단화를 위해 $\Sigma = \sigma^2 I$로 설정합니다. 이는 매니폴드 학습 방법론에서 영감을 받았습니다.
4. **분류기 합성:** 의미 공간과 모델 공간을 정렬하기 위해, 실제 클래스의 분류기 $w_c$가 팬텀 클래스의 가상 분류기(기저 분류기) $v_r$의 볼록 조합으로 합성되도록 최적화합니다:
   $$w_c = \sum_{r=1}^{R} s_{cr} v_r$$
5. **팬텀 클래스 학습:**
   - **기저 분류기 학습($v_r$):** 확인된 클래스의 훈련 데이터만을 사용하여 다음 목표 함수를 최소화합니다.
     - One-versus-other 손실:
       $$\min_{\{v_r\}} \sum_{c=1}^{S} \sum_{n=1}^{N} \mathcal{L}(x_n, I_{y_n,c}; w_c) + \frac{\lambda}{2} \sum_{c=1}^{S} \|w_c\|_{2}^{2}$$
       ($w_c = \sum_{r=1}^{R} s_{cr} v_r$ 제약 하에). 여기서 $\mathcal{L}$은 제곱 힌지 손실(squared hinge loss)입니다.
     - 또는 Crammer-Singer 다중 클래스 SVM 손실을 사용하며, 클래스 간 의미론적 관련성을 활용하는 구조화된 손실 $\Delta(c,y_n) = \|a_c - a_{y_n}\|_{2}^{2}$을 추가할 수 있습니다.
   - **의미 임베딩 학습($b_r$):** 팬텀 클래스의 의미 임베딩 $b_r$은 확인된 클래스 속성 벡터 $a_c$의 희소 선형 조합($b_r = \sum_{c=1}^{S} \beta_{rc} a_c$)으로 매개변수화됩니다. $\{\beta_{rc}\}$와 $\{v_r\}$을 동시에 최적화하며, 희소성과 $b_r$의 노름 보존을 위한 정규화 항을 추가합니다.
     - 전체 목적 함수:
       $$\min_{\{v_r\},\{ \beta_{rc}\}} \sum_{c=1}^{S} \sum_{n=1}^{N} \mathcal{L}(x_n, I_{y_n,c}; w_c) + \frac{\lambda}{2} \sum_{c=1}^{S} \|w_c\|_{2}^{2} + \eta \sum_{r,c} |\beta_{rc}| + \frac{\gamma}{2} \sum_{r=1}^{R} (\|b_r\|_{2}^{2} - h^2)^2$$
       이 최적화 문제는 교대 최적화(alternating optimization)를 통해 해결됩니다.
6. **하이퍼파라미터 튜닝:** 제로샷 학습 시나리오를 더 잘 시뮬레이션하기 위해, 기존의 '샘플 단위 교차 검증(sample-wise CV)' 대신 클래스 레이블이 서로 다른 폴드로 분리되는 '클래스 단위 교차 검증(class-wise CV)' 전략을 사용합니다.

## 📊 Results

본 논문의 실험 결과는 다음과 같습니다:

- **전반적인 우수성:** AwA, CUB, SUN, ImageNet의 4가지 벤치마크 데이터셋 대부분의 시나리오에서 제안된 방법론이 최신 기술 대비 최고의 성능을 달성했습니다.
- **대규모 제로샷 학습(ImageNet):** 20,345개의 미확인 클래스를 포함하는 'All' 시나리오에서, 본 방법론(Ours$_{o-vs-o}$ 및 Ours$_{struct}$)은 Flat Hit@K 및 Hierarchical precision@K 모두에서 ConSE [33]보다 지속적으로 우수한 성능을 보였습니다.
- **속성 유형의 영향:** 이진 속성(binary attributes)보다 연속 속성(continuous attributes)이 일반적으로 더 나은 성능을 제공하며, 특히 딥러닝 특징과 함께 사용될 때 더욱 그렇습니다.
- **딥 특징의 이점:** 얕은 특징(shallow features)에 비해 딥 특징(GoogLeNet, AlexNet)을 사용할 때 모든 방법론에서 성능이 크게 향상되었으며, GoogLeNet이 AlexNet보다 우수했습니다.
- **의미 공간 유형(AwA):** 수동으로 주석 달린 속성이 단어 벡터 임베딩보다 더 나은 성능을 보였고, 두 가지를 결합했을 때 가장 좋은 결과를 얻어 상호 보완성을 시사했습니다.
- **기저 분류기 개수:** 팬텀 클래스(기저 분류기)의 개수 $R$이 확인된 클래스 $S$의 약 60%-70%에 달했을 때 성능이 포화되었고, 그 이상 늘려도 큰 이점은 없었습니다.
- **의미 임베딩 학습:** 팬텀 클래스를 위한 속성을 학습하는 것이 성능 향상에 긍정적인 영향을 미칠 수 있음을 시사합니다 (예: AwA 속성 69.7%에서 71.1%로 향상).
- **교차 검증 전략:** 클래스 단위 교차 검증이 샘플 단위 교차 검증보다 약 2% 더 나은 정확도를 보여, 제로샷 학습 시나리오 시뮬레이션의 중요성을 확인했습니다.
- **유사성 지표 학습:** 의미론적 유사성 계산을 위한 지표(Mahalanobis 거리)를 학습하는 것이 성능을 더욱 향상시킬 수 있음을 보여주었습니다 (예: AwA 속성 69.7%에서 73.4%로 향상).
- **확인/미확인 클래스 수의 영향(CUB):** 확인된 클래스 수가 증가하면 성능이 향상되고, 미확인 클래스 수가 증가하면 정확도가 감소하는 경향을 보였습니다.
- **의미 유사성과의 상관관계:** 미확인 클래스가 확인된 클래스와 의미론적으로 더 유사할수록 분류 정확도가 높아지며, 이는 의미 유사성이 제로샷 학습 성능에 중요한 상관관계를 가짐을 나타냅니다.

## 🧠 Insights & Discussion

- **제로샷 학습을 위한 매니폴드 학습:** 본 연구는 제로샷 학습 문제를 의미 공간과 시각 모델 공간을 정렬하는 매니폴드 학습 문제로 성공적으로 재구성했습니다.
- **연결자로서의 팬텀 클래스:** 팬텀 클래스는 확인된 클래스와 미확인 클래스를 효과적으로 연결하며, 분류기 합성을 위한 적응 가능한 기저 역할을 수행합니다. 이는 기존 유사성 기반 방법론보다 풍부한 모델링 유연성을 제공합니다.
- **볼록 조합의 효율성:** 기저 분류기의 볼록 조합을 통해 미확인 클래스에 대한 분류기를 직접적인 레이블링된 데이터 없이 구축하는 것은 효율적이며 효과적인 접근 방식임이 입증되었습니다.
- **확장성:** 20,000개 이상의 미확인 클래스를 포함하는 ImageNet과 같은 대규모 데이터셋에서도 잘 작동하며, 이러한 도전적인 환경에서 최신 기술을 능가하는 성능을 보였습니다.
- **특징의 중요성:** 확인된 클래스에서 학습된 딥 특징이라도 제로샷 학습 작업에 매우 잘 전이되고 강력하며, 연속적인 의미 속성과 결합될 때 특히 효과적입니다.
- **상호 보완적인 의미 공간:** 속성과 단어 벡터는 상호 보완적인 정보를 제공하며, 이를 결합하면 성능을 더욱 향상시킬 수 있습니다.
- **제한 사항 및 향후 연구:**
  - 미확인 클래스가 확인된 클래스와 의미론적으로 너무 이질적일 경우 성능이 저하되는 경향이 있어, 제로샷 학습의 근본적인 한계를 시사합니다.
  - 기저 분류기의 최적 개수는 확인된 클래스 수보다 적을 수 있지만, 일정 수준 이상에서는 성능 향상이 미미합니다.
  - 팬텀 클래스의 의미 임베딩 학습은 가능성을 보였지만, 더 심층적인 연구가 필요합니다.
  - 교대 최적화는 비볼록(nonconvex)하며, 유용한 초기화 휴리스틱에 의존합니다.
  - 향후 연구로 가중치 $s_{cr}$를 정의하는 다른 형태를 탐색하고, 의미 임베딩 학습 및 최적 기저 분류기 개수에 대한 더 심층적인 분석이 제안됩니다.

## 📌 TL;DR

**TL;DR:** 레이블 없는 미확인 클래스를 인식하는 제로샷 학습 문제에 대해, 본 논문은 의미 공간과 시각 모델 공간을 정렬하는 매니폴드 학습 기반의 접근 방식을 제안합니다. 이 방법은 '팬텀 클래스'를 도입하여 적응 가능한 기저 분류기 역할을 하게 하고, 실제 클래스 분류기를 이 기저 분류기들의 볼록 조합으로 합성합니다. 확인된 클래스 데이터로부터 팬텀 클래스 및 기저 분류기를 학습하며, 대규모 ImageNet을 포함한 4개 벤치마크에서 최신 기술보다 우수한 성능을 달성했습니다. 특히 딥 특징과 연속 속성의 조합에서 큰 이점을 보였습니다.
