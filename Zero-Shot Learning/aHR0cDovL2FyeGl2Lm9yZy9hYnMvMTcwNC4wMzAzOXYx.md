# Semantically Consistent Regularization for Zero-Shot Recognition

Pedro Morgado, Nuno Vasconcelos

## 🧩 Problem to Solve

본 논문은 제로샷 학습(Zero-Shot Learning, ZSL)에서 시맨틱(semantics)의 역할을 탐구하며, 기존 ZSL 접근 방식의 한계를 해결하고자 합니다.
주요 문제점은 다음과 같습니다:

- **독립 시맨틱 인식(Recognition using Independent Semantics, RIS)** 방식은 각 시맨틱 속성에 대해 독립적으로 분류기를 학습하여 전체 시맨틱 공간에 제약을 가하지만, 속성 간의 종속성을 모델링하는 능력이 부족합니다. 예를 들어 "날개가 있다"와 "물에 산다"는 강한 음의 상관관계가 있을 수 있습니다.
- **시맨틱 임베딩 인식(Recognition using Semantic Embeddings, RULE)** 방식은 클래스를 시맨틱 공간으로 임베딩하여 다중 클래스 분류기를 학습합니다. 이는 속성 종속성을 모델링할 수 있지만, 학습 클래스에 의해 설명되는 시맨틱 서브스페이스(subspace)만 감독하여 시맨틱 공간의 상당 부분을 제약 없이 남겨둡니다. 특히 보지 못한(unseen) 클래스의 시맨틱 코드가 학습 클래스 서브스페이스와 정렬되지 않으면 예측 정확도가 떨어집니다.
- **상호 보완성의 활용 부족**: RIS는 모든 속성을 제약하지만 종속성을 무시하고, RULE은 종속성을 모델링하지만 많은 속성 차원을 제약하지 못합니다. 이 두 방식의 상호 보완적인 장점을 활용하는 통합된 프레임워크가 필요합니다.

## ✨ Key Contributions

- **SCoRe (Semantically Consistent Regularization) 프레임워크 제안**: RIS와 RULE의 장점을 모두 활용하는 새로운 컨볼루션 신경망(CNN) 기반 ZSL 프레임워크를 제안합니다.
- **두 가지 시맨틱 제약(정규화) 도입**:
  1. **손실 기반 정규화(Loss-based regularization)**: RIS와 유사하게 각 시맨틱 예측기에 일반화 제약을 도입하여 속성 예측의 정확성을 높이고, 학습 클래스 서브스페이스를 넘어서는 속성 분포를 제약합니다.
  2. **코드워드 정규화(Codeword regularization)**: RULE과 유사하게 학습된 분류 코드($w_c$)가 사전 시맨틱 지식(시맨틱 코드 $\varphi(c)$)과 일치하도록 유도하면서도 데이터로부터 이들을 학습할 수 있도록 합니다. 이는 속성 종속성을 모델링합니다.
- **다양한 시맨틱 개념 지원**: 이진 속성 외에도 계층(taxonomy) 및 Word2Vec 임베딩과 같은 다양한 시맨틱 개념을 SCoRe 프레임워크에서 통합하고 활용할 수 있음을 보여줍니다.
- **최첨단 성능 달성**: 여러 데이터셋에서 기존 최첨단 ZSL 방법에 비해 상당한 성능 향상을 달성합니다.

## 📎 Related Works

- **시맨틱 표현(Semantic Representations)**: 초기 작업은 클래스 자체를 시맨틱으로 활용했으며 [44, 45, 55, 56], 최근에는 보조 시맨틱 어휘를 사용하는 연구가 진행되었습니다.
- **제로샷 학습(Zero-Shot Learning, ZSL)**: [2, 4, 14, 31, 48, 49] 등에서 연구되었으며, 크게 두 가지 범주로 나뉩니다.
  - **RIS (Recognition using Independent Semantics)**: 대표적으로 DAP(Direct Attribute Prediction) [31]가 있으며, 속성 간의 상관관계를 사후에 모델링하는 CRF [10], 베이지안 네트워크 [58] 등의 개선 연구가 있었습니다.
  - **RULE (Recognition using Semantic Embeddings)**: [2]에서 도입되었으며, $\varphi(y)$와 같은 임베딩 함수를 통해 클래스 $y$를 속성 공간으로 매핑하는 방식입니다. 다양한 정규화 항 [43, 49]이나 개선된 시맨틱 표현 [1, 47]을 사용하는 변형들이 제안되었습니다.
- **시맨틱 개념**: 시각적 속성(visual attributes) [14, 31], 계층/분류 체계(hierarchies/taxonomies) [2, 4, 48, 60], 단어 벡터 표현(Word2Vec 등) [4, 8, 16, 18, 20, 41, 43, 47, 60] 등이 탐구되었습니다.
- **CNN 아키텍처**: AlexNet [28], GoogLeNet [54], VGG [51] 등의 대중적인 모델이 특징 추출기로 활용되었습니다.

## 🛠️ Methodology

SCoRe는 CNN을 다차원 분류 코드에 대한 최적의 분류기로 해석하며, 이를 시맨틱(최상위 계층 이전)과 클래스(최상위 계층) 간의 매핑으로 간주합니다. 이 프레임워크는 RIS와 RULE의 장점을 결합하기 위해 두 가지 정규화 메커니즘을 사용합니다.

1. **Deep-SCoRe 아키텍처 (그림 3)**

   - **특징 추출**: AlexNet, GoogLeNet, VGG 등 일반적인 CNN 아키텍처를 사용하여 이미지 특징 벡터 $\theta(x; \Theta)$를 계산합니다.
   - **시맨틱 예측기**: 특징 벡터 $\theta(x; \Theta)$에 선형 변환 $T$를 적용하여 시맨틱 예측기 출력 $f(x) = T^T \theta(x; \Theta)$를 얻습니다. 이는 속성 점수 벡터가 됩니다.
   - **시맨틱 인코딩(SE) 계층**:
     - **첫 번째 SE 계층**: $Q$개의 병렬 완전 연결 계층으로 구성됩니다. 각 브랜치 $k$는 시맨틱 $k$의 각 $S_k$ 상태에 대한 시맨틱 점수 $u^{(k)}_i(x) = \langle w^{(k)}_i, f_k(x) \rangle$를 계산합니다. 각 브랜치의 가중치 $w^{(k)}_i$는 코드워드 정규화에 따라 학습됩니다.
     - **두 번째 SE 계층**: 각 클래스 $c$에 대해, 시맨틱 $k$의 상태 $s^c_k$에 해당하는 각 브랜치에서 단일 출력을 선택하고 이들을 합산하여 클래스 인식 점수 $h_c(x) = \sum_k \langle w^{(k)}_{s^c_k}, f_k(x) \rangle$를 얻습니다. 이 계층의 가중치는 0과 1로 미리 결정되어 학습 중 고정됩니다.

2. **SCoRe 목적 함수 (식 13)**:
   $$ \underset{\Theta,T,W}{\text{minimize}} \sum_i L(h(x^{(i)};W,T,\Theta),y^{(i)}) + \lambda \sum_i \sum_k L_b(f_k(x^{(i)};t_k,\Theta),s^{(i)}\_k) + \beta \Omega[W] $$

   - **클래스 분류 손실**: 첫 번째 항은 표준 교차 엔트로피 손실 $L$로, 이미지 $x^{(i)}$를 실제 클래스 $y^{(i)}$로 분류하는 것을 목표로 합니다.
   - **손실 기반 정규화**: 두 번째 항은 $\lambda$로 가중되는 RIS와 유사한 부분입니다. $L_b$는 이진 교차 엔트로피 손실로, 각 시맨틱 예측기 $f_k(x)$가 실제 시맨틱 레이블 $s^{(i)}_k$를 정확하게 예측하도록 강제합니다. 이는 ZSL 전이를 위한 일반화 제약을 제공합니다.
   - **코드워드 정규화**: 세 번째 항은 $\beta$로 가중되는 RULE과 유사한 부분입니다. $\Omega[W] = \frac{1}{2} \sum_{c=1}^C ||w_c - \varphi(c)||^2$는 학습된 분류 코드 $w_c$가 미리 정의된 시맨틱 코드 $\varphi(c)$와 유사하도록 유도합니다. 이를 통해 속성 종속성이 모델링됩니다.
   - **하이퍼파라미터 $\lambda$, $\beta$**: 이 두 라그랑주 승수는 정규화 제약의 강도를 조절합니다. $\lambda=\beta=0$일 경우 일반적인 CNN 분류기가 되고, $\lambda$를 증가시키면 Deep-RIS에, $\beta$를 증가시키면 Deep-RULE에 가까워집니다.

3. **시맨틱 인코딩**:
   - **속성(Attributes)**: 이진 속성($\varphi_k(y) \in \{-1, 1\}$) 또는 연속 속성($\varphi_k(y) \in [-1, 1]$)을 사용합니다.
   - **계층(Taxonomies)**: WordNet [40]과 같은 계층 구조를 활용합니다. 각 노드는 시맨틱 개념으로 해석되며, 각 노드에 대해 가능한 자식 노드와 거부(reject) 옵션을 식별하는 시맨틱 상태 코드워드 집합 $\Psi^{(k)}$가 정의됩니다 (그림 2 참조).
   - **Word2Vec**: Word2Vec [39] 모델을 사용하여 단어 임베딩 $\xi(w)$를 생성하고 이를 시맨틱 코드로 사용합니다. 여러 인코딩 계층 크기와 윈도우 크기를 조합하여 $Q$개의 Word2Vec 코드워드 집합을 생성한 후 이들을 연결하여 최종 시맨틱 코드 $\varphi(y)$를 구성합니다.

## 📊 Results

- **데이터셋**: Animals with Attributes (AwA), Caltech-UCSD Birds 200-2011 (CUB), Imaging FlowCytobot (IFCB)를 사용했습니다.
- **정규화 효과**:
  - 코드워드 정규화와 손실 기반 정규화 모두 Deep-RULE에 비해 ZS-MCA (Zero-Shot Mean Class Accuracy)를 유의미하게 향상시켰습니다.
  - 코드워드 정규화는 중간 수준의 $\beta$ 값에서 최상의 결과를 보였는데, 이는 시맨틱과 분류 코드 간의 일관성을 장려하면서도 더 나은 분류 코드를 학습할 수 있는 유연성을 제공하기 때문입니다.
  - Deep-SCoRe는 Deep-RIS보다 항상 우수한 성능을 보였으며, 이는 속성 종속성 모델링의 중요성을 확인시켜 주었습니다.
  - 손실 기반 정규화는 학습 클래스와 ZS 클래스 간의 시맨틱 정렬이 낮을수록 (IFCB > AwA > CUB 순) 성능 향상이 더 크게 나타나, 이 가설을 뒷받침합니다 (그림 4).
- **최첨단 방법과의 비교 (표 3)**:
  - Deep-SCoRe는 모든 데이터셋(AwA, CUB)과 모든 CNN 아키텍처(AlexNet, GoogLeNet, VGG19)에서 이전의 모든 최첨단 방법을 능가하는 성능을 달성했습니다. 예를 들어, AwA에서 4.1%에서 6.5%, CUB에서 3.7%에서 10.5%의 상당한 ZS-MCA 향상을 보였습니다.
- **다양한 시맨틱 개념 활용 (그림 5)**:
  - 속성(Attributes)이 분류 체계(Taxonomies)나 Word2Vec 임베딩보다 ZSL 성능에서 가장 효과적인 전이를 가능하게 했습니다. 이는 속성이 객체 클래스의 식별 가능한 속성을 잘 나타내기 때문입니다.
  - Deep-SCoRe의 태스크-민감 정규화(task-sensitive regularization)는 사용된 시맨틱 유형(속성, 계층, Word2Vec)에 관계없이 다른 모든 접근 방식(DAP, SJE, ES-ZSL)보다 일관되게 우수했습니다.

## 🧠 Insights & Discussion

- **시맨틱 감독의 상호 보완성**: 이 논문은 기존 RIS (개별 속성 감독)와 RULE (속성 종속성 감독) 접근 방식의 상호 보완성을 효과적으로 활용하는 것이 ZSL 성능 향상에 결정적임을 입증했습니다.
- **태스크-민감 정규화의 중요성**: SCoRe에서 제안된 손실 기반 정규화와 코드워드 정규화는 ZSL의 전이 능력을 향상시키는 데 있어 단순히 모델의 복잡도를 줄이는 태스크-무감각 정규화(task-insensitive regularization)보다 훨씬 효과적입니다. 학습된 분류 코드를 고정하지 않고 시맨틱 코드와 유사하게 정규화하면서 학습하는 것이 더 나은 유연성과 성능을 제공합니다.
- **시맨틱 정렬의 영향**: 학습 클래스와 ZS 클래스 시맨틱 서브스페이스 간의 정렬 정도가 낮을수록 손실 기반 정규화의 중요성이 커지는 것으로 나타났습니다.
- **속성 시맨틱의 우월성**: 시각적 속성은 분류 체계나 Word2Vec 임베딩보다 ZSL에서 객체 클래스의 식별 능력이 높아 가장 효과적인 시맨틱으로 확인되었습니다.
- **제한 사항**: 논문은 SCoRe의 구체적인 한계나 실패 사례에 대한 심도 있는 분석보다는 강점과 실험적 검증에 주로 초점을 맞추고 있습니다.

## 📌 TL;DR

**문제**: 기존 제로샷 학습(ZSL) 방법인 RIS는 속성 종속성을 무시하고, RULE은 시맨틱 공간의 일부만 제약하는 상호 보완적인 약점이 있습니다.
**해결책**: 본 논문은 **SCoRe (Semantically Consistent Regularization)** 프레임워크를 제안합니다. SCoRe는 개별 속성 예측을 위한 **손실 기반 정규화** (RIS-유사)와 학습된 분류 코드를 시맨틱 지식과 정렬시키는 **코드워드 정규화** (RULE-유사)의 두 가지 시맨틱 제약을 도입하여 이 두 방식의 장점을 통합합니다.
**주요 발견**: SCoRe는 기존 최첨단 ZSL 방법을 모든 데이터셋에서 크게 능가하며, 개별 속성 제약(1차)과 속성 종속성 제약(2차)을 모두 활용하여 보지 못한 클래스에 대한 전이 가능성과 예측 정확도를 획기적으로 향상시켰습니다. 특히 시각적 속성이 가장 효과적인 시맨틱 유형으로 나타났습니다.
